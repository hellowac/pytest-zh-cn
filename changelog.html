<!doctype html>
<html class="no-js" lang="zh-CN" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="search" title="Search" href="search.html" /><link rel="next" title="贡献" href="contributing.html" /><link rel="prev" title="使用自定义目录收集器" href="example/customdirectory.html" />
        <link rel="canonical" href="https://docs.pytest.org/en/stable/changelog.html" />

    <link rel="shortcut icon" href="_static/favicon.png"/><!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>更改日志 - pytest documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/pygments_pytest.css" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css?v=a5c4661c" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="_static/pytest-custom.css?v=eb7c59a4" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">pytest documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="_static/pytest1.png" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">入门</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="how-to/index.html">操作指南</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of 操作指南</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="how-to/usage.html">如何调用 pytest</a></li>
<li class="toctree-l2"><a class="reference internal" href="how-to/assert.html">如何在测试中编写和报告断言</a></li>
<li class="toctree-l2"><a class="reference internal" href="how-to/fixtures.html">如何使用 fixture</a></li>
<li class="toctree-l2"><a class="reference internal" href="how-to/mark.html">如何用属性标记测试函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="how-to/parametrize.html">如何参数化fixtures和测试函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="how-to/tmp_path.html">如何在测试中使用临时目录和文件</a></li>
<li class="toctree-l2"><a class="reference internal" href="how-to/monkeypatch.html">如何使用 猴子补丁/mock 模块和环境</a></li>
<li class="toctree-l2"><a class="reference internal" href="how-to/doctest.html">如何运行文档测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="how-to/cache.html">如何重新运行失败的测试并在测试运行之间保持状态</a></li>
<li class="toctree-l2"><a class="reference internal" href="how-to/failures.html">如何处理测试失败</a></li>
<li class="toctree-l2"><a class="reference internal" href="how-to/output.html">管理 pytest 的输出</a></li>
<li class="toctree-l2"><a class="reference internal" href="how-to/logging.html">如何管理日志记录</a></li>
<li class="toctree-l2"><a class="reference internal" href="how-to/capture-stdout-stderr.html">如何捕获 stdout/stderr 输出</a></li>
<li class="toctree-l2"><a class="reference internal" href="how-to/capture-warnings.html">如何捕获警告</a></li>
<li class="toctree-l2"><a class="reference internal" href="how-to/skipping.html">如何使用 skip 和 xfail 处理无法成功的测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="how-to/plugins.html">如何安装和使用插件</a></li>
<li class="toctree-l2"><a class="reference internal" href="how-to/writing_plugins.html">编写插件</a></li>
<li class="toctree-l2"><a class="reference internal" href="how-to/writing_hook_functions.html">编写钩子函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="how-to/existingtestsuite.html">如何将 pytest 与现有测试套件结合使用</a></li>
<li class="toctree-l2"><a class="reference internal" href="how-to/unittest.html">如何在 pytest 中使用基于 unittest 的测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="how-to/xunit_setup.html">如何实现 xunit 样式的设置</a></li>
<li class="toctree-l2"><a class="reference internal" href="how-to/bash-completion.html">如何设置 bash 补全</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="reference/index.html">参考指南</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of 参考指南</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="reference/reference.html">API 参考</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/fixtures.html">Fixtures 参考</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/customize.html">配置</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/exit-codes.html">退出码</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/plugin_list.html">Pytest 插件列表</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="explanation/index.html">解答</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of 解答</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="explanation/anatomy.html">测试剖析</a></li>
<li class="toctree-l2"><a class="reference internal" href="explanation/fixtures.html">关于 fixtures</a></li>
<li class="toctree-l2"><a class="reference internal" href="explanation/goodpractices.html">良好的集成实践</a></li>
<li class="toctree-l2"><a class="reference internal" href="explanation/pythonpath.html">pytest 导入机制和 <code class="docutils literal notranslate"><span class="pre">sys.path</span></code> / <code class="docutils literal notranslate"><span class="pre">PYTHONPATH</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="explanation/ci.html">CI Pipelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="explanation/flaky.html">不稳定的测试</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="example/index.html">示例和自定义技巧</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of 示例和自定义技巧</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="example/reportingdemo.html">使用 pytest 的 Python 故障报告演示</a></li>
<li class="toctree-l2"><a class="reference internal" href="example/simple.html">基本模式和示例</a></li>
<li class="toctree-l2"><a class="reference internal" href="example/parametrize.html">参数化测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="example/markers.html">使用自定义标记</a></li>
<li class="toctree-l2"><a class="reference internal" href="example/special.html">可以查看所有收集到的测试的会话fixture</a></li>
<li class="toctree-l2"><a class="reference internal" href="example/pythoncollection.html">改变标准 (Python) 测试的发现机制</a></li>
<li class="toctree-l2"><a class="reference internal" href="example/nonpython.html">使用非 Python 测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="example/customdirectory.html">使用自定义目录收集器</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">关于项目</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">更改日志</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">贡献</a></li>
<li class="toctree-l1"><a class="reference internal" href="backwards-compatibility.html">向后兼容政策</a></li>
<li class="toctree-l1"><a class="reference internal" href="backwards-compatibility.html#id2">历史</a></li>
<li class="toctree-l1"><a class="reference internal" href="backwards-compatibility.html#python">Python版本支持</a></li>
<li class="toctree-l1"><a class="reference internal" href="sponsor.html">赞助</a></li>
<li class="toctree-l1"><a class="reference internal" href="tidelift.html">pytest 企业版</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">许可</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">联系渠道</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">游泳的链接</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://pypi.org/project/pytest/">pytest @ PyPI</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/pytest-dev/pytest/">pytest @ GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/pytest-dev/pytest/issues">Issue Tracker</a></li>
<li class="toctree-l1"><a class="reference external" href="https://media.readthedocs.org/pdf/pytest/latest/pytest.pdf">PDF Documentation</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          

<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="changelog">
<span id="id1"></span><h1>更改日志<a class="headerlink" href="#changelog" title="Link to this heading">¶</a></h1>
<p><strong>Changelog</strong></p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-0-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-0-0-0" name="0-0" role="tab" tabindex="0">中文</button><button aria-controls="panel-0-0-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-1" name="0-1" role="tab" tabindex="-1">英文</button></div><div aria-labelledby="tab-0-0-0" class="sphinx-tabs-panel" id="panel-0-0-0" name="0-0" role="tabpanel" tabindex="0"><p>版本遵循 <a class="reference external" href="https://semver.org/">语义版本控制</a>  (<code class="docutils literal notranslate"><span class="pre">&lt;major&gt;.&lt;minor&gt;.&lt;patch&gt;</span></code>)。</p>
<p>向后不兼容（重大）更改将仅在主要版本中引入，并在发布的 <strong>弃用</strong> 部分中提前通知。</p>
</div><div aria-labelledby="tab-0-0-1" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-1" name="0-1" role="tabpanel" tabindex="0"><p>Versions follow <a class="reference external" href="https://semver.org/">Semantic Versioning</a> (<code class="docutils literal notranslate"><span class="pre">&lt;major&gt;.&lt;minor&gt;.&lt;patch&gt;</span></code>).</p>
<p>Backward incompatible (breaking) changes will only be introduced in major versions
with advance notice in the <strong>Deprecations</strong> section of releases.</p>
</div></div>
<section id="to-be-included-in-vrelease-if-present">
<h2>To be included in v0.1 (if present)<a class="headerlink" href="#to-be-included-in-vrelease-if-present" title="Link to this heading">¶</a></h2>
<section id="pytest-release-unreleased-draft-2024-10-30">
<h3>pytest 0.1 [UNRELEASED DRAFT] (2024-10-30)<a class="headerlink" href="#pytest-release-unreleased-draft-2024-10-30" title="Link to this heading">¶</a></h3>
<section id="new-features">
<h4>New features<a class="headerlink" href="#new-features" title="Link to this heading">¶</a></h4>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12765">#12765</a>: Thresholds to trigger snippet truncation can now be set with <a class="reference internal" href="reference/reference.html#confval-39"><code class="xref std std-confval docutils literal notranslate"><span class="pre">truncation_limit_lines</span></code></a> and <a class="reference internal" href="reference/reference.html#confval-38"><code class="xref std std-confval docutils literal notranslate"><span class="pre">truncation_limit_chars</span></code></a>.</p>
<p>See <a class="reference internal" href="how-to/output.html#truncation-params"><span class="std std-ref">修改截断限制</span></a> for more information.</p>
</li>
</ul>
</section>
<section id="improvements-in-existing-functionality">
<h4>Improvements in existing functionality<a class="headerlink" href="#improvements-in-existing-functionality" title="Link to this heading">¶</a></h4>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11118">#11118</a>: Now <a class="reference internal" href="reference/reference.html#confval-33"><code class="xref std std-confval docutils literal notranslate"><span class="pre">pythonpath</span></code></a> configures <code class="docutils literal notranslate"><span class="pre">$PYTHONPATH</span></code> earlier than before during the initialization process, which now also affects plugins loaded via the <code class="docutils literal notranslate"><span class="pre">-p</span></code> command-line option.</p>
<p>– by <a class="reference external" href="https://github.com/sponsors/millerdev">&#64;millerdev</a></p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11372">#11372</a>: Async tests will now fail, instead of warning+skipping, if you don’t have any suitable plugin installed.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12707">#12707</a>: Exception chains can be navigated when dropped into Pdb in Python 3.13+.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4112">#4112</a>: Using <a class="reference internal" href="reference/reference.html#pytest-mark-usefixtures-ref"><span class="std std-ref">pytest.mark.usefixtures</span></a> on <a class="reference internal" href="reference/reference.html#pytest.param" title="pytest.param"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.param()</span></code></a> now produces an error instead of silently doing nothing.</p></li>
<li><dl>
<dt><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6985">#6985</a>: Improved <a class="reference internal" href="reference/reference.html#pytest.approx" title="pytest.approx"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.approx()</span></code></a> to enhance the readability of value ranges and tolerances between 0.001 and 1000.</dt><dd><ul>
<li><p>The <code class="docutils literal notranslate"><span class="pre">repr</span></code> method now provides clearer output for values within those ranges, making it easier to interpret the results.</p></li>
<li><p>Previously, the output for those ranges of values and tolerances was displayed in scientific notation (e.g., <code class="docutils literal notranslate"><span class="pre">42</span> <span class="pre">±</span> <span class="pre">1.0e+00</span></code>). The updated method now presents the tolerance as a decimal for better readability (e.g., <code class="docutils literal notranslate"><span class="pre">42</span> <span class="pre">±</span> <span class="pre">1</span></code>).</p>
<p>Example:</p>
<p><strong>Previous Output:</strong></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt; pytest.approx(42, abs=1)</span>
<span class="go">42 ± 1.0e+00</span>
</pre></div>
</div>
<p><strong>Current Output:</strong></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt; pytest.approx(42, abs=1)</span>
<span class="go">42 ± 1</span>
</pre></div>
</div>
</li>
</ul>
<p>– by <a class="reference external" href="https://github.com/sponsors/fazeelghafoor">&#64;fazeelghafoor</a></p>
</dd>
</dl>
</li>
</ul>
</section>
<section id="bug-fixes">
<h4>Bug fixes<a class="headerlink" href="#bug-fixes" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12008">#12008</a>: In <a class="reference external" href="https://github.com/pytest-dev/pytest/pull/11220">#11220</a>, an unintended change in reordering was introduced by changing the way indices were assigned to direct params. More specifically, before that change, the indices of direct params to metafunc’s callspecs were assigned after all parametrizations took place. Now, that change is reverted.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12592">#12592</a>: Fixed <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#KeyError" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">KeyError</span></code></a> crash when using <code class="docutils literal notranslate"><span class="pre">--import-mode=importlib</span></code> in a directory layout where a directory contains a child directory with the same name.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12818">#12818</a>: Assertion rewriting now preserves the source ranges of the original instructions, making it play well with tools that deal with the <code class="docutils literal notranslate"><span class="pre">AST</span></code>, like <a class="reference external" href="https://github.com/alexmojaki/executing">executing</a>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9037">#9037</a>: Honor <a class="reference internal" href="reference/reference.html#confval-4"><code class="xref std std-confval docutils literal notranslate"><span class="pre">disable_test_id_escaping_and_forfeit_all_rights_to_community_support</span></code></a> when escaping ids in parametrized tests.</p></li>
</ul>
</section>
<section id="improved-documentation">
<h4>Improved documentation<a class="headerlink" href="#improved-documentation" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10558">#10558</a>: Fix ambiguous docstring of <a class="reference internal" href="reference/reference.html#pytest.Config.getoption" title="pytest.Config.getoption"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.Config.getoption()</span></code></a>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12866">#12866</a>: Improved cross-references concerning the <a class="reference internal" href="reference/reference.html#std-fixture-recwarn"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">recwarn</span></code></a> fixture.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6649">#6649</a>: Added <a class="reference internal" href="reference/reference.html#pytest.TerminalReporter" title="pytest.TerminalReporter"><code class="xref py py-class docutils literal notranslate"><span class="pre">TerminalReporter</span></code></a> to the <a class="reference internal" href="reference/reference.html#api-reference"><span class="std std-ref">API 参考</span></a> documentation page.</p></li>
</ul>
</section>
<section id="contributor-facing-changes">
<h4>Contributor-facing changes<a class="headerlink" href="#contributor-facing-changes" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12497">#12497</a>: Fixed two failing pdb-related tests on Python 3.13.</p></li>
</ul>
</section>
<section id="miscellaneous-internal-changes">
<h4>Miscellaneous internal changes<a class="headerlink" href="#miscellaneous-internal-changes" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12346">#12346</a>: Tests will now fail, instead of raising a warning, if they return any value other than None.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6649">#6649</a>: Added <a class="reference internal" href="reference/reference.html#pytest.TerminalReporter" title="pytest.TerminalReporter"><code class="xref py py-class docutils literal notranslate"><span class="pre">TerminalReporter</span></code></a> to the public pytest API, as it is part of the signature of the <a class="reference internal" href="reference/reference.html#std:hook-38"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_terminal_summary</span></code></a> hook.</p></li>
</ul>
</section>
</section>
</section>
<section id="released-versions">
<h2>Released versions<a class="headerlink" href="#released-versions" title="Link to this heading">¶</a></h2>
</section>
<section id="pytest-8-3-3-2024-09-09">
<h2>pytest 8.3.3 (2024-09-09)<a class="headerlink" href="#pytest-8-3-3-2024-09-09" title="Link to this heading">¶</a></h2>
<section id="bug">
<h3>bug修复<a class="headerlink" href="#bug" title="Link to this heading">¶</a></h3>
<p><strong>Bug fixes</strong></p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-1-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-1-1-0" name="1-0" role="tab" tabindex="0">中文</button><button aria-controls="panel-1-1-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-1-1-1" name="1-1" role="tab" tabindex="-1">英文</button></div><div aria-labelledby="tab-1-1-0" class="sphinx-tabs-panel" id="panel-1-1-0" name="1-0" role="tabpanel" tabindex="0"><ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12446">#12446</a>：避免在装置发现期间调用 <a href="#id20"><span class="problematic" id="id21">``</span></a>&#64;property``（和其他实例描述符）–by <a class="reference external" href="https://github.com/sponsors/asottile">&#64;asottile</a></p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12659">#12659</a>：修复了在 pytest&gt;=8.1 中使用参数 <code class="docutils literal notranslate"><span class="pre">--import-mode=importlib</span></code> 时不显示断言失败差异的问题。</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12667">#12667</a>：修复了 <code class="docutils literal notranslate"><span class="pre">ExceptionInfo.errisinstance</span></code> 中的类型更改导致 <code class="docutils literal notranslate"><span class="pre">mypy</span></code> 失败的回归问题。</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12744">#12744</a>：修复了与 Python 3.9 或更低版本的类型兼容性 - 将 <code class="docutils literal notranslate"><span class="pre">typing.Self</span></code> 替换为 <code class="docutils literal notranslate"><span class="pre">typing_extensions.Self</span></code> - 作者：<a class="reference external" href="https://github.com/sponsors/Avasam">&#64;Avasam</a></p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12745">#12745</a>：修复了 Windows 上 nodeid 路径中反斜杠转换错误的问题，确保跨环境的路径处理一致。</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6682">#6682</a>：修复了打印失败断言的“msg”部分时不遵守详细程度的错误（如 <code class="docutils literal notranslate"><span class="pre">assert</span> <span class="pre">condition,</span> <span class="pre">msg</span></code>）。</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9422">#9422</a>: 修复通过 <code class="docutils literal notranslate"><span class="pre">-p</span> <span class="pre">no:terminal</span></code> 禁用终端插件会导致因缺少 <code class="docutils literal notranslate"><span class="pre">verbose</span></code> 选项而崩溃的错误。</p>
<p>– 作者：<a class="reference external" href="https://github.com/sponsors/GTowers1">&#64;GTowers1</a></p>
</li>
</ul>
</div><div aria-labelledby="tab-1-1-1" class="sphinx-tabs-panel" hidden="true" id="panel-1-1-1" name="1-1" role="tabpanel" tabindex="0"><ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12446">#12446</a>: Avoid calling <code class="docutils literal notranslate"><span class="pre">&#64;property</span></code> (and other instance descriptors) during fixture discovery – by <a class="reference external" href="https://github.com/sponsors/asottile">&#64;asottile</a></p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12659">#12659</a>: Fixed the issue of not displaying assertion failure differences when using the parameter <code class="docutils literal notranslate"><span class="pre">--import-mode=importlib</span></code> in pytest&gt;=8.1.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12667">#12667</a>: Fixed a regression where type change in <code class="docutils literal notranslate"><span class="pre">ExceptionInfo.errisinstance</span></code> caused <code class="docutils literal notranslate"><span class="pre">mypy</span></code> to fail.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12744">#12744</a>: Fixed typing compatibility with Python 3.9 or less – replaced <code class="docutils literal notranslate"><span class="pre">typing.Self</span></code> with <code class="docutils literal notranslate"><span class="pre">typing_extensions.Self</span></code> – by <a class="reference external" href="https://github.com/sponsors/Avasam">&#64;Avasam</a></p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12745">#12745</a>: Fixed an issue with backslashes being incorrectly converted in nodeid paths on Windows, ensuring consistent path handling across environments.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6682">#6682</a>: Fixed bug where the verbosity levels where not being respected when printing the “msg” part of failed assertion (as in <code class="docutils literal notranslate"><span class="pre">assert</span> <span class="pre">condition,</span> <span class="pre">msg</span></code>).</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9422">#9422</a>: Fix bug where disabling the terminal plugin via <code class="docutils literal notranslate"><span class="pre">-p</span> <span class="pre">no:terminal</span></code> would cause crashes related to missing the <code class="docutils literal notranslate"><span class="pre">verbose</span></code> option.</p>
<p>– by <a class="reference external" href="https://github.com/sponsors/GTowers1">&#64;GTowers1</a></p>
</li>
</ul>
</div></div>
</section>
<section id="id35">
<h3>改进的文档<a class="headerlink" href="#id35" title="Link to this heading">¶</a></h3>
<p><strong>Improved documentation</strong></p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-2-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-2-2-0" name="2-0" role="tab" tabindex="0">中文</button><button aria-controls="panel-2-2-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-2-2-1" name="2-1" role="tab" tabindex="-1">英文</button></div><div aria-labelledby="tab-2-2-0" class="sphinx-tabs-panel" id="panel-2-2-0" name="2-0" role="tabpanel" tabindex="0"><ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12663">#12663</a>：澄清当取消选择项目时，应从 <code class="docutils literal notranslate"><span class="pre">pytest_collection_modifyitems</span></code> 钩子实现中调用 <code class="docutils literal notranslate"><span class="pre">pytest_deselected</span></code> 钩子。</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12678">#12678</a>：从文档中的 <code class="docutils literal notranslate"><span class="pre">tmp_path_retention_policy</span></code> 示例中删除错误的引号。</p></li>
</ul>
</div><div aria-labelledby="tab-2-2-1" class="sphinx-tabs-panel" hidden="true" id="panel-2-2-1" name="2-1" role="tabpanel" tabindex="0"><ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12663">#12663</a>: Clarify that the <code class="docutils literal notranslate"><span class="pre">pytest_deselected</span></code> hook should be called from <code class="docutils literal notranslate"><span class="pre">pytest_collection_modifyitems</span></code> hook implementations when items are deselected.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12678">#12678</a>: Remove erroneous quotes from <code class="docutils literal notranslate"><span class="pre">tmp_path_retention_policy</span></code> example in docs.</p></li>
</ul>
</div></div>
</section>
<section id="id40">
<h3>Miscellaneous internal changes<a class="headerlink" href="#id40" title="Link to this heading">¶</a></h3>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-3-3-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-3-3-0" name="3-0" role="tab" tabindex="0">中文</button><button aria-controls="panel-3-3-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-3-3-1" name="3-1" role="tab" tabindex="-1">英文</button></div><div aria-labelledby="tab-3-3-0" class="sphinx-tabs-panel" id="panel-3-3-0" name="3-0" role="tabpanel" tabindex="0"><ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12769">#12769</a>: 修复 codespell 发现的拼写错误，并将 codespell 添加到预提交挂钩中。</p></li>
</ul>
</div><div aria-labelledby="tab-3-3-1" class="sphinx-tabs-panel" hidden="true" id="panel-3-3-1" name="3-1" role="tabpanel" tabindex="0"><ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12769">#12769</a>: Fix typos discovered by codespell and add codespell to pre-commit hooks.</p></li>
</ul>
</div></div>
</section>
</section>
<section id="pytest-8-3-2-2024-07-24">
<h2>pytest 8.3.2 (2024-07-24)<a class="headerlink" href="#pytest-8-3-2-2024-07-24" title="Link to this heading">¶</a></h2>
<section id="id43">
<h3>Bug fixes<a class="headerlink" href="#id43" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12652">#12652</a>: Resolve regression <code class="docutils literal notranslate"><span class="pre">conda</span></code> environments where no longer being automatically detected.</p>
<p>– by <a class="reference external" href="https://github.com/sponsors/RonnyPfannschmidt">&#64;RonnyPfannschmidt</a></p>
</li>
</ul>
</section>
</section>
<section id="pytest-8-3-1-2024-07-20">
<h2>pytest 8.3.1 (2024-07-20)<a class="headerlink" href="#pytest-8-3-1-2024-07-20" title="Link to this heading">¶</a></h2>
<p>The 8.3.0 release failed to include the change notes and docs for the release. This patch release remedies this. There are no other changes.</p>
</section>
<section id="pytest-8-3-0-2024-07-20">
<h2>pytest 8.3.0 (2024-07-20)<a class="headerlink" href="#pytest-8-3-0-2024-07-20" title="Link to this heading">¶</a></h2>
<section id="id45">
<h3>New features<a class="headerlink" href="#id45" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12231">#12231</a>: Added <code class="docutils literal notranslate"><span class="pre">--xfail-tb</span></code> flag, which turns on traceback output for XFAIL results.</p>
<ul class="simple">
<li><p>If the <code class="docutils literal notranslate"><span class="pre">--xfail-tb</span></code> flag is not given, tracebacks for XFAIL results are NOT shown.</p></li>
<li><p>The style of traceback for XFAIL is set with <code class="docutils literal notranslate"><span class="pre">--tb</span></code>, and can be <code class="docutils literal notranslate"><span class="pre">auto|long|short|line|native|no</span></code>.</p></li>
<li><p>Note: Even if you have <code class="docutils literal notranslate"><span class="pre">--xfail-tb</span></code> set, you won’t see them if <code class="docutils literal notranslate"><span class="pre">--tb=no</span></code>.</p></li>
</ul>
<p>Some history:</p>
<p>With pytest 8.0, <code class="docutils literal notranslate"><span class="pre">-rx</span></code> or <code class="docutils literal notranslate"><span class="pre">-ra</span></code> would not only turn on summary reports for xfail, but also report the tracebacks for xfail results. This caused issues with some projects that utilize xfail, but don’t want to see all of the xfail tracebacks.</p>
<p>This change detaches xfail tracebacks from <code class="docutils literal notranslate"><span class="pre">-rx</span></code>, and now we turn on xfail tracebacks with <code class="docutils literal notranslate"><span class="pre">--xfail-tb</span></code>. With this, the default <code class="docutils literal notranslate"><span class="pre">-rx</span></code>/ <code class="docutils literal notranslate"><span class="pre">-ra</span></code> behavior is identical to pre-8.0 with respect to xfail tracebacks. While this is a behavior change, it brings default behavior back to pre-8.0.0 behavior, which ultimately was considered the better course of action.</p>
<p>– by <a class="reference external" href="https://github.com/sponsors/okken">&#64;okken</a></p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12281">#12281</a>: Added support for keyword matching in marker expressions.</p>
<p>Now tests can be selected by marker keyword arguments.
Supported values are <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, (unescaped) <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a> &amp; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a>.</p>
<p>See <span class="xref std std-ref">marker examples</span> for more information.</p>
<p>– by <a class="reference external" href="https://github.com/sponsors/lovetheguitar">&#64;lovetheguitar</a></p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12567">#12567</a>: Added <code class="docutils literal notranslate"><span class="pre">--no-fold-skipped</span></code> command line option.</p>
<p>If this option is set, then skipped tests in short summary are no longer grouped
by reason but all tests are printed individually with their nodeid in the same
way as other statuses.</p>
<p>– by <a class="reference external" href="https://github.com/sponsors/pbrezina">&#64;pbrezina</a></p>
</li>
</ul>
</section>
<section id="id49">
<h3>Improvements in existing functionality<a class="headerlink" href="#id49" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12469">#12469</a>: The console output now uses the “third-party plugins” terminology,
replacing the previously established but confusing and outdated
reference to <a class="reference external" href="https://setuptools.pypa.io/en/stable/index.html" title="(in setuptools v75.3.0.post20241029)"><span class="xref std std-doc">setuptools</span></a>
– by <a class="reference external" href="https://github.com/sponsors/webknjaz">&#64;webknjaz</a>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12544">#12544</a>, <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12545">#12545</a>: Python virtual environment detection was improved by
checking for a <code class="file docutils literal notranslate"><span class="pre">pyvenv.cfg</span></code> file, ensuring reliable detection on
various platforms – by <a class="reference external" href="https://github.com/sponsors/zachsnickers">&#64;zachsnickers</a>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2871">#2871</a>: Do not truncate arguments to functions in output when running with <code class="docutils literal notranslate"><span class="pre">-vvv</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/389">#389</a>: The readability of assertion introspection of bound methods has been enhanced
– by <a class="reference external" href="https://github.com/sponsors/farbodahm">&#64;farbodahm</a>, <a class="reference external" href="https://github.com/sponsors/webknjaz">&#64;webknjaz</a>, <a class="reference external" href="https://github.com/sponsors/obestwalter">&#64;obestwalter</a>, <a class="reference external" href="https://github.com/sponsors/flub">&#64;flub</a>
and <a class="reference external" href="https://github.com/sponsors/glyphack">&#64;glyphack</a>.</p>
<p>Earlier, it was like:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">=================================== FAILURES ===================================</span>
<span class="go">_____________________________________ test _____________________________________</span>

<span class="go">    def test():</span>
<span class="go">&gt;       assert Help().fun() == 2</span>
<span class="go">E       assert 1 == 2</span>
<span class="go">E        +  where 1 = &lt;bound method Help.fun of &lt;example.Help instance at 0x256a830&gt;&gt;()</span>
<span class="go">E        +    where &lt;bound method Help.fun of &lt;example.Help instance at 0x256a830&gt;&gt; = &lt;example.Help instance at 0x256a830&gt;.fun</span>
<span class="go">E        +      where &lt;example.Help instance at 0x256a830&gt; = Help()</span>

<span class="go">example.py:7: AssertionError</span>
<span class="go">=========================== 1 failed in 0.03 seconds ===========================</span>
</pre></div>
</div>
<p>And now it’s like:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">=================================== FAILURES ===================================</span>
<span class="go">_____________________________________ test _____________________________________</span>

<span class="go">    def test():</span>
<span class="go">&gt;       assert Help().fun() == 2</span>
<span class="go">E       assert 1 == 2</span>
<span class="go">E        +  where 1 = fun()</span>
<span class="go">E        +    where fun = &lt;test_local.Help object at 0x1074be230&gt;.fun</span>
<span class="go">E        +      where &lt;test_local.Help object at 0x1074be230&gt; = Help()</span>

<span class="go">test_local.py:13: AssertionError</span>
<span class="go">=========================== 1 failed in 0.03 seconds ===========================</span>
</pre></div>
</div>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7662">#7662</a>: Added timezone information to the testsuite timestamp in the JUnit XML report.</p></li>
</ul>
</section>
<section id="id56">
<h3>Bug fixes<a class="headerlink" href="#id56" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11706">#11706</a>: Fixed reporting of teardown errors in higher-scoped fixtures when using <code class="docutils literal notranslate"><span class="pre">--maxfail</span></code> or <code class="docutils literal notranslate"><span class="pre">--stepwise</span></code>.</p>
<p>Originally added in pytest 8.0.0, but reverted in 8.0.2 due to a regression in pytest-xdist.
This regression was fixed in pytest-xdist 3.6.1.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11797">#11797</a>: <a class="reference internal" href="reference/reference.html#pytest.approx" title="pytest.approx"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.approx()</span></code></a> now correctly handles <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>-like objects.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12204">#12204</a>, <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12264">#12264</a>: Fixed a regression in pytest 8.0 where tracebacks get longer and longer when multiple
tests fail due to a shared higher-scope fixture which raised – by <a class="reference external" href="https://github.com/sponsors/bluetech">&#64;bluetech</a>.</p>
<p>Also fixed a similar regression in pytest 5.4 for collectors which raise during setup.</p>
<p>The fix necessitated internal changes which may affect some plugins:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">FixtureDef.cached_result[2]</span></code> is now a tuple <code class="docutils literal notranslate"><span class="pre">(exc,</span> <span class="pre">tb)</span></code>
instead of <code class="docutils literal notranslate"><span class="pre">exc</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SetupState.stack</span></code> failures are now a tuple <code class="docutils literal notranslate"><span class="pre">(exc,</span> <span class="pre">tb)</span></code>
instead of <code class="docutils literal notranslate"><span class="pre">exc</span></code>.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12275">#12275</a>: Fixed collection error upon encountering an <a class="reference external" href="https://docs.python.org/3/library/abc.html#module-abc" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">abstract</span></code></a> class, including abstract <code class="docutils literal notranslate"><span class="pre">unittest.TestCase</span></code> subclasses.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12328">#12328</a>: Fixed a regression in pytest 8.0.0 where package-scoped parameterized items were not correctly reordered to minimize setups/teardowns in some cases.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12424">#12424</a>: Fixed crash with <code class="docutils literal notranslate"><span class="pre">assert</span> <span class="pre">testcase</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">None</span></code> assertion failure when re-running unittest tests using plugins like pytest-rerunfailures. Regressed in 8.2.2.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12472">#12472</a>: Fixed a crash when returning category <code class="docutils literal notranslate"><span class="pre">&quot;error&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;failed&quot;</span></code> with a custom test status from <a class="reference internal" href="reference/reference.html#std:hook-35"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_report_teststatus</span></code></a> hook – <a class="reference external" href="https://github.com/sponsors/pbrezina">&#64;pbrezina</a>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12505">#12505</a>: Improved handling of invalid regex patterns in <a class="reference internal" href="reference/reference.html#pytest.raises" title="pytest.raises"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.raises(match=r'...')</span></code></a> by providing a clear error message.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12580">#12580</a>: Fixed a crash when using the cache class on Windows and the cache directory was created concurrently.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6962">#6962</a>: Parametrization parameters are now compared using <code class="docutils literal notranslate"><span class="pre">==</span></code> instead of <code class="docutils literal notranslate"><span class="pre">is</span></code> (<code class="docutils literal notranslate"><span class="pre">is</span></code> is still used as a fallback if the parameter does not support <code class="docutils literal notranslate"><span class="pre">==</span></code>).
This fixes use of parameters such as lists, which have a different <code class="docutils literal notranslate"><span class="pre">id</span></code> but compare equal, causing fixtures to be re-computed instead of being cached.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7166">#7166</a>: Fixed progress percentages (the <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">87%]</span></code> at the edge of the screen) sometimes not aligning correctly when running with pytest-xdist <code class="docutils literal notranslate"><span class="pre">-n</span></code>.</p></li>
</ul>
</section>
<section id="id69">
<h3>Improved documentation<a class="headerlink" href="#id69" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12153">#12153</a>: Documented using <span class="target" id="index-0"></span><a class="reference internal" href="reference/reference.html#envvar-3"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTEST_VERSION</span></code></a> to detect if code is running from within a pytest run.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12469">#12469</a>: The external plugin mentions in the documentation now avoid mentioning
<a class="reference external" href="https://setuptools.pypa.io/en/stable/index.html" title="(in setuptools v75.3.0.post20241029)"><span class="xref std std-doc">setuptools entry-points</span></a> as the concept is
much more generic nowadays. Instead, the terminology of “external”,
“installed”, or “third-party” plugins (or packages) replaces that.</p>
<p>– by <a class="reference external" href="https://github.com/sponsors/webknjaz">&#64;webknjaz</a></p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12577">#12577</a>: <code class="docutils literal notranslate"><span class="pre">CI</span></code> and <code class="docutils literal notranslate"><span class="pre">BUILD_NUMBER</span></code> environment variables role is described in
the reference doc. They now also appear when doing <code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">-h</span></code>
– by <a class="reference external" href="https://github.com/sponsors/MarcBresson">&#64;MarcBresson</a>.</p></li>
</ul>
</section>
<section id="id73">
<h3>Contributor-facing changes<a class="headerlink" href="#id73" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12467">#12467</a>: Migrated all internal type-annotations to the python3.10+ style by using the <code class="docutils literal notranslate"><span class="pre">annotations</span></code> future import.</p>
<p>– by <a class="reference external" href="https://github.com/sponsors/RonnyPfannschmidt">&#64;RonnyPfannschmidt</a></p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11771">#11771</a>, <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12557">#12557</a>: The PyPy runtime version has been updated to 3.9 from 3.8 that introduced
a flaky bug at the garbage collector which was not expected to fix there
as the 3.8 is EoL.</p>
<p>– by <a class="reference external" href="https://github.com/sponsors/x612skm">&#64;x612skm</a></p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12493">#12493</a>: The change log draft preview integration has been refactored to use a
third party extension <code class="docutils literal notranslate"><span class="pre">sphinxcontib-towncrier</span></code>. The previous in-repo
script was putting the change log preview file at
<code class="file docutils literal notranslate"><span class="pre">doc/en/_changelog_towncrier_draft.rst</span></code>. Said file is no longer
ignored in Git and might show up among untracked files in the
development environments of the contributors. To address that, the
contributors can run the following command that will clean it up:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>clean<span class="w"> </span>-x<span class="w"> </span>-i<span class="w"> </span>--<span class="w"> </span>doc/en/_changelog_towncrier_draft.rst
</pre></div>
</div>
<p>– by <a class="reference external" href="https://github.com/sponsors/webknjaz">&#64;webknjaz</a></p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12498">#12498</a>: All the undocumented <code class="docutils literal notranslate"><span class="pre">tox</span></code> environments now have descriptions.
They can be listed in one’s development environment by invoking
<code class="docutils literal notranslate"><span class="pre">tox</span> <span class="pre">-av</span></code> in a terminal.</p>
<p>– by <a class="reference external" href="https://github.com/sponsors/webknjaz">&#64;webknjaz</a></p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12501">#12501</a>: The changelog configuration has been updated to introduce more accurate
audience-tailored categories. Previously, there was a <code class="docutils literal notranslate"><span class="pre">trivial</span></code>
change log fragment type with an unclear and broad meaning. It was
removed and we now have <code class="docutils literal notranslate"><span class="pre">contrib</span></code>, <code class="docutils literal notranslate"><span class="pre">misc</span></code> and <code class="docutils literal notranslate"><span class="pre">packaging</span></code> in
place of it.</p>
<p>The new change note types target the readers who are downstream
packagers and project contributors. Additionally, the miscellaneous
section is kept for unspecified updates that do not fit anywhere else.</p>
<p>– by <a class="reference external" href="https://github.com/sponsors/webknjaz">&#64;webknjaz</a></p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12502">#12502</a>: The UX of the GitHub automation making pull requests to update the
plugin list has been updated. Previously, the maintainers had to close
the automatically created pull requests and re-open them to trigger the
CI runs. From now on, they only need to click the <code class="docutils literal notranslate"><span class="pre">Ready</span> <span class="pre">for</span> <span class="pre">review</span></code>
button instead.</p>
<p>– by <a class="reference external" href="https://github.com/sponsors/webknjaz">&#64;webknjaz</a></p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12522">#12522</a>: The <code class="docutils literal notranslate"><span class="pre">:pull:</span></code> RST role has been replaced with a shorter
<code class="docutils literal notranslate"><span class="pre">:pr:</span></code> due to starting to use the implementation from
the third-party <a class="reference external" href="https://pypi.org/project/sphinx-issues">sphinx-issues</a> Sphinx extension
– by <a class="reference external" href="https://github.com/sponsors/webknjaz">&#64;webknjaz</a>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12531">#12531</a>: The coverage reporting configuration has been updated to exclude
pytest’s own tests marked as expected to fail from the coverage
report. This has an effect of reducing the influence of flaky
tests on the resulting number.</p>
<p>– by <a class="reference external" href="https://github.com/sponsors/webknjaz">&#64;webknjaz</a></p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12533">#12533</a>: The <code class="docutils literal notranslate"><span class="pre">extlinks</span></code> Sphinx extension is no longer enabled. The <code class="docutils literal notranslate"><span class="pre">:bpo:</span></code>
role it used to declare has been removed with that. BPO itself has
migrated to GitHub some years ago and it is possible to link the
respective issues by using their GitHub issue numbers and the
<code class="docutils literal notranslate"><span class="pre">:issue:</span></code> role that the <code class="docutils literal notranslate"><span class="pre">sphinx-issues</span></code> extension implements.</p>
<p>– by <a class="reference external" href="https://github.com/sponsors/webknjaz">&#64;webknjaz</a></p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12562">#12562</a>: Possible typos in using the <code class="docutils literal notranslate"><span class="pre">:user:</span></code> RST role is now being linted
through the pre-commit tool integration – by <a class="reference external" href="https://github.com/sponsors/webknjaz">&#64;webknjaz</a>.</p></li>
</ul>
</section>
</section>
<section id="pytest-8-2-2-2024-06-04">
<h2>pytest 8.2.2 (2024-06-04)<a class="headerlink" href="#pytest-8-2-2-2024-06-04" title="Link to this heading">¶</a></h2>
<section id="id85">
<h3>Bug Fixes<a class="headerlink" href="#id85" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12355">#12355</a>: Fix possible catastrophic performance slowdown on a certain parametrization pattern involving many higher-scoped parameters.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12367">#12367</a>: Fix a regression in pytest 8.2.0 where unittest class instances (a fresh one is created for each test) were not released promptly on test teardown but only on session teardown.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12381">#12381</a>: Fix possible “Directory not empty” crashes arising from concurrent cache dir (<code class="docutils literal notranslate"><span class="pre">.pytest_cache</span></code>) creation. Regressed in pytest 8.2.0.</p></li>
</ul>
</section>
<section id="id89">
<h3>Improved Documentation<a class="headerlink" href="#id89" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12290">#12290</a>: Updated Sphinx theme to use Furo instead of Flask, enabling Dark mode theme.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12356">#12356</a>: Added a subsection to the documentation for debugging flaky tests to mention
lack of thread safety in pytest as a possible source of flakiness.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12363">#12363</a>: The documentation webpages now links to a canonical version to reduce outdated documentation in search engine results.</p></li>
</ul>
</section>
</section>
<section id="pytest-8-2-1-2024-05-19">
<h2>pytest 8.2.1 (2024-05-19)<a class="headerlink" href="#pytest-8-2-1-2024-05-19" title="Link to this heading">¶</a></h2>
<section id="improvements">
<h3>Improvements<a class="headerlink" href="#improvements" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12334">#12334</a>: Support for Python 3.13 (beta1 at the time of writing).</p></li>
</ul>
</section>
<section id="id94">
<h3>Bug Fixes<a class="headerlink" href="#id94" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12120">#12120</a>: Fix <code class="docutils literal notranslate"><span class="pre">PermissionError</span></code> crashes arising from directories which are not selected on the command-line.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12191">#12191</a>: Keyboard interrupts and system exits are now properly handled during the test collection.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12300">#12300</a>: Fixed handling of ‘Function not implemented’ error under squashfuse_ll, which is a different way to say that the mountpoint is read-only.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12308">#12308</a>: Fix a regression in pytest 8.2.0 where the permissions of automatically-created <code class="docutils literal notranslate"><span class="pre">.pytest_cache</span></code> directories became <code class="docutils literal notranslate"><span class="pre">rwx------</span></code> instead of the expected <code class="docutils literal notranslate"><span class="pre">rwxr-xr-x</span></code>.</p></li>
</ul>
</section>
<section id="trivial-internal-changes">
<h3>Trivial/Internal Changes<a class="headerlink" href="#trivial-internal-changes" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12333">#12333</a>: pytest releases are now attested using the recent <a class="reference external" href="https://github.blog/2024-05-02-introducing-artifact-attestations-now-in-public-beta/">Artifact Attestation</a> support from GitHub, allowing users to verify the provenance of pytest’s sdist and wheel artifacts.</p></li>
</ul>
</section>
</section>
<section id="pytest-8-2-0-2024-04-27">
<h2>pytest 8.2.0 (2024-04-27)<a class="headerlink" href="#pytest-8-2-0-2024-04-27" title="Link to this heading">¶</a></h2>
<section id="breaking-changes">
<h3>Breaking Changes<a class="headerlink" href="#breaking-changes" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/pull/12089">#12089</a>: pytest now requires that <a class="reference external" href="https://docs.python.org/3/library/unittest.html#unittest.TestCase" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.TestCase</span></code></a> subclasses can be instantiated freely using <code class="docutils literal notranslate"><span class="pre">MyTestCase('runTest')</span></code>.</p>
<p>If the class doesn’t allow this, you may see an error during collection such as <code class="docutils literal notranslate"><span class="pre">AttributeError:</span> <span class="pre">'MyTestCase'</span> <span class="pre">object</span> <span class="pre">has</span> <span class="pre">no</span> <span class="pre">attribute</span> <span class="pre">'runTest'</span></code>.</p>
<p>Classes which do not override <code class="docutils literal notranslate"><span class="pre">__init__</span></code>, or do not access the test method in <code class="docutils literal notranslate"><span class="pre">__init__</span></code> using <code class="docutils literal notranslate"><span class="pre">getattr</span></code> or similar, are unaffected.</p>
<p>Classes which do should take care to not crash when <code class="docutils literal notranslate"><span class="pre">&quot;runTest&quot;</span></code> is given, as is shown in <a class="reference external" href="https://github.com/python/cpython/blob/51aefc5bf907ddffaaf083ded0de773adcdf08c8/Lib/unittest/case.py#L419-L426">unittest.TestCases’s implementation</a>.
Alternatively, consider using <a class="reference external" href="https://docs.python.org/3/library/unittest.html#unittest.TestCase.setUp" title="(in Python v3.13)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setUp</span></code></a> instead of <code class="docutils literal notranslate"><span class="pre">__init__</span></code>.</p>
<p>If you run into this issue using <code class="docutils literal notranslate"><span class="pre">tornado.AsyncTestCase</span></code>, please see <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12263">issue 12263</a>.</p>
<p>If you run into this issue using an abstract <code class="docutils literal notranslate"><span class="pre">TestCase</span></code> subclass, please see <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12275">issue 12275</a>.</p>
<p>Historical note: the effect of this change on custom TestCase implementations was not properly considered initially, this is why it was done in a minor release. We apologize for the inconvenience.</p>
</li>
</ul>
</section>
<section id="deprecations">
<h3>Deprecations<a class="headerlink" href="#deprecations" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12069">#12069</a>: A deprecation warning is now raised when implementations of one of the following hooks request a deprecated <code class="docutils literal notranslate"><span class="pre">py.path.local</span></code> parameter instead of the <code class="docutils literal notranslate"><span class="pre">pathlib.Path</span></code> parameter which replaced it:</p>
<ul class="simple">
<li><p><a class="reference internal" href="reference/reference.html#std:hook-11"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_ignore_collect</span></code></a> - the <code class="docutils literal notranslate"><span class="pre">path</span></code> parameter - use <code class="docutils literal notranslate"><span class="pre">collection_path</span></code> instead.</p></li>
<li><p><a class="reference internal" href="reference/reference.html#std:hook-13"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_collect_file</span></code></a> - the <code class="docutils literal notranslate"><span class="pre">path</span></code> parameter - use <code class="docutils literal notranslate"><span class="pre">file_path</span></code> instead.</p></li>
<li><p><a class="reference internal" href="reference/reference.html#std:hook-14"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_pycollect_makemodule</span></code></a> - the <code class="docutils literal notranslate"><span class="pre">path</span></code> parameter - use <code class="docutils literal notranslate"><span class="pre">module_path</span></code> instead.</p></li>
<li><p><a class="reference internal" href="reference/reference.html#std:hook-33"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_report_header</span></code></a> - the <code class="docutils literal notranslate"><span class="pre">startdir</span></code> parameter - use <code class="docutils literal notranslate"><span class="pre">start_path</span></code> instead.</p></li>
<li><p><a class="reference internal" href="reference/reference.html#std:hook-34"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_report_collectionfinish</span></code></a> - the <code class="docutils literal notranslate"><span class="pre">startdir</span></code> parameter - use <code class="docutils literal notranslate"><span class="pre">start_path</span></code> instead.</p></li>
</ul>
<p>The replacement parameters are available since pytest 7.0.0.
The old parameters will be removed in pytest 9.0.0.</p>
<p>See <a class="reference internal" href="deprecations.html#legacy-path-hooks-deprecated"><span class="std std-ref">py.path.local arguments for hooks replaced with pathlib.Path</span></a> for more details.</p>
</li>
</ul>
</section>
<section id="features">
<h3>Features<a class="headerlink" href="#features" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11871">#11871</a>: Added support for reading command line arguments from a file using the prefix character <code class="docutils literal notranslate"><span class="pre">&#64;</span></code>, like e.g.: <code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">&#64;tests.txt</span></code>. The file must have one argument per line.</p>
<p>See <a class="reference internal" href="how-to/usage.html#args-from-file"><span class="std std-ref">Read arguments from file</span></a> for details.</p>
</li>
</ul>
</section>
<section id="id103">
<h3>Improvements<a class="headerlink" href="#id103" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11523">#11523</a>: <a class="reference internal" href="reference/reference.html#pytest.importorskip" title="pytest.importorskip"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.importorskip()</span></code></a> will now issue a warning if the module could be found, but raised <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ImportError" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImportError</span></code></a> instead of <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ModuleNotFoundError" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleNotFoundError</span></code></a>.</p>
<p>The warning can be suppressed by passing <code class="docutils literal notranslate"><span class="pre">exc_type=ImportError</span></code> to <a class="reference internal" href="reference/reference.html#pytest.importorskip" title="pytest.importorskip"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.importorskip()</span></code></a>.</p>
<p>See <a class="reference internal" href="deprecations.html#import-or-skip-import-error"><span class="std std-ref">pytest.importorskip default behavior regarding ImportError</span></a> for details.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11728">#11728</a>: For <code class="docutils literal notranslate"><span class="pre">unittest</span></code>-based tests, exceptions during class cleanup (as raised by functions registered with <a class="reference external" href="https://docs.python.org/3/library/unittest.html#unittest.TestCase.addClassCleanup" title="(in Python v3.13)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TestCase.addClassCleanup</span></code></a>) are now reported instead of silently failing.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11777">#11777</a>: Text is no longer truncated in the <code class="docutils literal notranslate"><span class="pre">short</span> <span class="pre">test</span> <span class="pre">summary</span> <span class="pre">info</span></code> section when <code class="docutils literal notranslate"><span class="pre">-vv</span></code> is given.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12112">#12112</a>: Improved namespace packages detection when <a class="reference internal" href="reference/reference.html#confval-2"><code class="xref std std-confval docutils literal notranslate"><span class="pre">consider_namespace_packages</span></code></a> is enabled, covering more situations (like editable installs).</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9502">#9502</a>: Added <span class="target" id="index-1"></span><a class="reference internal" href="reference/reference.html#envvar-3"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTEST_VERSION</span></code></a> environment variable which is defined at the start of the pytest session and undefined afterwards. It contains the value of <code class="docutils literal notranslate"><span class="pre">pytest.__version__</span></code>, and among other things can be used to easily check if code is running from within a pytest run.</p></li>
</ul>
</section>
<section id="id109">
<h3>Bug Fixes<a class="headerlink" href="#id109" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12065">#12065</a>: Fixed a regression in pytest 8.0.0 where test classes containing <code class="docutils literal notranslate"><span class="pre">setup_method</span></code> and tests using <code class="docutils literal notranslate"><span class="pre">&#64;staticmethod</span></code> or <code class="docutils literal notranslate"><span class="pre">&#64;classmethod</span></code> would crash with <code class="docutils literal notranslate"><span class="pre">AttributeError:</span> <span class="pre">'NoneType'</span> <span class="pre">object</span> <span class="pre">has</span> <span class="pre">no</span> <span class="pre">attribute</span> <span class="pre">'setup_method'</span></code>.</p>
<p>Now the <a class="reference internal" href="reference/reference.html#id82" title="pytest.FixtureRequest.instance"><code class="xref py py-attr docutils literal notranslate"><span class="pre">request.instance</span></code></a> attribute of tests using <code class="docutils literal notranslate"><span class="pre">&#64;staticmethod</span></code> and <code class="docutils literal notranslate"><span class="pre">&#64;classmethod</span></code> is no longer <code class="docutils literal notranslate"><span class="pre">None</span></code>, but a fresh instance of the class, like in non-static methods.
Previously it was <code class="docutils literal notranslate"><span class="pre">None</span></code>, and all fixtures of such tests would share a single <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12135">#12135</a>: Fixed issue where fixtures adding their finalizer multiple times to fixtures they request would cause unreliable and non-intuitive teardown ordering in some instances.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12194">#12194</a>: Fixed a bug with <code class="docutils literal notranslate"><span class="pre">--importmode=importlib</span></code> and <code class="docutils literal notranslate"><span class="pre">--doctest-modules</span></code> where child modules did not appear as attributes in parent modules.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1489">#1489</a>: Fixed some instances where teardown of higher-scoped fixtures was not happening in the reverse order they were initialized in.</p></li>
</ul>
</section>
<section id="id114">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id114" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12069">#12069</a>: <code class="docutils literal notranslate"><span class="pre">pluggy&gt;=1.5.0</span></code> is now required.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12167">#12167</a>: <a class="reference internal" href="how-to/cache.html#cache"><span class="std std-ref">cache</span></a>: create supporting files (<code class="docutils literal notranslate"><span class="pre">CACHEDIR.TAG</span></code>, <code class="docutils literal notranslate"><span class="pre">.gitignore</span></code>, etc.) in a temporary directory to provide atomic semantics.</p></li>
</ul>
</section>
</section>
<section id="pytest-8-1-2-2024-04-26">
<h2>pytest 8.1.2 (2024-04-26)<a class="headerlink" href="#pytest-8-1-2-2024-04-26" title="Link to this heading">¶</a></h2>
<section id="id117">
<h3>Bug Fixes<a class="headerlink" href="#id117" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12114">#12114</a>: Fixed error in <a class="reference internal" href="reference/reference.html#pytest.approx" title="pytest.approx"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.approx()</span></code></a> when used with <code class="docutils literal notranslate"><span class="pre">numpy</span></code> arrays and comparing with other types.</p></li>
</ul>
</section>
</section>
<section id="pytest-8-1-1-2024-03-08">
<h2>pytest 8.1.1 (2024-03-08)<a class="headerlink" href="#pytest-8-1-1-2024-03-08" title="Link to this heading">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This release is not a usual bug fix release – it contains features and improvements, being a follow up
to <code class="docutils literal notranslate"><span class="pre">8.1.0</span></code>, which has been yanked from PyPI.</p>
</div>
<section id="id119">
<h3>Features<a class="headerlink" href="#id119" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11475">#11475</a>: Added the new <a class="reference internal" href="reference/reference.html#confval-2"><code class="xref std std-confval docutils literal notranslate"><span class="pre">consider_namespace_packages</span></code></a> configuration option, defaulting to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<p>If set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, pytest will attempt to identify modules that are part of <a class="reference external" href="https://packaging.python.org/en/latest/guides/packaging-namespace-packages">namespace packages</a> when importing modules.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11653">#11653</a>: Added the new <a class="reference internal" href="reference/reference.html#confval-42"><code class="xref std std-confval docutils literal notranslate"><span class="pre">verbosity_test_cases</span></code></a> configuration option for fine-grained control of test execution verbosity.
See <a class="reference internal" href="how-to/output.html#pytest-fine-grained-verbosity"><span class="std std-ref">Fine-grained verbosity</span></a> for more details.</p></li>
</ul>
</section>
<section id="id122">
<h3>Improvements<a class="headerlink" href="#id122" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10865">#10865</a>: <a class="reference internal" href="reference/reference.html#pytest.warns" title="pytest.warns"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.warns()</span></code></a> now validates that <a class="reference external" href="https://docs.python.org/3/library/warnings.html#warnings.warn" title="(in Python v3.13)"><code class="xref py py-func docutils literal notranslate"><span class="pre">warnings.warn()</span></code></a> was called with a <code class="docutils literal notranslate"><span class="pre">str</span></code> or a <code class="docutils literal notranslate"><span class="pre">Warning</span></code>.
Currently in Python it is possible to use other types, however this causes an exception when <a class="reference external" href="https://docs.python.org/3/library/warnings.html#warnings.filterwarnings" title="(in Python v3.13)"><code class="xref py py-func docutils literal notranslate"><span class="pre">warnings.filterwarnings()</span></code></a> is used to filter those warnings (see <a class="reference external" href="https://github.com/python/cpython/issues/103577">CPython #103577</a> for a discussion).
While this can be considered a bug in CPython, we decided to put guards in pytest as the error message produced without this check in place is confusing.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11311">#11311</a>: When using <code class="docutils literal notranslate"><span class="pre">--override-ini</span></code> for paths in invocations without a configuration file defined, the current working directory is used
as the relative directory.</p>
<p>Previously this would raise an <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AssertionError" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">AssertionError</span></code></a>.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11475">#11475</a>: <span class="xref std std-ref">–import-mode=importlib</span> now tries to import modules using the standard import mechanism (but still without changing <a class="reference external" href="https://docs.python.org/3/library/sys.html#sys.path" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.path</span></code></a>), falling back to importing modules directly only if that fails.</p>
<p>This means that installed packages will be imported under their canonical name if possible first, for example <code class="docutils literal notranslate"><span class="pre">app.core.models</span></code>, instead of having the module name always be derived from their path (for example <code class="docutils literal notranslate"><span class="pre">.env310.lib.site_packages.app.core.models</span></code>).</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11801">#11801</a>: Added the <a class="reference internal" href="reference/reference.html#pytest.nodes.Node.iter_parents" title="_pytest.nodes.Node.iter_parents"><code class="xref py py-func docutils literal notranslate"><span class="pre">iter_parents()</span></code></a> helper method on nodes.
It is similar to <a class="reference internal" href="reference/reference.html#pytest.nodes.Node.listchain" title="_pytest.nodes.Node.listchain"><code class="xref py py-func docutils literal notranslate"><span class="pre">listchain</span></code></a>, but goes from bottom to top, and returns an iterator, not a list.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11850">#11850</a>: Added support for <a class="reference external" href="https://docs.python.org/3/library/sys.html#sys.last_exc" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.last_exc</span></code></a> for post-mortem debugging on Python&gt;=3.12.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11962">#11962</a>: In case no other suitable candidates for configuration file are found, a <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> (even without a <code class="docutils literal notranslate"><span class="pre">[tool.pytest.ini_options]</span></code> table) will be considered as the configuration file and define the <code class="docutils literal notranslate"><span class="pre">rootdir</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11978">#11978</a>: Add <code class="docutils literal notranslate"><span class="pre">--log-file-mode</span></code> option to the logging plugin, enabling appending to log-files. This option accepts either <code class="docutils literal notranslate"><span class="pre">&quot;w&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;a&quot;</span></code> and defaults to <code class="docutils literal notranslate"><span class="pre">&quot;w&quot;</span></code>.</p>
<p>Previously, the mode was hard-coded to be <code class="docutils literal notranslate"><span class="pre">&quot;w&quot;</span></code> which truncates the file before logging.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12047">#12047</a>: When multiple finalizers of a fixture raise an exception, now all exceptions are reported as an exception group.
Previously, only the first exception was reported.</p></li>
</ul>
</section>
<section id="id131">
<h3>Bug Fixes<a class="headerlink" href="#id131" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11475">#11475</a>: Fixed regression where <code class="docutils literal notranslate"><span class="pre">--importmode=importlib</span></code> would import non-test modules more than once.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11904">#11904</a>: Fixed a regression in pytest 8.0.0 that would cause test collection to fail due to permission errors when using <code class="docutils literal notranslate"><span class="pre">--pyargs</span></code>.</p>
<p>This change improves the collection tree for tests specified using <code class="docutils literal notranslate"><span class="pre">--pyargs</span></code>, see <a class="reference external" href="https://github.com/pytest-dev/pytest/pull/12043">#12043</a> for a comparison with pytest 8.0 and &lt;8.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12011">#12011</a>: Fixed a regression in 8.0.1 whereby <code class="docutils literal notranslate"><span class="pre">setup_module</span></code> xunit-style fixtures are not executed when <code class="docutils literal notranslate"><span class="pre">--doctest-modules</span></code> is passed.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12014">#12014</a>: Fix the <code class="docutils literal notranslate"><span class="pre">stacklevel</span></code> used when warning about marks used on fixtures.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12039">#12039</a>: Fixed a regression in <code class="docutils literal notranslate"><span class="pre">8.0.2</span></code> where tests created using <a class="reference internal" href="reference/reference.html#std:fixture-3"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">tmp_path</span></code></a> have been collected multiple times in CI under Windows.</p></li>
</ul>
</section>
<section id="id137">
<h3>Improved Documentation<a class="headerlink" href="#id137" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11790">#11790</a>: Documented the retention of temporary directories created using the <code class="docutils literal notranslate"><span class="pre">tmp_path</span></code> fixture in more detail.</p></li>
</ul>
</section>
<section id="id139">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id139" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11785">#11785</a>: Some changes were made to private functions which may affect plugins which access them:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">FixtureManager._getautousenames()</span></code> now takes a <code class="docutils literal notranslate"><span class="pre">Node</span></code> itself instead of the nodeid.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FixtureManager.getfixturedefs()</span></code> now takes the <code class="docutils literal notranslate"><span class="pre">Node</span></code> itself instead of the nodeid.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">_pytest.nodes.iterparentnodeids()</span></code> function is removed without replacement.
Prefer to traverse the node hierarchy itself instead.
If you really need to, copy the function from the previous pytest release.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12069">#12069</a>: Delayed the deprecation of the following features to <code class="docutils literal notranslate"><span class="pre">9.0.0</span></code>:</p>
<ul class="simple">
<li><p><a class="reference internal" href="deprecations.html#node-ctor-fspath-deprecation"><span class="std std-ref">fspath argument for Node constructors replaced with pathlib.Path</span></a>.</p></li>
<li><p><a class="reference internal" href="deprecations.html#legacy-path-hooks-deprecated"><span class="std std-ref">py.path.local arguments for hooks replaced with pathlib.Path</span></a>.</p></li>
</ul>
<p>It was discovered after <code class="docutils literal notranslate"><span class="pre">8.1.0</span></code> was released that the warnings about the impeding removal were not being displayed, so the team decided to revert the removal.</p>
<p>This is the reason for <code class="docutils literal notranslate"><span class="pre">8.1.0</span></code> being yanked.</p>
</li>
</ul>
</section>
</section>
<section id="pytest-8-1-0-yanked">
<h2>pytest 8.1.0 (YANKED)<a class="headerlink" href="#pytest-8-1-0-yanked" title="Link to this heading">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This release has been <strong>yanked</strong>: it broke some plugins without the proper warning period, due to
some warnings not showing up as expected.</p>
<p>See <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12069">#12069</a>.</p>
</div>
</section>
<section id="pytest-8-0-2-2024-02-24">
<h2>pytest 8.0.2 (2024-02-24)<a class="headerlink" href="#pytest-8-0-2-2024-02-24" title="Link to this heading">¶</a></h2>
<section id="id142">
<h3>Bug Fixes<a class="headerlink" href="#id142" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11895">#11895</a>: Fix collection on Windows where initial paths contain the short version of a path (for example <code class="docutils literal notranslate"><span class="pre">c:\PROGRA~1\tests</span></code>).</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11953">#11953</a>: Fix an <code class="docutils literal notranslate"><span class="pre">IndexError</span></code> crash raising from <code class="docutils literal notranslate"><span class="pre">getstatementrange_ast</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/12021">#12021</a>: Reverted a fix to <code class="docutils literal notranslate"><span class="pre">--maxfail</span></code> handling in pytest 8.0.0 because it caused a regression in pytest-xdist whereby session fixture teardowns may get executed multiple times when the max-fails is reached.</p></li>
</ul>
</section>
</section>
<section id="pytest-8-0-1-2024-02-16">
<h2>pytest 8.0.1 (2024-02-16)<a class="headerlink" href="#pytest-8-0-1-2024-02-16" title="Link to this heading">¶</a></h2>
<section id="id146">
<h3>Bug Fixes<a class="headerlink" href="#id146" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11875">#11875</a>: Correctly handle errors from <a class="reference external" href="https://docs.python.org/3/library/getpass.html#getpass.getuser" title="(in Python v3.13)"><code class="xref py py-func docutils literal notranslate"><span class="pre">getpass.getuser()</span></code></a> in Python 3.13.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11879">#11879</a>: Fix an edge case where <code class="docutils literal notranslate"><span class="pre">ExceptionInfo._stringify_exception</span></code> could crash <a class="reference internal" href="reference/reference.html#pytest.raises" title="pytest.raises"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.raises()</span></code></a>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11906">#11906</a>: Fix regression with <a class="reference internal" href="reference/reference.html#pytest.warns" title="pytest.warns"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.warns()</span></code></a> using custom warning subclasses which have more than one parameter in their <code class="docutils literal notranslate"><span class="pre">__init__</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11907">#11907</a>: Fix a regression in pytest 8.0.0 whereby calling <a class="reference internal" href="reference/reference.html#pytest.skip" title="pytest.skip"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.skip()</span></code></a> and similar control-flow exceptions within a <a class="reference internal" href="reference/reference.html#pytest.warns" title="pytest.warns"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.warns()</span></code></a> block would get suppressed instead of propagating.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11929">#11929</a>: Fix a regression in pytest 8.0.0 whereby autouse fixtures defined in a module get ignored by the doctests in the module.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11937">#11937</a>: Fix a regression in pytest 8.0.0 whereby items would be collected in reverse order in some circumstances.</p></li>
</ul>
</section>
</section>
<section id="pytest-8-0-0-2024-01-27">
<h2>pytest 8.0.0 (2024-01-27)<a class="headerlink" href="#pytest-8-0-0-2024-01-27" title="Link to this heading">¶</a></h2>
<section id="id153">
<h3>Bug Fixes<a class="headerlink" href="#id153" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11842">#11842</a>: Properly escape the <code class="docutils literal notranslate"><span class="pre">reason</span></code> of a <a class="reference internal" href="reference/reference.html#pytest-mark-skip-ref"><span class="std std-ref">skip</span></a> mark when writing JUnit XML files.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11861">#11861</a>: Avoid microsecond exceeds <code class="docutils literal notranslate"><span class="pre">1_000_000</span></code> when using <code class="docutils literal notranslate"><span class="pre">log-date-format</span></code> with <code class="docutils literal notranslate"><span class="pre">%f</span></code> specifier, which might cause the test suite to crash.</p></li>
</ul>
</section>
</section>
<section id="pytest-8-0-0rc2-2024-01-17">
<h2>pytest 8.0.0rc2 (2024-01-17)<a class="headerlink" href="#pytest-8-0-0rc2-2024-01-17" title="Link to this heading">¶</a></h2>
<section id="id156">
<h3>Improvements<a class="headerlink" href="#id156" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11233">#11233</a>: Improvements to <code class="docutils literal notranslate"><span class="pre">-r</span></code> for xfailures and xpasses:</p>
<ul>
<li><p>Report tracebacks for xfailures when <code class="docutils literal notranslate"><span class="pre">-rx</span></code> is set.</p></li>
<li><p>Report captured output for xpasses when <code class="docutils literal notranslate"><span class="pre">-rX</span></code> is set.</p></li>
<li><p>For xpasses, add <code class="docutils literal notranslate"><span class="pre">-</span></code> in summary between test name and reason, to match how xfail is displayed.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11825">#11825</a>: The <a class="reference internal" href="reference/reference.html#std:hook-9"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_plugin_registered</span></code></a> hook has a new <code class="docutils literal notranslate"><span class="pre">plugin_name</span></code> parameter containing the name by which <code class="docutils literal notranslate"><span class="pre">plugin</span></code> is registered.</p></li>
</ul>
</section>
<section id="id159">
<h3>Bug Fixes<a class="headerlink" href="#id159" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11706">#11706</a>: Fix reporting of teardown errors in higher-scoped fixtures when using <code class="docutils literal notranslate"><span class="pre">--maxfail</span></code> or <code class="docutils literal notranslate"><span class="pre">--stepwise</span></code>.</p>
<p>NOTE: This change was reverted in pytest 8.0.2 to fix a <a class="reference external" href="https://github.com/pytest-dev/pytest-xdist/issues/1024">regression</a> it caused in pytest-xdist.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11758">#11758</a>: Fixed <code class="docutils literal notranslate"><span class="pre">IndexError:</span> <span class="pre">string</span> <span class="pre">index</span> <span class="pre">out</span> <span class="pre">of</span> <span class="pre">range</span></code> crash in <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">highlighted[-1]</span> <span class="pre">==</span> <span class="pre">&quot;\n&quot;</span> <span class="pre">and</span> <span class="pre">source[-1]</span> <span class="pre">!=</span> <span class="pre">&quot;\n&quot;</span></code>.
This bug was introduced in pytest 8.0.0rc1.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9765">#9765</a>, <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11816">#11816</a>: Fixed a frustrating bug that afflicted some users with the only error being <code class="docutils literal notranslate"><span class="pre">assert</span> <span class="pre">mod</span> <span class="pre">not</span> <span class="pre">in</span> <span class="pre">mods</span></code>. The issue was caused by the fact that <code class="docutils literal notranslate"><span class="pre">str(Path(mod))</span></code> and <code class="docutils literal notranslate"><span class="pre">mod.__file__</span></code> don’t necessarily produce the same string, and was being erroneously used interchangeably in some places in the code.</p>
<p>This fix also broke the internal API of <code class="docutils literal notranslate"><span class="pre">PytestPluginManager.consider_conftest</span></code> by introducing a new parameter – we mention this in case it is being used by external code, even if marked as <em>private</em>.</p>
</li>
</ul>
</section>
</section>
<section id="pytest-8-0-0rc1-2023-12-30">
<h2>pytest 8.0.0rc1 (2023-12-30)<a class="headerlink" href="#pytest-8-0-0rc1-2023-12-30" title="Link to this heading">¶</a></h2>
<section id="id164">
<h3>Breaking Changes<a class="headerlink" href="#id164" title="Link to this heading">¶</a></h3>
<section id="old-deprecations-are-now-errors">
<h4>Old Deprecations Are Now Errors<a class="headerlink" href="#old-deprecations-are-now-errors" title="Link to this heading">¶</a></h4>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7363">#7363</a>: <strong>PytestRemovedIn8Warning deprecation warnings are now errors by default.</strong></p>
<p>Following our plan to remove deprecated features with as little disruption as
possible, all warnings of type <code class="docutils literal notranslate"><span class="pre">PytestRemovedIn8Warning</span></code> now generate errors
instead of warning messages by default.</p>
<p><strong>The affected features will be effectively removed in pytest 8.1</strong>, so please consult the
<a class="reference internal" href="deprecations.html#deprecations"><span class="std std-ref">Deprecations and Removals</span></a> section in the docs for directions on how to update existing code.</p>
<p>In the pytest <code class="docutils literal notranslate"><span class="pre">8.0.X</span></code> series, it is possible to change the errors back into warnings as a
stopgap measure by adding this to your <code class="docutils literal notranslate"><span class="pre">pytest.ini</span></code> file:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[pytest]</span>
<span class="na">filterwarnings</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="na">ignore</span><span class="o">:</span><span class="s">:pytest.PytestRemovedIn8Warning</span>
</pre></div>
</div>
<p>But this will stop working when pytest <code class="docutils literal notranslate"><span class="pre">8.1</span></code> is released.</p>
<p><strong>If you have concerns</strong> about the removal of a specific feature, please add a
comment to <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7363">#7363</a>.</p>
</li>
</ul>
</section>
<section id="version-compatibility">
<h4>Version Compatibility<a class="headerlink" href="#version-compatibility" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11151">#11151</a>: Dropped support for Python 3.7, which <a class="reference external" href="https://devguide.python.org/versions/">reached end-of-life on 2023-06-27</a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pluggy&gt;=1.3.0</span></code> is now required.</p></li>
</ul>
</section>
<section id="collection-changes">
<h4>Collection Changes<a class="headerlink" href="#collection-changes" title="Link to this heading">¶</a></h4>
<p>In this version we’ve made several breaking changes to pytest’s collection phase,
particularly around how filesystem directories and Python packages are collected,
fixing deficiencies and allowing for cleanups and improvements to pytest’s internals.
A deprecation period for these changes was not possible.</p>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7777">#7777</a>: Files and directories are now collected in alphabetical order jointly, unless changed by a plugin.
Previously, files were collected before directories.
See below for an example.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8976">#8976</a>: Running <code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">pkg/__init__.py</span></code> now collects the <code class="docutils literal notranslate"><span class="pre">pkg/__init__.py</span></code> file (module) only.
Previously, it collected the entire <code class="docutils literal notranslate"><span class="pre">pkg</span></code> package, including other test files in the directory, but excluding tests in the <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file itself
(unless <a class="reference internal" href="reference/reference.html#confval-31"><code class="xref std std-confval docutils literal notranslate"><span class="pre">python_files</span></code></a> was changed to allow <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file).</p>
<p>To collect the entire package, specify just the directory: <code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">pkg</span></code>.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11137">#11137</a>: <a class="reference internal" href="reference/reference.html#pytest.Package" title="pytest.Package"><code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.Package</span></code></a> is no longer a <a class="reference internal" href="reference/reference.html#pytest.Module" title="pytest.Module"><code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.Module</span></code></a> or <a class="reference internal" href="reference/reference.html#pytest.File" title="pytest.File"><code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.File</span></code></a>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Package</span></code> collector node designates a Python package, that is, a directory with an <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file.
Previously <code class="docutils literal notranslate"><span class="pre">Package</span></code> was a subtype of <code class="docutils literal notranslate"><span class="pre">pytest.Module</span></code> (which represents a single Python module),
the module being the <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file.
This has been deemed a design mistake (see <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11137">#11137</a> and <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7777">#7777</a> for details).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">path</span></code> property of <code class="docutils literal notranslate"><span class="pre">Package</span></code> nodes now points to the package directory instead of the <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file.</p>
<p>Note that a <code class="docutils literal notranslate"><span class="pre">Module</span></code> node for <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> (which is not a <code class="docutils literal notranslate"><span class="pre">Package</span></code>) may still exist,
if it is picked up during collection (e.g. if you configured <a class="reference internal" href="reference/reference.html#confval-31"><code class="xref std std-confval docutils literal notranslate"><span class="pre">python_files</span></code></a> to include <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> files).</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7777">#7777</a>: Added a new <a class="reference internal" href="reference/reference.html#pytest.Directory" title="pytest.Directory"><code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.Directory</span></code></a> base collection node, which all collector nodes for filesystem directories are expected to subclass.
This is analogous to the existing <a class="reference internal" href="reference/reference.html#pytest.File" title="pytest.File"><code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.File</span></code></a> for file nodes.</p>
<p>Changed <a class="reference internal" href="reference/reference.html#pytest.Package" title="pytest.Package"><code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.Package</span></code></a> to be a subclass of <a class="reference internal" href="reference/reference.html#pytest.Directory" title="pytest.Directory"><code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.Directory</span></code></a>.
A <code class="docutils literal notranslate"><span class="pre">Package</span></code> represents a filesystem directory which is a Python package,
i.e. contains an <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file.</p>
<p><a class="reference internal" href="reference/reference.html#pytest.Package" title="pytest.Package"><code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.Package</span></code></a> now only collects files in its own directory; previously it collected recursively.
Sub-directories are collected as their own collector nodes, which then collect themselves, thus creating a collection tree which mirrors the filesystem hierarchy.</p>
<p>Added a new <a class="reference internal" href="reference/reference.html#pytest.Dir" title="pytest.Dir"><code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.Dir</span></code></a> concrete collection node, a subclass of <a class="reference internal" href="reference/reference.html#pytest.Directory" title="pytest.Directory"><code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.Directory</span></code></a>.
This node represents a filesystem directory, which is not a <a class="reference internal" href="reference/reference.html#pytest.Package" title="pytest.Package"><code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.Package</span></code></a>,
that is, does not contain an <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file.
Similarly to <code class="docutils literal notranslate"><span class="pre">Package</span></code>, it only collects the files in its own directory.</p>
<p><a class="reference internal" href="reference/reference.html#pytest.Session" title="pytest.Session"><code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.Session</span></code></a> now only collects the initial arguments, without recursing into directories.
This work is now done by the <a class="reference internal" href="reference/reference.html#pytest.Collector.collect" title="pytest.Collector.collect"><code class="xref py py-func docutils literal notranslate"><span class="pre">recursive</span> <span class="pre">expansion</span> <span class="pre">process</span></code></a> of directory collector nodes.</p>
<p><a class="reference internal" href="reference/reference.html#pytest.Session.name" title="pytest.Session.name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">session.name</span></code></a> is now <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code>; previously it was the rootdir directory name.
This matches <a class="reference internal" href="reference/reference.html#pytest.nodes.Node.nodeid" title="_pytest.nodes.Node.nodeid"><code class="xref py py-attr docutils literal notranslate"><span class="pre">session.nodeid</span></code></a> which has always been <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code>.</p>
<p>The collection tree now contains directories/packages up to the <a class="reference internal" href="reference/customize.html#rootdir"><span class="std std-ref">rootdir</span></a>,
for initial arguments that are found within the rootdir.
For files outside the rootdir, only the immediate directory/package is collected –
note however that collecting from outside the rootdir is discouraged.</p>
<p>As an example, given the following filesystem tree:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>myroot/
    pytest.ini
    top/
    ├── aaa
    │   └── test_aaa.py
    ├── test_a.py
    ├── test_b
    │   ├── __init__.py
    │   └── test_b.py
    ├── test_c.py
    └── zzz
        ├── __init__.py
        └── test_zzz.py
</pre></div>
</div>
<p>the collection tree, as shown by <code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">--collect-only</span> <span class="pre">top/</span></code> but with the otherwise-hidden <a class="reference internal" href="reference/reference.html#pytest.Session" title="pytest.Session"><code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code></a> node added for clarity,
is now the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">Session</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">Dir</span> <span class="n">myroot</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">Dir</span> <span class="n">top</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">Dir</span> <span class="n">aaa</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">Module</span> <span class="n">test_aaa</span><span class="o">.</span><span class="n">py</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="n">Function</span> <span class="n">test_it</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">Module</span> <span class="n">test_a</span><span class="o">.</span><span class="n">py</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">Function</span> <span class="n">test_it</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">Package</span> <span class="n">test_b</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">Module</span> <span class="n">test_b</span><span class="o">.</span><span class="n">py</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="n">Function</span> <span class="n">test_it</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">Module</span> <span class="n">test_c</span><span class="o">.</span><span class="n">py</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">Function</span> <span class="n">test_it</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">Package</span> <span class="n">zzz</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">Module</span> <span class="n">test_zzz</span><span class="o">.</span><span class="n">py</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="n">Function</span> <span class="n">test_it</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Previously, it was:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">Session</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">Module</span> <span class="n">top</span><span class="o">/</span><span class="n">test_a</span><span class="o">.</span><span class="n">py</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">Function</span> <span class="n">test_it</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">Module</span> <span class="n">top</span><span class="o">/</span><span class="n">test_c</span><span class="o">.</span><span class="n">py</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">Function</span> <span class="n">test_it</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">Module</span> <span class="n">top</span><span class="o">/</span><span class="n">aaa</span><span class="o">/</span><span class="n">test_aaa</span><span class="o">.</span><span class="n">py</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">Function</span> <span class="n">test_it</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">Package</span> <span class="n">test_b</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">Module</span> <span class="n">test_b</span><span class="o">.</span><span class="n">py</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">Function</span> <span class="n">test_it</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">Package</span> <span class="n">zzz</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">Module</span> <span class="n">test_zzz</span><span class="o">.</span><span class="n">py</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">Function</span> <span class="n">test_it</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Code/plugins which rely on a specific shape of the collection tree might need to update.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11676">#11676</a>: The classes <a class="reference internal" href="reference/reference.html#pytest.nodes.Node" title="_pytest.nodes.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a>, <a class="reference internal" href="reference/reference.html#pytest.Collector" title="pytest.Collector"><code class="xref py py-class docutils literal notranslate"><span class="pre">Collector</span></code></a>, <a class="reference internal" href="reference/reference.html#pytest.Item" title="pytest.Item"><code class="xref py py-class docutils literal notranslate"><span class="pre">Item</span></code></a>, <a class="reference internal" href="reference/reference.html#pytest.File" title="pytest.File"><code class="xref py py-class docutils literal notranslate"><span class="pre">File</span></code></a>, <a class="reference internal" href="reference/reference.html#pytest.nodes.FSCollector" title="_pytest.nodes.FSCollector"><code class="xref py py-class docutils literal notranslate"><span class="pre">FSCollector</span></code></a> are now marked abstract (see <a class="reference external" href="https://docs.python.org/3/library/abc.html#module-abc" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">abc</span></code></a>).</p>
<p>We do not expect this change to affect users and plugin authors, it will only cause errors when the code is already wrong or problematic.</p>
</li>
</ul>
</section>
<section id="other-breaking-changes">
<h4>Other breaking changes<a class="headerlink" href="#other-breaking-changes" title="Link to this heading">¶</a></h4>
<p>These are breaking changes where deprecation was not possible.</p>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11282">#11282</a>: Sanitized the handling of the <code class="docutils literal notranslate"><span class="pre">default</span></code> parameter when defining configuration options.</p>
<p>Previously if <code class="docutils literal notranslate"><span class="pre">default</span></code> was not supplied for <a class="reference internal" href="reference/reference.html#pytest.Parser.addini" title="pytest.Parser.addini"><code class="xref py py-meth docutils literal notranslate"><span class="pre">parser.addini</span></code></a> and the configuration option value was not defined in a test session, then calls to <a class="reference internal" href="reference/reference.html#pytest.Config.getini" title="pytest.Config.getini"><code class="xref py py-func docutils literal notranslate"><span class="pre">config.getini</span></code></a> returned an <em>empty list</em> or an <em>empty string</em> depending on whether <code class="docutils literal notranslate"><span class="pre">type</span></code> was supplied or not respectively, which is clearly incorrect. Also, <code class="docutils literal notranslate"><span class="pre">None</span></code> was not honored even if <code class="docutils literal notranslate"><span class="pre">default=None</span></code> was used explicitly while defining the option.</p>
<p>Now the behavior of <a class="reference internal" href="reference/reference.html#pytest.Parser.addini" title="pytest.Parser.addini"><code class="xref py py-meth docutils literal notranslate"><span class="pre">parser.addini</span></code></a> is as follows:</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">default</span></code> is NOT passed but <code class="docutils literal notranslate"><span class="pre">type</span></code> is provided, then a type-specific default will be returned. For example <code class="docutils literal notranslate"><span class="pre">type=bool</span></code> will return <code class="docutils literal notranslate"><span class="pre">False</span></code>, <code class="docutils literal notranslate"><span class="pre">type=str</span></code> will return <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code>, etc.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">default=None</span></code> is passed and the option is not defined in a test session, then <code class="docutils literal notranslate"><span class="pre">None</span></code> will be returned, regardless of the <code class="docutils literal notranslate"><span class="pre">type</span></code>.</p></li>
<li><p>If neither <code class="docutils literal notranslate"><span class="pre">default</span></code> nor <code class="docutils literal notranslate"><span class="pre">type</span></code> are provided, assume <code class="docutils literal notranslate"><span class="pre">type=str</span></code> and return <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code> as default (this is as per previous behavior).</p></li>
</ul>
<p>The team decided to not introduce a deprecation period for this change, as doing so would be complicated both in terms of communicating this to the community as well as implementing it, and also because the team believes this change should not break existing plugins except in rare cases.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11667">#11667</a>: pytest’s <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> file is removed.
If you relied on this file, e.g. to install pytest using <code class="docutils literal notranslate"><span class="pre">setup.py</span> <span class="pre">install</span></code>,
please see <a class="reference external" href="https://blog.ganssle.io/articles/2021/10/setup-py-deprecated.html#summary">Why you shouldn’t invoke setup.py directly</a> for alternatives.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9288">#9288</a>: <a class="reference internal" href="reference/reference.html#pytest.warns" title="pytest.warns"><code class="xref py py-func docutils literal notranslate"><span class="pre">warns()</span></code></a> now re-emits unmatched warnings when the context
closes – previously it would consume all warnings, hiding those that were not
matched by the function.</p>
<p>While this is a new feature, we announce it as a breaking change
because many test suites are configured to error-out on warnings, and will
therefore fail on the newly-re-emitted warnings.</p>
</li>
<li><p>The internal <code class="docutils literal notranslate"><span class="pre">FixtureManager.getfixtureclosure</span></code> method has changed. Plugins which use this method or
which subclass <code class="docutils literal notranslate"><span class="pre">FixtureManager</span></code> and overwrite that method will need to adapt to the change.</p></li>
</ul>
</section>
</section>
<section id="id175">
<h3>Deprecations<a class="headerlink" href="#id175" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10465">#10465</a>: Test functions returning a value other than <code class="docutils literal notranslate"><span class="pre">None</span></code> will now issue a <a class="reference internal" href="reference/reference.html#pytest.PytestWarning" title="pytest.PytestWarning"><code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.PytestWarning</span></code></a> instead of <code class="docutils literal notranslate"><span class="pre">pytest.PytestRemovedIn8Warning</span></code>, meaning this will stay a warning instead of becoming an error in the future.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3664">#3664</a>: Applying a mark to a fixture function now issues a warning: marks in fixtures never had any effect, but it is a common user error to apply a mark to a fixture (for example <code class="docutils literal notranslate"><span class="pre">usefixtures</span></code>) and expect it to work.</p>
<p>This will become an error in pytest 9.0.</p>
</li>
</ul>
</section>
<section id="features-and-improvements">
<h3>Features and Improvements<a class="headerlink" href="#features-and-improvements" title="Link to this heading">¶</a></h3>
<section id="improved-diffs">
<h4>Improved Diffs<a class="headerlink" href="#improved-diffs" title="Link to this heading">¶</a></h4>
<p>These changes improve the diffs that pytest prints when an assertion fails.
Note that syntax highlighting requires the <code class="docutils literal notranslate"><span class="pre">pygments</span></code> package.</p>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11520">#11520</a>: The very verbose (<code class="docutils literal notranslate"><span class="pre">-vv</span></code>) diff output is now colored as a diff instead of a big chunk of red.</p>
<p>Python code in error reports is now syntax-highlighted as Python.</p>
<p>The sections in the error reports are now better separated.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1531">#1531</a>: The very verbose diff (<code class="docutils literal notranslate"><span class="pre">-vv</span></code>) for every standard library container type is improved. The indentation is now consistent and the markers are on their own separate lines, which should reduce the diffs shown to users.</p>
<p>Previously, the standard Python pretty printer was used to generate the output, which puts opening and closing
markers on the same line as the first/last entry, in addition to not having consistent indentation.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10617">#10617</a>: Added more comprehensive set assertion rewrites for comparisons other than equality <code class="docutils literal notranslate"><span class="pre">==</span></code>, with
the following operations now providing better failure messages: <code class="docutils literal notranslate"><span class="pre">!=</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;=</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;=</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;</span></code>, and <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>.</p></li>
</ul>
</section>
<section id="separate-control-for-assertion-verbosity">
<h4>Separate Control For Assertion Verbosity<a class="headerlink" href="#separate-control-for-assertion-verbosity" title="Link to this heading">¶</a></h4>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11387">#11387</a>: Added the new <a class="reference internal" href="reference/reference.html#confval-41"><code class="xref std std-confval docutils literal notranslate"><span class="pre">verbosity_assertions</span></code></a> configuration option for fine-grained control of failed assertions verbosity.</p>
<p>If you’ve ever wished that pytest always show you full diffs, but without making everything else verbose, this is for you.</p>
<p>See <a class="reference internal" href="how-to/output.html#pytest-fine-grained-verbosity"><span class="std std-ref">Fine-grained verbosity</span></a> for more details.</p>
<p>For plugin authors, <a class="reference internal" href="reference/reference.html#pytest.Config.get_verbosity" title="pytest.Config.get_verbosity"><code class="xref py py-attr docutils literal notranslate"><span class="pre">config.get_verbosity</span></code></a> can be used to retrieve the verbosity level for a specific verbosity type.</p>
</li>
</ul>
</section>
<section id="additional-support-for-exception-groups-and-notes">
<h4>Additional Support For Exception Groups and <code class="docutils literal notranslate"><span class="pre">__notes__</span></code><a class="headerlink" href="#additional-support-for-exception-groups-and-notes" title="Link to this heading">¶</a></h4>
<p>These changes improve pytest’s support for exception groups.</p>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10441">#10441</a>: Added <a class="reference internal" href="reference/reference.html#pytest.ExceptionInfo.group_contains" title="pytest.ExceptionInfo.group_contains"><code class="xref py py-func docutils literal notranslate"><span class="pre">ExceptionInfo.group_contains()</span></code></a>, an assertion helper that tests if an <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ExceptionGroup" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExceptionGroup</span></code></a> contains a matching exception.</p>
<p>See <a class="reference internal" href="how-to/assert.html#assert-matching-exception-groups"><span class="std std-ref">匹配异常组</span></a> for an example.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11227">#11227</a>: Allow <a class="reference internal" href="reference/reference.html#pytest.raises" title="pytest.raises"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.raises()</span></code></a> <code class="docutils literal notranslate"><span class="pre">match</span></code> argument to match against <code class="docutils literal notranslate"><span class="pre">PEP-678</span> <span class="pre">&lt;https://peps.python.org/pep-0678/&gt;</span></code> <code class="docutils literal notranslate"><span class="pre">__notes__</span></code>.</p></li>
</ul>
</section>
<section id="custom-directory-collectors">
<h4>Custom Directory collectors<a class="headerlink" href="#custom-directory-collectors" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7777">#7777</a>: Added a new hook <a class="reference internal" href="reference/reference.html#std:hook-12"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_collect_directory</span></code></a>,
which is called by filesystem-traversing collector nodes,
such as <a class="reference internal" href="reference/reference.html#pytest.Session" title="pytest.Session"><code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.Session</span></code></a>, <a class="reference internal" href="reference/reference.html#pytest.Dir" title="pytest.Dir"><code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.Dir</span></code></a> and <a class="reference internal" href="reference/reference.html#pytest.Package" title="pytest.Package"><code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.Package</span></code></a>,
to create a collector node for a sub-directory.
It is expected to return a subclass of <a class="reference internal" href="reference/reference.html#pytest.Directory" title="pytest.Directory"><code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.Directory</span></code></a>.
This hook allows plugins to <a class="reference internal" href="example/customdirectory.html#custom-directory-collectors"><span class="std std-ref">customize the collection of directories</span></a>.</p></li>
</ul>
</section>
<section id="new-style-hook-wrappers">
<h4>“New-style” Hook Wrappers<a class="headerlink" href="#new-style-hook-wrappers" title="Link to this heading">¶</a></h4>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11122">#11122</a>: pytest now uses “new-style” hook wrappers internally, available since pluggy 1.2.0.
See <a class="reference external" href="https://pluggy.readthedocs.io/en/latest/changelog.html#pluggy-1-2-0-2023-06-21">pluggy’s 1.2.0 changelog</a> and the <a class="reference internal" href="how-to/writing_hook_functions.html#hookwrapper"><span class="std std-ref">updated docs</span></a> for details.</p>
<p>Plugins which want to use new-style wrappers can do so if they require <code class="docutils literal notranslate"><span class="pre">pytest&gt;=8</span></code>.</p>
</li>
</ul>
</section>
<section id="other-improvements">
<h4>Other Improvements<a class="headerlink" href="#other-improvements" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11216">#11216</a>: If a test is skipped from inside an <a class="reference internal" href="how-to/xunit_setup.html#classic-xunit"><span class="std std-ref">xunit setup fixture</span></a>, the test summary now shows the test location instead of the fixture location.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11314">#11314</a>: Logging to a file using the <code class="docutils literal notranslate"><span class="pre">--log-file</span></code> option will use <code class="docutils literal notranslate"><span class="pre">--log-level</span></code>, <code class="docutils literal notranslate"><span class="pre">--log-format</span></code> and <code class="docutils literal notranslate"><span class="pre">--log-date-format</span></code> as fallback
if <code class="docutils literal notranslate"><span class="pre">--log-file-level</span></code>, <code class="docutils literal notranslate"><span class="pre">--log-file-format</span></code> and <code class="docutils literal notranslate"><span class="pre">--log-file-date-format</span></code> are not provided respectively.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11610">#11610</a>: Added the <a class="reference internal" href="reference/reference.html#pytest.LogCaptureFixture.filtering" title="pytest.LogCaptureFixture.filtering"><code class="xref py py-func docutils literal notranslate"><span class="pre">LogCaptureFixture.filtering()</span></code></a> context manager which
adds a given <a class="reference external" href="https://docs.python.org/3/library/logging.html#logging.Filter" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">logging.Filter</span></code></a> object to the <a class="reference internal" href="reference/reference.html#std-fixture-caplog"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">caplog</span></code></a> fixture.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11447">#11447</a>: <a class="reference internal" href="reference/reference.html#pytest.deprecated_call" title="pytest.deprecated_call"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.deprecated_call()</span></code></a> now also considers warnings of type <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#FutureWarning" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">FutureWarning</span></code></a>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11600">#11600</a>: Improved the documentation and type signature for <a class="reference internal" href="reference/reference.html#id8" title="pytest.mark.xfail"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.mark.xfail</span></code></a>’s <code class="docutils literal notranslate"><span class="pre">condition</span></code> param to use <code class="docutils literal notranslate"><span class="pre">False</span></code> as the default value.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7469">#7469</a>: <a class="reference internal" href="reference/reference.html#pytest.FixtureDef" title="pytest.FixtureDef"><code class="xref py py-class docutils literal notranslate"><span class="pre">FixtureDef</span></code></a> is now exported as <code class="docutils literal notranslate"><span class="pre">pytest.FixtureDef</span></code> for typing purposes.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11353">#11353</a>: Added typing to <a class="reference internal" href="reference/reference.html#pytest.PytestPluginManager" title="pytest.PytestPluginManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">PytestPluginManager</span></code></a>.</p></li>
</ul>
</section>
</section>
<section id="id193">
<h3>Bug Fixes<a class="headerlink" href="#id193" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10701">#10701</a>: <a class="reference internal" href="reference/reference.html#pytest.WarningsRecorder.pop" title="pytest.WarningsRecorder.pop"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pytest.WarningsRecorder.pop()</span></code></a> will return the most-closely-matched warning in the list,
rather than the first warning which is an instance of the requested type.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11255">#11255</a>: Fixed crash on <code class="docutils literal notranslate"><span class="pre">parametrize(...,</span> <span class="pre">scope=&quot;package&quot;)</span></code> without a package present.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11277">#11277</a>: Fixed a bug that when there are multiple fixtures for an indirect parameter,
the scope of the highest-scope fixture is picked for the parameter set, instead of that of the one with the narrowest scope.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11456">#11456</a>: Parametrized tests now <em>really do</em> ensure that the ids given to each input are unique - for
example, <code class="docutils literal notranslate"><span class="pre">a,</span> <span class="pre">a,</span> <span class="pre">a0</span></code> now results in <code class="docutils literal notranslate"><span class="pre">a1,</span> <span class="pre">a2,</span> <span class="pre">a0</span></code> instead of the previous (buggy) <code class="docutils literal notranslate"><span class="pre">a0,</span> <span class="pre">a1,</span> <span class="pre">a0</span></code>.
This necessarily means changing nodeids where these were previously colliding, and for
readability adds an underscore when non-unique ids end in a number.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11563">#11563</a>: Fixed a crash when using an empty string for the same parametrized value more than once.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11712">#11712</a>: Fixed handling <code class="docutils literal notranslate"><span class="pre">NO_COLOR</span></code> and <code class="docutils literal notranslate"><span class="pre">FORCE_COLOR</span></code> to ignore an empty value.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9036">#9036</a>: <code class="docutils literal notranslate"><span class="pre">pytest.warns</span></code> and similar functions now capture warnings when an exception is raised inside a <code class="docutils literal notranslate"><span class="pre">with</span></code> block.</p></li>
</ul>
</section>
<section id="id201">
<h3>Improved Documentation<a class="headerlink" href="#id201" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11011">#11011</a>: Added a warning about modifying the root logger during tests when using <code class="docutils literal notranslate"><span class="pre">caplog</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11065">#11065</a>: Use <code class="docutils literal notranslate"><span class="pre">pytestconfig</span></code> instead of <code class="docutils literal notranslate"><span class="pre">request.config</span></code> in cache example to be consistent with the API documentation.</p></li>
</ul>
</section>
<section id="id204">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id204" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11208">#11208</a>: The (internal) <code class="docutils literal notranslate"><span class="pre">FixtureDef.cached_result</span></code> type has changed.
Now the third item <code class="docutils literal notranslate"><span class="pre">cached_result[2]</span></code>, when set, is an exception instance instead of an exception triplet.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11218">#11218</a>: (This entry is meant to assist plugins which access private pytest internals to instantiate <code class="docutils literal notranslate"><span class="pre">FixtureRequest</span></code> objects.)</p>
<p><a class="reference internal" href="reference/reference.html#id74" title="pytest.FixtureRequest"><code class="xref py py-class docutils literal notranslate"><span class="pre">FixtureRequest</span></code></a> is now an abstract class which can’t be instantiated directly.
A new concrete <code class="docutils literal notranslate"><span class="pre">TopRequest</span></code> subclass of <code class="docutils literal notranslate"><span class="pre">FixtureRequest</span></code> has been added for the <code class="docutils literal notranslate"><span class="pre">request</span></code> fixture in test functions,
as counterpart to the existing <code class="docutils literal notranslate"><span class="pre">SubRequest</span></code> subclass for the <code class="docutils literal notranslate"><span class="pre">request</span></code> fixture in fixture functions.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11315">#11315</a>: The <a class="reference internal" href="reference/reference.html#std-fixture-pytester"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">pytester</span></code></a> fixture now uses the <a class="reference internal" href="reference/reference.html#std-fixture-monkeypatch"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">monkeypatch</span></code></a> fixture to manage the current working directory.
If you use <code class="docutils literal notranslate"><span class="pre">pytester</span></code> in combination with <a class="reference internal" href="reference/reference.html#pytest.MonkeyPatch.undo" title="pytest.MonkeyPatch.undo"><code class="xref py py-func docutils literal notranslate"><span class="pre">monkeypatch.undo()</span></code></a>, the CWD might get restored.
Use <a class="reference internal" href="reference/reference.html#pytest.MonkeyPatch.context" title="pytest.MonkeyPatch.context"><code class="xref py py-func docutils literal notranslate"><span class="pre">monkeypatch.context()</span></code></a> instead.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11333">#11333</a>: Corrected the spelling of <code class="docutils literal notranslate"><span class="pre">Config.ArgsSource.INVOCATION_DIR</span></code>.
The previous spelling <code class="docutils literal notranslate"><span class="pre">INCOVATION_DIR</span></code> remains as an alias.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11638">#11638</a>: Fixed the selftests to pass correctly if <code class="docutils literal notranslate"><span class="pre">FORCE_COLOR</span></code>, <code class="docutils literal notranslate"><span class="pre">NO_COLOR</span></code> or <code class="docutils literal notranslate"><span class="pre">PY_COLORS</span></code> is set in the calling environment.</p></li>
</ul>
</section>
</section>
<section id="pytest-7-4-4-2023-12-31">
<h2>pytest 7.4.4 (2023-12-31)<a class="headerlink" href="#pytest-7-4-4-2023-12-31" title="Link to this heading">¶</a></h2>
<section id="id210">
<h3>Bug Fixes<a class="headerlink" href="#id210" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11140">#11140</a>: Fix non-string constants at the top of file being detected as docstrings on Python&gt;=3.8.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11572">#11572</a>: Handle an edge case where <a class="reference external" href="https://docs.python.org/3/library/sys.html#sys.stderr" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.stderr</span></code></a> and <a class="reference external" href="https://docs.python.org/3/library/sys.html#sys.__stderr__" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.__stderr__</span></code></a> might already be closed when <a class="reference internal" href="how-to/failures.html#faulthandler"><span class="std std-ref">故障处理</span></a> is tearing down.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11710">#11710</a>: Fixed tracebacks from collection errors not getting pruned.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7966">#7966</a>: Removed unhelpful error message from assertion rewrite mechanism when exceptions are raised in <code class="docutils literal notranslate"><span class="pre">__iter__</span></code> methods. Now they are treated un-iterable instead.</p></li>
</ul>
</section>
<section id="id215">
<h3>Improved Documentation<a class="headerlink" href="#id215" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11091">#11091</a>: Updated documentation to refer to hyphenated options: replaced <code class="docutils literal notranslate"><span class="pre">--junitxml</span></code> with <code class="docutils literal notranslate"><span class="pre">--junit-xml</span></code> and <code class="docutils literal notranslate"><span class="pre">--collectonly</span></code> with <code class="docutils literal notranslate"><span class="pre">--collect-only</span></code>.</p></li>
</ul>
</section>
</section>
<section id="pytest-7-4-3-2023-10-24">
<h2>pytest 7.4.3 (2023-10-24)<a class="headerlink" href="#pytest-7-4-3-2023-10-24" title="Link to this heading">¶</a></h2>
<section id="id217">
<h3>Bug Fixes<a class="headerlink" href="#id217" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10447">#10447</a>: Markers are now considered in the reverse mro order to ensure base  class markers are considered first – this resolves a regression.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11239">#11239</a>: Fixed <code class="docutils literal notranslate"><span class="pre">:=</span></code> in asserts impacting unrelated test cases.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11439">#11439</a>: Handled an edge case where <a class="reference external" href="https://docs.python.org/3/library/sys.html#sys.stderr" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.stderr</span></code></a> might already be closed when <a class="reference internal" href="how-to/failures.html#faulthandler"><span class="std std-ref">故障处理</span></a> is tearing down.</p></li>
</ul>
</section>
</section>
<section id="pytest-7-4-2-2023-09-07">
<h2>pytest 7.4.2 (2023-09-07)<a class="headerlink" href="#pytest-7-4-2-2023-09-07" title="Link to this heading">¶</a></h2>
<section id="id221">
<h3>Bug Fixes<a class="headerlink" href="#id221" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11237">#11237</a>: Fix doctest collection of <code class="docutils literal notranslate"><span class="pre">functools.cached_property</span></code> objects.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11306">#11306</a>: Fixed bug using <code class="docutils literal notranslate"><span class="pre">--importmode=importlib</span></code> which would cause package <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> files to be imported more than once in some cases.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11367">#11367</a>: Fixed bug where <code class="docutils literal notranslate"><span class="pre">user_properties</span></code> where not being saved in the JUnit XML file if a fixture failed during teardown.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11394">#11394</a>: Fixed crash when parsing long command line arguments that might be interpreted as files.</p></li>
</ul>
</section>
<section id="id226">
<h3>Improved Documentation<a class="headerlink" href="#id226" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11391">#11391</a>: Improved disclaimer on pytest plugin reference page to better indicate this is an automated, non-curated listing.</p></li>
</ul>
</section>
</section>
<section id="pytest-7-4-1-2023-09-02">
<h2>pytest 7.4.1 (2023-09-02)<a class="headerlink" href="#pytest-7-4-1-2023-09-02" title="Link to this heading">¶</a></h2>
<section id="id228">
<h3>Bug Fixes<a class="headerlink" href="#id228" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10337">#10337</a>: Fixed bug where fake intermediate modules generated by <code class="docutils literal notranslate"><span class="pre">--import-mode=importlib</span></code> would not include the
child modules as attributes of the parent modules.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10702">#10702</a>: Fixed error assertion handling in <a class="reference internal" href="reference/reference.html#pytest.approx" title="pytest.approx"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.approx()</span></code></a> when <code class="docutils literal notranslate"><span class="pre">None</span></code> is an expected or received value when comparing dictionaries.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10811">#10811</a>: Fixed issue when using <code class="docutils literal notranslate"><span class="pre">--import-mode=importlib</span></code> together with <code class="docutils literal notranslate"><span class="pre">--doctest-modules</span></code> that caused modules
to be imported more than once, causing problems with modules that have import side effects.</p></li>
</ul>
</section>
</section>
<section id="pytest-7-4-0-2023-06-23">
<h2>pytest 7.4.0 (2023-06-23)<a class="headerlink" href="#pytest-7-4-0-2023-06-23" title="Link to this heading">¶</a></h2>
<section id="id232">
<h3>Features<a class="headerlink" href="#id232" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10901">#10901</a>: Added <a class="reference internal" href="reference/reference.html#pytest.ExceptionInfo.from_exception" title="pytest.ExceptionInfo.from_exception"><code class="xref py py-func docutils literal notranslate"><span class="pre">ExceptionInfo.from_exception()</span></code></a>, a simpler way to create an <a class="reference internal" href="reference/reference.html#pytest.ExceptionInfo" title="pytest.ExceptionInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExceptionInfo</span></code></a> from an exception.
This can replace <a class="reference internal" href="reference/reference.html#pytest.ExceptionInfo.from_exc_info" title="pytest.ExceptionInfo.from_exc_info"><code class="xref py py-func docutils literal notranslate"><span class="pre">ExceptionInfo.from_exc_info()</span></code></a> for most uses.</p></li>
</ul>
</section>
<section id="id234">
<h3>Improvements<a class="headerlink" href="#id234" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10872">#10872</a>: Update test log report annotation to named tuple and fixed inconsistency in docs for <a class="reference internal" href="reference/reference.html#std:hook-35"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_report_teststatus</span></code></a> hook.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10907">#10907</a>: When an exception traceback to be displayed is completely filtered out (by mechanisms such as <code class="docutils literal notranslate"><span class="pre">__tracebackhide__</span></code>, internal frames, and similar), now only the exception string and the following message are shown:</p>
<p>“All traceback entries are hidden. Pass <code class="docutils literal notranslate"><span class="pre">--full-trace</span></code> to see hidden and internal frames.”.</p>
<p>Previously, the last frame of the traceback was shown, even though it was hidden.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10940">#10940</a>: Improved verbose output (<code class="docutils literal notranslate"><span class="pre">-vv</span></code>) of <code class="docutils literal notranslate"><span class="pre">skip</span></code> and <code class="docutils literal notranslate"><span class="pre">xfail</span></code> reasons by performing text wrapping while leaving a clear margin for progress output.</p>
<p>Added <code class="docutils literal notranslate"><span class="pre">TerminalReporter.wrap_write()</span></code> as a helper for that.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10991">#10991</a>: Added handling of <code class="docutils literal notranslate"><span class="pre">%f</span></code> directive to print microseconds in log format options, such as <code class="docutils literal notranslate"><span class="pre">log-date-format</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11005">#11005</a>: Added the underlying exception to the cache provider’s path creation and write warning messages.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11013">#11013</a>: Added warning when <a class="reference internal" href="reference/reference.html#confval-35"><code class="xref std std-confval docutils literal notranslate"><span class="pre">testpaths</span></code></a> is set, but paths are not found by glob. In this case, pytest will fall back to searching from the current directory.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11043">#11043</a>: When <code class="docutils literal notranslate"><span class="pre">--confcutdir</span></code> is not specified, and there is no config file present, the conftest cutoff directory (<code class="docutils literal notranslate"><span class="pre">--confcutdir</span></code>) is now set to the <a class="reference internal" href="reference/customize.html#rootdir"><span class="std std-ref">rootdir</span></a>.
Previously in such cases, <code class="docutils literal notranslate"><span class="pre">conftest.py</span></code> files would be probed all the way to the root directory of the filesystem.
If you are badly affected by this change, consider adding an empty config file to your desired cutoff directory, or explicitly set <code class="docutils literal notranslate"><span class="pre">--confcutdir</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11081">#11081</a>: The <a class="reference internal" href="reference/reference.html#confval-29"><code class="xref std std-confval docutils literal notranslate"><span class="pre">norecursedirs</span></code></a> check is now performed in a <a class="reference internal" href="reference/reference.html#std:hook-11"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_ignore_collect</span></code></a> implementation, so plugins can affect it.</p>
<p>If after updating to this version you see that your <code class="docutils literal notranslate"><span class="pre">norecursedirs</span></code> setting is not being respected,
it means that a conftest or a plugin you use has a bad <code class="docutils literal notranslate"><span class="pre">pytest_ignore_collect</span></code> implementation.
Most likely, your hook returns <code class="docutils literal notranslate"><span class="pre">False</span></code> for paths it does not want to ignore,
which ends the processing and doesn’t allow other plugins, including pytest itself, to ignore the path.
The fix is to return <code class="docutils literal notranslate"><span class="pre">None</span></code> instead of <code class="docutils literal notranslate"><span class="pre">False</span></code> for paths your hook doesn’t want to ignore.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8711">#8711</a>: <a class="reference internal" href="reference/reference.html#pytest.LogCaptureFixture.set_level" title="pytest.LogCaptureFixture.set_level"><code class="xref py py-func docutils literal notranslate"><span class="pre">caplog.set_level()</span></code></a> and <a class="reference internal" href="reference/reference.html#pytest.LogCaptureFixture.at_level" title="pytest.LogCaptureFixture.at_level"><code class="xref py py-func docutils literal notranslate"><span class="pre">caplog.at_level()</span></code></a>
will temporarily enable the requested <code class="docutils literal notranslate"><span class="pre">level</span></code> if <code class="docutils literal notranslate"><span class="pre">level</span></code> was disabled globally via
<code class="docutils literal notranslate"><span class="pre">logging.disable(LEVEL)</span></code>.</p></li>
</ul>
</section>
<section id="id244">
<h3>Bug Fixes<a class="headerlink" href="#id244" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10831">#10831</a>: Terminal Reporting: Fixed bug when running in <code class="docutils literal notranslate"><span class="pre">--tb=line</span></code> mode where <code class="docutils literal notranslate"><span class="pre">pytest.fail(pytrace=False)</span></code> tests report <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11068">#11068</a>: Fixed the <code class="docutils literal notranslate"><span class="pre">--last-failed</span></code> whole-file skipping functionality (“skipped N files”) for <a class="reference internal" href="example/nonpython.html#non-python-tests"><span class="std std-ref">non-python test files</span></a>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11104">#11104</a>: Fixed a regression in pytest 7.3.2 which caused to <a class="reference internal" href="reference/reference.html#confval-35"><code class="xref std std-confval docutils literal notranslate"><span class="pre">testpaths</span></code></a> to be considered for loading initial conftests,
even when it was not utilized (e.g. when explicit paths were given on the command line).
Now the <code class="docutils literal notranslate"><span class="pre">testpaths</span></code> are only considered when they are in use.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1904">#1904</a>: Fixed traceback entries hidden with <code class="docutils literal notranslate"><span class="pre">__tracebackhide__</span> <span class="pre">=</span> <span class="pre">True</span></code> still being shown for chained exceptions (parts after “… the above exception …” message).</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7781">#7781</a>: Fix writing non-encodable text to log file when using <code class="docutils literal notranslate"><span class="pre">--debug</span></code>.</p></li>
</ul>
</section>
<section id="id250">
<h3>Improved Documentation<a class="headerlink" href="#id250" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9146">#9146</a>: Improved documentation for <a class="reference internal" href="reference/reference.html#pytest.LogCaptureFixture.set_level" title="pytest.LogCaptureFixture.set_level"><code class="xref py py-func docutils literal notranslate"><span class="pre">caplog.set_level()</span></code></a>.</p></li>
</ul>
</section>
<section id="id252">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id252" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11031">#11031</a>: Enhanced the CLI flag for <code class="docutils literal notranslate"><span class="pre">-c</span></code> to now include <code class="docutils literal notranslate"><span class="pre">--config-file</span></code> to make it clear that this flag applies to the usage of a custom config file.</p></li>
</ul>
</section>
</section>
<section id="pytest-7-3-2-2023-06-10">
<h2>pytest 7.3.2 (2023-06-10)<a class="headerlink" href="#pytest-7-3-2-2023-06-10" title="Link to this heading">¶</a></h2>
<section id="id254">
<h3>Bug Fixes<a class="headerlink" href="#id254" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10169">#10169</a>: Fix bug where very long option names could cause pytest to break with <code class="docutils literal notranslate"><span class="pre">OSError:</span> <span class="pre">[Errno</span> <span class="pre">36]</span> <span class="pre">File</span> <span class="pre">name</span> <span class="pre">too</span> <span class="pre">long</span></code> on some systems.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10894">#10894</a>: Support for Python 3.12 (beta at the time of writing).</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10987">#10987</a>: <a class="reference internal" href="reference/reference.html#confval-35"><code class="xref std std-confval docutils literal notranslate"><span class="pre">testpaths</span></code></a> is now honored to load root <code class="docutils literal notranslate"><span class="pre">conftests</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10999">#10999</a>: The <code class="docutils literal notranslate"><span class="pre">monkeypatch</span></code> <code class="docutils literal notranslate"><span class="pre">setitem</span></code>/<code class="docutils literal notranslate"><span class="pre">delitem</span></code> type annotations now allow <code class="docutils literal notranslate"><span class="pre">TypedDict</span></code> arguments.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11028">#11028</a>: Fixed bug in assertion rewriting where a variable assigned with the walrus operator could not be used later in a function call.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11054">#11054</a>: Fixed <code class="docutils literal notranslate"><span class="pre">--last-failed</span></code>’s “(skipped N files)” functionality for files inside of packages (directories with <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> files).</p></li>
</ul>
</section>
</section>
<section id="pytest-7-3-1-2023-04-14">
<h2>pytest 7.3.1 (2023-04-14)<a class="headerlink" href="#pytest-7-3-1-2023-04-14" title="Link to this heading">¶</a></h2>
<section id="id261">
<h3>Improvements<a class="headerlink" href="#id261" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10875">#10875</a>: Python 3.12 support: fixed <code class="docutils literal notranslate"><span class="pre">RuntimeError:</span> <span class="pre">TestResult</span> <span class="pre">has</span> <span class="pre">no</span> <span class="pre">addDuration</span> <span class="pre">method</span></code> when running <code class="docutils literal notranslate"><span class="pre">unittest</span></code> tests.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10890">#10890</a>: Python 3.12 support: fixed <code class="docutils literal notranslate"><span class="pre">shutil.rmtree(onerror=...)</span></code> deprecation warning when using <a class="reference internal" href="reference/reference.html#std:fixture-3"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">tmp_path</span></code></a>.</p></li>
</ul>
</section>
<section id="id264">
<h3>Bug Fixes<a class="headerlink" href="#id264" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10896">#10896</a>: Fixed performance regression related to <a class="reference internal" href="reference/reference.html#std:fixture-3"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">tmp_path</span></code></a> and the new <a class="reference internal" href="reference/reference.html#confval-37"><code class="xref std std-confval docutils literal notranslate"><span class="pre">tmp_path_retention_policy</span></code></a> option.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10903">#10903</a>: Fix crash <code class="docutils literal notranslate"><span class="pre">INTERNALERROR</span> <span class="pre">IndexError:</span> <span class="pre">list</span> <span class="pre">index</span> <span class="pre">out</span> <span class="pre">of</span> <span class="pre">range</span></code> which happens when displaying an exception where all entries are hidden.
This reverts the change “Correctly handle <code class="docutils literal notranslate"><span class="pre">__tracebackhide__</span></code> for chained exceptions.” introduced in version 7.3.0.</p></li>
</ul>
</section>
</section>
<section id="pytest-7-3-0-2023-04-08">
<h2>pytest 7.3.0 (2023-04-08)<a class="headerlink" href="#pytest-7-3-0-2023-04-08" title="Link to this heading">¶</a></h2>
<section id="id267">
<h3>Features<a class="headerlink" href="#id267" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10525">#10525</a>: Test methods decorated with <code class="docutils literal notranslate"><span class="pre">&#64;classmethod</span></code> can now be discovered as tests, following the same rules as normal methods. This fills the gap that static methods were discoverable as tests but not class methods.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10755">#10755</a>: <a class="reference internal" href="reference/reference.html#confval-3"><code class="xref std std-confval docutils literal notranslate"><span class="pre">console_output_style</span></code></a> now supports <code class="docutils literal notranslate"><span class="pre">progress-even-when-capture-no</span></code> to force the use of the progress output even when capture is disabled. This is useful in large test suites where capture may have significant performance impact.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7431">#7431</a>: <code class="docutils literal notranslate"><span class="pre">--log-disable</span></code> CLI option added to disable individual loggers.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8141">#8141</a>: Added <a class="reference internal" href="reference/reference.html#confval-36"><code class="xref std std-confval docutils literal notranslate"><span class="pre">tmp_path_retention_count</span></code></a> and <a class="reference internal" href="reference/reference.html#confval-37"><code class="xref std std-confval docutils literal notranslate"><span class="pre">tmp_path_retention_policy</span></code></a> configuration options to control how directories created by the <a class="reference internal" href="reference/reference.html#std:fixture-3"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">tmp_path</span></code></a> fixture are kept.</p></li>
</ul>
</section>
<section id="id272">
<h3>Improvements<a class="headerlink" href="#id272" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10226">#10226</a>: If multiple errors are raised in teardown, we now re-raise an <code class="docutils literal notranslate"><span class="pre">ExceptionGroup</span></code> of them instead of discarding all but the last.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10658">#10658</a>: Allow <code class="docutils literal notranslate"><span class="pre">-p</span></code> arguments to include spaces (eg: <code class="docutils literal notranslate"><span class="pre">-p</span> <span class="pre">no:logging</span></code> instead of
<code class="docutils literal notranslate"><span class="pre">-pno:logging</span></code>). Mostly useful in the <code class="docutils literal notranslate"><span class="pre">addopts</span></code> section of the configuration
file.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10710">#10710</a>: Added <code class="docutils literal notranslate"><span class="pre">start</span></code> and <code class="docutils literal notranslate"><span class="pre">stop</span></code> timestamps to <code class="docutils literal notranslate"><span class="pre">TestReport</span></code> objects.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10727">#10727</a>: Split the report header for <code class="docutils literal notranslate"><span class="pre">rootdir</span></code>, <code class="docutils literal notranslate"><span class="pre">config</span> <span class="pre">file</span></code> and <code class="docutils literal notranslate"><span class="pre">testpaths</span></code> so each has its own line.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10840">#10840</a>: pytest should no longer crash on AST with pathological position attributes, for example testing AST produced by <code class="docutils literal notranslate"><span class="pre">Hylang</span> <span class="pre">&lt;https://github.com/hylang/hy&gt;__</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6267">#6267</a>: The full output of a test is no longer truncated if the truncation message would be longer than
the hidden text. The line number shown has also been fixed.</p></li>
</ul>
</section>
<section id="id279">
<h3>Bug Fixes<a class="headerlink" href="#id279" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10743">#10743</a>: The assertion rewriting mechanism now works correctly when assertion expressions contain the walrus operator.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10765">#10765</a>: Fixed <a class="reference internal" href="reference/reference.html#std:fixture-3"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">tmp_path</span></code></a> fixture always raising <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#OSError" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">OSError</span></code></a> on <code class="docutils literal notranslate"><span class="pre">emscripten</span></code> platform due to missing <a class="reference external" href="https://docs.python.org/3/library/os.html#os.getuid" title="(in Python v3.13)"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.getuid()</span></code></a>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1904">#1904</a>: Correctly handle <code class="docutils literal notranslate"><span class="pre">__tracebackhide__</span></code> for chained exceptions.
NOTE: This change was reverted in version 7.3.1.</p></li>
</ul>
</section>
<section id="id283">
<h3>Improved Documentation<a class="headerlink" href="#id283" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10782">#10782</a>: Fixed the minimal example in <a class="reference internal" href="explanation/goodpractices.html#goodpractices"><span class="std std-ref">良好的集成实践</span></a>: <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-e</span> <span class="pre">.</span></code> requires a <code class="docutils literal notranslate"><span class="pre">version</span></code> entry in <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> to run successfully.</p></li>
</ul>
</section>
<section id="id285">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id285" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10669">#10669</a>: pytest no longer directly depends on the <a class="reference external" href="https://www.attrs.org/en/stable/">attrs</a> package. While
we at pytest all love the package dearly and would like to thank the <code class="docutils literal notranslate"><span class="pre">attrs</span></code> team for many years of cooperation and support,
it makes sense for <code class="docutils literal notranslate"><span class="pre">pytest</span></code> to have as little external dependencies as possible, as this helps downstream projects.
With that in mind, we have replaced the pytest’s limited internal usage to use the standard library’s <code class="docutils literal notranslate"><span class="pre">dataclasses</span></code> instead.</p>
<p>Nice diffs for <code class="docutils literal notranslate"><span class="pre">attrs</span></code> classes are still supported though.</p>
</li>
</ul>
</section>
</section>
<section id="pytest-7-2-2-2023-03-03">
<h2>pytest 7.2.2 (2023-03-03)<a class="headerlink" href="#pytest-7-2-2-2023-03-03" title="Link to this heading">¶</a></h2>
<section id="id287">
<h3>Bug Fixes<a class="headerlink" href="#id287" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10533">#10533</a>: Fixed <a class="reference internal" href="reference/reference.html#pytest.approx" title="pytest.approx"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.approx()</span></code></a> handling of dictionaries containing one or more values of <code class="docutils literal notranslate"><span class="pre">0.0</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10592">#10592</a>: Fixed crash if <code class="docutils literal notranslate"><span class="pre">--cache-show</span></code> and <code class="docutils literal notranslate"><span class="pre">--help</span></code> are passed at the same time.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10597">#10597</a>: Fixed bug where a fixture method named <code class="docutils literal notranslate"><span class="pre">teardown</span></code> would be called as part of <code class="docutils literal notranslate"><span class="pre">nose</span></code> teardown stage.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10626">#10626</a>: Fixed crash if <code class="docutils literal notranslate"><span class="pre">--fixtures</span></code> and <code class="docutils literal notranslate"><span class="pre">--help</span></code> are passed at the same time.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10660">#10660</a>: Fixed <a class="reference internal" href="reference/reference.html#pytest.raises" title="pytest.raises"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.raises()</span></code></a> to return a ‘ContextManager’ so that type-checkers could narrow
<code class="code docutils literal notranslate"><span class="pre">pytest.raises(...)</span> <span class="pre">if</span> <span class="pre">...</span> <span class="pre">else</span> <span class="pre">nullcontext()</span></code> down to ‘ContextManager’ rather than ‘object’.</p></li>
</ul>
</section>
<section id="id293">
<h3>Improved Documentation<a class="headerlink" href="#id293" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10690">#10690</a>: Added <code class="docutils literal notranslate"><span class="pre">CI</span></code> and <code class="docutils literal notranslate"><span class="pre">BUILD_NUMBER</span></code> environment variables to the documentation.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10721">#10721</a>: Fixed entry-points declaration in the documentation example using Hatch.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10753">#10753</a>: Changed wording of the module level skip to be very explicit
about not collecting tests and not executing the rest of the module.</p></li>
</ul>
</section>
</section>
<section id="pytest-7-2-1-2023-01-13">
<h2>pytest 7.2.1 (2023-01-13)<a class="headerlink" href="#pytest-7-2-1-2023-01-13" title="Link to this heading">¶</a></h2>
<section id="id297">
<h3>Bug Fixes<a class="headerlink" href="#id297" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10452">#10452</a>: Fix ‘importlib.abc.TraversableResources’ deprecation warning in Python 3.12.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10457">#10457</a>: If a test is skipped from inside a fixture, the test summary now shows the test location instead of the fixture location.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10506">#10506</a>: Fix bug where sometimes pytest would use the file system root directory as <a class="reference internal" href="reference/customize.html#rootdir"><span class="std std-ref">rootdir</span></a> on Windows.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10607">#10607</a>: Fix a race condition when creating junitxml reports, which could occur when multiple instances of pytest execute in parallel.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10641">#10641</a>: Fix a race condition when creating or updating the stepwise plugin’s cache, which could occur when multiple xdist worker nodes try to simultaneously update the stepwise plugin’s cache.</p></li>
</ul>
</section>
</section>
<section id="pytest-7-2-0-2022-10-23">
<h2>pytest 7.2.0 (2022-10-23)<a class="headerlink" href="#pytest-7-2-0-2022-10-23" title="Link to this heading">¶</a></h2>
<section id="id303">
<h3>Deprecations<a class="headerlink" href="#id303" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10012">#10012</a>: Update <code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.PytestUnhandledCoroutineWarning</span></code> to a deprecation; it will raise an error in pytest 8.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10396">#10396</a>: pytest no longer depends on the <code class="docutils literal notranslate"><span class="pre">py</span></code> library.  <code class="docutils literal notranslate"><span class="pre">pytest</span></code> provides a vendored copy of <code class="docutils literal notranslate"><span class="pre">py.error</span></code> and <code class="docutils literal notranslate"><span class="pre">py.path</span></code> modules but will use the <code class="docutils literal notranslate"><span class="pre">py</span></code> library if it is installed.  If you need other <code class="docutils literal notranslate"><span class="pre">py.*</span></code> modules, continue to install the deprecated <code class="docutils literal notranslate"><span class="pre">py</span></code> library separately, otherwise it can usually be removed as a dependency.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4562">#4562</a>: Deprecate configuring hook specs/impls using attributes/marks.</p>
<p>Instead use <a class="reference internal" href="reference/reference.html#id94" title="pytest.hookimpl"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.hookimpl()</span></code></a> and <a class="reference internal" href="reference/reference.html#pytest.hookspec" title="pytest.hookspec"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.hookspec()</span></code></a>.
For more details, see the <a class="reference internal" href="deprecations.html#legacy-path-hooks-deprecated"><span class="std std-ref">docs</span></a>.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9886">#9886</a>: The functionality for running tests written for <code class="docutils literal notranslate"><span class="pre">nose</span></code> has been officially deprecated.</p>
<p>This includes:</p>
<ul class="simple">
<li><p>Plain <code class="docutils literal notranslate"><span class="pre">setup</span></code> and <code class="docutils literal notranslate"><span class="pre">teardown</span></code> functions and methods: this might catch users by surprise, as <code class="docutils literal notranslate"><span class="pre">setup()</span></code> and <code class="docutils literal notranslate"><span class="pre">teardown()</span></code> are not pytest idioms, but part of the <code class="docutils literal notranslate"><span class="pre">nose</span></code> support.</p></li>
<li><p>Setup/teardown using the <a class="reference external" href="with-setup-nose">&#64;with_setup</a> decorator.</p></li>
</ul>
<p>For more details, consult the <a class="reference internal" href="deprecations.html#nose-deprecation"><span class="std std-ref">deprecation docs</span></a>.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7337">#7337</a>: A deprecation warning is now emitted if a test function returns something other than <code class="docutils literal notranslate"><span class="pre">None</span></code>. This prevents a common mistake among beginners that expect that returning a <code class="docutils literal notranslate"><span class="pre">bool</span></code> (for example <code class="docutils literal notranslate"><span class="pre">return</span> <span class="pre">foo(a,</span> <span class="pre">b)</span> <span class="pre">==</span> <span class="pre">result</span></code>) would cause a test to pass or fail, instead of using <code class="docutils literal notranslate"><span class="pre">assert</span></code>. The plan is to make returning non-<code class="docutils literal notranslate"><span class="pre">None</span></code> from tests an error in the future.</p></li>
</ul>
</section>
<section id="id309">
<h3>Features<a class="headerlink" href="#id309" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9897">#9897</a>: Added shell-style wildcard support to <code class="docutils literal notranslate"><span class="pre">testpaths</span></code>.</p></li>
</ul>
</section>
<section id="id311">
<h3>Improvements<a class="headerlink" href="#id311" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10218">#10218</a>: <code class="docutils literal notranslate"><span class="pre">&#64;pytest.mark.parametrize()</span></code> (and similar functions) now accepts any <code class="docutils literal notranslate"><span class="pre">Sequence[str]</span></code> for the argument names,
instead of just <code class="docutils literal notranslate"><span class="pre">list[str]</span></code> and <code class="docutils literal notranslate"><span class="pre">tuple[str,</span> <span class="pre">...]</span></code>.</p>
<p>(Note that <code class="docutils literal notranslate"><span class="pre">str</span></code>, which is itself a <code class="docutils literal notranslate"><span class="pre">Sequence[str]</span></code>, is still treated as a
comma-delimited name list, as before).</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10381">#10381</a>: The <code class="docutils literal notranslate"><span class="pre">--no-showlocals</span></code> flag has been added. This can be passed directly to tests to override <code class="docutils literal notranslate"><span class="pre">--showlocals</span></code> declared through <code class="docutils literal notranslate"><span class="pre">addopts</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3426">#3426</a>: Assertion failures with strings in NFC and NFD forms that normalize to the same string now have a dedicated error message detailing the issue, and their utf-8 representation is expressed instead.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8508">#8508</a>: Introduce multiline display for warning matching  via <a class="reference internal" href="reference/reference.html#pytest.warns" title="pytest.warns"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.warns()</span></code></a> and
enhance match comparison for <a class="reference internal" href="reference/reference.html#pytest.ExceptionInfo.match" title="pytest.ExceptionInfo.match"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.ExceptionInfo.match()</span></code></a> as returned by <a class="reference internal" href="reference/reference.html#pytest.raises" title="pytest.raises"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.raises()</span></code></a>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8646">#8646</a>: Improve <a class="reference internal" href="reference/reference.html#pytest.raises" title="pytest.raises"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.raises()</span></code></a>. Previously passing an empty tuple would give a confusing
error. We now raise immediately with a more helpful message.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9741">#9741</a>: On Python 3.11, use the standard library’s <a class="reference external" href="https://docs.python.org/3/library/tomllib.html#module-tomllib" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tomllib</span></code></a> to parse TOML.</p>
<p><code class="docutils literal notranslate"><span class="pre">tomli</span></code> is no longer a dependency on Python 3.11.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9742">#9742</a>: Display assertion message without escaped newline characters with <code class="docutils literal notranslate"><span class="pre">-vv</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9823">#9823</a>: Improved error message that is shown when no collector is found for a given file.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9873">#9873</a>: Some coloring has been added to the short test summary.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9883">#9883</a>: Normalize the help description of all command-line options.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9920">#9920</a>: Display full crash messages in <code class="docutils literal notranslate"><span class="pre">short</span> <span class="pre">test</span> <span class="pre">summary</span> <span class="pre">info</span></code>, when running in a CI environment.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9987">#9987</a>: Added support for hidden configuration file by allowing <code class="docutils literal notranslate"><span class="pre">.pytest.ini</span></code> as an alternative to <code class="docutils literal notranslate"><span class="pre">pytest.ini</span></code>.</p></li>
</ul>
</section>
<section id="id324">
<h3>Bug Fixes<a class="headerlink" href="#id324" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10150">#10150</a>: <a class="reference external" href="https://docs.python.org/3/library/sys.html#sys.stdin" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.stdin</span></code></a> now contains all expected methods of a file-like object when capture is enabled.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10382">#10382</a>: Do not break into pdb when <code class="docutils literal notranslate"><span class="pre">raise</span> <span class="pre">unittest.SkipTest()</span></code> appears top-level in a file.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7792">#7792</a>: Marks are now inherited according to the full MRO in test classes. Previously, if a test class inherited from two or more classes, only marks from the first super-class would apply.</p>
<p>When inheriting marks from super-classes, marks from the sub-classes are now ordered before marks from the super-classes, in MRO order. Previously it was the reverse.</p>
<p>When inheriting marks from super-classes, the <code class="docutils literal notranslate"><span class="pre">pytestmark</span></code> attribute of the sub-class now only contains the marks directly applied to it. Previously, it also contained marks from its super-classes. Please note that this attribute should not normally be accessed directly; use <a class="reference internal" href="reference/reference.html#pytest.nodes.Node.iter_markers" title="_pytest.nodes.Node.iter_markers"><code class="xref py py-func docutils literal notranslate"><span class="pre">Node.iter_markers</span></code></a> instead.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9159">#9159</a>: Showing inner exceptions by forcing native display in <code class="docutils literal notranslate"><span class="pre">ExceptionGroups</span></code> even when using display options other than <code class="docutils literal notranslate"><span class="pre">--tb=native</span></code>. A temporary step before full implementation of pytest-native display for inner exceptions in <code class="docutils literal notranslate"><span class="pre">ExceptionGroups</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9877">#9877</a>: Ensure <code class="docutils literal notranslate"><span class="pre">caplog.get_records(when)</span></code> returns current/correct data after invoking <code class="docutils literal notranslate"><span class="pre">caplog.clear()</span></code>.</p></li>
</ul>
</section>
<section id="id330">
<h3>Improved Documentation<a class="headerlink" href="#id330" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10344">#10344</a>: Update information on writing plugins to use <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> instead of <code class="docutils literal notranslate"><span class="pre">setup.py</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9248">#9248</a>: The documentation is now built using Sphinx 5.x (up from 3.x previously).</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9291">#9291</a>: Update documentation on how <a class="reference internal" href="reference/reference.html#pytest.warns" title="pytest.warns"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.warns()</span></code></a> affects <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#DeprecationWarning" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeprecationWarning</span></code></a>.</p></li>
</ul>
</section>
<section id="id334">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id334" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10313">#10313</a>: Made <code class="docutils literal notranslate"><span class="pre">_pytest.doctest.DoctestItem</span></code> export <code class="docutils literal notranslate"><span class="pre">pytest.DoctestItem</span></code> for
type check and runtime purposes. Made <code class="docutils literal notranslate"><span class="pre">_pytest.doctest</span></code> use internal APIs
to avoid circular imports.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9906">#9906</a>: Made <code class="docutils literal notranslate"><span class="pre">_pytest.compat</span></code> re-export <code class="docutils literal notranslate"><span class="pre">importlib_metadata</span></code> in the eyes of type checkers.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9910">#9910</a>: Fix default encoding warning (<code class="docutils literal notranslate"><span class="pre">EncodingWarning</span></code>) in <code class="docutils literal notranslate"><span class="pre">cacheprovider</span></code></p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9984">#9984</a>: Improve the error message when we attempt to access a fixture that has been
torn down.
Add an additional sentence to the docstring explaining when it’s not a good
idea to call <code class="docutils literal notranslate"><span class="pre">getfixturevalue</span></code>.</p></li>
</ul>
</section>
</section>
<section id="pytest-7-1-3-2022-08-31">
<h2>pytest 7.1.3 (2022-08-31)<a class="headerlink" href="#pytest-7-1-3-2022-08-31" title="Link to this heading">¶</a></h2>
<section id="id339">
<h3>Bug Fixes<a class="headerlink" href="#id339" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10060">#10060</a>: When running with <code class="docutils literal notranslate"><span class="pre">--pdb</span></code>, <code class="docutils literal notranslate"><span class="pre">TestCase.tearDown</span></code> is no longer called for tests when the <em>class</em> has been skipped via <code class="docutils literal notranslate"><span class="pre">unittest.skip</span></code> or <code class="docutils literal notranslate"><span class="pre">pytest.mark.skip</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10190">#10190</a>: Invalid XML characters in setup or teardown error messages are now properly escaped for JUnit XML reports.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10230">#10230</a>: Ignore <code class="docutils literal notranslate"><span class="pre">.py</span></code> files created by <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code>-based editable builds introduced in <a class="reference external" href="https://pip.pypa.io/en/stable/news/#v21-3">pip 21.3</a>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3396">#3396</a>: Doctests now respect the <code class="docutils literal notranslate"><span class="pre">--import-mode</span></code> flag.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9514">#9514</a>: Type-annotate <code class="docutils literal notranslate"><span class="pre">FixtureRequest.param</span></code> as <code class="docutils literal notranslate"><span class="pre">Any</span></code> as a stop gap measure until <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8073">#8073</a> is fixed.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9791">#9791</a>: Fixed a path handling code in <code class="docutils literal notranslate"><span class="pre">rewrite.py</span></code> that seems to work fine, but was incorrect and fails in some systems.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9917">#9917</a>: Fixed string representation for <a class="reference internal" href="reference/reference.html#pytest.approx" title="pytest.approx"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.approx()</span></code></a> when used to compare tuples.</p></li>
</ul>
</section>
<section id="id347">
<h3>Improved Documentation<a class="headerlink" href="#id347" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9937">#9937</a>: Explicit note that <a class="reference internal" href="reference/reference.html#std-fixture-tmpdir"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">tmpdir</span></code></a> fixture is discouraged in favour of <a class="reference internal" href="reference/reference.html#std:fixture-3"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">tmp_path</span></code></a>.</p></li>
</ul>
</section>
<section id="id349">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id349" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/10114">#10114</a>: Replace <a class="reference external" href="https://github.com/untitaker/python-atomicwrites">atomicwrites</a> dependency on windows with <code class="docutils literal notranslate"><span class="pre">os.replace</span></code>.</p></li>
</ul>
</section>
</section>
<section id="pytest-7-1-2-2022-04-23">
<h2>pytest 7.1.2 (2022-04-23)<a class="headerlink" href="#pytest-7-1-2-2022-04-23" title="Link to this heading">¶</a></h2>
<section id="id351">
<h3>Bug Fixes<a class="headerlink" href="#id351" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9726">#9726</a>: An unnecessary <code class="docutils literal notranslate"><span class="pre">numpy</span></code> import inside <a class="reference internal" href="reference/reference.html#pytest.approx" title="pytest.approx"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.approx()</span></code></a> was removed.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9820">#9820</a>: Fix comparison of  <code class="docutils literal notranslate"><span class="pre">dataclasses</span></code> with <code class="docutils literal notranslate"><span class="pre">InitVar</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9869">#9869</a>: Increase <code class="docutils literal notranslate"><span class="pre">stacklevel</span></code> for the <code class="docutils literal notranslate"><span class="pre">NODE_CTOR_FSPATH_ARG</span></code> deprecation to point to the
user’s code, not pytest.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9871">#9871</a>: Fix a bizarre (and fortunately rare) bug where the <code class="docutils literal notranslate"><span class="pre">temp_path</span></code> fixture could raise
an internal error while attempting to get the current user’s username.</p></li>
</ul>
</section>
</section>
<section id="pytest-7-1-1-2022-03-17">
<h2>pytest 7.1.1 (2022-03-17)<a class="headerlink" href="#pytest-7-1-1-2022-03-17" title="Link to this heading">¶</a></h2>
<section id="id356">
<h3>Bug Fixes<a class="headerlink" href="#id356" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9767">#9767</a>: Fixed a regression in pytest 7.1.0 where some conftest.py files outside of the source tree (e.g. in the <code class="docutils literal notranslate"><span class="pre">site-packages</span></code> directory) were not picked up.</p></li>
</ul>
</section>
</section>
<section id="pytest-7-1-0-2022-03-13">
<h2>pytest 7.1.0 (2022-03-13)<a class="headerlink" href="#pytest-7-1-0-2022-03-13" title="Link to this heading">¶</a></h2>
<section id="id358">
<h3>Breaking Changes<a class="headerlink" href="#id358" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8838">#8838</a>: As per our policy, the following features have been deprecated in the 6.X series and are now
removed:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pytest._fillfuncargs</span></code> function.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest_warning_captured</span></code> hook - use <code class="docutils literal notranslate"><span class="pre">pytest_warning_recorded</span></code> instead.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-k</span> <span class="pre">-foobar</span></code> syntax - use <code class="docutils literal notranslate"><span class="pre">-k</span> <span class="pre">'not</span> <span class="pre">foobar'</span></code> instead.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-k</span> <span class="pre">foobar:</span></code> syntax.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.collect</span></code> module - import from <code class="docutils literal notranslate"><span class="pre">pytest</span></code> directly.</p></li>
</ul>
<p>For more information consult
<a class="reference external" href="https://docs.pytest.org/en/latest/deprecations.html">Deprecations and Removals</a> in the docs.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9437">#9437</a>: Dropped support for Python 3.6, which reached <a class="reference external" href="https://devguide.python.org/#status-of-python-branches">end-of-life</a> at 2021-12-23.</p></li>
</ul>
</section>
<section id="id361">
<h3>Improvements<a class="headerlink" href="#id361" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5192">#5192</a>: Fixed test output for some data types where <code class="docutils literal notranslate"><span class="pre">-v</span></code> would show less information.</p>
<p>Also, when showing diffs for sequences, <code class="docutils literal notranslate"><span class="pre">-q</span></code> would produce full diffs instead of the expected diff.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9362">#9362</a>: pytest now avoids specialized assert formatting when it is detected that the default <code class="docutils literal notranslate"><span class="pre">__eq__</span></code> is overridden in <code class="docutils literal notranslate"><span class="pre">attrs</span></code> or <code class="docutils literal notranslate"><span class="pre">dataclasses</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9536">#9536</a>: When <code class="docutils literal notranslate"><span class="pre">-vv</span></code> is given on command line, show skipping and xfail reasons in full instead of truncating them to fit the terminal width.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9644">#9644</a>: More information about the location of resources that led Python to raise <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ResourceWarning" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceWarning</span></code></a> can now
be obtained by enabling <a class="reference external" href="https://docs.python.org/3/library/tracemalloc.html#module-tracemalloc" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tracemalloc</span></code></a>.</p>
<p>See <a class="reference internal" href="how-to/capture-warnings.html#resource-warnings"><span class="std std-ref">资源警告</span></a> for more information.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9678">#9678</a>: More types are now accepted in the <code class="docutils literal notranslate"><span class="pre">ids</span></code> argument to <code class="docutils literal notranslate"><span class="pre">&#64;pytest.mark.parametrize</span></code>.
Previously only <code class="docutils literal notranslate"><span class="pre">str</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, <code class="docutils literal notranslate"><span class="pre">int</span></code> and <code class="docutils literal notranslate"><span class="pre">bool</span></code> were accepted;
now <code class="docutils literal notranslate"><span class="pre">bytes</span></code>, <code class="docutils literal notranslate"><span class="pre">complex</span></code>, <code class="docutils literal notranslate"><span class="pre">re.Pattern</span></code>, <code class="docutils literal notranslate"><span class="pre">Enum</span></code> and anything with a <code class="docutils literal notranslate"><span class="pre">__name__</span></code> are also accepted.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9692">#9692</a>: <a class="reference internal" href="reference/reference.html#pytest.approx" title="pytest.approx"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.approx()</span></code></a> now raises a <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeError</span></code></a> when given an unordered sequence (such as <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">set</span></code></a>).</p>
<p>Note that this implies that custom classes which only implement <code class="docutils literal notranslate"><span class="pre">__iter__</span></code> and <code class="docutils literal notranslate"><span class="pre">__len__</span></code> are no longer supported as they don’t guarantee order.</p>
</li>
</ul>
</section>
<section id="id368">
<h3>Bug Fixes<a class="headerlink" href="#id368" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8242">#8242</a>: The deprecation of raising <a class="reference external" href="https://docs.python.org/3/library/unittest.html#unittest.SkipTest" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.SkipTest</span></code></a> to skip collection of
tests during the pytest collection phase is reverted - this is now a supported
feature again.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9493">#9493</a>: Symbolic link components are no longer resolved in conftest paths.
This means that if a conftest appears twice in collection tree, using symlinks, it will be executed twice.
For example, given</p>
<blockquote>
<div><p>tests/real/conftest.py
tests/real/test_it.py
tests/link -&gt; tests/real</p>
</div></blockquote>
<p>running <code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">tests</span></code> now imports the conftest twice, once as <code class="docutils literal notranslate"><span class="pre">tests/real/conftest.py</span></code> and once as <code class="docutils literal notranslate"><span class="pre">tests/link/conftest.py</span></code>.
This is a fix to match a similar change made to test collection itself in pytest 6.0 (see <a class="reference external" href="https://github.com/pytest-dev/pytest/pull/6523">#6523</a> for details).</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9626">#9626</a>: Fixed count of selected tests on terminal collection summary when there were errors or skipped modules.</p>
<p>If there were errors or skipped modules on collection, pytest would mistakenly subtract those from the selected count.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9645">#9645</a>: Fixed regression where <code class="docutils literal notranslate"><span class="pre">--import-mode=importlib</span></code> used together with <span class="target" id="index-2"></span><a class="reference external" href="https://docs.python.org/3/using/cmdline.html#envvar-PYTHONPATH" title="(in Python v3.13)"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHONPATH</span></code></a> or <a class="reference internal" href="reference/reference.html#confval-33"><code class="xref std std-confval docutils literal notranslate"><span class="pre">pythonpath</span></code></a> would cause import errors in test suites.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9708">#9708</a>: <a class="reference internal" href="reference/reference.html#std-fixture-pytester"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">pytester</span></code></a> now requests a <a class="reference internal" href="reference/reference.html#std-fixture-monkeypatch"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">monkeypatch</span></code></a> fixture instead of creating one internally. This solves some issues with tests that involve pytest environment variables.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9730">#9730</a>: Malformed <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> files now produce a clearer error message.</p></li>
</ul>
</section>
</section>
<section id="pytest-7-0-1-2022-02-11">
<h2>pytest 7.0.1 (2022-02-11)<a class="headerlink" href="#pytest-7-0-1-2022-02-11" title="Link to this heading">¶</a></h2>
<section id="id375">
<h3>Bug Fixes<a class="headerlink" href="#id375" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9608">#9608</a>: Fix invalid importing of <code class="docutils literal notranslate"><span class="pre">importlib.readers</span></code> in Python 3.9.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9610">#9610</a>: Restore <code class="docutils literal notranslate"><span class="pre">UnitTestFunction.obj</span></code> to return unbound rather than bound method.
Fixes a crash during a failed teardown in unittest TestCases with non-default <code class="docutils literal notranslate"><span class="pre">__init__</span></code>.
Regressed in pytest 7.0.0.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9636">#9636</a>: The <code class="docutils literal notranslate"><span class="pre">pythonpath</span></code> plugin was renamed to <code class="docutils literal notranslate"><span class="pre">python_path</span></code>. This avoids a conflict with the <code class="docutils literal notranslate"><span class="pre">pytest-pythonpath</span></code> plugin.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9642">#9642</a>: Fix running tests by id with <code class="docutils literal notranslate"><span class="pre">::</span></code> in the parametrize portion.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9643">#9643</a>: Delay issuing a <a class="reference internal" href="reference/reference.html#pytest.PytestWarning" title="pytest.PytestWarning"><code class="xref py py-class docutils literal notranslate"><span class="pre">PytestWarning</span></code></a> about diamond inheritance involving <a class="reference internal" href="reference/reference.html#pytest.Item" title="pytest.Item"><code class="xref py py-class docutils literal notranslate"><span class="pre">Item</span></code></a> and
<a class="reference internal" href="reference/reference.html#pytest.Collector" title="pytest.Collector"><code class="xref py py-class docutils literal notranslate"><span class="pre">Collector</span></code></a> so it can be filtered using <a class="reference internal" href="how-to/capture-warnings.html#warnings"><span class="std std-ref">standard warning filters</span></a>.</p></li>
</ul>
</section>
</section>
<section id="pytest-7-0-0-2022-02-03">
<h2>pytest 7.0.0 (2022-02-03)<a class="headerlink" href="#pytest-7-0-0-2022-02-03" title="Link to this heading">¶</a></h2>
<p>(<strong>Please see the full set of changes for this release also in the 7.0.0rc1 notes below</strong>)</p>
<section id="id381">
<h3>Deprecations<a class="headerlink" href="#id381" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9488">#9488</a>: If custom subclasses of nodes like <a class="reference internal" href="reference/reference.html#pytest.Item" title="pytest.Item"><code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.Item</span></code></a> override the
<code class="docutils literal notranslate"><span class="pre">__init__</span></code> method, they should take <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>. See
<a class="reference internal" href="deprecations.html#uncooperative-constructors-deprecated"><span class="std std-ref">Constructors of custom Node subclasses should take **kwargs</span></a> for details.</p>
<p>Note that a deprecation warning is only emitted when there is a conflict in the
arguments pytest expected to pass. This deprecation was already part of pytest
7.0.0rc1 but wasn’t documented.</p>
</li>
</ul>
</section>
<section id="id383">
<h3>Bug Fixes<a class="headerlink" href="#id383" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9355">#9355</a>: Fixed error message prints function decorators when using assert in Python 3.8 and above.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9396">#9396</a>: Ensure <code class="docutils literal notranslate"><span class="pre">pytest.Config.inifile</span></code> is available during the <a class="reference internal" href="reference/reference.html#std:hook-2"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_cmdline_main</span></code></a> hook (regression during <code class="docutils literal notranslate"><span class="pre">7.0.0rc1</span></code>).</p></li>
</ul>
</section>
<section id="id386">
<h3>Improved Documentation<a class="headerlink" href="#id386" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9404">#9404</a>: Added extra documentation on alternatives to common misuses of <code class="docutils literal notranslate"><span class="pre">pytest.warns(None)</span></code> ahead of its deprecation.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9505">#9505</a>: Clarify where the configuration files are located. To avoid confusions documentation mentions
that configuration file is located in the root of the repository.</p></li>
</ul>
</section>
<section id="id389">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id389" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9521">#9521</a>: Add test coverage to assertion rewrite path.</p></li>
</ul>
</section>
</section>
<section id="pytest-7-0-0rc1-2021-12-06">
<h2>pytest 7.0.0rc1 (2021-12-06)<a class="headerlink" href="#pytest-7-0-0rc1-2021-12-06" title="Link to this heading">¶</a></h2>
<section id="id391">
<h3>Breaking Changes<a class="headerlink" href="#id391" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7259">#7259</a>: The <a class="reference internal" href="example/nonpython.html#non-python-tests"><span class="std std-ref">Node.reportinfo()</span></a> function first return value type has been expanded from <code class="docutils literal notranslate"><span class="pre">py.path.local</span> <span class="pre">|</span> <span class="pre">str</span></code> to <code class="docutils literal notranslate"><span class="pre">os.PathLike[str]</span> <span class="pre">|</span> <span class="pre">str</span></code>.</p>
<p>Most plugins which refer to <code class="docutils literal notranslate"><span class="pre">reportinfo()</span></code> only define it as part of a custom <a class="reference internal" href="reference/reference.html#pytest.Item" title="pytest.Item"><code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.Item</span></code></a> implementation.
Since <code class="docutils literal notranslate"><span class="pre">py.path.local</span></code> is an <code class="docutils literal notranslate"><span class="pre">os.PathLike[str]</span></code>, these plugins are unaffected.</p>
<p>Plugins and users which call <code class="docutils literal notranslate"><span class="pre">reportinfo()</span></code>, use the first return value and interact with it as a <code class="docutils literal notranslate"><span class="pre">py.path.local</span></code>, would need to adjust by calling <code class="docutils literal notranslate"><span class="pre">py.path.local(fspath)</span></code>.
Although preferably, avoid the legacy <code class="docutils literal notranslate"><span class="pre">py.path.local</span></code> and use <code class="docutils literal notranslate"><span class="pre">pathlib.Path</span></code>, or use <code class="docutils literal notranslate"><span class="pre">item.location</span></code> or <code class="docutils literal notranslate"><span class="pre">item.path</span></code>, instead.</p>
<p>Note: pytest was not able to provide a deprecation period for this change.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8246">#8246</a>: <code class="docutils literal notranslate"><span class="pre">--version</span></code> now writes version information to <code class="docutils literal notranslate"><span class="pre">stdout</span></code> rather than <code class="docutils literal notranslate"><span class="pre">stderr</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8733">#8733</a>: Drop a workaround for <a class="reference external" href="https://github.com/pyreadline/pyreadline">pyreadline</a> that made it work with <code class="docutils literal notranslate"><span class="pre">--pdb</span></code>.</p>
<p>The workaround was introduced in <a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1281">#1281</a> in 2015, however since then
<a class="reference external" href="https://github.com/pyreadline/pyreadline/issues/58">pyreadline seems to have gone unmaintained</a>, is <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8847">generating
warnings</a>, and will stop working on Python 3.10.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9061">#9061</a>: Using <a class="reference internal" href="reference/reference.html#pytest.approx" title="pytest.approx"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.approx()</span></code></a> in a boolean context now raises an error hinting at the proper usage.</p>
<p>It is apparently common for users to mistakenly use <code class="docutils literal notranslate"><span class="pre">pytest.approx</span></code> like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="n">pytest</span><span class="o">.</span><span class="n">approx</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>
</pre></div>
</div>
<p>While the correct usage is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="n">actual</span> <span class="o">==</span> <span class="n">pytest</span><span class="o">.</span><span class="n">approx</span><span class="p">(</span><span class="n">expected</span><span class="p">)</span>
</pre></div>
</div>
<p>The new error message helps catch those mistakes.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9277">#9277</a>: The <code class="docutils literal notranslate"><span class="pre">pytest.Instance</span></code> collector type has been removed.
Importing <code class="docutils literal notranslate"><span class="pre">pytest.Instance</span></code> or <code class="docutils literal notranslate"><span class="pre">_pytest.python.Instance</span></code> returns a dummy type and emits a deprecation warning.
See <a class="reference internal" href="deprecations.html#instance-collector-deprecation"><span class="std std-ref">The pytest.Instance collector</span></a> for details.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9308">#9308</a>: <strong>PytestRemovedIn7Warning deprecation warnings are now errors by default.</strong></p>
<p>Following our plan to remove deprecated features with as little disruption as
possible, all warnings of type <code class="docutils literal notranslate"><span class="pre">PytestRemovedIn7Warning</span></code> now generate errors
instead of warning messages by default.</p>
<p><strong>The affected features will be effectively removed in pytest 7.1</strong>, so please consult the
<a class="reference internal" href="deprecations.html#deprecations"><span class="std std-ref">Deprecations and Removals</span></a> section in the docs for directions on how to update existing code.</p>
<p>In the pytest <code class="docutils literal notranslate"><span class="pre">7.0.X</span></code> series, it is possible to change the errors back into warnings as a
stopgap measure by adding this to your <code class="docutils literal notranslate"><span class="pre">pytest.ini</span></code> file:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[pytest]</span>
<span class="na">filterwarnings</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="na">ignore</span><span class="o">:</span><span class="s">:pytest.PytestRemovedIn7Warning</span>
</pre></div>
</div>
<p>But this will stop working when pytest <code class="docutils literal notranslate"><span class="pre">7.1</span></code> is released.</p>
<p><strong>If you have concerns</strong> about the removal of a specific feature, please add a
comment to <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9308">#9308</a>.</p>
</li>
</ul>
</section>
<section id="id398">
<h3>Deprecations<a class="headerlink" href="#id398" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7259">#7259</a>: <code class="docutils literal notranslate"><span class="pre">py.path.local</span></code> arguments for hooks have been deprecated. See <a class="reference internal" href="deprecations.html#legacy-path-hooks-deprecated"><span class="std std-ref">the deprecation note</span></a> for full details.</p>
<p><code class="docutils literal notranslate"><span class="pre">py.path.local</span></code> arguments to Node constructors have been deprecated. See <a class="reference internal" href="deprecations.html#node-ctor-fspath-deprecation"><span class="std std-ref">the deprecation note</span></a> for full details.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The name of the <a class="reference internal" href="reference/reference.html#pytest.nodes.Node" title="_pytest.nodes.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> arguments and attributes (the
new attribute being <code class="docutils literal notranslate"><span class="pre">path</span></code>) is <strong>the opposite</strong> of the situation for hooks
(the old argument being <code class="docutils literal notranslate"><span class="pre">path</span></code>).</p>
<p>This is an unfortunate artifact due to historical reasons, which should be
resolved in future versions as we slowly get rid of the <a class="reference external" href="https://pypi.org/project/py">py</a>
dependency (see <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9283">#9283</a> for a longer discussion).</p>
</div>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7469">#7469</a>: Directly constructing the following classes is now deprecated:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">_pytest.mark.structures.Mark</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_pytest.mark.structures.MarkDecorator</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_pytest.mark.structures.MarkGenerator</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_pytest.python.Metafunc</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_pytest.runner.CallInfo</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_pytest._code.ExceptionInfo</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_pytest.config.argparsing.Parser</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_pytest.config.argparsing.OptionGroup</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_pytest.pytester.HookRecorder</span></code></p></li>
</ul>
<p>These constructors have always been considered private, but now issue a deprecation warning, which may become a hard error in pytest 8.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8242">#8242</a>: Raising <a class="reference external" href="https://docs.python.org/3/library/unittest.html#unittest.SkipTest" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.SkipTest</span></code></a> to skip collection of tests during the
pytest collection phase is deprecated. Use <a class="reference internal" href="reference/reference.html#pytest.skip" title="pytest.skip"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.skip()</span></code></a> instead.</p>
<p>Note: This deprecation only relates to using <a class="reference external" href="https://docs.python.org/3/library/unittest.html#unittest.SkipTest" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.SkipTest</span></code></a> during test
collection. You are probably not doing that. Ordinary usage of
<a class="reference external" href="https://docs.python.org/3/library/unittest.html#unittest.SkipTest" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.SkipTest</span></code></a> / <a class="reference external" href="https://docs.python.org/3/library/unittest.html#unittest.TestCase.skipTest" title="(in Python v3.13)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">unittest.TestCase.skipTest()</span></code></a> /
<a class="reference external" href="https://docs.python.org/3/library/unittest.html#unittest.skip" title="(in Python v3.13)"><code class="xref py py-func docutils literal notranslate"><span class="pre">unittest.skip()</span></code></a> in unittest test cases is fully supported.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This deprecation has been reverted in pytest 7.1.0.</p>
</div>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8315">#8315</a>: Several behaviors of <a class="reference internal" href="reference/reference.html#pytest.Parser.addoption" title="pytest.Parser.addoption"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Parser.addoption</span></code></a> are now
scheduled for removal in pytest 8 (deprecated since pytest 2.4.0):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">parser.addoption(...,</span> <span class="pre">help=&quot;..</span> <span class="pre">%default</span> <span class="pre">..&quot;)</span></code> - use <code class="docutils literal notranslate"><span class="pre">%(default)s</span></code> instead.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parser.addoption(...,</span> <span class="pre">type=&quot;int/string/float/complex&quot;)</span></code> - use <code class="docutils literal notranslate"><span class="pre">type=int</span></code> etc. instead.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8447">#8447</a>: Defining a custom pytest node type which is both an <a class="reference internal" href="reference/reference.html#pytest.Item" title="pytest.Item"><code class="xref py py-class docutils literal notranslate"><span class="pre">Item</span></code></a> and a <a class="reference internal" href="reference/reference.html#pytest.Collector" title="pytest.Collector"><code class="xref py py-class docutils literal notranslate"><span class="pre">Collector</span></code></a> (e.g. <a class="reference internal" href="reference/reference.html#pytest.File" title="pytest.File"><code class="xref py py-class docutils literal notranslate"><span class="pre">File</span></code></a>) now issues a warning.
It was never sanely supported and triggers hard to debug errors.</p>
<p>See <a class="reference internal" href="deprecations.html#diamond-inheritance-deprecated"><span class="std std-ref">the deprecation note</span></a> for full details.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8592">#8592</a>: <code class="docutils literal notranslate"><span class="pre">pytest_cmdline_preparse</span></code> has been officially deprecated.  It will be removed in a future release.  Use <a class="reference internal" href="reference/reference.html#std:hook-0"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_load_initial_conftests</span></code></a> instead.</p>
<p>See <a class="reference internal" href="deprecations.html#cmdline-preparse-deprecated"><span class="std std-ref">the deprecation note</span></a> for full details.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8645">#8645</a>: <a class="reference internal" href="reference/reference.html#pytest.warns" title="pytest.warns"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.warns(None)</span></code></a> is now deprecated because many people used
it to mean “this code does not emit warnings”, but it actually had the effect of
checking that the code emits at least one warning of any type - like <code class="docutils literal notranslate"><span class="pre">pytest.warns()</span></code>
or <code class="docutils literal notranslate"><span class="pre">pytest.warns(Warning)</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8948">#8948</a>: <a class="reference internal" href="reference/reference.html#pytest.skip" title="pytest.skip"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.skip(msg=...)</span></code></a>, <a class="reference internal" href="reference/reference.html#pytest.fail" title="pytest.fail"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.fail(msg=...)</span></code></a> and <a class="reference internal" href="reference/reference.html#pytest.exit" title="pytest.exit"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.exit(msg=...)</span></code></a>
signatures now accept a <code class="docutils literal notranslate"><span class="pre">reason</span></code> argument instead of <code class="docutils literal notranslate"><span class="pre">msg</span></code>.  Using <code class="docutils literal notranslate"><span class="pre">msg</span></code> still works, but is deprecated and will be removed in a future release.</p>
<p>This was changed for consistency with <a class="reference internal" href="reference/reference.html#id5" title="pytest.mark.skip"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.mark.skip</span></code></a> and  <a class="reference internal" href="reference/reference.html#id8" title="pytest.mark.xfail"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.mark.xfail</span></code></a> which both accept
<code class="docutils literal notranslate"><span class="pre">reason</span></code> as an argument.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8174">#8174</a>: The following changes have been made to types reachable through <a class="reference internal" href="reference/reference.html#pytest.ExceptionInfo.traceback" title="pytest.ExceptionInfo.traceback"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pytest.ExceptionInfo.traceback</span></code></a>:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">path</span></code> property of <code class="docutils literal notranslate"><span class="pre">_pytest.code.Code</span></code> returns <code class="docutils literal notranslate"><span class="pre">Path</span></code> instead of <code class="docutils literal notranslate"><span class="pre">py.path.local</span></code>.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">path</span></code> property of <code class="docutils literal notranslate"><span class="pre">_pytest.code.TracebackEntry</span></code> returns <code class="docutils literal notranslate"><span class="pre">Path</span></code> instead of <code class="docutils literal notranslate"><span class="pre">py.path.local</span></code>.</p></li>
</ul>
<p>There was no deprecation period for this change (sorry!).</p>
</li>
</ul>
</section>
<section id="id408">
<h3>Features<a class="headerlink" href="#id408" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5196">#5196</a>: Tests are now ordered by definition order in more cases.</p>
<p>In a class hierarchy, tests from base classes are now consistently ordered before tests defined on their subclasses (reverse MRO order).</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7132">#7132</a>: Added two environment variables <span class="target" id="index-3"></span><a class="reference internal" href="reference/reference.html#envvar-8"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTEST_THEME</span></code></a> and <span class="target" id="index-4"></span><a class="reference internal" href="reference/reference.html#envvar-9"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTEST_THEME_MODE</span></code></a> to let the users customize the pygments theme used.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7259">#7259</a>: Added <code class="xref py py-meth docutils literal notranslate"><span class="pre">cache.mkdir()</span></code>, which is similar to the existing <code class="docutils literal notranslate"><span class="pre">cache.makedir()</span></code>,
but returns a <a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pathlib.Path</span></code></a> instead of a legacy <code class="docutils literal notranslate"><span class="pre">py.path.local</span></code>.</p>
<p>Added a <code class="docutils literal notranslate"><span class="pre">paths</span></code> type to <a class="reference internal" href="reference/reference.html#pytest.Parser.addini" title="pytest.Parser.addini"><code class="xref py py-meth docutils literal notranslate"><span class="pre">parser.addini()</span></code></a>,
as in <code class="docutils literal notranslate"><span class="pre">parser.addini(&quot;mypaths&quot;,</span> <span class="pre">&quot;my</span> <span class="pre">paths&quot;,</span> <span class="pre">type=&quot;paths&quot;)</span></code>,
which is similar to the existing <code class="docutils literal notranslate"><span class="pre">pathlist</span></code>,
but returns a list of <a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pathlib.Path</span></code></a> instead of legacy <code class="docutils literal notranslate"><span class="pre">py.path.local</span></code>.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7469">#7469</a>: The types of objects used in pytest’s API are now exported so they may be used in type annotations.</p>
<p>The newly-exported types are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.Config</span></code> for <a class="reference internal" href="reference/reference.html#pytest.Config" title="pytest.Config"><code class="xref py py-class docutils literal notranslate"><span class="pre">Config</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.Mark</span></code> for <a class="reference internal" href="reference/reference.html#pytest.Mark" title="pytest.Mark"><code class="xref py py-class docutils literal notranslate"><span class="pre">marks</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.MarkDecorator</span></code> for <a class="reference internal" href="reference/reference.html#pytest.MarkDecorator" title="pytest.MarkDecorator"><code class="xref py py-class docutils literal notranslate"><span class="pre">mark</span> <span class="pre">decorators</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.MarkGenerator</span></code> for the <a class="reference internal" href="reference/reference.html#pytest.MarkGenerator" title="pytest.MarkGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.mark</span></code></a> singleton.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.Metafunc</span></code> for the <a class="reference internal" href="reference/reference.html#pytest.MarkGenerator" title="pytest.MarkGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">metafunc</span></code></a> argument to the <a class="reference internal" href="reference/reference.html#std:hook-16"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_generate_tests</span></code></a> hook.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.CallInfo</span></code> for the <a class="reference internal" href="reference/reference.html#pytest.CallInfo" title="pytest.CallInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">CallInfo</span></code></a> type passed to various hooks.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.PytestPluginManager</span></code> for <a class="reference internal" href="reference/reference.html#pytest.PytestPluginManager" title="pytest.PytestPluginManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">PytestPluginManager</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.ExceptionInfo</span></code> for the <a class="reference internal" href="reference/reference.html#pytest.ExceptionInfo" title="pytest.ExceptionInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExceptionInfo</span></code></a> type returned from <a class="reference internal" href="reference/reference.html#pytest.raises" title="pytest.raises"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.raises()</span></code></a> and passed to various hooks.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.Parser</span></code> for the <a class="reference internal" href="reference/reference.html#pytest.Parser" title="pytest.Parser"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parser</span></code></a> type passed to the <a class="reference internal" href="reference/reference.html#std:hook-3"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_addoption</span></code></a> hook.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.OptionGroup</span></code> for the <a class="reference internal" href="reference/reference.html#pytest.OptionGroup" title="pytest.OptionGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptionGroup</span></code></a> type returned from the <a class="reference internal" href="reference/reference.html#pytest.Parser.getgroup" title="pytest.Parser.getgroup"><code class="xref py py-func docutils literal notranslate"><span class="pre">parser.addgroup</span></code></a> method.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.HookRecorder</span></code> for the <a class="reference internal" href="reference/reference.html#id70" title="pytest.HookRecorder"><code class="xref py py-class docutils literal notranslate"><span class="pre">HookRecorder</span></code></a> type returned from <a class="reference internal" href="reference/reference.html#id11" title="pytest.Pytester"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pytester</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.RecordedHookCall</span></code> for the <a class="reference internal" href="reference/reference.html#id70" title="pytest.HookRecorder"><code class="xref py py-class docutils literal notranslate"><span class="pre">RecordedHookCall</span></code></a> type returned from <a class="reference internal" href="reference/reference.html#id70" title="pytest.HookRecorder"><code class="xref py py-class docutils literal notranslate"><span class="pre">HookRecorder</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.RunResult</span></code> for the <a class="reference internal" href="reference/reference.html#id50" title="pytest.RunResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">RunResult</span></code></a> type returned from <a class="reference internal" href="reference/reference.html#id11" title="pytest.Pytester"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pytester</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.LineMatcher</span></code> for the <a class="reference internal" href="reference/reference.html#id60" title="pytest.LineMatcher"><code class="xref py py-class docutils literal notranslate"><span class="pre">LineMatcher</span></code></a> type used in <a class="reference internal" href="reference/reference.html#id50" title="pytest.RunResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">RunResult</span></code></a> and others.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.TestReport</span></code> for the <a class="reference internal" href="reference/reference.html#pytest.TestReport" title="pytest.TestReport"><code class="xref py py-class docutils literal notranslate"><span class="pre">TestReport</span></code></a> type used in various hooks.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.CollectReport</span></code> for the <a class="reference internal" href="reference/reference.html#pytest.CollectReport" title="pytest.CollectReport"><code class="xref py py-class docutils literal notranslate"><span class="pre">CollectReport</span></code></a> type used in various hooks.</p></li>
</ul>
<p>Constructing most of them directly is not supported; they are only meant for use in type annotations.
Doing so will emit a deprecation warning, and may become a hard-error in pytest 8.0.</p>
<p>Subclassing them is also not supported. This is not currently enforced at runtime, but is detected by type-checkers such as mypy.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7856">#7856</a>: <a class="reference internal" href="explanation/pythonpath.html#import-modes"><span class="std std-ref">–import-mode=importlib</span></a> now works with features that
depend on modules being on <a class="reference external" href="https://docs.python.org/3/library/sys.html#sys.modules" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.modules</span></code></a>, such as <a class="reference external" href="https://docs.python.org/3/library/pickle.html#module-pickle" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pickle</span></code></a> and <a class="reference external" href="https://docs.python.org/3/library/dataclasses.html#module-dataclasses" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dataclasses</span></code></a>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8144">#8144</a>: The following hooks now receive an additional <code class="docutils literal notranslate"><span class="pre">pathlib.Path</span></code> argument, equivalent to an existing <code class="docutils literal notranslate"><span class="pre">py.path.local</span></code> argument:</p>
<ul class="simple">
<li><p><a class="reference internal" href="reference/reference.html#std:hook-11"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_ignore_collect</span></code></a> - The <code class="docutils literal notranslate"><span class="pre">collection_path</span></code> parameter (equivalent to existing <code class="docutils literal notranslate"><span class="pre">path</span></code> parameter).</p></li>
<li><p><a class="reference internal" href="reference/reference.html#std:hook-13"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_collect_file</span></code></a> - The <code class="docutils literal notranslate"><span class="pre">file_path</span></code> parameter (equivalent to existing <code class="docutils literal notranslate"><span class="pre">path</span></code> parameter).</p></li>
<li><p><a class="reference internal" href="reference/reference.html#std:hook-14"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_pycollect_makemodule</span></code></a> - The <code class="docutils literal notranslate"><span class="pre">module_path</span></code> parameter (equivalent to existing <code class="docutils literal notranslate"><span class="pre">path</span></code> parameter).</p></li>
<li><p><a class="reference internal" href="reference/reference.html#std:hook-33"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_report_header</span></code></a> - The <code class="docutils literal notranslate"><span class="pre">start_path</span></code> parameter (equivalent to existing <code class="docutils literal notranslate"><span class="pre">startdir</span></code> parameter).</p></li>
<li><p><a class="reference internal" href="reference/reference.html#std:hook-34"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_report_collectionfinish</span></code></a> - The <code class="docutils literal notranslate"><span class="pre">start_path</span></code> parameter (equivalent to existing <code class="docutils literal notranslate"><span class="pre">startdir</span></code> parameter).</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The name of the <a class="reference internal" href="reference/reference.html#pytest.nodes.Node" title="_pytest.nodes.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> arguments and attributes (the
new attribute being <code class="docutils literal notranslate"><span class="pre">path</span></code>) is <strong>the opposite</strong> of the situation for hooks
(the old argument being <code class="docutils literal notranslate"><span class="pre">path</span></code>).</p>
<p>This is an unfortunate artifact due to historical reasons, which should be
resolved in future versions as we slowly get rid of the <a class="reference external" href="https://pypi.org/project/py">py</a>
dependency (see <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9283">#9283</a> for a longer discussion).</p>
</div>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8251">#8251</a>: Implement <code class="docutils literal notranslate"><span class="pre">Node.path</span></code> as a <code class="docutils literal notranslate"><span class="pre">pathlib.Path</span></code>. Both the old <code class="docutils literal notranslate"><span class="pre">fspath</span></code> and this new attribute gets set no matter whether <code class="docutils literal notranslate"><span class="pre">path</span></code> or <code class="docutils literal notranslate"><span class="pre">fspath</span></code> (deprecated) is passed to the constructor. It is a replacement for the <code class="docutils literal notranslate"><span class="pre">fspath</span></code> attribute (which represents the same path as <code class="docutils literal notranslate"><span class="pre">py.path.local</span></code>). While <code class="docutils literal notranslate"><span class="pre">fspath</span></code> is not deprecated yet
due to the ongoing migration of methods like <a class="reference internal" href="reference/reference.html#pytest.Item.reportinfo" title="pytest.Item.reportinfo"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reportinfo()</span></code></a>, we expect to deprecate it in a future release.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The name of the <a class="reference internal" href="reference/reference.html#pytest.nodes.Node" title="_pytest.nodes.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> arguments and attributes (the
new attribute being <code class="docutils literal notranslate"><span class="pre">path</span></code>) is <strong>the opposite</strong> of the situation for hooks
(the old argument being <code class="docutils literal notranslate"><span class="pre">path</span></code>).</p>
<p>This is an unfortunate artifact due to historical reasons, which should be
resolved in future versions as we slowly get rid of the <a class="reference external" href="https://pypi.org/project/py">py</a>
dependency (see <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9283">#9283</a> for a longer discussion).</p>
</div>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8421">#8421</a>: <a class="reference internal" href="reference/reference.html#pytest.approx" title="pytest.approx"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.approx()</span></code></a> now works on <a class="reference external" href="https://docs.python.org/3/library/decimal.html#decimal.Decimal" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Decimal</span></code></a> within mappings/dicts and sequences/lists.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8606">#8606</a>: pytest invocations with <code class="docutils literal notranslate"><span class="pre">--fixtures-per-test</span></code> and <code class="docutils literal notranslate"><span class="pre">--fixtures</span></code> have been enriched with:</p>
<ul class="simple">
<li><p>Fixture location path printed with the fixture name.</p></li>
<li><p>First section of the fixture’s docstring printed under the fixture name.</p></li>
<li><p>Whole of fixture’s docstring printed under the fixture name using <code class="docutils literal notranslate"><span class="pre">--verbose</span></code> option.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8761">#8761</a>: New <a class="reference internal" href="reference/reference.html#version-tuple"><span class="std std-ref">pytest.version_tuple</span></a> attribute, which makes it simpler for users to do something depending on the pytest version (such as declaring hooks which are introduced in later versions).</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8789">#8789</a>: Switch TOML parser from <code class="docutils literal notranslate"><span class="pre">toml</span></code> to <code class="docutils literal notranslate"><span class="pre">tomli</span></code> for TOML v1.0.0 support in <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8920">#8920</a>: Added <a class="reference internal" href="reference/reference.html#pytest.Stash" title="pytest.Stash"><code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.Stash</span></code></a>, a facility for plugins to store their data on <a class="reference internal" href="reference/reference.html#pytest.Config" title="pytest.Config"><code class="xref py py-class docutils literal notranslate"><span class="pre">Config</span></code></a> and <a class="reference internal" href="reference/reference.html#pytest.nodes.Node" title="_pytest.nodes.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a>s in a type-safe and conflict-free manner.
See <a class="reference internal" href="how-to/writing_hook_functions.html#plugin-stash"><span class="std std-ref">跨钩子函数存储项目数据</span></a> for details.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8953">#8953</a>: <a class="reference internal" href="reference/reference.html#id50" title="pytest.RunResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">RunResult</span></code></a> method <a class="reference internal" href="reference/reference.html#id59" title="pytest.RunResult.assert_outcomes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assert_outcomes()</span></code></a> now accepts a
<code class="docutils literal notranslate"><span class="pre">warnings</span></code> argument to assert the total number of warnings captured.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8954">#8954</a>: <code class="docutils literal notranslate"><span class="pre">--debug</span></code> flag now accepts a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> file to route debug logs into, remains defaulted to <code class="docutils literal notranslate"><span class="pre">pytestdebug.log</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9023">#9023</a>: Full diffs are now always shown for equality assertions of iterables when
<code class="docutils literal notranslate"><span class="pre">CI</span></code> or <code class="docutils literal notranslate"><span class="pre">BUILD_NUMBER</span></code> is found in the environment, even when <code class="docutils literal notranslate"><span class="pre">-v</span></code> isn’t
used.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9113">#9113</a>: <a class="reference internal" href="reference/reference.html#id50" title="pytest.RunResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">RunResult</span></code></a> method <a class="reference internal" href="reference/reference.html#id59" title="pytest.RunResult.assert_outcomes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assert_outcomes()</span></code></a> now accepts a
<code class="docutils literal notranslate"><span class="pre">deselected</span></code> argument to assert the total number of deselected tests.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9114">#9114</a>: Added <a class="reference internal" href="reference/reference.html#confval-33"><code class="xref std std-confval docutils literal notranslate"><span class="pre">pythonpath</span></code></a> setting that adds listed paths to <a class="reference external" href="https://docs.python.org/3/library/sys.html#sys.path" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.path</span></code></a> for the duration of the test session. If you currently use the pytest-pythonpath or pytest-srcpaths plugins, you should be able to replace them with built-in <code class="docutils literal notranslate"><span class="pre">pythonpath</span></code> setting.</p></li>
</ul>
</section>
<section id="id426">
<h3>Improvements<a class="headerlink" href="#id426" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7480">#7480</a>: A deprecation scheduled to be removed in a major version X (e.g. pytest 7, 8, 9, …) now uses warning category <code class="docutils literal notranslate"><span class="pre">PytestRemovedInXWarning</span></code>,
a subclass of <a class="reference internal" href="reference/reference.html#pytest.PytestDeprecationWarning" title="pytest.PytestDeprecationWarning"><code class="xref py py-class docutils literal notranslate"><span class="pre">PytestDeprecationWarning</span></code></a>,
instead of <a class="reference internal" href="reference/reference.html#pytest.PytestDeprecationWarning" title="pytest.PytestDeprecationWarning"><code class="xref py py-class docutils literal notranslate"><span class="pre">PytestDeprecationWarning</span></code></a> directly.</p>
<p>See <a class="reference internal" href="backwards-compatibility.html#backwards-compatibility"><span class="std std-ref">向后兼容政策</span></a> for more details.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7864">#7864</a>: Improved error messages when parsing warning filters.</p>
<p>Previously pytest would show an internal traceback, which besides being ugly sometimes would hide the cause
of the problem (for example an <code class="docutils literal notranslate"><span class="pre">ImportError</span></code> while importing a specific warning type).</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8335">#8335</a>: Improved <a class="reference internal" href="reference/reference.html#pytest.approx" title="pytest.approx"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.approx()</span></code></a> assertion messages for sequences of numbers.</p>
<p>The assertion messages now dumps a table with the index and the error of each diff.
Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span>       <span class="k">assert</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="n">pytest</span><span class="o">.</span><span class="n">approx</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">E</span>       <span class="k">assert</span> <span class="n">comparison</span> <span class="n">failed</span> <span class="k">for</span> <span class="mi">2</span> <span class="n">values</span><span class="p">:</span>
<span class="n">E</span>         <span class="n">Index</span> <span class="o">|</span> <span class="n">Obtained</span> <span class="o">|</span> <span class="n">Expected</span>
<span class="n">E</span>         <span class="mi">1</span>     <span class="o">|</span> <span class="mi">2</span>        <span class="o">|</span> <span class="mi">3</span> <span class="o">+-</span> <span class="mf">3.0e-06</span>
<span class="n">E</span>         <span class="mi">3</span>     <span class="o">|</span> <span class="mi">4</span>        <span class="o">|</span> <span class="mi">5</span> <span class="o">+-</span> <span class="mf">5.0e-06</span>
</pre></div>
</div>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8403">#8403</a>: By default, pytest will truncate long strings in assert errors so they don’t clutter the output too much,
currently at <code class="docutils literal notranslate"><span class="pre">240</span></code> characters by default.</p>
<p>However, in some cases the longer output helps, or is even crucial, to diagnose a failure. Using <code class="docutils literal notranslate"><span class="pre">-v</span></code> will
now increase the truncation threshold to <code class="docutils literal notranslate"><span class="pre">2400</span></code> characters, and <code class="docutils literal notranslate"><span class="pre">-vv</span></code> or higher will disable truncation entirely.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8509">#8509</a>: Fixed issue where <a class="reference external" href="https://docs.python.org/3/library/unittest.html#unittest.TestCase.setUpClass" title="(in Python v3.13)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">unittest.TestCase.setUpClass()</span></code></a> is not called when a test has <code class="docutils literal notranslate"><span class="pre">/</span></code> in its name since pytest 6.2.0.</p>
<p>This refers to the path part in pytest node IDs, e.g. <code class="docutils literal notranslate"><span class="pre">TestClass::test_it</span></code> in the node ID <code class="docutils literal notranslate"><span class="pre">tests/test_file.py::TestClass::test_it</span></code>.</p>
<p>Now, instead of assuming that the test name does not contain <code class="docutils literal notranslate"><span class="pre">/</span></code>, it is assumed that test path does not contain <code class="docutils literal notranslate"><span class="pre">::</span></code>. We plan to hopefully make both of these work in the future.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8803">#8803</a>: It is now possible to add colors to custom log levels on cli log.</p>
<p>By using <code class="docutils literal notranslate"><span class="pre">add_color_level</span></code> from a <a class="reference internal" href="reference/reference.html#std:hook-5"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_configure</span></code></a> hook, colors can be added:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">logging_plugin</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">pluginmanager</span><span class="o">.</span><span class="n">get_plugin</span><span class="p">(</span><span class="s1">&#39;logging-plugin&#39;</span><span class="p">)</span>
<span class="n">logging_plugin</span><span class="o">.</span><span class="n">log_cli_handler</span><span class="o">.</span><span class="n">formatter</span><span class="o">.</span><span class="n">add_color_level</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="s1">&#39;cyan&#39;</span><span class="p">)</span>
<span class="n">logging_plugin</span><span class="o">.</span><span class="n">log_cli_handler</span><span class="o">.</span><span class="n">formatter</span><span class="o">.</span><span class="n">add_color_level</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">SPAM</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="how-to/logging.html#log-colors"><span class="std std-ref">自定义颜色</span></a> for more information.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8822">#8822</a>: When showing fixture paths in <code class="docutils literal notranslate"><span class="pre">--fixtures</span></code> or <code class="docutils literal notranslate"><span class="pre">--fixtures-by-test</span></code>, fixtures coming from pytest itself now display an elided path, rather than the full path to the file in the <code class="docutils literal notranslate"><span class="pre">site-packages</span></code> directory.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8898">#8898</a>: Complex numbers are now treated like floats and integers when generating parameterization IDs.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9062">#9062</a>: <code class="docutils literal notranslate"><span class="pre">--stepwise-skip</span></code> now implicitly enables <code class="docutils literal notranslate"><span class="pre">--stepwise</span></code> and can be used on its own.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9205">#9205</a>: <code class="xref py py-meth docutils literal notranslate"><span class="pre">pytest.Cache.set()</span></code> now preserves key order when saving dicts.</p></li>
</ul>
</section>
<section id="id437">
<h3>Bug Fixes<a class="headerlink" href="#id437" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7124">#7124</a>: Fixed an issue where <code class="docutils literal notranslate"><span class="pre">__main__.py</span></code> would raise an <code class="docutils literal notranslate"><span class="pre">ImportError</span></code> when <code class="docutils literal notranslate"><span class="pre">--doctest-modules</span></code> was provided.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8061">#8061</a>: Fixed failing <code class="docutils literal notranslate"><span class="pre">staticmethod</span></code> test cases if they are inherited from a parent test class.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8192">#8192</a>: <code class="docutils literal notranslate"><span class="pre">testdir.makefile</span></code> now silently accepts values which don’t start with <code class="docutils literal notranslate"><span class="pre">.</span></code> to maintain backward compatibility with older pytest versions.</p>
<p><code class="docutils literal notranslate"><span class="pre">pytester.makefile</span></code> now issues a clearer error if the <code class="docutils literal notranslate"><span class="pre">.</span></code> is missing in the <code class="docutils literal notranslate"><span class="pre">ext</span></code> argument.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8258">#8258</a>: Fixed issue where pytest’s <code class="docutils literal notranslate"><span class="pre">faulthandler</span></code> support would not dump traceback on crashes
if the <a class="reference external" href="https://docs.python.org/3/library/faulthandler.html#module-faulthandler" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">faulthandler</span></code></a> module was already enabled during pytest startup (using
<code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-X</span> <span class="pre">dev</span> <span class="pre">-m</span> <span class="pre">pytest</span></code> for example).</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8317">#8317</a>: Fixed an issue where illegal directory characters derived from <code class="docutils literal notranslate"><span class="pre">getpass.getuser()</span></code> raised an <code class="docutils literal notranslate"><span class="pre">OSError</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8367">#8367</a>: Fix <code class="docutils literal notranslate"><span class="pre">Class.from_parent</span></code> so it forwards extra keyword arguments to the constructor.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8377">#8377</a>: The test selection options <code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">-k</span></code> and <code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">-m</span></code> now support matching
names containing forward slash (<code class="docutils literal notranslate"><span class="pre">/</span></code>) characters.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8384">#8384</a>: The <code class="docutils literal notranslate"><span class="pre">&#64;pytest.mark.skip</span></code> decorator now correctly handles its arguments. When the <code class="docutils literal notranslate"><span class="pre">reason</span></code> argument is accidentally given both positional and as a keyword (e.g. because it was confused with <code class="docutils literal notranslate"><span class="pre">skipif</span></code>), a <code class="docutils literal notranslate"><span class="pre">TypeError</span></code> now occurs. Before, such tests were silently skipped, and the positional argument ignored. Additionally, <code class="docutils literal notranslate"><span class="pre">reason</span></code> is now documented correctly as positional or keyword (rather than keyword-only).</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8394">#8394</a>: Use private names for internal fixtures that handle classic setup/teardown so that they don’t show up with the default <code class="docutils literal notranslate"><span class="pre">--fixtures</span></code> invocation (but they still show up with <code class="docutils literal notranslate"><span class="pre">--fixtures</span> <span class="pre">-v</span></code>).</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8456">#8456</a>: The <a class="reference internal" href="reference/reference.html#confval-34"><code class="xref std std-confval docutils literal notranslate"><span class="pre">required_plugins</span></code></a> config option now works correctly when pre-releases of plugins are installed, rather than falsely claiming that those plugins aren’t installed at all.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8464">#8464</a>: <code class="docutils literal notranslate"><span class="pre">-c</span> <span class="pre">&lt;config</span> <span class="pre">file&gt;</span></code> now also properly defines <code class="docutils literal notranslate"><span class="pre">rootdir</span></code> as the directory that contains <code class="docutils literal notranslate"><span class="pre">&lt;config</span> <span class="pre">file&gt;</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8503">#8503</a>: <a class="reference internal" href="reference/reference.html#pytest.MonkeyPatch.syspath_prepend" title="pytest.MonkeyPatch.syspath_prepend"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pytest.MonkeyPatch.syspath_prepend()</span></code></a> no longer fails when
<code class="docutils literal notranslate"><span class="pre">setuptools</span></code> is not installed.
It now only calls <code class="docutils literal notranslate"><span class="pre">pkg_resources.fixup_namespace_packages</span></code> if
<code class="docutils literal notranslate"><span class="pre">pkg_resources</span></code> was previously imported, because it is not needed otherwise.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8548">#8548</a>: Introduce fix to handle precision width in <code class="docutils literal notranslate"><span class="pre">log-cli-format</span></code> in turn to fix output coloring for certain formats.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8796">#8796</a>: Fixed internal error when skipping doctests.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8983">#8983</a>: The test selection options <code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">-k</span></code> and <code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">-m</span></code> now support matching names containing backslash (<code class="docutils literal notranslate"><span class="pre">\</span></code>) characters.
Backslashes are treated literally, not as escape characters (the values being matched against are already escaped).</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8990">#8990</a>: Fix <code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">-vv</span></code> crashing with an internal exception <code class="docutils literal notranslate"><span class="pre">AttributeError:</span> <span class="pre">'str'</span> <span class="pre">object</span> <span class="pre">has</span> <span class="pre">no</span> <span class="pre">attribute</span> <span class="pre">'relative_to'</span></code> in some cases.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9077">#9077</a>: Fixed confusing error message when <code class="docutils literal notranslate"><span class="pre">request.fspath</span></code> / <code class="docutils literal notranslate"><span class="pre">request.path</span></code> was accessed from a session-scoped fixture.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9131">#9131</a>: Fixed the URL used by <code class="docutils literal notranslate"><span class="pre">--pastebin</span></code> to use <a class="reference external" href="http://bpa.st">bpa.st</a>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9163">#9163</a>: The end line number and end column offset are now properly set for rewritten assert statements.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9169">#9169</a>: Support for the <code class="docutils literal notranslate"><span class="pre">files</span></code> API from <code class="docutils literal notranslate"><span class="pre">importlib.resources</span></code> within rewritten files.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9272">#9272</a>: The nose compatibility module-level fixtures <code class="docutils literal notranslate"><span class="pre">setup()</span></code> and <code class="docutils literal notranslate"><span class="pre">teardown()</span></code> are now only called once per module, instead of for each test function.
They are now called even if object-level <code class="docutils literal notranslate"><span class="pre">setup</span></code>/<code class="docutils literal notranslate"><span class="pre">teardown</span></code> is defined.</p></li>
</ul>
</section>
<section id="id459">
<h3>Improved Documentation<a class="headerlink" href="#id459" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4320">#4320</a>: Improved docs for <code class="docutils literal notranslate"><span class="pre">pytester.copy_example</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5105">#5105</a>: Add automatically generated <a class="reference internal" href="reference/plugin_list.html#plugin-list"><span class="std std-ref">Pytest 插件列表</span></a>. The list is updated on a periodic schedule.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8337">#8337</a>: Recommend <a class="reference external" href="https://numpy.org/doc/stable/reference/routines.testing.html">numpy.testing</a> module on <a class="reference internal" href="reference/reference.html#pytest.approx" title="pytest.approx"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.approx()</span></code></a> documentation.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8655">#8655</a>: Help text for <code class="docutils literal notranslate"><span class="pre">--pdbcls</span></code> more accurately reflects the option’s behavior.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9210">#9210</a>: Remove incorrect docs about <code class="docutils literal notranslate"><span class="pre">confcutdir</span></code> being a configuration option: it can only be set through the <code class="docutils literal notranslate"><span class="pre">--confcutdir</span></code> command-line option.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9242">#9242</a>: Upgrade readthedocs configuration to use a <code class="docutils literal notranslate"><span class="pre">newer</span> <span class="pre">Ubuntu</span> <span class="pre">version</span> <span class="pre">&lt;https://blog.readthedocs.com/new-build-specification/&gt;`__</span></code> with better unicode support for PDF docs.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9341">#9341</a>: Various methods commonly used for <a class="reference internal" href="example/nonpython.html#non-python-tests"><span class="std std-ref">使用非 Python 测试</span></a> are now correctly documented in the reference docs. They were undocumented previously.</p></li>
</ul>
</section>
<section id="id467">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id467" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8133">#8133</a>: Migrate to <code class="docutils literal notranslate"><span class="pre">setuptools_scm</span></code> 6.x to use <code class="docutils literal notranslate"><span class="pre">SETUPTOOLS_SCM_PRETEND_VERSION_FOR_PYTEST</span></code> for more robust release tooling.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8174">#8174</a>: The following changes have been made to internal pytest types/functions:</p>
<ul>
<li><p>The <code class="docutils literal notranslate"><span class="pre">_pytest.code.getfslineno()</span></code> function returns <code class="docutils literal notranslate"><span class="pre">Path</span></code> instead of <code class="docutils literal notranslate"><span class="pre">py.path.local</span></code>.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">_pytest.python.path_matches_patterns()</span></code> function takes <code class="docutils literal notranslate"><span class="pre">Path</span></code> instead of <code class="docutils literal notranslate"><span class="pre">py.path.local</span></code>.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">_pytest._code.Traceback.cut()</span></code> function accepts any <code class="docutils literal notranslate"><span class="pre">os.PathLike[str]</span></code>, not just <code class="docutils literal notranslate"><span class="pre">py.path.local</span></code>.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8248">#8248</a>: Internal Restructure: let <code class="docutils literal notranslate"><span class="pre">python.PyObjMixin</span></code> inherit from <code class="docutils literal notranslate"><span class="pre">nodes.Node</span></code> to carry over typing information.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8432">#8432</a>: Improve error message when <a class="reference internal" href="reference/reference.html#pytest.skip" title="pytest.skip"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.skip()</span></code></a> is used at module level without passing <code class="docutils literal notranslate"><span class="pre">allow_module_level=True</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8818">#8818</a>: Ensure <code class="docutils literal notranslate"><span class="pre">regendoc</span></code> opts out of <code class="docutils literal notranslate"><span class="pre">TOX_ENV</span></code> cachedir selection to ensure independent example test runs.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8913">#8913</a>: The private <code class="docutils literal notranslate"><span class="pre">CallSpec2._arg2scopenum</span></code> attribute has been removed after an internal refactoring.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8967">#8967</a>: <a class="reference internal" href="reference/reference.html#std:hook-44"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_assertion_pass</span></code></a> is no longer considered experimental and
future changes to it will be considered more carefully.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9202">#9202</a>: Add github action to upload coverage report to codecov instead of bash uploader.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9225">#9225</a>: Changed the command used to create sdist and wheel artifacts: using the build package instead of setup.py.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9351">#9351</a>: Correct minor typos in doc/en/example/special.rst.</p></li>
</ul>
</section>
</section>
<section id="pytest-6-2-5-2021-08-29">
<h2>pytest 6.2.5 (2021-08-29)<a class="headerlink" href="#pytest-6-2-5-2021-08-29" title="Link to this heading">¶</a></h2>
<section id="id478">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id478" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8494">#8494</a>: Python 3.10 is now supported.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9040">#9040</a>: Enable compatibility with <code class="docutils literal notranslate"><span class="pre">pluggy</span> <span class="pre">1.0</span></code> or later.</p></li>
</ul>
</section>
</section>
<section id="pytest-6-2-4-2021-05-04">
<h2>pytest 6.2.4 (2021-05-04)<a class="headerlink" href="#pytest-6-2-4-2021-05-04" title="Link to this heading">¶</a></h2>
<section id="id479">
<h3>Bug Fixes<a class="headerlink" href="#id479" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8539">#8539</a>: Fixed assertion rewriting on Python 3.10.</p></li>
</ul>
</section>
</section>
<section id="pytest-6-2-3-2021-04-03">
<h2>pytest 6.2.3 (2021-04-03)<a class="headerlink" href="#pytest-6-2-3-2021-04-03" title="Link to this heading">¶</a></h2>
<section id="id480">
<h3>Bug Fixes<a class="headerlink" href="#id480" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8414">#8414</a>: pytest used to create directories under <code class="docutils literal notranslate"><span class="pre">/tmp</span></code> with world-readable
permissions. This means that any user in the system was able to read
information written by tests in temporary directories (such as those created by
the <code class="docutils literal notranslate"><span class="pre">tmp_path</span></code>/<code class="docutils literal notranslate"><span class="pre">tmpdir</span></code> fixture). Now the directories are created with
private permissions.</p>
<p>pytest used to silently use a preexisting <code class="docutils literal notranslate"><span class="pre">/tmp/pytest-of-&lt;username&gt;</span></code> directory,
even if owned by another user. This means another user could pre-create such a
directory and gain control of another user’s temporary directory. Now such a
condition results in an error.</p>
</li>
</ul>
</section>
</section>
<section id="pytest-6-2-2-2021-01-25">
<h2>pytest 6.2.2 (2021-01-25)<a class="headerlink" href="#pytest-6-2-2-2021-01-25" title="Link to this heading">¶</a></h2>
<section id="id481">
<h3>Bug Fixes<a class="headerlink" href="#id481" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8152">#8152</a>: Fixed “(&lt;Skipped instance&gt;)” being shown as a skip reason in the verbose test summary line when the reason is empty.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8249">#8249</a>: Fix the <code class="docutils literal notranslate"><span class="pre">faulthandler</span></code> plugin for occasions when running with <code class="docutils literal notranslate"><span class="pre">twisted.logger</span></code> and using <code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">--capture=no</span></code>.</p></li>
</ul>
</section>
</section>
<section id="pytest-6-2-1-2020-12-15">
<h2>pytest 6.2.1 (2020-12-15)<a class="headerlink" href="#pytest-6-2-1-2020-12-15" title="Link to this heading">¶</a></h2>
<section id="id482">
<h3>Bug Fixes<a class="headerlink" href="#id482" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7678">#7678</a>: Fixed bug where <code class="docutils literal notranslate"><span class="pre">ImportPathMismatchError</span></code> would be raised for files compiled in
the host and loaded later from an UNC mounted path (Windows).</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8132">#8132</a>: Fixed regression in <code class="docutils literal notranslate"><span class="pre">approx</span></code>: in 6.2.0 <code class="docutils literal notranslate"><span class="pre">approx</span></code> no longer raises
<code class="docutils literal notranslate"><span class="pre">TypeError</span></code> when dealing with non-numeric types, falling back to normal comparison.
Before 6.2.0, array types like tf.DeviceArray fell through to the scalar case,
and happened to compare correctly to a scalar if they had only one element.
After 6.2.0, these types began failing, because they inherited neither from
standard Python number hierarchy nor from <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">approx</span></code> now converts arguments to <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> if they expose the array
protocol and are not scalars. This treats array-like objects like numpy arrays,
regardless of size.</p>
</li>
</ul>
</section>
</section>
<section id="pytest-6-2-0-2020-12-12">
<h2>pytest 6.2.0 (2020-12-12)<a class="headerlink" href="#pytest-6-2-0-2020-12-12" title="Link to this heading">¶</a></h2>
<section id="id483">
<h3>Breaking Changes<a class="headerlink" href="#id483" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7808">#7808</a>: pytest now supports python3.6+ only.</p></li>
</ul>
</section>
<section id="id484">
<h3>Deprecations<a class="headerlink" href="#id484" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7469">#7469</a>: Directly constructing/calling the following classes/functions is now deprecated:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">_pytest.cacheprovider.Cache</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_pytest.cacheprovider.Cache.for_config()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_pytest.cacheprovider.Cache.clear_cache()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_pytest.cacheprovider.Cache.cache_dir_from_config()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_pytest.capture.CaptureFixture</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_pytest.fixtures.FixtureRequest</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_pytest.fixtures.SubRequest</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_pytest.logging.LogCaptureFixture</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_pytest.pytester.Pytester</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_pytest.pytester.Testdir</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_pytest.recwarn.WarningsRecorder</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_pytest.recwarn.WarningsChecker</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_pytest.tmpdir.TempPathFactory</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_pytest.tmpdir.TempdirFactory</span></code></p></li>
</ul>
<p>These have always been considered private, but now issue a deprecation warning, which may become a hard error in pytest 8.0.0.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7530">#7530</a>: The <code class="docutils literal notranslate"><span class="pre">--strict</span></code> command-line option has been deprecated, use <code class="docutils literal notranslate"><span class="pre">--strict-markers</span></code> instead.</p>
<p>We have plans to maybe in the future to reintroduce <code class="docutils literal notranslate"><span class="pre">--strict</span></code> and make it an encompassing flag for all strictness
related options (<code class="docutils literal notranslate"><span class="pre">--strict-markers</span></code> and <code class="docutils literal notranslate"><span class="pre">--strict-config</span></code> at the moment, more might be introduced in the future).</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7988">#7988</a>: The <code class="docutils literal notranslate"><span class="pre">&#64;pytest.yield_fixture</span></code> decorator/function is now deprecated. Use <a class="reference internal" href="reference/reference.html#pytest.fixture" title="pytest.fixture"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.fixture()</span></code></a> instead.</p>
<p><code class="docutils literal notranslate"><span class="pre">yield_fixture</span></code> has been an alias for <code class="docutils literal notranslate"><span class="pre">fixture</span></code> for a very long time, so can be search/replaced safely.</p>
</li>
</ul>
</section>
<section id="id485">
<h3>Features<a class="headerlink" href="#id485" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5299">#5299</a>: pytest now warns about unraisable exceptions and unhandled thread exceptions that occur in tests on Python&gt;=3.8.
See <a class="reference internal" href="how-to/failures.html#unraisable"><span class="std std-ref">关于无法引发的异常和未处理的线程异常的警告</span></a> for more information.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7425">#7425</a>: New <a class="reference internal" href="reference/reference.html#std-fixture-pytester"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">pytester</span></code></a> fixture, which is identical to <a class="reference internal" href="reference/reference.html#std:fixture-2"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">testdir</span></code></a> but its methods return <a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pathlib.Path</span></code></a> when appropriate instead of <code class="docutils literal notranslate"><span class="pre">py.path.local</span></code>.</p>
<p>This is part of the movement to use <a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pathlib.Path</span></code></a> objects internally, in order to remove the dependency to <code class="docutils literal notranslate"><span class="pre">py</span></code> in the future.</p>
<p>Internally, the old <code class="docutils literal notranslate"><span class="pre">pytest.Testdir</span></code> is now a thin wrapper around <a class="reference internal" href="reference/reference.html#id11" title="pytest.Pytester"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pytester</span></code></a>, preserving the old interface.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7695">#7695</a>: A new hook was added, <code class="docutils literal notranslate"><span class="pre">pytest_markeval_namespace</span></code> which should return a dictionary.
This dictionary will be used to augment the “global” variables available to evaluate skipif/xfail/xpass markers.</p>
<p>Pseudo example</p>
<p><code class="docutils literal notranslate"><span class="pre">conftest.py</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pytest_markeval_namespace</span><span class="p">():</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;red&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">test_func.py</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">skipif</span><span class="p">(</span><span class="s2">&quot;color == &#39;blue&#39;&quot;</span><span class="p">,</span> <span class="n">reason</span><span class="o">=</span><span class="s2">&quot;Color is not red&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_func</span><span class="p">():</span>
    <span class="k">assert</span> <span class="kc">False</span>
</pre></div>
</div>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8006">#8006</a>: It is now possible to construct a <a class="reference internal" href="reference/reference.html#pytest.MonkeyPatch" title="pytest.MonkeyPatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">MonkeyPatch</span></code></a> object directly as <code class="docutils literal notranslate"><span class="pre">pytest.MonkeyPatch()</span></code>,
in cases when the <a class="reference internal" href="reference/reference.html#std-fixture-monkeypatch"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">monkeypatch</span></code></a> fixture cannot be used. Previously some users imported it
from the private <code class="docutils literal notranslate"><span class="pre">_pytest.monkeypatch.MonkeyPatch</span></code> namespace.</p>
<p>Additionally, <a class="reference internal" href="reference/reference.html#pytest.MonkeyPatch.context" title="pytest.MonkeyPatch.context"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MonkeyPatch.context</span></code></a> is now a classmethod,
and can be used as <code class="docutils literal notranslate"><span class="pre">with</span> <span class="pre">MonkeyPatch.context()</span> <span class="pre">as</span> <span class="pre">mp:</span> <span class="pre">...</span></code>. This is the recommended way to use
<code class="docutils literal notranslate"><span class="pre">MonkeyPatch</span></code> directly, since unlike the <code class="docutils literal notranslate"><span class="pre">monkeypatch</span></code> fixture, an instance created directly
is not <code class="docutils literal notranslate"><span class="pre">undo()</span></code>-ed automatically.</p>
</li>
</ul>
</section>
<section id="id486">
<h3>Improvements<a class="headerlink" href="#id486" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1265">#1265</a>: Added an <code class="docutils literal notranslate"><span class="pre">__str__</span></code> implementation to the <a class="reference internal" href="reference/reference.html#id60" title="pytest.LineMatcher"><code class="xref py py-class docutils literal notranslate"><span class="pre">LineMatcher</span></code></a> class which is returned from <code class="docutils literal notranslate"><span class="pre">pytester.run_pytest().stdout</span></code> and similar. It returns the entire output, like the existing <code class="docutils literal notranslate"><span class="pre">str()</span></code> method.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2044">#2044</a>: Verbose mode now shows the reason that a test was skipped in the test’s terminal line after the “SKIPPED”, “XFAIL” or “XPASS”.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7469">#7469</a> The types of builtin pytest fixtures are now exported so they may be used in type annotations of test functions.
The newly-exported types are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.FixtureRequest</span></code> for the <a class="reference internal" href="reference/reference.html#std-fixture-request"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">request</span></code></a> fixture.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.Cache</span></code> for the <a class="reference internal" href="reference/reference.html#std-fixture-cache"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">cache</span></code></a> fixture.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.CaptureFixture[str]</span></code> for the <a class="reference internal" href="reference/reference.html#std-fixture-capfd"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">capfd</span></code></a> and <a class="reference internal" href="reference/reference.html#std-fixture-capsys"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">capsys</span></code></a> fixtures.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.CaptureFixture[bytes]</span></code> for the <a class="reference internal" href="reference/reference.html#std-fixture-capfdbinary"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">capfdbinary</span></code></a> and <a class="reference internal" href="reference/reference.html#std-fixture-capsysbinary"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">capsysbinary</span></code></a> fixtures.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.LogCaptureFixture</span></code> for the <a class="reference internal" href="reference/reference.html#std-fixture-caplog"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">caplog</span></code></a> fixture.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.Pytester</span></code> for the <a class="reference internal" href="reference/reference.html#std-fixture-pytester"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">pytester</span></code></a> fixture.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.Testdir</span></code> for the <a class="reference internal" href="reference/reference.html#std:fixture-2"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">testdir</span></code></a> fixture.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.TempdirFactory</span></code> for the <a class="reference internal" href="reference/reference.html#std-fixture-tmpdir_factory"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">tmpdir_factory</span></code></a> fixture.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.TempPathFactory</span></code> for the <a class="reference internal" href="reference/reference.html#std-fixture-tmp_path_factory"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">tmp_path_factory</span></code></a> fixture.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.MonkeyPatch</span></code> for the <a class="reference internal" href="reference/reference.html#std-fixture-monkeypatch"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">monkeypatch</span></code></a> fixture.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.WarningsRecorder</span></code> for the <a class="reference internal" href="reference/reference.html#std-fixture-recwarn"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">recwarn</span></code></a> fixture.</p></li>
</ul>
<p>Constructing them is not supported (except for <code class="docutils literal notranslate"><span class="pre">MonkeyPatch</span></code>); they are only meant for use in type annotations.
Doing so will emit a deprecation warning, and may become a hard-error in pytest 8.0.</p>
<p>Subclassing them is also not supported. This is not currently enforced at runtime, but is detected by type-checkers such as mypy.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7527">#7527</a>: When a comparison between <a class="reference external" href="https://docs.python.org/3/library/collections.html#collections.namedtuple" title="(in Python v3.13)"><code class="xref py py-func docutils literal notranslate"><span class="pre">namedtuple</span></code></a> instances of the same type fails, pytest now shows the differing field names (possibly nested) instead of their indexes.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7615">#7615</a>: <a class="reference internal" href="reference/reference.html#pytest.nodes.Node.warn" title="_pytest.nodes.Node.warn"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Node.warn</span></code></a> now permits any subclass of <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Warning" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Warning</span></code></a>, not just <a class="reference internal" href="reference/reference.html#pytest.PytestWarning" title="pytest.PytestWarning"><code class="xref py py-class docutils literal notranslate"><span class="pre">PytestWarning</span></code></a>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7701">#7701</a>: Improved reporting when using <code class="docutils literal notranslate"><span class="pre">--collected-only</span></code>. It will now show the number of collected tests in the summary stats.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7710">#7710</a>: Use strict equality comparison for non-numeric types in <a class="reference internal" href="reference/reference.html#pytest.approx" title="pytest.approx"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.approx()</span></code></a> instead of
raising <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeError</span></code></a>.</p>
<p>This was the undocumented behavior before 3.7, but is now officially a supported feature.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7938">#7938</a>: New <code class="docutils literal notranslate"><span class="pre">--sw-skip</span></code> argument which is a shorthand for <code class="docutils literal notranslate"><span class="pre">--stepwise-skip</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8023">#8023</a>: Added <code class="docutils literal notranslate"><span class="pre">'node_modules'</span></code> to default value for <a class="reference internal" href="reference/reference.html#confval-29"><code class="xref std std-confval docutils literal notranslate"><span class="pre">norecursedirs</span></code></a>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8032">#8032</a>: <a class="reference external" href="https://docs.python.org/3/library/unittest.html#unittest.TestCase.doClassCleanups" title="(in Python v3.13)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">doClassCleanups</span></code></a> (introduced in <a class="reference external" href="https://docs.python.org/3/library/unittest.html#module-unittest" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">unittest</span></code></a> in Python and 3.8) is now called appropriately.</p></li>
</ul>
</section>
<section id="id487">
<h3>Bug Fixes<a class="headerlink" href="#id487" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4824">#4824</a>: Fixed quadratic behavior and improved performance of collection of items using autouse fixtures and xunit fixtures.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7758">#7758</a>: Fixed an issue where some files in packages are getting lost from <code class="docutils literal notranslate"><span class="pre">--lf</span></code> even though they contain tests that failed. Regressed in pytest 5.4.0.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7911">#7911</a>: Directories created by by <a class="reference internal" href="reference/reference.html#std:fixture-3"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">tmp_path</span></code></a> and <a class="reference internal" href="reference/reference.html#std-fixture-tmpdir"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">tmpdir</span></code></a> are now considered stale after 3 days without modification (previous value was 3 hours) to avoid deleting directories still in use in long running test suites.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7913">#7913</a>: Fixed a crash or hang in <a class="reference internal" href="reference/reference.html#id49" title="pytest.Pytester.spawn"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pytester.spawn</span></code></a> when the <a class="reference external" href="https://docs.python.org/3/library/readline.html#module-readline" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">readline</span></code></a> module is involved.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7951">#7951</a>: Fixed handling of recursive symlinks when collecting tests.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7981">#7981</a>: Fixed symlinked directories not being followed during collection. Regressed in pytest 6.1.0.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8016">#8016</a>: Fixed only one doctest being collected when using <code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">--doctest-modules</span> <span class="pre">path/to/an/__init__.py</span></code>.</p></li>
</ul>
</section>
<section id="id488">
<h3>Improved Documentation<a class="headerlink" href="#id488" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7429">#7429</a>: Add more information and use cases about skipping doctests.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7780">#7780</a>: Classes which should not be inherited from are now marked <code class="docutils literal notranslate"><span class="pre">final</span> <span class="pre">class</span></code> in the API reference.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7872">#7872</a>: <code class="docutils literal notranslate"><span class="pre">_pytest.config.argparsing.Parser.addini()</span></code> accepts explicit <code class="docutils literal notranslate"><span class="pre">None</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;string&quot;</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7878">#7878</a>: In pull request section, ask to commit after editing changelog and authors file.</p></li>
</ul>
</section>
<section id="id489">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id489" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7802">#7802</a>: The <code class="docutils literal notranslate"><span class="pre">attrs</span></code> dependency requirement is now &gt;=19.2.0 instead of &gt;=17.4.0.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/8014">#8014</a>: <code class="docutils literal notranslate"><span class="pre">.pyc</span></code> files created by pytest’s assertion rewriting now conform to the newer <span class="target" id="index-5"></span><a class="pep reference external" href="https://peps.python.org/pep-0552/"><strong>PEP 552</strong></a> format on Python&gt;=3.7.
(These files are internal and only interpreted by pytest itself.)</p></li>
</ul>
</section>
</section>
<section id="pytest-6-1-2-2020-10-28">
<h2>pytest 6.1.2 (2020-10-28)<a class="headerlink" href="#pytest-6-1-2-2020-10-28" title="Link to this heading">¶</a></h2>
<section id="id490">
<h3>Bug Fixes<a class="headerlink" href="#id490" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7758">#7758</a>: Fixed an issue where some files in packages are getting lost from <code class="docutils literal notranslate"><span class="pre">--lf</span></code> even though they contain tests that failed. Regressed in pytest 5.4.0.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7911">#7911</a>: Directories created by <code class="docutils literal notranslate"><span class="pre">tmpdir</span></code> are now considered stale after 3 days without modification (previous value was 3 hours) to avoid deleting directories still in use in long running test suites.</p></li>
</ul>
</section>
<section id="id491">
<h3>Improved Documentation<a class="headerlink" href="#id491" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7815">#7815</a>: Improve deprecation warning message for <code class="docutils literal notranslate"><span class="pre">pytest._fillfuncargs()</span></code>.</p></li>
</ul>
</section>
</section>
<section id="pytest-6-1-1-2020-10-03">
<h2>pytest 6.1.1 (2020-10-03)<a class="headerlink" href="#pytest-6-1-1-2020-10-03" title="Link to this heading">¶</a></h2>
<section id="id492">
<h3>Bug Fixes<a class="headerlink" href="#id492" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7807">#7807</a>: Fixed regression in pytest 6.1.0 causing incorrect rootdir to be determined in some non-trivial cases where parent directories have config files as well.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7814">#7814</a>: Fixed crash in header reporting when <a class="reference internal" href="reference/reference.html#confval-35"><code class="xref std std-confval docutils literal notranslate"><span class="pre">testpaths</span></code></a> is used and contains absolute paths (regression in 6.1.0).</p></li>
</ul>
</section>
</section>
<section id="pytest-6-1-0-2020-09-26">
<h2>pytest 6.1.0 (2020-09-26)<a class="headerlink" href="#pytest-6-1-0-2020-09-26" title="Link to this heading">¶</a></h2>
<section id="id493">
<h3>Breaking Changes<a class="headerlink" href="#id493" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5585">#5585</a>: As per our policy, the following features which have been deprecated in the 5.X series are now
removed:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">funcargnames</span></code> read-only property of <code class="docutils literal notranslate"><span class="pre">FixtureRequest</span></code>, <code class="docutils literal notranslate"><span class="pre">Metafunc</span></code>, and <code class="docutils literal notranslate"><span class="pre">Function</span></code> classes. Use <code class="docutils literal notranslate"><span class="pre">fixturenames</span></code> attribute.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&#64;pytest.fixture</span></code> no longer supports positional arguments, pass all arguments by keyword instead.</p></li>
<li><p>Direct construction of <code class="docutils literal notranslate"><span class="pre">Node</span></code> subclasses now raise an error, use <code class="docutils literal notranslate"><span class="pre">from_parent</span></code> instead.</p></li>
<li><p>The default value for <code class="docutils literal notranslate"><span class="pre">junit_family</span></code> has changed to <code class="docutils literal notranslate"><span class="pre">xunit2</span></code>. If you require the old format, add <code class="docutils literal notranslate"><span class="pre">junit_family=xunit1</span></code> to your configuration file.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">TerminalReporter</span></code> no longer has a <code class="docutils literal notranslate"><span class="pre">writer</span></code> attribute. Plugin authors may use the public functions of the <code class="docutils literal notranslate"><span class="pre">TerminalReporter</span></code> instead of accessing the <code class="docutils literal notranslate"><span class="pre">TerminalWriter</span></code> object directly.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">--result-log</span></code> option has been removed. Users are recommended to use the <a class="reference external" href="https://github.com/pytest-dev/pytest-reportlog">pytest-reportlog</a> plugin instead.</p></li>
</ul>
<p>For more information consult <a class="reference internal" href="deprecations.html"><span class="doc">Deprecations and Removals</span></a> in the docs.</p>
</li>
</ul>
</section>
<section id="id494">
<h3>Deprecations<a class="headerlink" href="#id494" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6981">#6981</a>: The <code class="docutils literal notranslate"><span class="pre">pytest.collect</span></code> module is deprecated: all its names can be imported from <code class="docutils literal notranslate"><span class="pre">pytest</span></code> directly.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7097">#7097</a>: The <code class="docutils literal notranslate"><span class="pre">pytest._fillfuncargs</span></code> function is deprecated. This function was kept
for backward compatibility with an older plugin.</p>
<p>It’s functionality is not meant to be used directly, but if you must replace
it, use <code class="docutils literal notranslate"><span class="pre">function._request._fillfixtures()</span></code> instead, though note this is not
a public API and may break in the future.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7210">#7210</a>: The special <code class="docutils literal notranslate"><span class="pre">-k</span> <span class="pre">'-expr'</span></code> syntax to <code class="docutils literal notranslate"><span class="pre">-k</span></code> is deprecated. Use <code class="docutils literal notranslate"><span class="pre">-k</span> <span class="pre">'not</span> <span class="pre">expr'</span></code>
instead.</p>
<p>The special <code class="docutils literal notranslate"><span class="pre">-k</span> <span class="pre">'expr:'</span></code> syntax to <code class="docutils literal notranslate"><span class="pre">-k</span></code> is deprecated. Please open an issue
if you use this and want a replacement.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7255">#7255</a>: The <code class="docutils literal notranslate"><span class="pre">pytest_warning_captured</span></code> hook is deprecated in favor
of <a class="reference internal" href="reference/reference.html#std:hook-41"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_warning_recorded</span></code></a>, and will be removed in a future version.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7648">#7648</a>: The <code class="docutils literal notranslate"><span class="pre">gethookproxy()</span></code> and <code class="docutils literal notranslate"><span class="pre">isinitpath()</span></code> methods of <code class="docutils literal notranslate"><span class="pre">FSCollector</span></code> and <code class="docutils literal notranslate"><span class="pre">Package</span></code> are deprecated;
use <code class="docutils literal notranslate"><span class="pre">self.session.gethookproxy()</span></code> and <code class="docutils literal notranslate"><span class="pre">self.session.isinitpath()</span></code> instead.
This should work on all pytest versions.</p></li>
</ul>
</section>
<section id="id495">
<h3>Features<a class="headerlink" href="#id495" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7667">#7667</a>: New <code class="docutils literal notranslate"><span class="pre">--durations-min</span></code> command-line flag controls the minimal duration for inclusion in the slowest list of tests shown by <code class="docutils literal notranslate"><span class="pre">--durations</span></code>. Previously this was hard-coded to <code class="docutils literal notranslate"><span class="pre">0.005s</span></code>.</p></li>
</ul>
</section>
<section id="id496">
<h3>Improvements<a class="headerlink" href="#id496" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6681">#6681</a>: Internal pytest warnings issued during the early stages of initialization are now properly handled and can filtered through <a class="reference internal" href="reference/reference.html#confval-9"><code class="xref std std-confval docutils literal notranslate"><span class="pre">filterwarnings</span></code></a> or <code class="docutils literal notranslate"><span class="pre">--pythonwarnings/-W</span></code>.</p>
<p>This also fixes a number of long standing issues: <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2891">#2891</a>, <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7620">#7620</a>, <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7426">#7426</a>.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7572">#7572</a>: When a plugin listed in <code class="docutils literal notranslate"><span class="pre">required_plugins</span></code> is missing or an unknown config key is used with <code class="docutils literal notranslate"><span class="pre">--strict-config</span></code>, a simple error message is now shown instead of a stacktrace.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7685">#7685</a>: Added two new attributes <a class="reference internal" href="reference/reference.html#pytest.Config.rootpath" title="pytest.Config.rootpath"><code class="xref py py-attr docutils literal notranslate"><span class="pre">rootpath</span></code></a> and <a class="reference internal" href="reference/reference.html#pytest.Config.inipath" title="pytest.Config.inipath"><code class="xref py py-attr docutils literal notranslate"><span class="pre">inipath</span></code></a> to <a class="reference internal" href="reference/reference.html#pytest.Config" title="pytest.Config"><code class="xref py py-class docutils literal notranslate"><span class="pre">Config</span></code></a>.
These attributes are <a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pathlib.Path</span></code></a> versions of the existing <code class="docutils literal notranslate"><span class="pre">rootdir</span></code> and <code class="docutils literal notranslate"><span class="pre">inifile</span></code> attributes,
and should be preferred over them when possible.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7780">#7780</a>: Public classes which are not designed to be inherited from are now marked <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.final" title="(in Python v3.13)"><code class="xref py py-func docutils literal notranslate"><span class="pre">&#64;final</span></code></a>.
Code which inherits from these classes will trigger a type-checking (e.g. mypy) error, but will still work in runtime.
Currently the <code class="docutils literal notranslate"><span class="pre">final</span></code> designation does not appear in the API Reference but hopefully will in the future.</p></li>
</ul>
</section>
<section id="id497">
<h3>Bug Fixes<a class="headerlink" href="#id497" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1953">#1953</a>: Fixed error when overwriting a parametrized fixture, while also reusing the super fixture value.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># conftest.py</span>
<span class="kn">import</span> <span class="nn">pytest</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">request</span><span class="o">.</span><span class="n">param</span>


<span class="c1"># test_foo.py</span>
<span class="kn">import</span> <span class="nn">pytest</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">foo</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">foo</span> <span class="o">*</span> <span class="mi">2</span>
</pre></div>
</div>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4984">#4984</a>: Fixed an internal error crash with <code class="docutils literal notranslate"><span class="pre">IndexError:</span> <span class="pre">list</span> <span class="pre">index</span> <span class="pre">out</span> <span class="pre">of</span> <span class="pre">range</span></code> when
collecting a module which starts with a decorated function, the decorator
raises, and assertion rewriting is enabled.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7591">#7591</a>: pylint shouldn’t complain anymore about unimplemented abstract methods when inheriting from <a class="reference internal" href="example/nonpython.html#non-python-tests"><span class="std std-ref">File</span></a>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7628">#7628</a>: Fixed test collection when a full path without a drive letter was passed to pytest on Windows (for example <code class="docutils literal notranslate"><span class="pre">\projects\tests\test.py</span></code> instead of <code class="docutils literal notranslate"><span class="pre">c:\projects\tests\pytest.py</span></code>).</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7638">#7638</a>: Fix handling of command-line options that appear as paths but trigger an OS-level syntax error on Windows, such as the options used internally by <code class="docutils literal notranslate"><span class="pre">pytest-xdist</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7742">#7742</a>: Fixed INTERNALERROR when accessing locals / globals with faulty <code class="docutils literal notranslate"><span class="pre">exec</span></code>.</p></li>
</ul>
</section>
<section id="id498">
<h3>Improved Documentation<a class="headerlink" href="#id498" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1477">#1477</a>: Removed faq.rst and its reference in contents.rst.</p></li>
</ul>
</section>
<section id="id499">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id499" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7536">#7536</a>: The internal <code class="docutils literal notranslate"><span class="pre">junitxml</span></code> plugin has rewritten to use <code class="docutils literal notranslate"><span class="pre">xml.etree.ElementTree</span></code>.
The order of attributes in XML elements might differ. Some unneeded escaping is
no longer performed.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7587">#7587</a>: The dependency on the <code class="docutils literal notranslate"><span class="pre">more-itertools</span></code> package has been removed.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7631">#7631</a>: The result type of <a class="reference internal" href="reference/reference.html#pytest.CaptureFixture.readouterr" title="pytest.CaptureFixture.readouterr"><code class="xref py py-meth docutils literal notranslate"><span class="pre">capfd.readouterr()</span></code></a> (and similar) is no longer a namedtuple,
but should behave like one in all respects. This was done for technical reasons.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7671">#7671</a>: When collecting tests, pytest finds test classes and functions by examining the
attributes of python objects (modules, classes and instances). To speed up this
process, pytest now ignores builtin attributes (like <code class="docutils literal notranslate"><span class="pre">__class__</span></code>,
<code class="docutils literal notranslate"><span class="pre">__delattr__</span></code> and <code class="docutils literal notranslate"><span class="pre">__new__</span></code>) without consulting the <a class="reference internal" href="reference/reference.html#confval-30"><code class="xref std std-confval docutils literal notranslate"><span class="pre">python_classes</span></code></a> and
<a class="reference internal" href="reference/reference.html#confval-32"><code class="xref std std-confval docutils literal notranslate"><span class="pre">python_functions</span></code></a> configuration options and without passing them to plugins
using the <a class="reference internal" href="reference/reference.html#std:hook-15"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_pycollect_makeitem</span></code></a> hook.</p></li>
</ul>
</section>
</section>
<section id="pytest-6-0-2-2020-09-04">
<h2>pytest 6.0.2 (2020-09-04)<a class="headerlink" href="#pytest-6-0-2-2020-09-04" title="Link to this heading">¶</a></h2>
<section id="id500">
<h3>Bug Fixes<a class="headerlink" href="#id500" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7148">#7148</a>: Fixed <code class="docutils literal notranslate"><span class="pre">--log-cli</span></code> potentially causing unrelated <code class="docutils literal notranslate"><span class="pre">print</span></code> output to be swallowed.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7672">#7672</a>: Fixed log-capturing level restored incorrectly if <code class="docutils literal notranslate"><span class="pre">caplog.set_level</span></code> is called more than once.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7686">#7686</a>: Fixed <code class="docutils literal notranslate"><span class="pre">NotSetType.token</span></code> being used as the parameter ID when the parametrization list is empty.
Regressed in pytest 6.0.0.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7707">#7707</a>: Fix internal error when handling some exceptions that contain multiple lines or the style uses multiple lines (<code class="docutils literal notranslate"><span class="pre">--tb=line</span></code> for example).</p></li>
</ul>
</section>
</section>
<section id="pytest-6-0-1-2020-07-30">
<h2>pytest 6.0.1 (2020-07-30)<a class="headerlink" href="#pytest-6-0-1-2020-07-30" title="Link to this heading">¶</a></h2>
<section id="id501">
<h3>Bug Fixes<a class="headerlink" href="#id501" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7394">#7394</a>: Passing an empty <code class="docutils literal notranslate"><span class="pre">help</span></code> value to <code class="docutils literal notranslate"><span class="pre">Parser.add_option</span></code> is now accepted instead of crashing when running <code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">--help</span></code>.
Passing <code class="docutils literal notranslate"><span class="pre">None</span></code> raises a more informative <code class="docutils literal notranslate"><span class="pre">TypeError</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7558">#7558</a>: Fix pylint <code class="docutils literal notranslate"><span class="pre">not-callable</span></code> lint on <code class="docutils literal notranslate"><span class="pre">pytest.mark.parametrize()</span></code> and the other builtin marks:
<code class="docutils literal notranslate"><span class="pre">skip</span></code>, <code class="docutils literal notranslate"><span class="pre">skipif</span></code>, <code class="docutils literal notranslate"><span class="pre">xfail</span></code>, <code class="docutils literal notranslate"><span class="pre">usefixtures</span></code>, <code class="docutils literal notranslate"><span class="pre">filterwarnings</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7559">#7559</a>: Fix regression in plugins using <code class="docutils literal notranslate"><span class="pre">TestReport.longreprtext</span></code> (such as <code class="docutils literal notranslate"><span class="pre">pytest-html</span></code>) when <code class="docutils literal notranslate"><span class="pre">TestReport.longrepr</span></code> is not a string.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7569">#7569</a>: Fix logging capture handler’s level not reset on teardown after a call to <code class="docutils literal notranslate"><span class="pre">caplog.set_level()</span></code>.</p></li>
</ul>
</section>
</section>
<section id="pytest-6-0-0-2020-07-28">
<h2>pytest 6.0.0 (2020-07-28)<a class="headerlink" href="#pytest-6-0-0-2020-07-28" title="Link to this heading">¶</a></h2>
<p>(<strong>Please see the full set of changes for this release also in the 6.0.0rc1 notes below</strong>)</p>
<section id="id502">
<h3>Breaking Changes<a class="headerlink" href="#id502" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5584">#5584</a>: <strong>PytestDeprecationWarning are now errors by default.</strong></p>
<p>Following our plan to remove deprecated features with as little disruption as
possible, all warnings of type <code class="docutils literal notranslate"><span class="pre">PytestDeprecationWarning</span></code> now generate errors
instead of warning messages.</p>
<p><strong>The affected features will be effectively removed in pytest 6.1</strong>, so please consult the
<a class="reference internal" href="deprecations.html"><span class="doc">Deprecations and Removals</span></a> section in the docs for directions on how to update existing code.</p>
<p>In the pytest <code class="docutils literal notranslate"><span class="pre">6.0.X</span></code> series, it is possible to change the errors back into warnings as a
stopgap measure by adding this to your <code class="docutils literal notranslate"><span class="pre">pytest.ini</span></code> file:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[pytest]</span>
<span class="na">filterwarnings</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="na">ignore</span><span class="o">:</span><span class="s">:pytest.PytestDeprecationWarning</span>
</pre></div>
</div>
<p>But this will stop working when pytest <code class="docutils literal notranslate"><span class="pre">6.1</span></code> is released.</p>
<p><strong>If you have concerns</strong> about the removal of a specific feature, please add a
comment to <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5584">#5584</a>.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7472">#7472</a>: The <code class="docutils literal notranslate"><span class="pre">exec_()</span></code> and <code class="docutils literal notranslate"><span class="pre">is_true()</span></code> methods of <code class="docutils literal notranslate"><span class="pre">_pytest._code.Frame</span></code> have been removed.</p></li>
</ul>
</section>
<section id="id503">
<h3>Features<a class="headerlink" href="#id503" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7464">#7464</a>: Added support for <span class="target" id="index-6"></span><a class="reference internal" href="reference/reference.html#envvar-11"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">NO_COLOR</span></code></a> and <span class="target" id="index-7"></span><a class="reference internal" href="reference/reference.html#envvar-12"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">FORCE_COLOR</span></code></a> environment variables to control colored output.</p></li>
</ul>
</section>
<section id="id504">
<h3>Improvements<a class="headerlink" href="#id504" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7467">#7467</a>: <code class="docutils literal notranslate"><span class="pre">--log-file</span></code> CLI option and <code class="docutils literal notranslate"><span class="pre">log_file</span></code> ini marker now create subdirectories if needed.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7489">#7489</a>: The <a class="reference internal" href="reference/reference.html#pytest.raises" title="pytest.raises"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.raises()</span></code></a> function has a clearer error message when <code class="docutils literal notranslate"><span class="pre">match</span></code> equals the obtained string but is not a regex match. In this case it is suggested to escape the regex.</p></li>
</ul>
</section>
<section id="id505">
<h3>Bug Fixes<a class="headerlink" href="#id505" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7392">#7392</a>: Fix the reported location of tests skipped with <code class="docutils literal notranslate"><span class="pre">&#64;pytest.mark.skip</span></code> when <code class="docutils literal notranslate"><span class="pre">--runxfail</span></code> is used.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7491">#7491</a>: <a class="reference internal" href="reference/reference.html#std-fixture-tmpdir"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">tmpdir</span></code></a> and <a class="reference internal" href="reference/reference.html#std:fixture-3"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">tmp_path</span></code></a> no longer raise an error if the lock to check for
stale temporary directories is not accessible.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7517">#7517</a>: Preserve line endings when captured via <code class="docutils literal notranslate"><span class="pre">capfd</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7534">#7534</a>: Restored the previous formatting of <code class="docutils literal notranslate"><span class="pre">TracebackEntry.__str__</span></code> which was changed by accident.</p></li>
</ul>
</section>
<section id="id506">
<h3>Improved Documentation<a class="headerlink" href="#id506" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7422">#7422</a>: Clarified when the <code class="docutils literal notranslate"><span class="pre">usefixtures</span></code> mark can apply fixtures to test.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7441">#7441</a>: Add a note about <code class="docutils literal notranslate"><span class="pre">-q</span></code> option used in getting started guide.</p></li>
</ul>
</section>
<section id="id507">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id507" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7389">#7389</a>: Fixture scope <code class="docutils literal notranslate"><span class="pre">package</span></code> is no longer considered experimental.</p></li>
</ul>
</section>
</section>
<section id="pytest-6-0-0rc1-2020-07-08">
<h2>pytest 6.0.0rc1 (2020-07-08)<a class="headerlink" href="#pytest-6-0-0rc1-2020-07-08" title="Link to this heading">¶</a></h2>
<section id="id508">
<h3>Breaking Changes<a class="headerlink" href="#id508" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1316">#1316</a>: <code class="docutils literal notranslate"><span class="pre">TestReport.longrepr</span></code> is now always an instance of <code class="docutils literal notranslate"><span class="pre">ReprExceptionInfo</span></code>. Previously it was a <code class="docutils literal notranslate"><span class="pre">str</span></code> when a test failed with <code class="docutils literal notranslate"><span class="pre">pytest.fail(...,</span> <span class="pre">pytrace=False)</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5965">#5965</a>: symlinks are no longer resolved during collection and matching <code class="docutils literal notranslate"><span class="pre">conftest.py</span></code> files with test file paths.</p>
<p>Resolving symlinks for the current directory and during collection was introduced as a bugfix in 3.9.0, but it actually is a new feature which had unfortunate consequences in Windows and surprising results in other platforms.</p>
<p>The team decided to step back on resolving symlinks at all, planning to review this in the future with a more solid solution (see discussion in
<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/6523">#6523</a> for details).</p>
<p>This might break test suites which made use of this feature; the fix is to create a symlink
for the entire test tree, and not only to partial files/tress as it was possible previously.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6505">#6505</a>: <code class="docutils literal notranslate"><span class="pre">Testdir.run().parseoutcomes()</span></code> now always returns the parsed nouns in plural form.</p>
<p>Originally <code class="docutils literal notranslate"><span class="pre">parseoutcomes()</span></code> would always returns the nouns in plural form, but a change
meant to improve the terminal summary by using singular form single items (<code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">warning</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">error</span></code>)
caused an unintended regression by changing the keys returned by <code class="docutils literal notranslate"><span class="pre">parseoutcomes()</span></code>.</p>
<p>Now the API guarantees to always return the plural form, so calls like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">testdir</span><span class="o">.</span><span class="n">runpytest</span><span class="p">()</span>
<span class="n">result</span><span class="o">.</span><span class="n">assert_outcomes</span><span class="p">(</span><span class="n">error</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Need to be changed to:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">testdir</span><span class="o">.</span><span class="n">runpytest</span><span class="p">()</span>
<span class="n">result</span><span class="o">.</span><span class="n">assert_outcomes</span><span class="p">(</span><span class="n">errors</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6903">#6903</a>: The <code class="docutils literal notranslate"><span class="pre">os.dup()</span></code> function is now assumed to exist. We are not aware of any
supported Python 3 implementations which do not provide it.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7040">#7040</a>: <code class="docutils literal notranslate"><span class="pre">-k</span></code> no longer matches against the names of the directories outside the test session root.</p>
<p>Also, <code class="docutils literal notranslate"><span class="pre">pytest.Package.name</span></code> is now just the name of the directory containing the package’s
<code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file, instead of the full path. This is consistent with how the other nodes
are named, and also one of the reasons why <code class="docutils literal notranslate"><span class="pre">-k</span></code> would match against any directory containing
the test suite.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7122">#7122</a>: Expressions given to the <code class="docutils literal notranslate"><span class="pre">-m</span></code> and <code class="docutils literal notranslate"><span class="pre">-k</span></code> options are no longer evaluated using Python’s <a class="reference external" href="https://docs.python.org/3/library/functions.html#eval" title="(in Python v3.13)"><code class="xref py py-func docutils literal notranslate"><span class="pre">eval()</span></code></a>.
The format supports <code class="docutils literal notranslate"><span class="pre">or</span></code>, <code class="docutils literal notranslate"><span class="pre">and</span></code>, <code class="docutils literal notranslate"><span class="pre">not</span></code>, parenthesis and general identifiers to match against.
Python constants, keywords or other operators are no longer evaluated differently.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7135">#7135</a>: Pytest now uses its own <code class="docutils literal notranslate"><span class="pre">TerminalWriter</span></code> class instead of using the one from the <code class="docutils literal notranslate"><span class="pre">py</span></code> library.
Plugins generally access this class through <code class="docutils literal notranslate"><span class="pre">TerminalReporter.writer</span></code>, <code class="docutils literal notranslate"><span class="pre">TerminalReporter.write()</span></code>
(and similar methods), or <code class="docutils literal notranslate"><span class="pre">_pytest.config.create_terminal_writer()</span></code>.</p>
<p>The following breaking changes were made:</p>
<ul class="simple">
<li><p>Output (<code class="docutils literal notranslate"><span class="pre">write()</span></code> method and others) no longer flush implicitly; the flushing behavior
of the underlying file is respected. To flush explicitly (for example, if you
want output to be shown before an end-of-line is printed), use <code class="docutils literal notranslate"><span class="pre">write(flush=True)</span></code> or
<code class="docutils literal notranslate"><span class="pre">terminal_writer.flush()</span></code>.</p></li>
<li><p>Explicit Windows console support was removed, delegated to the colorama library.</p></li>
<li><p>Support for writing <code class="docutils literal notranslate"><span class="pre">bytes</span></code> was removed.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">reline</span></code> method and <code class="docutils literal notranslate"><span class="pre">chars_on_current_line</span></code> property were removed.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">stringio</span></code> and <code class="docutils literal notranslate"><span class="pre">encoding</span></code> arguments was removed.</p></li>
<li><p>Support for passing a callable instead of a file was removed.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7224">#7224</a>: The <code class="docutils literal notranslate"><span class="pre">item.catch_log_handler</span></code> and <code class="docutils literal notranslate"><span class="pre">item.catch_log_handlers</span></code> attributes, set by the
logging plugin and never meant to be public, are no longer available.</p>
<p>The deprecated <code class="docutils literal notranslate"><span class="pre">--no-print-logs</span></code> option and <code class="docutils literal notranslate"><span class="pre">log_print</span></code> ini option are removed. Use <code class="docutils literal notranslate"><span class="pre">--show-capture</span></code> instead.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7226">#7226</a>: Removed the unused <code class="docutils literal notranslate"><span class="pre">args</span></code> parameter from <code class="docutils literal notranslate"><span class="pre">pytest.Function.__init__</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7418">#7418</a>: Removed the <code class="docutils literal notranslate"><span class="pre">pytest_doctest_prepare_content</span></code> hook specification. This hook
hasn’t been triggered by pytest for at least 10 years.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7438">#7438</a>: Some changes were made to the internal <code class="docutils literal notranslate"><span class="pre">_pytest._code.source</span></code>, listed here
for the benefit of plugin authors who may be using it:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">deindent</span></code> argument to <code class="docutils literal notranslate"><span class="pre">Source()</span></code> has been removed, now it is always true.</p></li>
<li><p>Support for zero or multiple arguments to <code class="docutils literal notranslate"><span class="pre">Source()</span></code> has been removed.</p></li>
<li><p>Support for comparing <code class="docutils literal notranslate"><span class="pre">Source</span></code> with an <code class="docutils literal notranslate"><span class="pre">str</span></code> has been removed.</p></li>
<li><p>The methods <code class="docutils literal notranslate"><span class="pre">Source.isparseable()</span></code> and <code class="docutils literal notranslate"><span class="pre">Source.putaround()</span></code> have been removed.</p></li>
<li><p>The method <code class="docutils literal notranslate"><span class="pre">Source.compile()</span></code> and function <code class="docutils literal notranslate"><span class="pre">_pytest._code.compile()</span></code> have
been removed; use plain <code class="docutils literal notranslate"><span class="pre">compile()</span></code> instead.</p></li>
<li><p>The function <code class="docutils literal notranslate"><span class="pre">_pytest._code.source.getsource()</span></code> has been removed; use
<code class="docutils literal notranslate"><span class="pre">Source()</span></code> directly instead.</p></li>
</ul>
</li>
</ul>
</section>
<section id="id509">
<h3>Deprecations<a class="headerlink" href="#id509" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7210">#7210</a>: The special <code class="docutils literal notranslate"><span class="pre">-k</span> <span class="pre">'-expr'</span></code> syntax to <code class="docutils literal notranslate"><span class="pre">-k</span></code> is deprecated. Use <code class="docutils literal notranslate"><span class="pre">-k</span> <span class="pre">'not</span> <span class="pre">expr'</span></code>
instead.</p>
<p>The special <code class="docutils literal notranslate"><span class="pre">-k</span> <span class="pre">'expr:'</span></code> syntax to <code class="docutils literal notranslate"><span class="pre">-k</span></code> is deprecated. Please open an issue
if you use this and want a replacement.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4049">#4049</a>: <code class="docutils literal notranslate"><span class="pre">pytest_warning_captured</span></code> is deprecated in favor of the <code class="docutils literal notranslate"><span class="pre">pytest_warning_recorded</span></code> hook.</p></li>
</ul>
</section>
<section id="id510">
<h3>Features<a class="headerlink" href="#id510" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1556">#1556</a>: pytest now supports <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> files for configuration.</p>
<p>The configuration options is similar to the one available in other formats, but must be defined
in a <code class="docutils literal notranslate"><span class="pre">[tool.pytest.ini_options]</span></code> table to be picked up by pytest:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="c1"># pyproject.toml</span>
<span class="k">[tool.pytest.ini_options]</span>
<span class="n">minversion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;6.0&quot;</span>
<span class="n">addopts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;-ra -q&quot;</span>
<span class="n">testpaths</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;tests&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;integration&quot;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
<p>More information can be found <a class="reference internal" href="reference/customize.html#config-file-formats"><span class="std std-ref">in the docs</span></a>.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3342">#3342</a>: pytest now includes inline type annotations and exposes them to user programs.
Most of the user-facing API is covered, as well as internal code.</p>
<p>If you are running a type checker such as mypy on your tests, you may start
noticing type errors indicating incorrect usage. If you run into an error that
you believe to be incorrect, please let us know in an issue.</p>
<p>The types were developed against mypy version 0.780. Versions before 0.750
are known not to work. We recommend using the latest version. Other type
checkers may work as well, but they are not officially verified to work by
pytest yet.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4049">#4049</a>: Introduced a new hook named <code class="docutils literal notranslate"><span class="pre">pytest_warning_recorded</span></code> to convey information about warnings captured by the internal <code class="docutils literal notranslate"><span class="pre">pytest</span></code> warnings plugin.</p>
<p>This hook is meant to replace <code class="docutils literal notranslate"><span class="pre">pytest_warning_captured</span></code>, which is deprecated and will be removed in a future release.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6471">#6471</a>: New command-line flags:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--no-header</span></code>: disables the initial header, including platform, version, and plugins.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--no-summary</span></code>: disables the final test summary, including warnings.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6856">#6856</a>: A warning is now shown when an unknown key is read from a config INI file.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">--strict-config</span></code> flag has been added to treat these warnings as errors.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6906">#6906</a>: Added <code class="docutils literal notranslate"><span class="pre">--code-highlight</span></code> command line option to enable/disable code highlighting in terminal output.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7245">#7245</a>: New <code class="docutils literal notranslate"><span class="pre">--import-mode=importlib</span></code> option that uses <a class="reference external" href="https://docs.python.org/3/library/importlib.html#module-importlib" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">importlib</span></code></a> to import test modules.</p>
<p>Traditionally pytest used <code class="docutils literal notranslate"><span class="pre">__import__</span></code> while changing <code class="docutils literal notranslate"><span class="pre">sys.path</span></code> to import test modules (which
also changes <code class="docutils literal notranslate"><span class="pre">sys.modules</span></code> as a side-effect), which works but has a number of drawbacks, like requiring test modules
that don’t live in packages to have unique names (as they need to reside under a unique name in <code class="docutils literal notranslate"><span class="pre">sys.modules</span></code>).</p>
<p><code class="docutils literal notranslate"><span class="pre">--import-mode=importlib</span></code> uses more fine-grained import mechanisms from <code class="docutils literal notranslate"><span class="pre">importlib</span></code> which don’t
require pytest to change <code class="docutils literal notranslate"><span class="pre">sys.path</span></code> or <code class="docutils literal notranslate"><span class="pre">sys.modules</span></code> at all, eliminating much of the drawbacks
of the previous mode.</p>
<p>We intend to make <code class="docutils literal notranslate"><span class="pre">--import-mode=importlib</span></code> the default in future versions, so users are encouraged
to try the new mode and provide feedback (both positive or negative) in issue <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7245">#7245</a>.</p>
<p>You can read more about this option in <a class="reference internal" href="explanation/pythonpath.html#import-modes"><span class="std std-ref">the documentation</span></a>.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7305">#7305</a>: New <code class="docutils literal notranslate"><span class="pre">required_plugins</span></code> configuration option allows the user to specify a list of plugins, including version information, that are required for pytest to run. An error is raised if any required plugins are not found when running pytest.</p></li>
</ul>
</section>
<section id="id511">
<h3>Improvements<a class="headerlink" href="#id511" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4375">#4375</a>: The <code class="docutils literal notranslate"><span class="pre">pytest</span></code> command now suppresses the <code class="docutils literal notranslate"><span class="pre">BrokenPipeError</span></code> error message that
is printed to stderr when the output of <code class="docutils literal notranslate"><span class="pre">pytest</span></code> is piped and the pipe is
closed by the piped-to program (common examples are <code class="docutils literal notranslate"><span class="pre">less</span></code> and <code class="docutils literal notranslate"><span class="pre">head</span></code>).</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4391">#4391</a>: Improved precision of test durations measurement. <code class="docutils literal notranslate"><span class="pre">CallInfo</span></code> items now have a new <code class="docutils literal notranslate"><span class="pre">&lt;CallInfo&gt;.duration</span></code> attribute, created using <code class="docutils literal notranslate"><span class="pre">time.perf_counter()</span></code>. This attribute is used to fill the <code class="docutils literal notranslate"><span class="pre">&lt;TestReport&gt;.duration</span></code> attribute, which is more accurate than the previous <code class="docutils literal notranslate"><span class="pre">&lt;CallInfo&gt;.stop</span> <span class="pre">-</span> <span class="pre">&lt;CallInfo&gt;.start</span></code> (as these are based on <code class="docutils literal notranslate"><span class="pre">time.time()</span></code>).</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4675">#4675</a>: Rich comparison for dataclasses and <code class="docutils literal notranslate"><span class="pre">attrs</span></code>-classes is now recursive.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6285">#6285</a>: Exposed the <code class="docutils literal notranslate"><span class="pre">pytest.FixtureLookupError</span></code> exception which is raised by <code class="docutils literal notranslate"><span class="pre">request.getfixturevalue()</span></code>
(where <code class="docutils literal notranslate"><span class="pre">request</span></code> is a <code class="docutils literal notranslate"><span class="pre">FixtureRequest</span></code> fixture) when a fixture with the given name cannot be returned.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6433">#6433</a>: If an error is encountered while formatting the message in a logging call, for
example <code class="docutils literal notranslate"><span class="pre">logging.warning(&quot;oh</span> <span class="pre">no!:</span> <span class="pre">%s:</span> <span class="pre">%s&quot;,</span> <span class="pre">&quot;first&quot;)</span></code> (a second argument is
missing), pytest now propagates the error, likely causing the test to fail.</p>
<p>Previously, such a mistake would cause an error to be printed to stderr, which
is not displayed by default for passing tests. This change makes the mistake
visible during testing.</p>
<p>You may suppress this behavior temporarily or permanently by setting
<code class="docutils literal notranslate"><span class="pre">logging.raiseExceptions</span> <span class="pre">=</span> <span class="pre">False</span></code>.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6817">#6817</a>: Explicit new-lines in help texts of command-line options are preserved, allowing plugins better control
of the help displayed to users.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6940">#6940</a>: When using the <code class="docutils literal notranslate"><span class="pre">--duration</span></code> option, the terminal message output is now more precise about the number and duration of hidden items.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6991">#6991</a>: Collected files are displayed after any reports from hooks, e.g. the status from <code class="docutils literal notranslate"><span class="pre">--lf</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7091">#7091</a>: When <code class="docutils literal notranslate"><span class="pre">fd</span></code> capturing is used, through <code class="docutils literal notranslate"><span class="pre">--capture=fd</span></code> or the <code class="docutils literal notranslate"><span class="pre">capfd</span></code> and
<code class="docutils literal notranslate"><span class="pre">capfdbinary</span></code> fixtures, and the file descriptor (0, 1, 2) cannot be
duplicated, FD capturing is still performed. Previously, direct writes to the
file descriptors would fail or be lost in this case.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7119">#7119</a>: Exit with an error if the <code class="docutils literal notranslate"><span class="pre">--basetemp</span></code> argument is empty, is the current working directory or is one of the parent directories.
This is done to protect against accidental data loss, as any directory passed to this argument is cleared.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7128">#7128</a>: <code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">--version</span></code> now displays just the pytest version, while <code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">--version</span> <span class="pre">--version</span></code> displays more verbose information including plugins. This is more consistent with how other tools show <code class="docutils literal notranslate"><span class="pre">--version</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7133">#7133</a>: <a class="reference internal" href="reference/reference.html#pytest.LogCaptureFixture.set_level" title="pytest.LogCaptureFixture.set_level"><code class="xref py py-meth docutils literal notranslate"><span class="pre">caplog.set_level()</span></code></a> will now override any <a class="reference internal" href="reference/reference.html#confval-26"><code class="xref std std-confval docutils literal notranslate"><span class="pre">log_level</span></code></a> set via the CLI or configuration file.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7159">#7159</a>: <a class="reference internal" href="reference/reference.html#pytest.LogCaptureFixture.set_level" title="pytest.LogCaptureFixture.set_level"><code class="xref py py-meth docutils literal notranslate"><span class="pre">caplog.set_level()</span></code></a> and <a class="reference internal" href="reference/reference.html#pytest.LogCaptureFixture.at_level" title="pytest.LogCaptureFixture.at_level"><code class="xref py py-meth docutils literal notranslate"><span class="pre">caplog.at_level()</span></code></a> no longer affect
the level of logs that are shown in the <em>Captured log report</em> report section.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7348">#7348</a>: Improve recursive diff report for comparison asserts on dataclasses / attrs.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7385">#7385</a>: <code class="docutils literal notranslate"><span class="pre">--junitxml</span></code> now includes the exception cause in the <code class="docutils literal notranslate"><span class="pre">message</span></code> XML attribute for failures during setup and teardown.</p>
<p>Previously:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;error</span><span class="w"> </span><span class="na">message=</span><span class="s">&quot;test setup failure&quot;</span><span class="nt">&gt;</span>
</pre></div>
</div>
<p>Now:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;error</span><span class="w"> </span><span class="na">message=</span><span class="s">&quot;failed on setup with &amp;quot;ValueError: Some error during setup&amp;quot;&quot;</span><span class="nt">&gt;</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="id512">
<h3>Bug Fixes<a class="headerlink" href="#id512" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1120">#1120</a>: Fix issue where directories from <a class="reference internal" href="reference/reference.html#std-fixture-tmpdir"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">tmpdir</span></code></a> are not removed properly when multiple instances of pytest are running in parallel.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4583">#4583</a>: Prevent crashing and provide a user-friendly error when a marker expression (<code class="docutils literal notranslate"><span class="pre">-m</span></code>) invoking of <a class="reference external" href="https://docs.python.org/3/library/functions.html#eval" title="(in Python v3.13)"><code class="xref py py-func docutils literal notranslate"><span class="pre">eval()</span></code></a> raises any exception.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4677">#4677</a>: The path shown in the summary report for SKIPPED tests is now always relative. Previously it was sometimes absolute.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5456">#5456</a>: Fix a possible race condition when trying to remove lock files used to control access to folders
created by <a class="reference internal" href="reference/reference.html#std:fixture-3"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">tmp_path</span></code></a> and <a class="reference internal" href="reference/reference.html#std-fixture-tmpdir"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">tmpdir</span></code></a>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6240">#6240</a>: Fixes an issue where logging during collection step caused duplication of log
messages to stderr.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6428">#6428</a>: Paths appearing in error messages are now correct in case the current working directory has
changed since the start of the session.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6755">#6755</a>: Support deleting paths longer than 260 characters on windows created inside <a class="reference internal" href="reference/reference.html#std-fixture-tmpdir"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">tmpdir</span></code></a>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6871">#6871</a>: Fix crash with captured output when using <a class="reference internal" href="reference/reference.html#std-fixture-capsysbinary"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">capsysbinary</span></code></a>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6909">#6909</a>: Revert the change introduced by <a class="reference external" href="https://github.com/pytest-dev/pytest/pull/6330">#6330</a>, which required all arguments to <code class="docutils literal notranslate"><span class="pre">&#64;pytest.mark.parametrize</span></code> to be explicitly defined in the function signature.</p>
<p>The intention of the original change was to remove what was expected to be an unintended/surprising behavior, but it turns out many people relied on it, so the restriction has been reverted.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6910">#6910</a>: Fix crash when plugins return an unknown stats while using the <code class="docutils literal notranslate"><span class="pre">--reportlog</span></code> option.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6924">#6924</a>: Ensure a <code class="docutils literal notranslate"><span class="pre">unittest.IsolatedAsyncioTestCase</span></code> is actually awaited.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6925">#6925</a>: Fix <code class="docutils literal notranslate"><span class="pre">TerminalRepr</span></code> instances to be hashable again.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6947">#6947</a>: Fix regression where functions registered with <a class="reference external" href="https://docs.python.org/3/library/unittest.html#unittest.TestCase.addCleanup" title="(in Python v3.13)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">unittest.TestCase.addCleanup()</span></code></a> were not being called on test failures.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6951">#6951</a>: Allow users to still set the deprecated <code class="docutils literal notranslate"><span class="pre">TerminalReporter.writer</span></code> attribute.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6956">#6956</a>: Prevent pytest from printing <code class="docutils literal notranslate"><span class="pre">ConftestImportFailure</span></code> traceback to stdout.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6991">#6991</a>: Fix regressions with <code class="docutils literal notranslate"><span class="pre">--lf</span></code> filtering too much since pytest 5.4.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6992">#6992</a>: Revert “tmpdir: clean up indirection via config for factories” <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6767">#6767</a> as it breaks pytest-xdist.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7061">#7061</a>: When a yielding fixture fails to yield a value, report a test setup error instead of crashing.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7076">#7076</a>: The path of file skipped by <code class="docutils literal notranslate"><span class="pre">&#64;pytest.mark.skip</span></code> in the SKIPPED report is now relative to invocation directory. Previously it was relative to root directory.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7110">#7110</a>: Fixed regression: <code class="docutils literal notranslate"><span class="pre">asyncbase.TestCase</span></code> tests are executed correctly again.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7126">#7126</a>: <code class="docutils literal notranslate"><span class="pre">--setup-show</span></code> now doesn’t raise an error when a bytes value is used as a <code class="docutils literal notranslate"><span class="pre">parametrize</span></code>
parameter when Python is called with the <code class="docutils literal notranslate"><span class="pre">-bb</span></code> flag.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7143">#7143</a>: Fix <a class="reference internal" href="reference/reference.html#pytest.nodes.Node.from_parent" title="_pytest.nodes.Node.from_parent"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pytest.File.from_parent</span></code></a> so it forwards extra keyword arguments to the constructor.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7145">#7145</a>: Classes with broken <code class="docutils literal notranslate"><span class="pre">__getattribute__</span></code> methods are displayed correctly during failures.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7150">#7150</a>: Prevent hiding the underlying exception when <code class="docutils literal notranslate"><span class="pre">ConfTestImportFailure</span></code> is raised.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7180">#7180</a>: Fix <code class="docutils literal notranslate"><span class="pre">_is_setup_py</span></code> for files encoded differently than locale.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7215">#7215</a>: Fix regression where running with <code class="docutils literal notranslate"><span class="pre">--pdb</span></code> would call <a class="reference external" href="https://docs.python.org/3/library/unittest.html#unittest.TestCase.tearDown" title="(in Python v3.13)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">unittest.TestCase.tearDown()</span></code></a> for skipped tests.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7253">#7253</a>: When using <code class="docutils literal notranslate"><span class="pre">pytest.fixture</span></code> on a function directly, as in <code class="docutils literal notranslate"><span class="pre">pytest.fixture(func)</span></code>,
if the <code class="docutils literal notranslate"><span class="pre">autouse</span></code> or <code class="docutils literal notranslate"><span class="pre">params</span></code> arguments are also passed, the function is no longer
ignored, but is marked as a fixture.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7360">#7360</a>: Fix possibly incorrect evaluation of string expressions passed to <code class="docutils literal notranslate"><span class="pre">pytest.mark.skipif</span></code> and <code class="docutils literal notranslate"><span class="pre">pytest.mark.xfail</span></code>,
in rare circumstances where the exact same string is used but refers to different global values.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7383">#7383</a>: Fixed exception causes all over the codebase, i.e. use <code class="docutils literal notranslate"><span class="pre">raise</span> <span class="pre">new_exception</span> <span class="pre">from</span> <span class="pre">old_exception</span></code> when wrapping an exception.</p></li>
</ul>
</section>
<section id="id513">
<h3>Improved Documentation<a class="headerlink" href="#id513" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7202">#7202</a>: The development guide now links to the contributing section of the docs and <code class="docutils literal notranslate"><span class="pre">RELEASING.rst</span></code> on GitHub.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7233">#7233</a>: Add a note about <code class="docutils literal notranslate"><span class="pre">--strict</span></code> and <code class="docutils literal notranslate"><span class="pre">--strict-markers</span></code> and the preference for the latter one.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7345">#7345</a>: Explain indirect parametrization and markers for fixtures.</p></li>
</ul>
</section>
<section id="id514">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id514" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7035">#7035</a>: The <code class="docutils literal notranslate"><span class="pre">originalname</span></code> attribute of <code class="docutils literal notranslate"><span class="pre">_pytest.python.Function</span></code> now defaults to <code class="docutils literal notranslate"><span class="pre">name</span></code> if not
provided explicitly, and is always set.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7264">#7264</a>: The dependency on the <code class="docutils literal notranslate"><span class="pre">wcwidth</span></code> package has been removed.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7291">#7291</a>: Replaced <code class="docutils literal notranslate"><span class="pre">py.iniconfig</span></code> with <a class="reference external" href="https://pypi.org/project/iniconfig">iniconfig</a>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7295">#7295</a>: <code class="docutils literal notranslate"><span class="pre">src/_pytest/config/__init__.py</span></code> now uses the <code class="docutils literal notranslate"><span class="pre">warnings</span></code> module to report warnings instead of <code class="docutils literal notranslate"><span class="pre">sys.stderr.write</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7356">#7356</a>: Remove last internal uses of deprecated <em>slave</em> term from old <code class="docutils literal notranslate"><span class="pre">pytest-xdist</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7357">#7357</a>: <code class="docutils literal notranslate"><span class="pre">py</span></code>&gt;=1.8.2 is now required.</p></li>
</ul>
</section>
</section>
<section id="pytest-5-4-3-2020-06-02">
<h2>pytest 5.4.3 (2020-06-02)<a class="headerlink" href="#pytest-5-4-3-2020-06-02" title="Link to this heading">¶</a></h2>
<section id="id515">
<h3>Bug Fixes<a class="headerlink" href="#id515" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6428">#6428</a>: Paths appearing in error messages are now correct in case the current working directory has
changed since the start of the session.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6755">#6755</a>: Support deleting paths longer than 260 characters on windows created inside tmpdir.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6956">#6956</a>: Prevent pytest from printing ConftestImportFailure traceback to stdout.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7150">#7150</a>: Prevent hiding the underlying exception when <code class="docutils literal notranslate"><span class="pre">ConfTestImportFailure</span></code> is raised.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7215">#7215</a>: Fix regression where running with <code class="docutils literal notranslate"><span class="pre">--pdb</span></code> would call the <code class="docutils literal notranslate"><span class="pre">tearDown</span></code> methods of <code class="docutils literal notranslate"><span class="pre">unittest.TestCase</span></code>
subclasses for skipped tests.</p></li>
</ul>
</section>
</section>
<section id="pytest-5-4-2-2020-05-08">
<h2>pytest 5.4.2 (2020-05-08)<a class="headerlink" href="#pytest-5-4-2-2020-05-08" title="Link to this heading">¶</a></h2>
<section id="id516">
<h3>Bug Fixes<a class="headerlink" href="#id516" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6871">#6871</a>: Fix crash with captured output when using the <a class="reference internal" href="reference/reference.html#std-fixture-capsysbinary"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">capsysbinary</span> <span class="pre">fixture</span></code></a>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6924">#6924</a>: Ensure a <code class="docutils literal notranslate"><span class="pre">unittest.IsolatedAsyncioTestCase</span></code> is actually awaited.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6925">#6925</a>: Fix TerminalRepr instances to be hashable again.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6947">#6947</a>: Fix regression where functions registered with <code class="docutils literal notranslate"><span class="pre">TestCase.addCleanup</span></code> were not being called on test failures.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6951">#6951</a>: Allow users to still set the deprecated <code class="docutils literal notranslate"><span class="pre">TerminalReporter.writer</span></code> attribute.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6992">#6992</a>: Revert “tmpdir: clean up indirection via config for factories” #6767 as it breaks pytest-xdist.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7110">#7110</a>: Fixed regression: <code class="docutils literal notranslate"><span class="pre">asyncbase.TestCase</span></code> tests are executed correctly again.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7143">#7143</a>: Fix <code class="docutils literal notranslate"><span class="pre">File.from_parent</span></code> so it forwards extra keyword arguments to the constructor.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7145">#7145</a>: Classes with broken <code class="docutils literal notranslate"><span class="pre">__getattribute__</span></code> methods are displayed correctly during failures.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7180">#7180</a>: Fix <code class="docutils literal notranslate"><span class="pre">_is_setup_py</span></code> for files encoded differently than locale.</p></li>
</ul>
</section>
</section>
<section id="pytest-5-4-1-2020-03-13">
<h2>pytest 5.4.1 (2020-03-13)<a class="headerlink" href="#pytest-5-4-1-2020-03-13" title="Link to this heading">¶</a></h2>
<section id="id517">
<h3>Bug Fixes<a class="headerlink" href="#id517" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6909">#6909</a>: Revert the change introduced by <a class="reference external" href="https://github.com/pytest-dev/pytest/pull/6330">#6330</a>, which required all arguments to <code class="docutils literal notranslate"><span class="pre">&#64;pytest.mark.parametrize</span></code> to be explicitly defined in the function signature.</p>
<p>The intention of the original change was to remove what was expected to be an unintended/surprising behavior, but it turns out many people relied on it, so the restriction has been reverted.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6910">#6910</a>: Fix crash when plugins return an unknown stats while using the <code class="docutils literal notranslate"><span class="pre">--reportlog</span></code> option.</p></li>
</ul>
</section>
</section>
<section id="pytest-5-4-0-2020-03-12">
<h2>pytest 5.4.0 (2020-03-12)<a class="headerlink" href="#pytest-5-4-0-2020-03-12" title="Link to this heading">¶</a></h2>
<section id="id518">
<h3>Breaking Changes<a class="headerlink" href="#id518" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6316">#6316</a>: Matching of <code class="docutils literal notranslate"><span class="pre">-k</span> <span class="pre">EXPRESSION</span></code> to test names is now case-insensitive.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6443">#6443</a>: Plugins specified with <code class="docutils literal notranslate"><span class="pre">-p</span></code> are now loaded after internal plugins, which results in their hooks being called <em>before</em> the internal ones.</p>
<p>This makes the <code class="docutils literal notranslate"><span class="pre">-p</span></code> behavior consistent with <code class="docutils literal notranslate"><span class="pre">PYTEST_PLUGINS</span></code>.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6637">#6637</a>: Removed the long-deprecated <code class="docutils literal notranslate"><span class="pre">pytest_itemstart</span></code> hook.</p>
<p>This hook has been marked as deprecated and not been even called by pytest for over 10 years now.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6673">#6673</a>: Reversed / fix meaning of “+/-” in error diffs.  “-” means that something expected is missing in the result and “+” means that there are unexpected extras in the result.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6737">#6737</a>: The <code class="docutils literal notranslate"><span class="pre">cached_result</span></code> attribute of <code class="docutils literal notranslate"><span class="pre">FixtureDef</span></code> is now set to <code class="docutils literal notranslate"><span class="pre">None</span></code> when
the result is unavailable, instead of being deleted.</p>
<p>If your plugin performs checks like <code class="docutils literal notranslate"><span class="pre">hasattr(fixturedef,</span> <span class="pre">'cached_result')</span></code>,
for example in a <code class="docutils literal notranslate"><span class="pre">pytest_fixture_post_finalizer</span></code> hook implementation, replace
it with <code class="docutils literal notranslate"><span class="pre">fixturedef.cached_result</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">None</span></code>. If you <code class="docutils literal notranslate"><span class="pre">del</span></code> the attribute,
set it to <code class="docutils literal notranslate"><span class="pre">None</span></code> instead.</p>
</li>
</ul>
</section>
<section id="id519">
<h3>Deprecations<a class="headerlink" href="#id519" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3238">#3238</a>: Option <code class="docutils literal notranslate"><span class="pre">--no-print-logs</span></code> is deprecated and meant to be removed in a future release. If you use <code class="docutils literal notranslate"><span class="pre">--no-print-logs</span></code>, please try out <code class="docutils literal notranslate"><span class="pre">--show-capture</span></code> and
provide feedback.</p>
<p><code class="docutils literal notranslate"><span class="pre">--show-capture</span></code> command-line option was added in <code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">3.5.0</span></code> and allows to specify how to
display captured output when tests fail: <code class="docutils literal notranslate"><span class="pre">no</span></code>, <code class="docutils literal notranslate"><span class="pre">stdout</span></code>, <code class="docutils literal notranslate"><span class="pre">stderr</span></code>, <code class="docutils literal notranslate"><span class="pre">log</span></code> or <code class="docutils literal notranslate"><span class="pre">all</span></code> (the default).</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/571">#571</a>: Deprecate the unused/broken <code class="docutils literal notranslate"><span class="pre">pytest_collect_directory</span></code> hook.
It was misaligned since the removal of the <code class="docutils literal notranslate"><span class="pre">Directory</span></code> collector in 2010
and incorrect/unusable as soon as collection was split from test execution.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5975">#5975</a>: Deprecate using direct constructors for <code class="docutils literal notranslate"><span class="pre">Nodes</span></code>.</p>
<p>Instead they are now constructed via <code class="docutils literal notranslate"><span class="pre">Node.from_parent</span></code>.</p>
<p>This transitional mechanism enables us to untangle the very intensely
entangled <code class="docutils literal notranslate"><span class="pre">Node</span></code> relationships by enforcing more controlled creation/configuration patterns.</p>
<p>As part of this change, session/config are already disallowed parameters and as we work on the details we might need disallow a few more as well.</p>
<p>Subclasses are expected to use <code class="docutils literal notranslate"><span class="pre">super().from_parent</span></code> if they intend to expand the creation of <code class="docutils literal notranslate"><span class="pre">Nodes</span></code>.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6779">#6779</a>: The <code class="docutils literal notranslate"><span class="pre">TerminalReporter.writer</span></code> attribute has been deprecated and should no longer be used. This
was inadvertently exposed as part of the public API of that plugin and ties it too much
with <code class="docutils literal notranslate"><span class="pre">py.io.TerminalWriter</span></code>.</p></li>
</ul>
</section>
<section id="id520">
<h3>Features<a class="headerlink" href="#id520" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4597">#4597</a>: New <a class="reference internal" href="how-to/capture-stdout-stderr.html#capture-method"><span class="std std-ref">–capture=tee-sys</span></a> option to allow both live printing and capturing of test output.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5712">#5712</a>: Now all arguments to <code class="docutils literal notranslate"><span class="pre">&#64;pytest.mark.parametrize</span></code> need to be explicitly declared in the function signature or via <code class="docutils literal notranslate"><span class="pre">indirect</span></code>.
Previously it was possible to omit an argument if a fixture with the same name existed, which was just an accident of implementation and was not meant to be a part of the API.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6454">#6454</a>: Changed default for <code class="docutils literal notranslate"><span class="pre">-r</span></code> to <code class="docutils literal notranslate"><span class="pre">fE</span></code>, which displays failures and errors in the <a class="reference internal" href="how-to/output.html#pytest-detailed-failed-tests-usage"><span class="std std-ref">short test summary</span></a>.  <code class="docutils literal notranslate"><span class="pre">-rN</span></code> can be used to disable it (the old behavior).</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6469">#6469</a>: New options have been added to the <a class="reference internal" href="reference/reference.html#confval-12"><code class="xref std std-confval docutils literal notranslate"><span class="pre">junit_logging</span></code></a> option: <code class="docutils literal notranslate"><span class="pre">log</span></code>, <code class="docutils literal notranslate"><span class="pre">out-err</span></code>, and <code class="docutils literal notranslate"><span class="pre">all</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6834">#6834</a>: Excess warning summaries are now collapsed per file to ensure readable display of warning summaries.</p></li>
</ul>
</section>
<section id="id521">
<h3>Improvements<a class="headerlink" href="#id521" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1857">#1857</a>: <code class="docutils literal notranslate"><span class="pre">pytest.mark.parametrize</span></code> accepts integers for <code class="docutils literal notranslate"><span class="pre">ids</span></code> again, converting it to strings.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/449">#449</a>: Use “yellow” main color with any XPASSED tests.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4639">#4639</a>: Revert “A warning is now issued when assertions are made for <code class="docutils literal notranslate"><span class="pre">None</span></code>”.</p>
<p>The warning proved to be less useful than initially expected and had quite a
few false positive cases.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5686">#5686</a>: <code class="docutils literal notranslate"><span class="pre">tmpdir_factory.mktemp</span></code> now fails when given absolute and non-normalized paths.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5984">#5984</a>: The <code class="docutils literal notranslate"><span class="pre">pytest_warning_captured</span></code> hook now receives a <code class="docutils literal notranslate"><span class="pre">location</span></code> parameter with the code location that generated the warning.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6213">#6213</a>: pytester: the <code class="docutils literal notranslate"><span class="pre">testdir</span></code> fixture respects environment settings from the <code class="docutils literal notranslate"><span class="pre">monkeypatch</span></code> fixture for inner runs.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6247">#6247</a>: <code class="docutils literal notranslate"><span class="pre">--fulltrace</span></code> is honored with collection errors.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6384">#6384</a>: Make <code class="docutils literal notranslate"><span class="pre">--showlocals</span></code> work also with <code class="docutils literal notranslate"><span class="pre">--tb=short</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6653">#6653</a>: Add support for matching lines consecutively with <a class="reference internal" href="reference/reference.html#id60" title="pytest.LineMatcher"><code class="xref py py-class docutils literal notranslate"><span class="pre">LineMatcher</span></code></a>’s <a class="reference internal" href="reference/reference.html#id65" title="pytest.LineMatcher.fnmatch_lines"><code class="xref py py-func docutils literal notranslate"><span class="pre">fnmatch_lines()</span></code></a> and <a class="reference internal" href="reference/reference.html#id66" title="pytest.LineMatcher.re_match_lines"><code class="xref py py-func docutils literal notranslate"><span class="pre">re_match_lines()</span></code></a>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6658">#6658</a>: Code is now highlighted in tracebacks when <code class="docutils literal notranslate"><span class="pre">pygments</span></code> is installed.</p>
<p>Users are encouraged to install <code class="docutils literal notranslate"><span class="pre">pygments</span></code> into their environment and provide feedback, because
the plan is to make <code class="docutils literal notranslate"><span class="pre">pygments</span></code> a regular dependency in the future.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6795">#6795</a>: Import usage error message with invalid <code class="docutils literal notranslate"><span class="pre">-o</span></code> option.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/759">#759</a>: <code class="docutils literal notranslate"><span class="pre">pytest.mark.parametrize</span></code> supports iterators and generators for <code class="docutils literal notranslate"><span class="pre">ids</span></code>.</p></li>
</ul>
</section>
<section id="id522">
<h3>Bug Fixes<a class="headerlink" href="#id522" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/310">#310</a>: Add support for calling <code class="docutils literal notranslate"><span class="pre">pytest.xfail()</span></code> and <code class="docutils literal notranslate"><span class="pre">pytest.importorskip()</span></code> with doctests.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3823">#3823</a>: <code class="docutils literal notranslate"><span class="pre">--trace</span></code> now works with unittests.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4445">#4445</a>: Fixed some warning reports produced by pytest to point to the correct location of the warning in the user’s code.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5301">#5301</a>: Fix <code class="docutils literal notranslate"><span class="pre">--last-failed</span></code> to collect new tests from files with known failures.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5928">#5928</a>: Report <code class="docutils literal notranslate"><span class="pre">PytestUnknownMarkWarning</span></code> at the level of the user’s code, not <code class="docutils literal notranslate"><span class="pre">pytest</span></code>’s.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5991">#5991</a>: Fix interaction with <code class="docutils literal notranslate"><span class="pre">--pdb</span></code> and unittests: do not use unittest’s <code class="docutils literal notranslate"><span class="pre">TestCase.debug()</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6334">#6334</a>: Fix summary entries appearing twice when <code class="docutils literal notranslate"><span class="pre">f/F</span></code> and <code class="docutils literal notranslate"><span class="pre">s/S</span></code> report chars were used at the same time in the <code class="docutils literal notranslate"><span class="pre">-r</span></code> command-line option (for example <code class="docutils literal notranslate"><span class="pre">-rFf</span></code>).</p>
<p>The upper case variants were never documented and the preferred form should be the lower case.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6409">#6409</a>: Fallback to green (instead of yellow) for non-last items without previous passes with colored terminal progress indicator.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6454">#6454</a>: <code class="docutils literal notranslate"><span class="pre">--disable-warnings</span></code> is honored with <code class="docutils literal notranslate"><span class="pre">-ra</span></code> and <code class="docutils literal notranslate"><span class="pre">-rA</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6497">#6497</a>: Fix bug in the comparison of request key with cached key in fixture.</p>
<p>A construct <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">key</span> <span class="pre">==</span> <span class="pre">cached_key:</span></code> can fail either because <code class="docutils literal notranslate"><span class="pre">==</span></code> is explicitly disallowed, or for, e.g., NumPy arrays, where the result of <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">==</span> <span class="pre">b</span></code> cannot generally be converted to <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>.
The implemented fix replaces <code class="docutils literal notranslate"><span class="pre">==</span></code> with <code class="docutils literal notranslate"><span class="pre">is</span></code>.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6557">#6557</a>: Make capture output streams <code class="docutils literal notranslate"><span class="pre">.write()</span></code> method return the same return value from original streams.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6566">#6566</a>: Fix <code class="docutils literal notranslate"><span class="pre">EncodedFile.writelines</span></code> to call the underlying buffer’s <code class="docutils literal notranslate"><span class="pre">writelines</span></code> method.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6575">#6575</a>: Fix internal crash when <code class="docutils literal notranslate"><span class="pre">faulthandler</span></code> starts initialized
(for example with <code class="docutils literal notranslate"><span class="pre">PYTHONFAULTHANDLER=1</span></code> environment variable set) and <code class="docutils literal notranslate"><span class="pre">faulthandler_timeout</span></code> defined
in the configuration file.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6597">#6597</a>: Fix node ids which contain a parametrized empty-string variable.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6646">#6646</a>: Assertion rewriting hooks are (re)stored for the current item, which fixes them being still used after e.g. pytester’s <code class="docutils literal notranslate"><span class="pre">testdir.runpytest</span></code> etc.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6660">#6660</a>: <a class="reference internal" href="reference/reference.html#pytest.exit" title="pytest.exit"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.exit()</span></code></a> is handled when emitted from the <a class="reference internal" href="reference/reference.html#std:hook-8"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_sessionfinish</span></code></a> hook.  This includes quitting from a debugger.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6752">#6752</a>: When <a class="reference internal" href="reference/reference.html#pytest.raises" title="pytest.raises"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.raises()</span></code></a> is used as a function (as opposed to a context manager),
a <code class="docutils literal notranslate"><span class="pre">match</span></code> keyword argument is now passed through to the tested function. Previously
it was swallowed and ignored (regression in pytest 5.1.0).</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6801">#6801</a>: Do not display empty lines in between traceback for unexpected exceptions with doctests.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6802">#6802</a>: The <a class="reference internal" href="reference/reference.html#std:fixture-2"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">testdir</span> <span class="pre">fixture</span></code></a> works within doctests now.</p></li>
</ul>
</section>
<section id="id523">
<h3>Improved Documentation<a class="headerlink" href="#id523" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6696">#6696</a>: Add list of fixtures to start of fixture chapter.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6742">#6742</a>: Expand first sentence on fixtures into a paragraph.</p></li>
</ul>
</section>
<section id="id524">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id524" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6404">#6404</a>: Remove usage of <code class="docutils literal notranslate"><span class="pre">parser</span></code> module, deprecated in Python 3.9.</p></li>
</ul>
</section>
</section>
<section id="pytest-5-3-5-2020-01-29">
<h2>pytest 5.3.5 (2020-01-29)<a class="headerlink" href="#pytest-5-3-5-2020-01-29" title="Link to this heading">¶</a></h2>
<section id="id525">
<h3>Bug Fixes<a class="headerlink" href="#id525" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6517">#6517</a>: Fix regression in pytest 5.3.4 causing an INTERNALERROR due to a wrong assertion.</p></li>
</ul>
</section>
</section>
<section id="pytest-5-3-4-2020-01-20">
<h2>pytest 5.3.4 (2020-01-20)<a class="headerlink" href="#pytest-5-3-4-2020-01-20" title="Link to this heading">¶</a></h2>
<section id="id526">
<h3>Bug Fixes<a class="headerlink" href="#id526" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6496">#6496</a>: Revert <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6436">#6436</a>: unfortunately this change has caused a number of regressions in many suites,
so the team decided to revert this change and make a new release while we continue to look for a solution.</p></li>
</ul>
</section>
</section>
<section id="pytest-5-3-3-2020-01-16">
<h2>pytest 5.3.3 (2020-01-16)<a class="headerlink" href="#pytest-5-3-3-2020-01-16" title="Link to this heading">¶</a></h2>
<section id="id527">
<h3>Bug Fixes<a class="headerlink" href="#id527" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2780">#2780</a>: Captured output during teardown is shown with <code class="docutils literal notranslate"><span class="pre">-rP</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5971">#5971</a>: Fix a <code class="docutils literal notranslate"><span class="pre">pytest-xdist</span></code> crash when dealing with exceptions raised in subprocesses created by the
<code class="docutils literal notranslate"><span class="pre">multiprocessing</span></code> module.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6436">#6436</a>: <a class="reference internal" href="reference/reference.html#pytest.FixtureDef" title="pytest.FixtureDef"><code class="xref py py-class docutils literal notranslate"><span class="pre">FixtureDef</span></code></a> objects now properly register their finalizers with autouse and
parameterized fixtures that execute before them in the fixture stack so they are torn
down at the right times, and in the right order.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6532">#6532</a>: Fix parsing of outcomes containing multiple errors with <code class="docutils literal notranslate"><span class="pre">testdir</span></code> results (regression in 5.3.0).</p></li>
</ul>
</section>
<section id="id528">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id528" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6350">#6350</a>: Optimized automatic renaming of test parameter IDs.</p></li>
</ul>
</section>
</section>
<section id="pytest-5-3-2-2019-12-13">
<h2>pytest 5.3.2 (2019-12-13)<a class="headerlink" href="#pytest-5-3-2-2019-12-13" title="Link to this heading">¶</a></h2>
<section id="id529">
<h3>Improvements<a class="headerlink" href="#id529" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4639">#4639</a>: Revert “A warning is now issued when assertions are made for <code class="docutils literal notranslate"><span class="pre">None</span></code>”.</p>
<p>The warning proved to be less useful than initially expected and had quite a
few false positive cases.</p>
</li>
</ul>
</section>
<section id="id530">
<h3>Bug Fixes<a class="headerlink" href="#id530" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5430">#5430</a>: junitxml: Logs for failed test are now passed to junit report in case the test fails during call phase.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6290">#6290</a>: The supporting files in the <code class="docutils literal notranslate"><span class="pre">.pytest_cache</span></code> directory are kept with <code class="docutils literal notranslate"><span class="pre">--cache-clear</span></code>, which only clears cached values now.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6301">#6301</a>: Fix assertion rewriting for egg-based distributions and <code class="docutils literal notranslate"><span class="pre">editable</span></code> installs (<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">--editable</span></code>).</p></li>
</ul>
</section>
</section>
<section id="pytest-5-3-1-2019-11-25">
<h2>pytest 5.3.1 (2019-11-25)<a class="headerlink" href="#pytest-5-3-1-2019-11-25" title="Link to this heading">¶</a></h2>
<section id="id531">
<h3>Improvements<a class="headerlink" href="#id531" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6231">#6231</a>: Improve check for misspelling of <a class="reference internal" href="reference/reference.html#pytest-mark-parametrize-ref"><span class="std std-ref">pytest.mark.parametrize</span></a>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6257">#6257</a>: Handle <a class="reference internal" href="reference/reference.html#pytest.exit" title="pytest.exit"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.exit()</span></code></a> being used via <a class="reference internal" href="reference/reference.html#std-hook-pytest_internalerror"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_internalerror</span></code></a>, e.g. when quitting pdb from post mortem.</p></li>
</ul>
</section>
<section id="id532">
<h3>Bug Fixes<a class="headerlink" href="#id532" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5914">#5914</a>: pytester: fix <a class="reference internal" href="reference/reference.html#id67" title="pytest.LineMatcher.no_fnmatch_line"><code class="xref py py-func docutils literal notranslate"><span class="pre">no_fnmatch_line()</span></code></a> when used after positive matching.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6082">#6082</a>: Fix line detection for doctest samples inside
<a class="reference external" href="https://docs.python.org/3/library/functions.html#property" title="(in Python v3.13)"><code class="docutils literal notranslate"><span class="pre">property</span></code></a> docstrings, as a workaround to
<a class="reference external" href="https://github.com/python/cpython/issues/61648">python/cpython#61648</a>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6254">#6254</a>: Fix compatibility with pytest-parallel (regression in pytest 5.3.0).</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6255">#6255</a>: Clear the <a class="reference external" href="https://docs.python.org/3/library/sys.html#sys.last_traceback" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.last_traceback</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/sys.html#sys.last_type" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.last_type</span></code></a>
and <a class="reference external" href="https://docs.python.org/3/library/sys.html#sys.last_value" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.last_value</span></code></a> attributes by deleting them instead
of setting them to <code class="docutils literal notranslate"><span class="pre">None</span></code>. This better matches the behaviour of
the Python standard library.</p></li>
</ul>
</section>
</section>
<section id="pytest-5-3-0-2019-11-19">
<h2>pytest 5.3.0 (2019-11-19)<a class="headerlink" href="#pytest-5-3-0-2019-11-19" title="Link to this heading">¶</a></h2>
<section id="id533">
<h3>Deprecations<a class="headerlink" href="#id533" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6179">#6179</a>: The default value of <a class="reference internal" href="reference/reference.html#confval-11"><code class="xref std std-confval docutils literal notranslate"><span class="pre">junit_family</span></code></a> option will change to <code class="docutils literal notranslate"><span class="pre">&quot;xunit2&quot;</span></code> in pytest 6.0, given
that this is the version supported by default in modern tools that manipulate this type of file.</p>
<p>In order to smooth the transition, pytest will issue a warning in case the <code class="docutils literal notranslate"><span class="pre">--junitxml</span></code> option
is given in the command line but <a class="reference internal" href="reference/reference.html#confval-11"><code class="xref std std-confval docutils literal notranslate"><span class="pre">junit_family</span></code></a> is not explicitly configured in <code class="docutils literal notranslate"><span class="pre">pytest.ini</span></code>.</p>
<p>For more information, <a class="reference internal" href="deprecations.html#junit-family-changed-default-value"><span class="std std-ref">see the docs</span></a>.</p>
</li>
</ul>
</section>
<section id="id534">
<h3>Features<a class="headerlink" href="#id534" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4488">#4488</a>: The pytest team has created the <a class="reference external" href="https://github.com/pytest-dev/pytest-reportlog">pytest-reportlog</a>
plugin, which provides a new <code class="docutils literal notranslate"><span class="pre">--report-log=FILE</span></code> option that writes <em>report logs</em> into a file as the test session executes.</p>
<p>Each line of the report log contains a self contained JSON object corresponding to a testing event,
such as a collection or a test result report. The file is guaranteed to be flushed after writing
each line, so systems can read and process events in real-time.</p>
<p>The plugin is meant to replace the <code class="docutils literal notranslate"><span class="pre">--resultlog</span></code> option, which is deprecated and meant to be removed
in a future release. If you use <code class="docutils literal notranslate"><span class="pre">--resultlog</span></code>, please try out <code class="docutils literal notranslate"><span class="pre">pytest-reportlog</span></code> and
provide feedback.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4730">#4730</a>: When <a class="reference external" href="https://docs.python.org/3/library/sys.html#sys.pycache_prefix" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.pycache_prefix</span></code></a> (Python 3.8+) is set, it will be used by pytest to cache test files changed by the assertion rewriting mechanism.</p>
<p>This makes it easier to benefit of cached <code class="docutils literal notranslate"><span class="pre">.pyc</span></code> files even on file systems without permissions.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5515">#5515</a>: Allow selective auto-indentation of multiline log messages.</p>
<p>Adds command line option <code class="docutils literal notranslate"><span class="pre">--log-auto-indent</span></code>, config option
<a class="reference internal" href="reference/reference.html#confval-15"><code class="xref std std-confval docutils literal notranslate"><span class="pre">log_auto_indent</span></code></a> and support for per-entry configuration of
indentation behavior on calls to <a class="reference external" href="https://docs.python.org/3/library/logging.html#logging.log" title="(in Python v3.13)"><code class="docutils literal notranslate"><span class="pre">logging.log()</span></code></a>.</p>
<p>Alters the default for auto-indention from <code class="docutils literal notranslate"><span class="pre">&quot;on&quot;</span></code> to <code class="docutils literal notranslate"><span class="pre">&quot;off&quot;</span></code>. This
restores the older behavior that existed prior to v4.6.0. This
reversion to earlier behavior was done because it is better to
activate new features that may lead to broken tests explicitly
rather than implicitly.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5914">#5914</a>: <a class="reference internal" href="reference/reference.html#std:fixture-2"><code class="xref std std-fixture docutils literal notranslate"><span class="pre">testdir</span></code></a> learned two new functions, <a class="reference internal" href="reference/reference.html#id67" title="pytest.LineMatcher.no_fnmatch_line"><code class="xref py py-func docutils literal notranslate"><span class="pre">no_fnmatch_line()</span></code></a> and
<a class="reference internal" href="reference/reference.html#id68" title="pytest.LineMatcher.no_re_match_line"><code class="xref py py-func docutils literal notranslate"><span class="pre">no_re_match_line()</span></code></a>.</p>
<p>The functions are used to ensure the captured text <em>does not</em> match the given
pattern.</p>
<p>The previous idiom was to use <a class="reference external" href="https://docs.python.org/3/library/re.html#re.match" title="(in Python v3.13)"><code class="docutils literal notranslate"><span class="pre">re.match()</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">testdir</span><span class="o">.</span><span class="n">runpytest</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">pat</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">str</span><span class="p">())</span> <span class="ow">is</span> <span class="kc">None</span>
</pre></div>
</div>
<p>Or the <code class="docutils literal notranslate"><span class="pre">in</span></code> operator:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">testdir</span><span class="o">.</span><span class="n">runpytest</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">str</span><span class="p">()</span>
</pre></div>
</div>
<p>But the new functions produce best output on failure.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6057">#6057</a>: Added tolerances to complex values when printing <code class="docutils literal notranslate"><span class="pre">pytest.approx</span></code>.</p>
<p>For example, <code class="docutils literal notranslate"><span class="pre">repr(pytest.approx(3+4j))</span></code> returns <code class="docutils literal notranslate"><span class="pre">(3+4j)</span> <span class="pre">±</span> <span class="pre">5e-06</span> <span class="pre">∠</span> <span class="pre">±180°</span></code>. This is polar notation indicating a circle around the expected value, with a radius of 5e-06. For <code class="docutils literal notranslate"><span class="pre">approx</span></code> comparisons to return <code class="docutils literal notranslate"><span class="pre">True</span></code>, the actual value should fall within this circle.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6061">#6061</a>: Added the pluginmanager as an argument to <code class="docutils literal notranslate"><span class="pre">pytest_addoption</span></code>
so that hooks can be invoked when setting up command line options. This is
useful for having one plugin communicate things to another plugin,
such as default values or which set of command line options to add.</p></li>
</ul>
</section>
<section id="id535">
<h3>Improvements<a class="headerlink" href="#id535" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5061">#5061</a>: Use multiple colors with terminal summary statistics.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5630">#5630</a>: Quitting from debuggers is now properly handled in <code class="docutils literal notranslate"><span class="pre">doctest</span></code> items.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5924">#5924</a>: Improved verbose diff output with sequences.</p>
<p>Before:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">E</span>   <span class="ne">AssertionError</span><span class="p">:</span> <span class="k">assert</span> <span class="p">[</span><span class="s1">&#39;version&#39;</span><span class="p">,</span> <span class="s1">&#39;...version_info&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;version&#39;</span><span class="p">,</span> <span class="s1">&#39;...version&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
<span class="n">E</span>     <span class="n">Right</span> <span class="n">contains</span> <span class="mi">3</span> <span class="n">more</span> <span class="n">items</span><span class="p">,</span> <span class="n">first</span> <span class="n">extra</span> <span class="n">item</span><span class="p">:</span> <span class="s1">&#39; &#39;</span>
<span class="n">E</span>     <span class="n">Full</span> <span class="n">diff</span><span class="p">:</span>
<span class="n">E</span>     <span class="o">-</span> <span class="p">[</span><span class="s1">&#39;version&#39;</span><span class="p">,</span> <span class="s1">&#39;version_info&#39;</span><span class="p">,</span> <span class="s1">&#39;sys.version&#39;</span><span class="p">,</span> <span class="s1">&#39;sys.version_info&#39;</span><span class="p">]</span>
<span class="n">E</span>     <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;version&#39;</span><span class="p">,</span>
<span class="n">E</span>     <span class="o">+</span>  <span class="s1">&#39;version_info&#39;</span><span class="p">,</span>
<span class="n">E</span>     <span class="o">+</span>  <span class="s1">&#39;sys.version&#39;</span><span class="p">,</span>
<span class="n">E</span>     <span class="o">+</span>  <span class="s1">&#39;sys.version_info&#39;</span><span class="p">,</span>
<span class="n">E</span>     <span class="o">+</span>  <span class="s1">&#39; &#39;</span><span class="p">,</span>
<span class="n">E</span>     <span class="o">+</span>  <span class="s1">&#39;sys.version&#39;</span><span class="p">,</span>
<span class="n">E</span>     <span class="o">+</span>  <span class="s1">&#39;sys.version_info&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>After:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">E</span>   <span class="ne">AssertionError</span><span class="p">:</span> <span class="k">assert</span> <span class="p">[</span><span class="s1">&#39;version&#39;</span><span class="p">,</span> <span class="s1">&#39;...version_info&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;version&#39;</span><span class="p">,</span> <span class="s1">&#39;...version&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
<span class="n">E</span>     <span class="n">Right</span> <span class="n">contains</span> <span class="mi">3</span> <span class="n">more</span> <span class="n">items</span><span class="p">,</span> <span class="n">first</span> <span class="n">extra</span> <span class="n">item</span><span class="p">:</span> <span class="s1">&#39; &#39;</span>
<span class="n">E</span>     <span class="n">Full</span> <span class="n">diff</span><span class="p">:</span>
<span class="n">E</span>       <span class="p">[</span>
<span class="n">E</span>        <span class="s1">&#39;version&#39;</span><span class="p">,</span>
<span class="n">E</span>        <span class="s1">&#39;version_info&#39;</span><span class="p">,</span>
<span class="n">E</span>        <span class="s1">&#39;sys.version&#39;</span><span class="p">,</span>
<span class="n">E</span>        <span class="s1">&#39;sys.version_info&#39;</span><span class="p">,</span>
<span class="n">E</span>     <span class="o">+</span>  <span class="s1">&#39; &#39;</span><span class="p">,</span>
<span class="n">E</span>     <span class="o">+</span>  <span class="s1">&#39;sys.version&#39;</span><span class="p">,</span>
<span class="n">E</span>     <span class="o">+</span>  <span class="s1">&#39;sys.version_info&#39;</span><span class="p">,</span>
<span class="n">E</span>       <span class="p">]</span>
</pre></div>
</div>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5934">#5934</a>: <code class="docutils literal notranslate"><span class="pre">repr</span></code> of <code class="docutils literal notranslate"><span class="pre">ExceptionInfo</span></code> objects has been improved to honor the <code class="docutils literal notranslate"><span class="pre">__repr__</span></code> method of the underlying exception.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5936">#5936</a>: Display untruncated assertion message with <code class="docutils literal notranslate"><span class="pre">-vv</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5990">#5990</a>: Fixed plurality mismatch in test summary (e.g. display “1 error” instead of “1 errors”).</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6008">#6008</a>: <code class="docutils literal notranslate"><span class="pre">Config.InvocationParams.args</span></code> is now always a <code class="docutils literal notranslate"><span class="pre">tuple</span></code> to better convey that it should be
immutable and avoid accidental modifications.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6023">#6023</a>: <code class="docutils literal notranslate"><span class="pre">pytest.main</span></code> returns a <code class="docutils literal notranslate"><span class="pre">pytest.ExitCode</span></code> instance now, except for when custom exit codes are used (where it returns <code class="docutils literal notranslate"><span class="pre">int</span></code> then still).</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6026">#6026</a>: Align prefixes in output of pytester’s <code class="docutils literal notranslate"><span class="pre">LineMatcher</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6059">#6059</a>: Collection errors are reported as errors (and not failures like before) in the terminal’s short test summary.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6069">#6069</a>: <code class="docutils literal notranslate"><span class="pre">pytester.spawn</span></code> does not skip/xfail tests on FreeBSD anymore unconditionally.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6097">#6097</a>: The “[…%]” indicator in the test summary is now colored according to the final (new) multi-colored line’s main color.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6116">#6116</a>: Added <code class="docutils literal notranslate"><span class="pre">--co</span></code> as a synonym to <code class="docutils literal notranslate"><span class="pre">--collect-only</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6148">#6148</a>: <code class="docutils literal notranslate"><span class="pre">atomicwrites</span></code> is now only used on Windows, fixing a performance regression with assertion rewriting on Unix.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6152">#6152</a>: Now parametrization will use the <code class="docutils literal notranslate"><span class="pre">__name__</span></code> attribute of any object for the id, if present. Previously it would only use <code class="docutils literal notranslate"><span class="pre">__name__</span></code> for functions and classes.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6176">#6176</a>: Improved failure reporting with pytester’s <code class="docutils literal notranslate"><span class="pre">Hookrecorder.assertoutcome</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6181">#6181</a>: The reason for a stopped session, e.g. with <code class="docutils literal notranslate"><span class="pre">--maxfail</span></code> / <code class="docutils literal notranslate"><span class="pre">-x</span></code>, now gets reported in the test summary.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6206">#6206</a>: Improved <code class="docutils literal notranslate"><span class="pre">cache.set</span></code> robustness and performance.</p></li>
</ul>
</section>
<section id="id536">
<h3>Bug Fixes<a class="headerlink" href="#id536" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2049">#2049</a>: Fixed <code class="docutils literal notranslate"><span class="pre">--setup-plan</span></code> showing inaccurate information about fixture lifetimes.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2548">#2548</a>: Fixed line offset mismatch of skipped tests in terminal summary.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6039">#6039</a>: The <code class="docutils literal notranslate"><span class="pre">PytestDoctestRunner</span></code> is now properly invalidated when unconfiguring the doctest plugin.</p>
<p>This is important when used with <code class="docutils literal notranslate"><span class="pre">pytester</span></code>’s <code class="docutils literal notranslate"><span class="pre">runpytest_inprocess</span></code>.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6047">#6047</a>: BaseExceptions are now handled in <code class="docutils literal notranslate"><span class="pre">saferepr</span></code>, which includes <code class="docutils literal notranslate"><span class="pre">pytest.fail.Exception</span></code> etc.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6074">#6074</a>: pytester: fixed order of arguments in <code class="docutils literal notranslate"><span class="pre">rm_rf</span></code> warning when cleaning up temporary directories, and do not emit warnings for errors with <code class="docutils literal notranslate"><span class="pre">os.open</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6189">#6189</a>: Fixed result of <code class="docutils literal notranslate"><span class="pre">getmodpath</span></code> method.</p></li>
</ul>
</section>
<section id="id537">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id537" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4901">#4901</a>: <code class="docutils literal notranslate"><span class="pre">RunResult</span></code> from <code class="docutils literal notranslate"><span class="pre">pytester</span></code> now displays the mnemonic of the <code class="docutils literal notranslate"><span class="pre">ret</span></code> attribute when it is a
valid <code class="docutils literal notranslate"><span class="pre">pytest.ExitCode</span></code> value.</p></li>
</ul>
</section>
</section>
<section id="pytest-5-2-4-2019-11-15">
<h2>pytest 5.2.4 (2019-11-15)<a class="headerlink" href="#pytest-5-2-4-2019-11-15" title="Link to this heading">¶</a></h2>
<section id="id538">
<h3>Bug Fixes<a class="headerlink" href="#id538" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6194">#6194</a>: Fix incorrect discovery of non-test <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> files.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6197">#6197</a>: Revert “The first test in a package (<code class="docutils literal notranslate"><span class="pre">__init__.py</span></code>) marked with <code class="docutils literal notranslate"><span class="pre">&#64;pytest.mark.skip</span></code> is now correctly skipped.”.</p></li>
</ul>
</section>
</section>
<section id="pytest-5-2-3-2019-11-14">
<h2>pytest 5.2.3 (2019-11-14)<a class="headerlink" href="#pytest-5-2-3-2019-11-14" title="Link to this heading">¶</a></h2>
<section id="id539">
<h3>Bug Fixes<a class="headerlink" href="#id539" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5830">#5830</a>: The first test in a package (<code class="docutils literal notranslate"><span class="pre">__init__.py</span></code>) marked with <code class="docutils literal notranslate"><span class="pre">&#64;pytest.mark.skip</span></code> is now correctly skipped.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6099">#6099</a>: Fix <code class="docutils literal notranslate"><span class="pre">--trace</span></code> when used with parametrized functions.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6183">#6183</a>: Using <code class="docutils literal notranslate"><span class="pre">request</span></code> as a parameter name in <code class="docutils literal notranslate"><span class="pre">&#64;pytest.mark.parametrize</span></code> now produces a more
user-friendly error.</p></li>
</ul>
</section>
</section>
<section id="pytest-5-2-2-2019-10-24">
<h2>pytest 5.2.2 (2019-10-24)<a class="headerlink" href="#pytest-5-2-2-2019-10-24" title="Link to this heading">¶</a></h2>
<section id="id540">
<h3>Bug Fixes<a class="headerlink" href="#id540" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5206">#5206</a>: Fix <code class="docutils literal notranslate"><span class="pre">--nf</span></code> to not forget about known nodeids with partial test selection.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5906">#5906</a>: Fix crash with <code class="docutils literal notranslate"><span class="pre">KeyboardInterrupt</span></code> during <code class="docutils literal notranslate"><span class="pre">--setup-show</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5946">#5946</a>: Fixed issue when parametrizing fixtures with numpy arrays (and possibly other sequence-like types).</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6044">#6044</a>: Properly ignore <code class="docutils literal notranslate"><span class="pre">FileNotFoundError</span></code> exceptions when trying to remove old temporary directories,
for instance when multiple processes try to remove the same directory (common with <code class="docutils literal notranslate"><span class="pre">pytest-xdist</span></code>
for example).</p></li>
</ul>
</section>
</section>
<section id="pytest-5-2-1-2019-10-06">
<h2>pytest 5.2.1 (2019-10-06)<a class="headerlink" href="#pytest-5-2-1-2019-10-06" title="Link to this heading">¶</a></h2>
<section id="id541">
<h3>Bug Fixes<a class="headerlink" href="#id541" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5902">#5902</a>: Fix warnings about deprecated <code class="docutils literal notranslate"><span class="pre">cmp</span></code> attribute in <code class="docutils literal notranslate"><span class="pre">attrs&gt;=19.2</span></code>.</p></li>
</ul>
</section>
</section>
<section id="pytest-5-2-0-2019-09-28">
<h2>pytest 5.2.0 (2019-09-28)<a class="headerlink" href="#pytest-5-2-0-2019-09-28" title="Link to this heading">¶</a></h2>
<section id="id542">
<h3>Deprecations<a class="headerlink" href="#id542" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1682">#1682</a>: Passing arguments to pytest.fixture() as positional arguments is deprecated - pass them
as a keyword argument instead.</p></li>
</ul>
</section>
<section id="id543">
<h3>Features<a class="headerlink" href="#id543" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1682">#1682</a>: The <code class="docutils literal notranslate"><span class="pre">scope</span></code> parameter of <code class="docutils literal notranslate"><span class="pre">&#64;pytest.fixture</span></code> can now be a callable that receives
the fixture name and the <code class="docutils literal notranslate"><span class="pre">config</span></code> object as keyword-only parameters.
See <a class="reference internal" href="how-to/fixtures.html#dynamic-scope"><span class="std std-ref">the docs</span></a> for more information.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5764">#5764</a>: New behavior of the <code class="docutils literal notranslate"><span class="pre">--pastebin</span></code> option: failures to connect to the pastebin server are reported, without failing the pytest run</p></li>
</ul>
</section>
<section id="id544">
<h3>Bug Fixes<a class="headerlink" href="#id544" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5806">#5806</a>: Fix “lexer” being used when uploading to bpaste.net from <code class="docutils literal notranslate"><span class="pre">--pastebin</span></code> to “text”.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5884">#5884</a>: Fix <code class="docutils literal notranslate"><span class="pre">--setup-only</span></code> and <code class="docutils literal notranslate"><span class="pre">--setup-show</span></code> for custom pytest items.</p></li>
</ul>
</section>
<section id="id545">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id545" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5056">#5056</a>: The HelpFormatter uses <code class="docutils literal notranslate"><span class="pre">py.io.get_terminal_width</span></code> for better width detection.</p></li>
</ul>
</section>
</section>
<section id="pytest-5-1-3-2019-09-18">
<h2>pytest 5.1.3 (2019-09-18)<a class="headerlink" href="#pytest-5-1-3-2019-09-18" title="Link to this heading">¶</a></h2>
<section id="id546">
<h3>Bug Fixes<a class="headerlink" href="#id546" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5807">#5807</a>: Fix pypy3.6 (nightly) on windows.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5811">#5811</a>: Handle <code class="docutils literal notranslate"><span class="pre">--fulltrace</span></code> correctly with <code class="docutils literal notranslate"><span class="pre">pytest.raises</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5819">#5819</a>: Windows: Fix regression with conftest whose qualified name contains uppercase
characters (introduced by #5792).</p></li>
</ul>
</section>
</section>
<section id="pytest-5-1-2-2019-08-30">
<h2>pytest 5.1.2 (2019-08-30)<a class="headerlink" href="#pytest-5-1-2-2019-08-30" title="Link to this heading">¶</a></h2>
<section id="id547">
<h3>Bug Fixes<a class="headerlink" href="#id547" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2270">#2270</a>: Fixed <code class="docutils literal notranslate"><span class="pre">self</span></code> reference in function-scoped fixtures defined plugin classes: previously <code class="docutils literal notranslate"><span class="pre">self</span></code>
would be a reference to a <em>test</em> class, not the <em>plugin</em> class.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/570">#570</a>: Fixed long standing issue where fixture scope was not respected when indirect fixtures were used during
parametrization.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5782">#5782</a>: Fix decoding error when printing an error response from <code class="docutils literal notranslate"><span class="pre">--pastebin</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5786">#5786</a>: Chained exceptions in test and collection reports are now correctly serialized, allowing plugins like
<code class="docutils literal notranslate"><span class="pre">pytest-xdist</span></code> to display them properly.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5792">#5792</a>: Windows: Fix error that occurs in certain circumstances when loading
<code class="docutils literal notranslate"><span class="pre">conftest.py</span></code> from a working directory that has casing other than the one stored
in the filesystem (e.g., <code class="docutils literal notranslate"><span class="pre">c:\test</span></code> instead of <code class="docutils literal notranslate"><span class="pre">C:\test</span></code>).</p></li>
</ul>
</section>
</section>
<section id="pytest-5-1-1-2019-08-20">
<h2>pytest 5.1.1 (2019-08-20)<a class="headerlink" href="#pytest-5-1-1-2019-08-20" title="Link to this heading">¶</a></h2>
<section id="id548">
<h3>Bug Fixes<a class="headerlink" href="#id548" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5751">#5751</a>: Fixed <code class="docutils literal notranslate"><span class="pre">TypeError</span></code> when importing pytest on Python 3.5.0 and 3.5.1.</p></li>
</ul>
</section>
</section>
<section id="pytest-5-1-0-2019-08-15">
<h2>pytest 5.1.0 (2019-08-15)<a class="headerlink" href="#pytest-5-1-0-2019-08-15" title="Link to this heading">¶</a></h2>
<section id="removals">
<h3>Removals<a class="headerlink" href="#removals" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5180">#5180</a>: As per our policy, the following features have been deprecated in the 4.X series and are now
removed:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Request.getfuncargvalue</span></code>: use <code class="docutils literal notranslate"><span class="pre">Request.getfixturevalue</span></code> instead.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.raises</span></code> and <code class="docutils literal notranslate"><span class="pre">pytest.warns</span></code> no longer support strings as the second argument.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">message</span></code> parameter of <code class="docutils literal notranslate"><span class="pre">pytest.raises</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.raises</span></code>, <code class="docutils literal notranslate"><span class="pre">pytest.warns</span></code> and <code class="docutils literal notranslate"><span class="pre">ParameterSet.param</span></code> now use native keyword-only
syntax. This might change the exception message from previous versions, but they still raise
<code class="docutils literal notranslate"><span class="pre">TypeError</span></code> on unknown keyword arguments as before.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.config</span></code> global variable.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tmpdir_factory.ensuretemp</span></code> method.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest_logwarning</span></code> hook.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">RemovedInPytest4Warning</span></code> warning type.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">request</span></code> is now a reserved name for fixtures.</p></li>
</ul>
<p>For more information consult <a class="reference internal" href="deprecations.html"><span class="doc">Deprecations and Removals</span></a> in the docs.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5565">#5565</a>: Removed unused support code for <a class="reference external" href="https://pypi.org/project/unittest2">unittest2</a>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">unittest2</span></code> backport module is no longer
necessary since Python 3.3+, and the small amount of code in pytest to support it also doesn’t seem
to be used: after removed, all tests still pass unchanged.</p>
<p>Although our policy is to introduce a deprecation period before removing any features or support
for third party libraries, because this code is apparently not used
at all (even if <code class="docutils literal notranslate"><span class="pre">unittest2</span></code> is used by a test suite executed by pytest), it was decided to
remove it in this release.</p>
<p>If you experience a regression because of this, please <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/new">file an issue</a>.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5615">#5615</a>: <code class="docutils literal notranslate"><span class="pre">pytest.fail</span></code>, <code class="docutils literal notranslate"><span class="pre">pytest.xfail</span></code> and <code class="docutils literal notranslate"><span class="pre">pytest.skip</span></code> no longer support bytes for the message argument.</p>
<p>This was supported for Python 2 where it was tempting to use <code class="docutils literal notranslate"><span class="pre">&quot;message&quot;</span></code>
instead of <code class="docutils literal notranslate"><span class="pre">u&quot;message&quot;</span></code>.</p>
<p>Python 3 code is unlikely to pass <code class="docutils literal notranslate"><span class="pre">bytes</span></code> to these functions. If you do,
please decode it to an <code class="docutils literal notranslate"><span class="pre">str</span></code> beforehand.</p>
</li>
</ul>
</section>
<section id="id549">
<h3>Features<a class="headerlink" href="#id549" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5564">#5564</a>: New <code class="docutils literal notranslate"><span class="pre">Config.invocation_args</span></code> attribute containing the unchanged arguments passed to <code class="docutils literal notranslate"><span class="pre">pytest.main()</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5576">#5576</a>: New <a class="reference internal" href="how-to/doctest.html#using-doctest-options"><span class="std std-ref">NUMBER</span></a>
option for doctests to ignore irrelevant differences in floating-point numbers.
Inspired by Sébastien Boisgérault’s <a class="reference external" href="https://github.com/boisgera/numtest">numtest</a>
extension for doctest.</p></li>
</ul>
</section>
<section id="id550">
<h3>Improvements<a class="headerlink" href="#id550" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5471">#5471</a>: JUnit XML now includes a timestamp and hostname in the testsuite tag.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5707">#5707</a>: Time taken to run the test suite now includes a human-readable representation when it takes over
60 seconds, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">=====</span> <span class="mi">2</span> <span class="n">failed</span> <span class="ow">in</span> <span class="mf">102.70</span><span class="n">s</span> <span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">42</span><span class="p">)</span> <span class="o">=====</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="id551">
<h3>Bug Fixes<a class="headerlink" href="#id551" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4344">#4344</a>: Fix RuntimeError/StopIteration when trying to collect package with “__init__.py” only.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5115">#5115</a>: Warnings issued during <code class="docutils literal notranslate"><span class="pre">pytest_configure</span></code> are explicitly not treated as errors, even if configured as such, because it otherwise completely breaks pytest.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5477">#5477</a>: The XML file produced by <code class="docutils literal notranslate"><span class="pre">--junitxml</span></code> now correctly contain a <code class="docutils literal notranslate"><span class="pre">&lt;testsuites&gt;</span></code> root element.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5524">#5524</a>: Fix issue where <code class="docutils literal notranslate"><span class="pre">tmp_path</span></code> and <code class="docutils literal notranslate"><span class="pre">tmpdir</span></code> would not remove directories containing files marked as read-only,
which could lead to pytest crashing when executed a second time with the <code class="docutils literal notranslate"><span class="pre">--basetemp</span></code> option.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5537">#5537</a>: Replace <code class="docutils literal notranslate"><span class="pre">importlib_metadata</span></code> backport with <code class="docutils literal notranslate"><span class="pre">importlib.metadata</span></code> from the
standard library on Python 3.8+.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5578">#5578</a>: Improve type checking for some exception-raising functions (<code class="docutils literal notranslate"><span class="pre">pytest.xfail</span></code>, <code class="docutils literal notranslate"><span class="pre">pytest.skip</span></code>, etc)
so they provide better error messages when users meant to use marks (for example <code class="docutils literal notranslate"><span class="pre">&#64;pytest.xfail</span></code>
instead of <code class="docutils literal notranslate"><span class="pre">&#64;pytest.mark.xfail</span></code>).</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5606">#5606</a>: Fixed internal error when test functions were patched with objects that cannot be compared
for truth values against others, like <code class="docutils literal notranslate"><span class="pre">numpy</span></code> arrays.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5634">#5634</a>: <code class="docutils literal notranslate"><span class="pre">pytest.exit</span></code> is now correctly handled in <code class="docutils literal notranslate"><span class="pre">unittest</span></code> cases.
This makes <code class="docutils literal notranslate"><span class="pre">unittest</span></code> cases handle <code class="docutils literal notranslate"><span class="pre">quit</span></code> from pytest’s pdb correctly.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5650">#5650</a>: Improved output when parsing an ini configuration file fails.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5701">#5701</a>: Fix collection of <code class="docutils literal notranslate"><span class="pre">staticmethod</span></code> objects defined with <code class="docutils literal notranslate"><span class="pre">functools.partial</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5734">#5734</a>: Skip async generator test functions, and update the warning message to refer to <code class="docutils literal notranslate"><span class="pre">async</span> <span class="pre">def</span></code> functions.</p></li>
</ul>
</section>
<section id="id552">
<h3>Improved Documentation<a class="headerlink" href="#id552" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5669">#5669</a>: Add docstring for <code class="docutils literal notranslate"><span class="pre">Testdir.copy_example</span></code>.</p></li>
</ul>
</section>
<section id="id553">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id553" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5095">#5095</a>: XML files of the <code class="docutils literal notranslate"><span class="pre">xunit2</span></code> family are now validated against the schema by pytest’s own test suite
to avoid future regressions.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5516">#5516</a>: Cache node splitting function which can improve collection performance in very large test suites.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5603">#5603</a>: Simplified internal <code class="docutils literal notranslate"><span class="pre">SafeRepr</span></code> class and removed some dead code.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5664">#5664</a>: When invoking pytest’s own testsuite with <code class="docutils literal notranslate"><span class="pre">PYTHONDONTWRITEBYTECODE=1</span></code>,
the <code class="docutils literal notranslate"><span class="pre">test_xfail_handling</span></code> test no longer fails.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5684">#5684</a>: Replace manual handling of <code class="docutils literal notranslate"><span class="pre">OSError.errno</span></code> in the codebase by new <code class="docutils literal notranslate"><span class="pre">OSError</span></code> subclasses (<code class="docutils literal notranslate"><span class="pre">PermissionError</span></code>, <code class="docutils literal notranslate"><span class="pre">FileNotFoundError</span></code>, etc.).</p></li>
</ul>
</section>
</section>
<section id="pytest-5-0-1-2019-07-04">
<h2>pytest 5.0.1 (2019-07-04)<a class="headerlink" href="#pytest-5-0-1-2019-07-04" title="Link to this heading">¶</a></h2>
<section id="id554">
<h3>Bug Fixes<a class="headerlink" href="#id554" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5479">#5479</a>: Improve quoting in <code class="docutils literal notranslate"><span class="pre">raises</span></code> match failure message.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5523">#5523</a>: Fixed using multiple short options together in the command-line (for example <code class="docutils literal notranslate"><span class="pre">-vs</span></code>) in Python 3.8+.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5547">#5547</a>: <code class="docutils literal notranslate"><span class="pre">--step-wise</span></code> now handles <code class="docutils literal notranslate"><span class="pre">xfail(strict=True)</span></code> markers properly.</p></li>
</ul>
</section>
<section id="id555">
<h3>Improved Documentation<a class="headerlink" href="#id555" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5517">#5517</a>: Improve “Declaring new hooks” section in chapter “Writing Plugins”</p></li>
</ul>
</section>
</section>
<section id="pytest-5-0-0-2019-06-28">
<h2>pytest 5.0.0 (2019-06-28)<a class="headerlink" href="#pytest-5-0-0-2019-06-28" title="Link to this heading">¶</a></h2>
<section id="important">
<h3>Important<a class="headerlink" href="#important" title="Link to this heading">¶</a></h3>
<p>This release is a Python3.5+ only release.</p>
<p>For more details, see our <a class="reference external" href="https://docs.pytest.org/en/7.0.x/py27-py34-deprecation.html">Python 2.7 and 3.4 support plan</a>.</p>
</section>
<section id="id556">
<h3>Removals<a class="headerlink" href="#id556" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1149">#1149</a>: Pytest no longer accepts prefixes of command-line arguments, for example
typing <code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">--doctest-mod</span></code> inplace of <code class="docutils literal notranslate"><span class="pre">--doctest-modules</span></code>.
This was previously allowed where the <code class="docutils literal notranslate"><span class="pre">ArgumentParser</span></code> thought it was unambiguous,
but this could be incorrect due to delayed parsing of options for plugins.
See for example issues <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1149">#1149</a>,
<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3413">#3413</a>, and
<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4009">#4009</a>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5402">#5402</a>: <strong>PytestDeprecationWarning are now errors by default.</strong></p>
<p>Following our plan to remove deprecated features with as little disruption as
possible, all warnings of type <code class="docutils literal notranslate"><span class="pre">PytestDeprecationWarning</span></code> now generate errors
instead of warning messages.</p>
<p><strong>The affected features will be effectively removed in pytest 5.1</strong>, so please consult the
<a class="reference internal" href="deprecations.html"><span class="doc">Deprecations and Removals</span></a> section in the docs for directions on how to update existing code.</p>
<p>In the pytest <code class="docutils literal notranslate"><span class="pre">5.0.X</span></code> series, it is possible to change the errors back into warnings as a stop
gap measure by adding this to your <code class="docutils literal notranslate"><span class="pre">pytest.ini</span></code> file:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[pytest]</span>
<span class="na">filterwarnings</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="na">ignore</span><span class="o">:</span><span class="s">:pytest.PytestDeprecationWarning</span>
</pre></div>
</div>
<p>But this will stop working when pytest <code class="docutils literal notranslate"><span class="pre">5.1</span></code> is released.</p>
<p><strong>If you have concerns</strong> about the removal of a specific feature, please add a
comment to <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5402">#5402</a>.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5412">#5412</a>: <code class="docutils literal notranslate"><span class="pre">ExceptionInfo</span></code> objects (returned by <code class="docutils literal notranslate"><span class="pre">pytest.raises</span></code>) now have the same <code class="docutils literal notranslate"><span class="pre">str</span></code> representation as <code class="docutils literal notranslate"><span class="pre">repr</span></code>, which
avoids some confusion when users use <code class="docutils literal notranslate"><span class="pre">print(e)</span></code> to inspect the object.</p>
<p>This means code like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="n">SomeException</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="o">...</span>
<span class="k">assert</span> <span class="s2">&quot;some message&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<p>Needs to be changed to:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="n">SomeException</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="o">...</span>
<span class="k">assert</span> <span class="s2">&quot;some message&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="id557">
<h3>Deprecations<a class="headerlink" href="#id557" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4488">#4488</a>: The removal of the <code class="docutils literal notranslate"><span class="pre">--result-log</span></code> option and module has been postponed to (tentatively) pytest 6.0 as
the team has not yet got around to implement a good alternative for it.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/466">#466</a>: The <code class="docutils literal notranslate"><span class="pre">funcargnames</span></code> attribute has been an alias for <code class="docutils literal notranslate"><span class="pre">fixturenames</span></code> since
pytest 2.3, and is now deprecated in code too.</p></li>
</ul>
</section>
<section id="id558">
<h3>Features<a class="headerlink" href="#id558" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3457">#3457</a>: New <a class="reference internal" href="reference/reference.html#std:hook-44"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_assertion_pass</span></code></a>
hook, called with context information when an assertion <em>passes</em>.</p>
<p>This hook is still <strong>experimental</strong> so use it with caution.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5440">#5440</a>: The <a class="reference external" href="https://docs.python.org/3/library/faulthandler.html#module-faulthandler" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">faulthandler</span></code></a> standard library
module is now enabled by default to help users diagnose crashes in C modules.</p>
<p>This functionality was provided by integrating the external
<a class="reference external" href="https://github.com/pytest-dev/pytest-faulthandler">pytest-faulthandler</a> plugin into the core,
so users should remove that plugin from their requirements if used.</p>
<p>For more information see the docs: <a class="reference internal" href="how-to/failures.html#faulthandler"><span class="std std-ref">故障处理</span></a>.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5452">#5452</a>: When warnings are configured as errors, pytest warnings now appear as originating from <code class="docutils literal notranslate"><span class="pre">pytest.</span></code> instead of the internal <code class="docutils literal notranslate"><span class="pre">_pytest.warning_types.</span></code> module.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5125">#5125</a>: <code class="docutils literal notranslate"><span class="pre">Session.exitcode</span></code> values are now coded in <code class="docutils literal notranslate"><span class="pre">pytest.ExitCode</span></code>, an <code class="docutils literal notranslate"><span class="pre">IntEnum</span></code>. This makes the exit code available for consumer code and are more explicit other than just documentation. User defined exit codes are still valid, but should be used with caution.</p>
<p>The team doesn’t expect this change to break test suites or plugins in general, except in esoteric/specific scenarios.</p>
<p><strong>pytest-xdist</strong> users should upgrade to <code class="docutils literal notranslate"><span class="pre">1.29.0</span></code> or later, as <code class="docutils literal notranslate"><span class="pre">pytest-xdist</span></code> required a compatibility fix because of this change.</p>
</li>
</ul>
</section>
<section id="id559">
<h3>Bug Fixes<a class="headerlink" href="#id559" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1403">#1403</a>: Switch from <code class="docutils literal notranslate"><span class="pre">imp</span></code> to <code class="docutils literal notranslate"><span class="pre">importlib</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1671">#1671</a>: The name of the <code class="docutils literal notranslate"><span class="pre">.pyc</span></code> files cached by the assertion writer now includes the pytest version
to avoid stale caches.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2761">#2761</a>: Honor <span class="target" id="index-8"></span><a class="pep reference external" href="https://peps.python.org/pep-0235/"><strong>PEP 235</strong></a> on case-insensitive file systems.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5078">#5078</a>: Test module is no longer double-imported when using <code class="docutils literal notranslate"><span class="pre">--pyargs</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5260">#5260</a>: Improved comparison of byte strings.</p>
<p>When comparing bytes, the assertion message used to show the byte numeric value when showing the differences:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">test</span><span class="p">():</span>
<span class="o">&gt;</span>       <span class="k">assert</span> <span class="sa">b</span><span class="s1">&#39;spam&#39;</span> <span class="o">==</span> <span class="sa">b</span><span class="s1">&#39;eggs&#39;</span>
<span class="n">E</span>       <span class="ne">AssertionError</span><span class="p">:</span> <span class="k">assert</span> <span class="sa">b</span><span class="s1">&#39;spam&#39;</span> <span class="o">==</span> <span class="sa">b</span><span class="s1">&#39;eggs&#39;</span>
<span class="n">E</span>         <span class="n">At</span> <span class="n">index</span> <span class="mi">0</span> <span class="n">diff</span><span class="p">:</span> <span class="mi">115</span> <span class="o">!=</span> <span class="mi">101</span>
<span class="n">E</span>         <span class="n">Use</span> <span class="o">-</span><span class="n">v</span> <span class="n">to</span> <span class="n">get</span> <span class="n">the</span> <span class="n">full</span> <span class="n">diff</span>
</pre></div>
</div>
<p>It now shows the actual ascii representation instead, which is often more useful:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">test</span><span class="p">():</span>
<span class="o">&gt;</span>       <span class="k">assert</span> <span class="sa">b</span><span class="s1">&#39;spam&#39;</span> <span class="o">==</span> <span class="sa">b</span><span class="s1">&#39;eggs&#39;</span>
<span class="n">E</span>       <span class="ne">AssertionError</span><span class="p">:</span> <span class="k">assert</span> <span class="sa">b</span><span class="s1">&#39;spam&#39;</span> <span class="o">==</span> <span class="sa">b</span><span class="s1">&#39;eggs&#39;</span>
<span class="n">E</span>         <span class="n">At</span> <span class="n">index</span> <span class="mi">0</span> <span class="n">diff</span><span class="p">:</span> <span class="sa">b</span><span class="s1">&#39;s&#39;</span> <span class="o">!=</span> <span class="sa">b</span><span class="s1">&#39;e&#39;</span>
<span class="n">E</span>         <span class="n">Use</span> <span class="o">-</span><span class="n">v</span> <span class="n">to</span> <span class="n">get</span> <span class="n">the</span> <span class="n">full</span> <span class="n">diff</span>
</pre></div>
</div>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5335">#5335</a>: Colorize level names when the level in the logging format is formatted using
‘%(levelname).Xs’ (truncated fixed width alignment), where X is an integer.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5354">#5354</a>: Fix <code class="docutils literal notranslate"><span class="pre">pytest.mark.parametrize</span></code> when the argvalues is an iterator.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5370">#5370</a>: Revert unrolling of <code class="docutils literal notranslate"><span class="pre">all()</span></code> to fix <code class="docutils literal notranslate"><span class="pre">NameError</span></code> on nested comprehensions.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5371">#5371</a>: Revert unrolling of <code class="docutils literal notranslate"><span class="pre">all()</span></code> to fix incorrect handling of generators with <code class="docutils literal notranslate"><span class="pre">if</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5372">#5372</a>: Revert unrolling of <code class="docutils literal notranslate"><span class="pre">all()</span></code> to fix incorrect assertion when using <code class="docutils literal notranslate"><span class="pre">all()</span></code> in an expression.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5383">#5383</a>: <code class="docutils literal notranslate"><span class="pre">-q</span></code> has again an impact on the style of the collected items
(<code class="docutils literal notranslate"><span class="pre">--collect-only</span></code>) when <code class="docutils literal notranslate"><span class="pre">--log-cli-level</span></code> is used.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5389">#5389</a>: Fix regressions of <a class="reference external" href="https://github.com/pytest-dev/pytest/pull/5063">#5063</a> for <code class="docutils literal notranslate"><span class="pre">importlib_metadata.PathDistribution</span></code> which have their <code class="docutils literal notranslate"><span class="pre">files</span></code> attribute being <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5390">#5390</a>: Fix regression where the <code class="docutils literal notranslate"><span class="pre">obj</span></code> attribute of <code class="docutils literal notranslate"><span class="pre">TestCase</span></code> items was no longer bound to methods.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5404">#5404</a>: Emit a warning when attempting to unwrap a broken object raises an exception,
for easier debugging (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5080">#5080</a>).</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5432">#5432</a>: Prevent “already imported” warnings from assertion rewriter when invoking pytest in-process multiple times.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5433">#5433</a>: Fix assertion rewriting in packages (<code class="docutils literal notranslate"><span class="pre">__init__.py</span></code>).</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5444">#5444</a>: Fix <code class="docutils literal notranslate"><span class="pre">--stepwise</span></code> mode when the first file passed on the command-line fails to collect.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5482">#5482</a>: Fix bug introduced in 4.6.0 causing collection errors when passing
more than 2 positional arguments to <code class="docutils literal notranslate"><span class="pre">pytest.mark.parametrize</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5505">#5505</a>: Fix crash when discovery fails while using <code class="docutils literal notranslate"><span class="pre">-p</span> <span class="pre">no:terminal</span></code>.</p></li>
</ul>
</section>
<section id="id560">
<h3>Improved Documentation<a class="headerlink" href="#id560" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5315">#5315</a>: Expand docs on mocking classes and dictionaries with <code class="docutils literal notranslate"><span class="pre">monkeypatch</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5416">#5416</a>: Fix PytestUnknownMarkWarning in run/skip example.</p></li>
</ul>
</section>
</section>
<section id="pytest-4-6-11-2020-06-04">
<h2>pytest 4.6.11 (2020-06-04)<a class="headerlink" href="#pytest-4-6-11-2020-06-04" title="Link to this heading">¶</a></h2>
<section id="id561">
<h3>Bug Fixes<a class="headerlink" href="#id561" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6334">#6334</a>: Fix summary entries appearing twice when <code class="docutils literal notranslate"><span class="pre">f/F</span></code> and <code class="docutils literal notranslate"><span class="pre">s/S</span></code> report chars were used at the same time in the <code class="docutils literal notranslate"><span class="pre">-r</span></code> command-line option (for example <code class="docutils literal notranslate"><span class="pre">-rFf</span></code>).</p>
<p>The upper case variants were never documented and the preferred form should be the lower case.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/7310">#7310</a>: Fix <code class="docutils literal notranslate"><span class="pre">UnboundLocalError:</span> <span class="pre">local</span> <span class="pre">variable</span> <span class="pre">'letter'</span> <span class="pre">referenced</span> <span class="pre">before</span>
<span class="pre">assignment</span></code> in <code class="docutils literal notranslate"><span class="pre">_pytest.terminal.pytest_report_teststatus()</span></code>
when plugins return report objects in an unconventional state.</p>
<p>This was making <code class="docutils literal notranslate"><span class="pre">pytest_report_teststatus()</span></code> skip
entering if-block branches that declare the <code class="docutils literal notranslate"><span class="pre">letter</span></code> variable.</p>
<p>The fix was to set the initial value of the <code class="docutils literal notranslate"><span class="pre">letter</span></code> before
the if-block cascade so that it always has a value.</p>
</li>
</ul>
</section>
</section>
<section id="pytest-4-6-10-2020-05-08">
<h2>pytest 4.6.10 (2020-05-08)<a class="headerlink" href="#pytest-4-6-10-2020-05-08" title="Link to this heading">¶</a></h2>
<section id="id562">
<h3>Features<a class="headerlink" href="#id562" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6870">#6870</a>: New <code class="docutils literal notranslate"><span class="pre">Config.invocation_args</span></code> attribute containing the unchanged arguments passed to <code class="docutils literal notranslate"><span class="pre">pytest.main()</span></code>.</p>
<p>Remark: while this is technically a new feature and according to our
<a class="reference external" href="https://docs.pytest.org/en/7.0.x/py27-py34-deprecation.html#what-goes-into-4-6-x-releases">policy</a>
it should not have been backported, we have opened an exception in this
particular case because it fixes a serious interaction with <code class="docutils literal notranslate"><span class="pre">pytest-xdist</span></code>,
so it can also be considered a bugfix.</p>
</li>
</ul>
</section>
<section id="id563">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id563" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6404">#6404</a>: Remove usage of <code class="docutils literal notranslate"><span class="pre">parser</span></code> module, deprecated in Python 3.9.</p></li>
</ul>
</section>
</section>
<section id="pytest-4-6-9-2020-01-04">
<h2>pytest 4.6.9 (2020-01-04)<a class="headerlink" href="#pytest-4-6-9-2020-01-04" title="Link to this heading">¶</a></h2>
<section id="id564">
<h3>Bug Fixes<a class="headerlink" href="#id564" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6301">#6301</a>: Fix assertion rewriting for egg-based distributions and <code class="docutils literal notranslate"><span class="pre">editable</span></code> installs (<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">--editable</span></code>).</p></li>
</ul>
</section>
</section>
<section id="pytest-4-6-8-2019-12-19">
<h2>pytest 4.6.8 (2019-12-19)<a class="headerlink" href="#pytest-4-6-8-2019-12-19" title="Link to this heading">¶</a></h2>
<section id="id565">
<h3>Features<a class="headerlink" href="#id565" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5471">#5471</a>: JUnit XML now includes a timestamp and hostname in the testsuite tag.</p></li>
</ul>
</section>
<section id="id566">
<h3>Bug Fixes<a class="headerlink" href="#id566" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5430">#5430</a>: junitxml: Logs for failed test are now passed to junit report in case the test fails during call phase.</p></li>
</ul>
</section>
<section id="id567">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id567" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6345">#6345</a>: Pin <code class="docutils literal notranslate"><span class="pre">colorama</span></code> to <code class="docutils literal notranslate"><span class="pre">0.4.1</span></code> only for Python 3.4 so newer Python versions can still receive colorama updates.</p></li>
</ul>
</section>
</section>
<section id="pytest-4-6-7-2019-12-05">
<h2>pytest 4.6.7 (2019-12-05)<a class="headerlink" href="#pytest-4-6-7-2019-12-05" title="Link to this heading">¶</a></h2>
<section id="id568">
<h3>Bug Fixes<a class="headerlink" href="#id568" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5477">#5477</a>: The XML file produced by <code class="docutils literal notranslate"><span class="pre">--junitxml</span></code> now correctly contain a <code class="docutils literal notranslate"><span class="pre">&lt;testsuites&gt;</span></code> root element.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/6044">#6044</a>: Properly ignore <code class="docutils literal notranslate"><span class="pre">FileNotFoundError</span></code> (<code class="docutils literal notranslate"><span class="pre">OSError.errno</span> <span class="pre">==</span> <span class="pre">NOENT</span></code> in Python 2) exceptions when trying to remove old temporary directories,
for instance when multiple processes try to remove the same directory (common with <code class="docutils literal notranslate"><span class="pre">pytest-xdist</span></code>
for example).</p></li>
</ul>
</section>
</section>
<section id="pytest-4-6-6-2019-10-11">
<h2>pytest 4.6.6 (2019-10-11)<a class="headerlink" href="#pytest-4-6-6-2019-10-11" title="Link to this heading">¶</a></h2>
<section id="id569">
<h3>Bug Fixes<a class="headerlink" href="#id569" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5523">#5523</a>: Fixed using multiple short options together in the command-line (for example <code class="docutils literal notranslate"><span class="pre">-vs</span></code>) in Python 3.8+.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5537">#5537</a>: Replace <code class="docutils literal notranslate"><span class="pre">importlib_metadata</span></code> backport with <code class="docutils literal notranslate"><span class="pre">importlib.metadata</span></code> from the
standard library on Python 3.8+.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5806">#5806</a>: Fix “lexer” being used when uploading to bpaste.net from <code class="docutils literal notranslate"><span class="pre">--pastebin</span></code> to “text”.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5902">#5902</a>: Fix warnings about deprecated <code class="docutils literal notranslate"><span class="pre">cmp</span></code> attribute in <code class="docutils literal notranslate"><span class="pre">attrs&gt;=19.2</span></code>.</p></li>
</ul>
</section>
<section id="id570">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id570" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5801">#5801</a>: Fixes python version checks (detected by <code class="docutils literal notranslate"><span class="pre">flake8-2020</span></code>) in case python4 becomes a thing.</p></li>
</ul>
</section>
</section>
<section id="pytest-4-6-5-2019-08-05">
<h2>pytest 4.6.5 (2019-08-05)<a class="headerlink" href="#pytest-4-6-5-2019-08-05" title="Link to this heading">¶</a></h2>
<section id="id571">
<h3>Bug Fixes<a class="headerlink" href="#id571" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4344">#4344</a>: Fix RuntimeError/StopIteration when trying to collect package with “__init__.py” only.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5478">#5478</a>: Fix encode error when using unicode strings in exceptions with <code class="docutils literal notranslate"><span class="pre">pytest.raises</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5524">#5524</a>: Fix issue where <code class="docutils literal notranslate"><span class="pre">tmp_path</span></code> and <code class="docutils literal notranslate"><span class="pre">tmpdir</span></code> would not remove directories containing files marked as read-only,
which could lead to pytest crashing when executed a second time with the <code class="docutils literal notranslate"><span class="pre">--basetemp</span></code> option.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5547">#5547</a>: <code class="docutils literal notranslate"><span class="pre">--step-wise</span></code> now handles <code class="docutils literal notranslate"><span class="pre">xfail(strict=True)</span></code> markers properly.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5650">#5650</a>: Improved output when parsing an ini configuration file fails.</p></li>
</ul>
</section>
</section>
<section id="pytest-4-6-4-2019-06-28">
<h2>pytest 4.6.4 (2019-06-28)<a class="headerlink" href="#pytest-4-6-4-2019-06-28" title="Link to this heading">¶</a></h2>
<section id="id572">
<h3>Bug Fixes<a class="headerlink" href="#id572" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5404">#5404</a>: Emit a warning when attempting to unwrap a broken object raises an exception,
for easier debugging (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5080">#5080</a>).</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5444">#5444</a>: Fix <code class="docutils literal notranslate"><span class="pre">--stepwise</span></code> mode when the first file passed on the command-line fails to collect.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5482">#5482</a>: Fix bug introduced in 4.6.0 causing collection errors when passing
more than 2 positional arguments to <code class="docutils literal notranslate"><span class="pre">pytest.mark.parametrize</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5505">#5505</a>: Fix crash when discovery fails while using <code class="docutils literal notranslate"><span class="pre">-p</span> <span class="pre">no:terminal</span></code>.</p></li>
</ul>
</section>
</section>
<section id="pytest-4-6-3-2019-06-11">
<h2>pytest 4.6.3 (2019-06-11)<a class="headerlink" href="#pytest-4-6-3-2019-06-11" title="Link to this heading">¶</a></h2>
<section id="id573">
<h3>Bug Fixes<a class="headerlink" href="#id573" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5383">#5383</a>: <code class="docutils literal notranslate"><span class="pre">-q</span></code> has again an impact on the style of the collected items
(<code class="docutils literal notranslate"><span class="pre">--collect-only</span></code>) when <code class="docutils literal notranslate"><span class="pre">--log-cli-level</span></code> is used.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5389">#5389</a>: Fix regressions of <a class="reference external" href="https://github.com/pytest-dev/pytest/pull/5063">#5063</a> for <code class="docutils literal notranslate"><span class="pre">importlib_metadata.PathDistribution</span></code> which have their <code class="docutils literal notranslate"><span class="pre">files</span></code> attribute being <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5390">#5390</a>: Fix regression where the <code class="docutils literal notranslate"><span class="pre">obj</span></code> attribute of <code class="docutils literal notranslate"><span class="pre">TestCase</span></code> items was no longer bound to methods.</p></li>
</ul>
</section>
</section>
<section id="pytest-4-6-2-2019-06-03">
<h2>pytest 4.6.2 (2019-06-03)<a class="headerlink" href="#pytest-4-6-2-2019-06-03" title="Link to this heading">¶</a></h2>
<section id="id574">
<h3>Bug Fixes<a class="headerlink" href="#id574" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5370">#5370</a>: Revert unrolling of <code class="docutils literal notranslate"><span class="pre">all()</span></code> to fix <code class="docutils literal notranslate"><span class="pre">NameError</span></code> on nested comprehensions.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5371">#5371</a>: Revert unrolling of <code class="docutils literal notranslate"><span class="pre">all()</span></code> to fix incorrect handling of generators with <code class="docutils literal notranslate"><span class="pre">if</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5372">#5372</a>: Revert unrolling of <code class="docutils literal notranslate"><span class="pre">all()</span></code> to fix incorrect assertion when using <code class="docutils literal notranslate"><span class="pre">all()</span></code> in an expression.</p></li>
</ul>
</section>
</section>
<section id="pytest-4-6-1-2019-06-02">
<h2>pytest 4.6.1 (2019-06-02)<a class="headerlink" href="#pytest-4-6-1-2019-06-02" title="Link to this heading">¶</a></h2>
<section id="id575">
<h3>Bug Fixes<a class="headerlink" href="#id575" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5354">#5354</a>: Fix <code class="docutils literal notranslate"><span class="pre">pytest.mark.parametrize</span></code> when the argvalues is an iterator.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5358">#5358</a>: Fix assertion rewriting of <code class="docutils literal notranslate"><span class="pre">all()</span></code> calls to deal with non-generators.</p></li>
</ul>
</section>
</section>
<section id="pytest-4-6-0-2019-05-31">
<h2>pytest 4.6.0 (2019-05-31)<a class="headerlink" href="#pytest-4-6-0-2019-05-31" title="Link to this heading">¶</a></h2>
<section id="id576">
<h3>Important<a class="headerlink" href="#id576" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">4.6.X</span></code> series will be the last series to support <strong>Python 2 and Python 3.4</strong>.</p>
<p>For more details, see our <a class="reference external" href="https://docs.pytest.org/en/7.0.x/py27-py34-deprecation.html">Python 2.7 and 3.4 support plan</a>.</p>
</section>
<section id="id578">
<h3>Features<a class="headerlink" href="#id578" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4559">#4559</a>: Added the <code class="docutils literal notranslate"><span class="pre">junit_log_passing_tests</span></code> ini value which can be used to enable or disable logging of passing test output in the Junit XML file.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4956">#4956</a>: pytester’s <code class="docutils literal notranslate"><span class="pre">testdir.spawn</span></code> uses <code class="docutils literal notranslate"><span class="pre">tmpdir</span></code> as HOME/USERPROFILE directory.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5062">#5062</a>: Unroll calls to <code class="docutils literal notranslate"><span class="pre">all</span></code> to full for-loops with assertion rewriting for better failure messages, especially when using Generator Expressions.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5063">#5063</a>: Switch from <code class="docutils literal notranslate"><span class="pre">pkg_resources</span></code> to <code class="docutils literal notranslate"><span class="pre">importlib-metadata</span></code> for entrypoint detection for improved performance and import time.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5091">#5091</a>: The output for ini options in <code class="docutils literal notranslate"><span class="pre">--help</span></code> has been improved.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5269">#5269</a>: <code class="docutils literal notranslate"><span class="pre">pytest.importorskip</span></code> includes the <code class="docutils literal notranslate"><span class="pre">ImportError</span></code> now in the default <code class="docutils literal notranslate"><span class="pre">reason</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5311">#5311</a>: Captured logs that are output for each failing test are formatted using the
ColoredLevelFormatter.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5312">#5312</a>: Improved formatting of multiline log messages in Python 3.</p></li>
</ul>
</section>
<section id="id579">
<h3>Bug Fixes<a class="headerlink" href="#id579" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2064">#2064</a>: The debugging plugin imports the wrapped <code class="docutils literal notranslate"><span class="pre">Pdb</span></code> class (<code class="docutils literal notranslate"><span class="pre">--pdbcls</span></code>) on-demand now.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4908">#4908</a>: The <code class="docutils literal notranslate"><span class="pre">pytest_enter_pdb</span></code> hook gets called with post-mortem (<code class="docutils literal notranslate"><span class="pre">--pdb</span></code>).</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5036">#5036</a>: Fix issue where fixtures dependent on other parametrized fixtures would be erroneously parametrized.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5256">#5256</a>: Handle internal error due to a lone surrogate unicode character not being representable in Jython.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5257">#5257</a>: Ensure that <code class="docutils literal notranslate"><span class="pre">sys.stdout.mode</span></code> does not include <code class="docutils literal notranslate"><span class="pre">'b'</span></code> as it is a text stream.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5278">#5278</a>: Pytest’s internal python plugin can be disabled using <code class="docutils literal notranslate"><span class="pre">-p</span> <span class="pre">no:python</span></code> again.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5286">#5286</a>: Fix issue with <code class="docutils literal notranslate"><span class="pre">disable_test_id_escaping_and_forfeit_all_rights_to_community_support</span></code> option not working when using a list of test IDs in parametrized tests.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5330">#5330</a>: Show the test module being collected when emitting <code class="docutils literal notranslate"><span class="pre">PytestCollectionWarning</span></code> messages for
test classes with <code class="docutils literal notranslate"><span class="pre">__init__</span></code> and <code class="docutils literal notranslate"><span class="pre">__new__</span></code> methods to make it easier to pin down the problem.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5333">#5333</a>: Fix regression in 4.5.0 with <code class="docutils literal notranslate"><span class="pre">--lf</span></code> not re-running all tests with known failures from non-selected tests.</p></li>
</ul>
</section>
<section id="id580">
<h3>Improved Documentation<a class="headerlink" href="#id580" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5250">#5250</a>: Expand docs on use of <code class="docutils literal notranslate"><span class="pre">setenv</span></code> and <code class="docutils literal notranslate"><span class="pre">delenv</span></code> with <code class="docutils literal notranslate"><span class="pre">monkeypatch</span></code>.</p></li>
</ul>
</section>
</section>
<section id="pytest-4-5-0-2019-05-11">
<h2>pytest 4.5.0 (2019-05-11)<a class="headerlink" href="#pytest-4-5-0-2019-05-11" title="Link to this heading">¶</a></h2>
<section id="id581">
<h3>Features<a class="headerlink" href="#id581" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4826">#4826</a>: A warning is now emitted when unknown marks are used as a decorator.
This is often due to a typo, which can lead to silently broken tests.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4907">#4907</a>: Show XFail reason as part of JUnitXML message field.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5013">#5013</a>: Messages from crash reports are displayed within test summaries now, truncated to the terminal width.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5023">#5023</a>: New flag <code class="docutils literal notranslate"><span class="pre">--strict-markers</span></code> that triggers an error when unknown markers (e.g. those not registered using the <a class="reference internal" href="reference/reference.html#confval-27"><code class="xref std std-confval docutils literal notranslate"><span class="pre">markers</span></code></a> option in the configuration file) are used in the test suite.</p>
<p>The existing <code class="docutils literal notranslate"><span class="pre">--strict</span></code> option has the same behavior currently, but can be augmented in the future for additional checks.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5026">#5026</a>: Assertion failure messages for sequences and dicts contain the number of different items now.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5034">#5034</a>: Improve reporting with <code class="docutils literal notranslate"><span class="pre">--lf</span></code> and <code class="docutils literal notranslate"><span class="pre">--ff</span></code> (run-last-failure).</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5035">#5035</a>: The <code class="docutils literal notranslate"><span class="pre">--cache-show</span></code> option/action accepts an optional glob to show only matching cache entries.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5059">#5059</a>: Standard input (stdin) can be given to pytester’s <code class="docutils literal notranslate"><span class="pre">Testdir.run()</span></code> and <code class="docutils literal notranslate"><span class="pre">Testdir.popen()</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5068">#5068</a>: The <code class="docutils literal notranslate"><span class="pre">-r</span></code> option learnt about <code class="docutils literal notranslate"><span class="pre">A</span></code> to display all reports (including passed ones) in the short test summary.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5108">#5108</a>: The short test summary is displayed after passes with output (<code class="docutils literal notranslate"><span class="pre">-rP</span></code>).</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5172">#5172</a>: The <code class="docutils literal notranslate"><span class="pre">--last-failed</span></code> (<code class="docutils literal notranslate"><span class="pre">--lf</span></code>) option got smarter and will now skip entire files if all tests
of that test file have passed in previous runs, greatly speeding up collection.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5177">#5177</a>: Introduce new specific warning <code class="docutils literal notranslate"><span class="pre">PytestWarning</span></code> subclasses to make it easier to filter warnings based on the class, rather than on the message. The new subclasses are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">PytestAssertRewriteWarning</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PytestCacheWarning</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PytestCollectionWarning</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PytestConfigWarning</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PytestUnhandledCoroutineWarning</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PytestUnknownMarkWarning</span></code></p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5202">#5202</a>: New <code class="docutils literal notranslate"><span class="pre">record_testsuite_property</span></code> session-scoped fixture allows users to log <code class="docutils literal notranslate"><span class="pre">&lt;property&gt;</span></code> tags at the <code class="docutils literal notranslate"><span class="pre">testsuite</span></code>
level with the <code class="docutils literal notranslate"><span class="pre">junitxml</span></code> plugin.</p>
<p>The generated XML is compatible with the latest xunit standard, contrary to
the properties recorded by <code class="docutils literal notranslate"><span class="pre">record_property</span></code> and <code class="docutils literal notranslate"><span class="pre">record_xml_attribute</span></code>.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5214">#5214</a>: The default logging format has been changed to improve readability. Here is an
example of a previous logging message:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">test_log_cli_enabled_disabled</span><span class="o">.</span><span class="n">py</span>    <span class="mi">3</span> <span class="n">CRITICAL</span> <span class="n">critical</span> <span class="n">message</span> <span class="n">logged</span> <span class="n">by</span> <span class="n">test</span>
</pre></div>
</div>
<p>This has now become:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CRITICAL</span> <span class="n">root</span><span class="p">:</span><span class="n">test_log_cli_enabled_disabled</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">3</span> <span class="n">critical</span> <span class="n">message</span> <span class="n">logged</span> <span class="n">by</span> <span class="n">test</span>
</pre></div>
</div>
<p>The formatting can be changed through the <a class="reference internal" href="reference/reference.html#confval-25"><code class="xref std std-confval docutils literal notranslate"><span class="pre">log_format</span></code></a> configuration option.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5220">#5220</a>: <code class="docutils literal notranslate"><span class="pre">--fixtures</span></code> now also shows fixture scope for scopes other than <code class="docutils literal notranslate"><span class="pre">&quot;function&quot;</span></code>.</p></li>
</ul>
</section>
<section id="id582">
<h3>Bug Fixes<a class="headerlink" href="#id582" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5113">#5113</a>: Deselected items from plugins using <code class="docutils literal notranslate"><span class="pre">pytest_collect_modifyitems</span></code> as a hookwrapper are correctly reported now.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5144">#5144</a>: With usage errors <code class="docutils literal notranslate"><span class="pre">exitstatus</span></code> is set to <code class="docutils literal notranslate"><span class="pre">EXIT_USAGEERROR</span></code> in the <code class="docutils literal notranslate"><span class="pre">pytest_sessionfinish</span></code> hook now as expected.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5235">#5235</a>: <code class="docutils literal notranslate"><span class="pre">outcome.exit</span></code> is not used with <code class="docutils literal notranslate"><span class="pre">EOF</span></code> in the pdb wrapper anymore, but only with <code class="docutils literal notranslate"><span class="pre">quit</span></code>.</p></li>
</ul>
</section>
<section id="id583">
<h3>Improved Documentation<a class="headerlink" href="#id583" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4935">#4935</a>: Expand docs on registering marks and the effect of <code class="docutils literal notranslate"><span class="pre">--strict</span></code>.</p></li>
</ul>
</section>
<section id="id584">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id584" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4942">#4942</a>: <code class="docutils literal notranslate"><span class="pre">logging.raiseExceptions</span></code> is not set to <code class="docutils literal notranslate"><span class="pre">False</span></code> anymore.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5013">#5013</a>: pytest now depends on <a class="reference external" href="https://pypi.org/project/wcwidth">wcwidth</a> to properly track unicode character sizes for more precise terminal output.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5059">#5059</a>: pytester’s <code class="docutils literal notranslate"><span class="pre">Testdir.popen()</span></code> uses <code class="docutils literal notranslate"><span class="pre">stdout</span></code> and <code class="docutils literal notranslate"><span class="pre">stderr</span></code> via keyword arguments with defaults now (<code class="docutils literal notranslate"><span class="pre">subprocess.PIPE</span></code>).</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5069">#5069</a>: The code for the short test summary in the terminal was moved to the terminal plugin.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5082">#5082</a>: Improved validation of kwargs for various methods in the pytester plugin.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5202">#5202</a>: <code class="docutils literal notranslate"><span class="pre">record_property</span></code> now emits a <code class="docutils literal notranslate"><span class="pre">PytestWarning</span></code> when used with <code class="docutils literal notranslate"><span class="pre">junit_family=xunit2</span></code>: the fixture generates
<code class="docutils literal notranslate"><span class="pre">property</span></code> tags as children of <code class="docutils literal notranslate"><span class="pre">testcase</span></code>, which is not permitted according to the most
<a class="reference external" href="https://github.com/jenkinsci/xunit-plugin/blob/master/src/main/resources/org/jenkinsci/plugins/xunit/types/model/xsd/junit-10.xsd">recent schema</a>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5239">#5239</a>: Pin <code class="docutils literal notranslate"><span class="pre">pluggy</span></code> to <code class="docutils literal notranslate"><span class="pre">&lt;</span> <span class="pre">1.0</span></code> so we don’t update to <code class="docutils literal notranslate"><span class="pre">1.0</span></code> automatically when
it gets released: there are planned breaking changes, and we want to ensure
pytest properly supports <code class="docutils literal notranslate"><span class="pre">pluggy</span> <span class="pre">1.0</span></code>.</p></li>
</ul>
</section>
</section>
<section id="pytest-4-4-2-2019-05-08">
<h2>pytest 4.4.2 (2019-05-08)<a class="headerlink" href="#pytest-4-4-2-2019-05-08" title="Link to this heading">¶</a></h2>
<section id="id585">
<h3>Bug Fixes<a class="headerlink" href="#id585" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5089">#5089</a>: Fix crash caused by error in <code class="docutils literal notranslate"><span class="pre">__repr__</span></code> function with both <code class="docutils literal notranslate"><span class="pre">showlocals</span></code> and verbose output enabled.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5139">#5139</a>: Eliminate core dependency on ‘terminal’ plugin.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5229">#5229</a>: Require <code class="docutils literal notranslate"><span class="pre">pluggy&gt;=0.11.0</span></code> which reverts a dependency to <code class="docutils literal notranslate"><span class="pre">importlib-metadata</span></code> added in <code class="docutils literal notranslate"><span class="pre">0.10.0</span></code>.
The <code class="docutils literal notranslate"><span class="pre">importlib-metadata</span></code> package cannot be imported when installed as an egg and causes issues when relying on <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> to install test dependencies.</p></li>
</ul>
</section>
<section id="id586">
<h3>Improved Documentation<a class="headerlink" href="#id586" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5171">#5171</a>: Doc: <code class="docutils literal notranslate"><span class="pre">pytest_ignore_collect</span></code>, <code class="docutils literal notranslate"><span class="pre">pytest_collect_directory</span></code>, <code class="docutils literal notranslate"><span class="pre">pytest_collect_file</span></code> and <code class="docutils literal notranslate"><span class="pre">pytest_pycollect_makemodule</span></code> hooks’s ‘path’ parameter documented type is now <code class="docutils literal notranslate"><span class="pre">py.path.local</span></code></p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5188">#5188</a>: Improve help for <code class="docutils literal notranslate"><span class="pre">--runxfail</span></code> flag.</p></li>
</ul>
</section>
<section id="id587">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id587" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5182">#5182</a>: Removed internal and unused <code class="docutils literal notranslate"><span class="pre">_pytest.deprecated.MARK_INFO_ATTRIBUTE</span></code>.</p></li>
</ul>
</section>
</section>
<section id="pytest-4-4-1-2019-04-15">
<h2>pytest 4.4.1 (2019-04-15)<a class="headerlink" href="#pytest-4-4-1-2019-04-15" title="Link to this heading">¶</a></h2>
<section id="id588">
<h3>Bug Fixes<a class="headerlink" href="#id588" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5031">#5031</a>: Environment variables are properly restored when using pytester’s <code class="docutils literal notranslate"><span class="pre">testdir</span></code> fixture.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5039">#5039</a>: Fix regression with <code class="docutils literal notranslate"><span class="pre">--pdbcls</span></code>, which stopped working with local modules in 4.0.0.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5092">#5092</a>: Produce a warning when unknown keywords are passed to <code class="docutils literal notranslate"><span class="pre">pytest.param(...)</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5098">#5098</a>: Invalidate import caches with <code class="docutils literal notranslate"><span class="pre">monkeypatch.syspath_prepend</span></code>, which is required with namespace packages being used.</p></li>
</ul>
</section>
</section>
<section id="pytest-4-4-0-2019-03-29">
<h2>pytest 4.4.0 (2019-03-29)<a class="headerlink" href="#pytest-4-4-0-2019-03-29" title="Link to this heading">¶</a></h2>
<section id="id589">
<h3>Features<a class="headerlink" href="#id589" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2224">#2224</a>: <code class="docutils literal notranslate"><span class="pre">async</span></code> test functions are skipped and a warning is emitted when a suitable
async plugin is not installed (such as <code class="docutils literal notranslate"><span class="pre">pytest-asyncio</span></code> or <code class="docutils literal notranslate"><span class="pre">pytest-trio</span></code>).</p>
<p>Previously <code class="docutils literal notranslate"><span class="pre">async</span></code> functions would not execute at all but still be marked as “passed”.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2482">#2482</a>: Include new <code class="docutils literal notranslate"><span class="pre">disable_test_id_escaping_and_forfeit_all_rights_to_community_support</span></code> option to disable ascii-escaping in parametrized values. This may cause a series of problems and as the name makes clear, use at your own risk.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4718">#4718</a>: The <code class="docutils literal notranslate"><span class="pre">-p</span></code> option can now be used to early-load plugins also by entry-point name, instead of just
by module name.</p>
<p>This makes it possible to early load external plugins like <code class="docutils literal notranslate"><span class="pre">pytest-cov</span></code> in the command-line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pytest</span> <span class="o">-</span><span class="n">p</span> <span class="n">pytest_cov</span>
</pre></div>
</div>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4855">#4855</a>: The <code class="docutils literal notranslate"><span class="pre">--pdbcls</span></code> option handles classes via module attributes now (e.g.
<code class="docutils literal notranslate"><span class="pre">pdb:pdb.Pdb</span></code> with <a class="reference external" href="https://pypi.org/project/pdbpp">pdbpp</a>), and its validation was improved.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4875">#4875</a>: The <a class="reference internal" href="reference/reference.html#confval-35"><code class="xref std std-confval docutils literal notranslate"><span class="pre">testpaths</span></code></a> configuration option is now displayed next
to the <code class="docutils literal notranslate"><span class="pre">rootdir</span></code> and <code class="docutils literal notranslate"><span class="pre">inifile</span></code> lines in the pytest header if the option is in effect, i.e., directories or file names were
not explicitly passed in the command line.</p>
<p>Also, <code class="docutils literal notranslate"><span class="pre">inifile</span></code> is only displayed if there’s a configuration file, instead of an empty <code class="docutils literal notranslate"><span class="pre">inifile:</span></code> string.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4911">#4911</a>: Doctests can be skipped now dynamically using <code class="docutils literal notranslate"><span class="pre">pytest.skip()</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4920">#4920</a>: Internal refactorings have been made in order to make the implementation of the
<a class="reference external" href="https://github.com/pytest-dev/pytest-subtests">pytest-subtests</a> plugin
possible, which adds unittest sub-test support and a new <code class="docutils literal notranslate"><span class="pre">subtests</span></code> fixture as discussed in
<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1367">#1367</a>.</p>
<p>For details on the internal refactorings, please see the details on the related PR.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4931">#4931</a>: pytester’s <code class="docutils literal notranslate"><span class="pre">LineMatcher</span></code> asserts that the passed lines are a sequence.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4936">#4936</a>: Handle <code class="docutils literal notranslate"><span class="pre">-p</span> <span class="pre">plug</span></code> after <code class="docutils literal notranslate"><span class="pre">-p</span> <span class="pre">no:plug</span></code>.</p>
<p>This can be used to override a blocked plugin (e.g. in “addopts”) from the
command line etc.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4951">#4951</a>: Output capturing is handled correctly when only capturing via fixtures (capsys, capfs) with <code class="docutils literal notranslate"><span class="pre">pdb.set_trace()</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4956">#4956</a>: <code class="docutils literal notranslate"><span class="pre">pytester</span></code> sets <code class="docutils literal notranslate"><span class="pre">$HOME</span></code> and <code class="docutils literal notranslate"><span class="pre">$USERPROFILE</span></code> to the temporary directory during test runs.</p>
<p>This ensures to not load configuration files from the real user’s home directory.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4980">#4980</a>: Namespace packages are handled better with <code class="docutils literal notranslate"><span class="pre">monkeypatch.syspath_prepend</span></code> and <code class="docutils literal notranslate"><span class="pre">testdir.syspathinsert</span></code> (via <code class="docutils literal notranslate"><span class="pre">pkg_resources.fixup_namespace_packages</span></code>).</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4993">#4993</a>: The stepwise plugin reports status information now.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5008">#5008</a>: If a <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code> file contains <code class="docutils literal notranslate"><span class="pre">[tool:pytest]</span></code> and also the no longer supported <code class="docutils literal notranslate"><span class="pre">[pytest]</span></code> section, pytest will use <code class="docutils literal notranslate"><span class="pre">[tool:pytest]</span></code> ignoring <code class="docutils literal notranslate"><span class="pre">[pytest]</span></code>. Previously it would unconditionally error out.</p>
<p>This makes it simpler for plugins to support old pytest versions.</p>
</li>
</ul>
</section>
<section id="id590">
<h3>Bug Fixes<a class="headerlink" href="#id590" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1895">#1895</a>: Fix bug where fixtures requested dynamically via <code class="docutils literal notranslate"><span class="pre">request.getfixturevalue()</span></code> might be teardown
before the requesting fixture.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4851">#4851</a>: pytester unsets <code class="docutils literal notranslate"><span class="pre">PYTEST_ADDOPTS</span></code> now to not use outer options with <code class="docutils literal notranslate"><span class="pre">testdir.runpytest()</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4903">#4903</a>: Use the correct modified time for years after 2038 in rewritten <code class="docutils literal notranslate"><span class="pre">.pyc</span></code> files.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4928">#4928</a>: Fix line offsets with <code class="docutils literal notranslate"><span class="pre">ScopeMismatch</span></code> errors.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4957">#4957</a>: <code class="docutils literal notranslate"><span class="pre">-p</span> <span class="pre">no:plugin</span></code> is handled correctly for default (internal) plugins now, e.g. with <code class="docutils literal notranslate"><span class="pre">-p</span> <span class="pre">no:capture</span></code>.</p>
<p>Previously they were loaded (imported) always, making e.g. the <code class="docutils literal notranslate"><span class="pre">capfd</span></code> fixture available.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4968">#4968</a>: The pdb <code class="docutils literal notranslate"><span class="pre">quit</span></code> command is handled properly when used after the <code class="docutils literal notranslate"><span class="pre">debug</span></code> command with <a class="reference external" href="https://pypi.org/project/pdbpp">pdbpp</a>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4975">#4975</a>: Fix the interpretation of <code class="docutils literal notranslate"><span class="pre">-qq</span></code> option where it was being considered as <code class="docutils literal notranslate"><span class="pre">-v</span></code> instead.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4978">#4978</a>: <code class="docutils literal notranslate"><span class="pre">outcomes.Exit</span></code> is not swallowed in <code class="docutils literal notranslate"><span class="pre">assertrepr_compare</span></code> anymore.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4988">#4988</a>: Close logging’s file handler explicitly when the session finishes.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/5003">#5003</a>: Fix line offset with mark collection error (off by one).</p></li>
</ul>
</section>
<section id="id591">
<h3>Improved Documentation<a class="headerlink" href="#id591" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4974">#4974</a>: Update docs for <code class="docutils literal notranslate"><span class="pre">pytest_cmdline_parse</span></code> hook to note availability limitations</p></li>
</ul>
</section>
<section id="id592">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id592" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4718">#4718</a>: <code class="docutils literal notranslate"><span class="pre">pluggy&gt;=0.9</span></code> is now required.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4815">#4815</a>: <code class="docutils literal notranslate"><span class="pre">funcsigs&gt;=1.0</span></code> is now required for Python 2.7.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4829">#4829</a>: Some left-over internal code related to <code class="docutils literal notranslate"><span class="pre">yield</span></code> tests has been removed.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4890">#4890</a>: Remove internally unused <code class="docutils literal notranslate"><span class="pre">anypython</span></code> fixture from the pytester plugin.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4912">#4912</a>: Remove deprecated Sphinx directive, <code class="docutils literal notranslate"><span class="pre">add_description_unit()</span></code>,
pin sphinx-removed-in to &gt;= 0.2.0 to support Sphinx 2.0.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4913">#4913</a>: Fix pytest tests invocation with custom <code class="docutils literal notranslate"><span class="pre">PYTHONPATH</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4965">#4965</a>: New <code class="docutils literal notranslate"><span class="pre">pytest_report_to_serializable</span></code> and <code class="docutils literal notranslate"><span class="pre">pytest_report_from_serializable</span></code> <strong>experimental</strong> hooks.</p>
<p>These hooks will be used by <code class="docutils literal notranslate"><span class="pre">pytest-xdist</span></code>, <code class="docutils literal notranslate"><span class="pre">pytest-subtests</span></code>, and the replacement for
resultlog to serialize and customize reports.</p>
<p>They are experimental, meaning that their details might change or even be removed
completely in future patch releases without warning.</p>
<p>Feedback is welcome from plugin authors and users alike.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4987">#4987</a>: <code class="docutils literal notranslate"><span class="pre">Collector.repr_failure</span></code> respects the <code class="docutils literal notranslate"><span class="pre">--tb</span></code> option, but only defaults to <code class="docutils literal notranslate"><span class="pre">short</span></code> now (with <code class="docutils literal notranslate"><span class="pre">auto</span></code>).</p></li>
</ul>
</section>
</section>
<section id="pytest-4-3-1-2019-03-11">
<h2>pytest 4.3.1 (2019-03-11)<a class="headerlink" href="#pytest-4-3-1-2019-03-11" title="Link to this heading">¶</a></h2>
<section id="id593">
<h3>Bug Fixes<a class="headerlink" href="#id593" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4810">#4810</a>: Logging messages inside <code class="docutils literal notranslate"><span class="pre">pytest_runtest_logreport()</span></code> are now properly captured and displayed.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4861">#4861</a>: Improve validation of contents written to captured output so it behaves the same as when capture is disabled.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4898">#4898</a>: Fix <code class="docutils literal notranslate"><span class="pre">AttributeError:</span> <span class="pre">FixtureRequest</span> <span class="pre">has</span> <span class="pre">no</span> <span class="pre">'confg'</span> <span class="pre">attribute</span></code> bug in <code class="docutils literal notranslate"><span class="pre">testdir.copy_example</span></code>.</p></li>
</ul>
</section>
<section id="id594">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id594" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4768">#4768</a>: Avoid pkg_resources import at the top-level.</p></li>
</ul>
</section>
</section>
<section id="pytest-4-3-0-2019-02-16">
<h2>pytest 4.3.0 (2019-02-16)<a class="headerlink" href="#pytest-4-3-0-2019-02-16" title="Link to this heading">¶</a></h2>
<section id="id595">
<h3>Deprecations<a class="headerlink" href="#id595" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4724">#4724</a>: <code class="docutils literal notranslate"><span class="pre">pytest.warns()</span></code> now emits a warning when it receives unknown keyword arguments.</p>
<p>This will be changed into an error in the future.</p>
</li>
</ul>
</section>
<section id="id596">
<h3>Features<a class="headerlink" href="#id596" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2753">#2753</a>: Usage errors from argparse are mapped to pytest’s <code class="docutils literal notranslate"><span class="pre">UsageError</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3711">#3711</a>: Add the <code class="docutils literal notranslate"><span class="pre">--ignore-glob</span></code> parameter to exclude test-modules with Unix shell-style wildcards.
Add the <a class="reference internal" href="reference/reference.html#globalvar-1"><code class="xref std std-globalvar docutils literal notranslate"><span class="pre">collect_ignore_glob</span></code></a> for <code class="docutils literal notranslate"><span class="pre">conftest.py</span></code> to exclude test-modules with Unix shell-style wildcards.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4698">#4698</a>: The warning about Python 2.7 and 3.4 not being supported in pytest 5.0 has been removed.</p>
<p>In the end it was considered to be more
of a nuisance than actual utility and users of those Python versions shouldn’t have problems as <code class="docutils literal notranslate"><span class="pre">pip</span></code> will not
install pytest 5.0 on those interpreters.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4707">#4707</a>: With the help of new <code class="docutils literal notranslate"><span class="pre">set_log_path()</span></code> method there is a way to set <code class="docutils literal notranslate"><span class="pre">log_file</span></code> paths from hooks.</p></li>
</ul>
</section>
<section id="id597">
<h3>Bug Fixes<a class="headerlink" href="#id597" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4651">#4651</a>: <code class="docutils literal notranslate"><span class="pre">--help</span></code> and <code class="docutils literal notranslate"><span class="pre">--version</span></code> are handled with <code class="docutils literal notranslate"><span class="pre">UsageError</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4782">#4782</a>: Fix <code class="docutils literal notranslate"><span class="pre">AssertionError</span></code> with collection of broken symlinks with packages.</p></li>
</ul>
</section>
</section>
<section id="pytest-4-2-1-2019-02-12">
<h2>pytest 4.2.1 (2019-02-12)<a class="headerlink" href="#pytest-4-2-1-2019-02-12" title="Link to this heading">¶</a></h2>
<section id="id598">
<h3>Bug Fixes<a class="headerlink" href="#id598" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2895">#2895</a>: The <code class="docutils literal notranslate"><span class="pre">pytest_report_collectionfinish</span></code> hook now is also called with <code class="docutils literal notranslate"><span class="pre">--collect-only</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3899">#3899</a>: Do not raise <code class="docutils literal notranslate"><span class="pre">UsageError</span></code> when an imported package has a <code class="docutils literal notranslate"><span class="pre">pytest_plugins.py</span></code> child module.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4347">#4347</a>: Fix output capturing when using pdb++ with recursive debugging.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4592">#4592</a>: Fix handling of <code class="docutils literal notranslate"><span class="pre">collect_ignore</span></code> via parent <code class="docutils literal notranslate"><span class="pre">conftest.py</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4700">#4700</a>: Fix regression where <code class="docutils literal notranslate"><span class="pre">setUpClass</span></code> would always be called in subclasses even if all tests
were skipped by a <code class="docutils literal notranslate"><span class="pre">unittest.skip()</span></code> decorator applied in the subclass.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4739">#4739</a>: Fix <code class="docutils literal notranslate"><span class="pre">parametrize(...</span> <span class="pre">ids=&lt;function&gt;)</span></code> when the function returns non-strings.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4745">#4745</a>: Fix/improve collection of args when passing in <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> and a test file.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4770">#4770</a>: <code class="docutils literal notranslate"><span class="pre">more_itertools</span></code> is now constrained to &lt;6.0.0 when required for Python 2.7 compatibility.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/526">#526</a>: Fix “ValueError: Plugin already registered” exceptions when running in build directories that symlink to actual source.</p></li>
</ul>
</section>
<section id="id599">
<h3>Improved Documentation<a class="headerlink" href="#id599" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3899">#3899</a>: Add note to <code class="docutils literal notranslate"><span class="pre">plugins.rst</span></code> that <code class="docutils literal notranslate"><span class="pre">pytest_plugins</span></code> should not be used as a name for a user module containing plugins.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4324">#4324</a>: Document how to use <code class="docutils literal notranslate"><span class="pre">raises</span></code> and <code class="docutils literal notranslate"><span class="pre">does_not_raise</span></code> to write parametrized tests with conditional raises.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4709">#4709</a>: Document how to customize test failure messages when using
<code class="docutils literal notranslate"><span class="pre">pytest.warns</span></code>.</p></li>
</ul>
</section>
<section id="id600">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id600" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4741">#4741</a>: Some verbosity related attributes of the TerminalReporter plugin are now
read only properties.</p></li>
</ul>
</section>
</section>
<section id="pytest-4-2-0-2019-01-30">
<h2>pytest 4.2.0 (2019-01-30)<a class="headerlink" href="#pytest-4-2-0-2019-01-30" title="Link to this heading">¶</a></h2>
<section id="id601">
<h3>Features<a class="headerlink" href="#id601" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3094">#3094</a>: <a class="reference internal" href="how-to/xunit_setup.html"><span class="doc">Classic xunit-style</span></a> functions and methods
now obey the scope of <em>autouse</em> fixtures.</p>
<p>This fixes a number of surprising issues like <code class="docutils literal notranslate"><span class="pre">setup_method</span></code> being called before session-scoped
autouse fixtures (see <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/517">#517</a> for an example).</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4627">#4627</a>: Display a message at the end of the test session when running under Python 2.7 and 3.4 that pytest 5.0 will no longer
support those Python versions.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4660">#4660</a>: The number of <em>selected</em> tests now are also displayed when the <code class="docutils literal notranslate"><span class="pre">-k</span></code> or <code class="docutils literal notranslate"><span class="pre">-m</span></code> flags are used.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4688">#4688</a>: <code class="docutils literal notranslate"><span class="pre">pytest_report_teststatus</span></code> hook now can also receive a <code class="docutils literal notranslate"><span class="pre">config</span></code> parameter.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4691">#4691</a>: <code class="docutils literal notranslate"><span class="pre">pytest_terminal_summary</span></code> hook now can also receive a <code class="docutils literal notranslate"><span class="pre">config</span></code> parameter.</p></li>
</ul>
</section>
<section id="id602">
<h3>Bug Fixes<a class="headerlink" href="#id602" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3547">#3547</a>: <code class="docutils literal notranslate"><span class="pre">--junitxml</span></code> can emit XML compatible with Jenkins xUnit.
<code class="docutils literal notranslate"><span class="pre">junit_family</span></code> INI option accepts <code class="docutils literal notranslate"><span class="pre">legacy|xunit1</span></code>, which produces old style output, and <code class="docutils literal notranslate"><span class="pre">xunit2</span></code> that conforms more strictly to <a class="reference external" href="https://github.com/jenkinsci/xunit-plugin/blob/xunit-2.3.2/src/main/resources/org/jenkinsci/plugins/xunit/types/model/xsd/junit-10.xsd">https://github.com/jenkinsci/xunit-plugin/blob/xunit-2.3.2/src/main/resources/org/jenkinsci/plugins/xunit/types/model/xsd/junit-10.xsd</a></p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4280">#4280</a>: Improve quitting from pdb, especially with <code class="docutils literal notranslate"><span class="pre">--trace</span></code>.</p>
<p>Using <code class="docutils literal notranslate"><span class="pre">q[quit]</span></code> after <code class="docutils literal notranslate"><span class="pre">pdb.set_trace()</span></code> will quit pytest also.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4402">#4402</a>: Warning summary now groups warnings by message instead of by test id.</p>
<p>This makes the output more compact and better conveys the general idea of how much code is
actually generating warnings, instead of how many tests call that code.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4536">#4536</a>: <code class="docutils literal notranslate"><span class="pre">monkeypatch.delattr</span></code> handles class descriptors like <code class="docutils literal notranslate"><span class="pre">staticmethod</span></code>/<code class="docutils literal notranslate"><span class="pre">classmethod</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4649">#4649</a>: Restore marks being considered keywords for keyword expressions.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4653">#4653</a>: <code class="docutils literal notranslate"><span class="pre">tmp_path</span></code> fixture and other related ones provides resolved path (a.k.a real path)</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4667">#4667</a>: <code class="docutils literal notranslate"><span class="pre">pytest_terminal_summary</span></code> uses result from <code class="docutils literal notranslate"><span class="pre">pytest_report_teststatus</span></code> hook, rather than hardcoded strings.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4669">#4669</a>: Correctly handle <code class="docutils literal notranslate"><span class="pre">unittest.SkipTest</span></code> exception containing non-ascii characters on Python 2.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4680">#4680</a>: Ensure the <code class="docutils literal notranslate"><span class="pre">tmpdir</span></code> and the <code class="docutils literal notranslate"><span class="pre">tmp_path</span></code> fixtures are the same folder.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4681">#4681</a>: Ensure <code class="docutils literal notranslate"><span class="pre">tmp_path</span></code> is always a real path.</p></li>
</ul>
</section>
<section id="id603">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id603" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4643">#4643</a>: Use <code class="docutils literal notranslate"><span class="pre">a.item()</span></code> instead of the deprecated <code class="docutils literal notranslate"><span class="pre">np.asscalar(a)</span></code> in <code class="docutils literal notranslate"><span class="pre">pytest.approx</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">np.asscalar</span></code> has been <a class="reference external" href="https://numpy.org/doc/stable/release/1.16.0-notes.html" title="(in NumPy v2.1)"><span class="xref std std-doc">deprecated</span></a> in <code class="docutils literal notranslate"><span class="pre">numpy</span> <span class="pre">1.16.</span></code>.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4657">#4657</a>: Copy saferepr from pylib</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4668">#4668</a>: The verbose word for expected failures in the teststatus report changes from <code class="docutils literal notranslate"><span class="pre">xfail</span></code> to <code class="docutils literal notranslate"><span class="pre">XFAIL</span></code> to be consistent with other test outcomes.</p></li>
</ul>
</section>
</section>
<section id="pytest-4-1-1-2019-01-12">
<h2>pytest 4.1.1 (2019-01-12)<a class="headerlink" href="#pytest-4-1-1-2019-01-12" title="Link to this heading">¶</a></h2>
<section id="id604">
<h3>Bug Fixes<a class="headerlink" href="#id604" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2256">#2256</a>: Show full repr with <code class="docutils literal notranslate"><span class="pre">assert</span> <span class="pre">a==b</span></code> and <code class="docutils literal notranslate"><span class="pre">-vv</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3456">#3456</a>: Extend Doctest-modules to ignore mock objects.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4617">#4617</a>: Fixed <code class="docutils literal notranslate"><span class="pre">pytest.warns</span></code> bug when context manager is reused (e.g. multiple parametrization).</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4631">#4631</a>: Don’t rewrite assertion when <code class="docutils literal notranslate"><span class="pre">__getattr__</span></code> is broken</p></li>
</ul>
</section>
<section id="id605">
<h3>Improved Documentation<a class="headerlink" href="#id605" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3375">#3375</a>: Document that using <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code> may crash other tools or cause hard to track down problems because it uses a different parser than <code class="docutils literal notranslate"><span class="pre">pytest.ini</span></code> or <code class="docutils literal notranslate"><span class="pre">tox.ini</span></code> files.</p></li>
</ul>
</section>
<section id="id606">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id606" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4602">#4602</a>: Uninstall <code class="docutils literal notranslate"><span class="pre">hypothesis</span></code> in regen tox env.</p></li>
</ul>
</section>
</section>
<section id="pytest-4-1-0-2019-01-05">
<h2>pytest 4.1.0 (2019-01-05)<a class="headerlink" href="#pytest-4-1-0-2019-01-05" title="Link to this heading">¶</a></h2>
<section id="id607">
<h3>Removals<a class="headerlink" href="#id607" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2169">#2169</a>: <code class="docutils literal notranslate"><span class="pre">pytest.mark.parametrize</span></code>: in previous versions, errors raised by id functions were suppressed and changed into warnings. Now the exceptions are propagated, along with a pytest message informing the node, parameter value and index where the exception occurred.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3078">#3078</a>: Remove legacy internal warnings system: <code class="docutils literal notranslate"><span class="pre">config.warn</span></code>, <code class="docutils literal notranslate"><span class="pre">Node.warn</span></code>. The <code class="docutils literal notranslate"><span class="pre">pytest_logwarning</span></code> now issues a warning when implemented.</p>
<p>See our <a class="reference internal" href="deprecations.html#config-warn-and-node-warn-deprecated"><span class="std std-ref">docs</span></a> on information on how to update your code.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3079">#3079</a>: Removed support for yield tests - they are fundamentally broken because they don’t support fixtures properly since collection and test execution were separated.</p>
<p>See our <a class="reference internal" href="deprecations.html#yield-tests-deprecated"><span class="std std-ref">docs</span></a> on information on how to update your code.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3082">#3082</a>: Removed support for applying marks directly to values in <code class="docutils literal notranslate"><span class="pre">&#64;pytest.mark.parametrize</span></code>. Use <code class="docutils literal notranslate"><span class="pre">pytest.param</span></code> instead.</p>
<p>See our <a class="reference internal" href="deprecations.html#marks-in-pytest-parametrize-deprecated"><span class="std std-ref">docs</span></a> on information on how to update your code.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3083">#3083</a>: Removed <code class="docutils literal notranslate"><span class="pre">Metafunc.addcall</span></code>. This was the predecessor mechanism to <code class="docutils literal notranslate"><span class="pre">&#64;pytest.mark.parametrize</span></code>.</p>
<p>See our <a class="reference internal" href="deprecations.html#metafunc-addcall-deprecated"><span class="std std-ref">docs</span></a> on information on how to update your code.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3085">#3085</a>: Removed support for passing strings to <code class="docutils literal notranslate"><span class="pre">pytest.main</span></code>. Now, always pass a list of strings instead.</p>
<p>See our <a class="reference internal" href="deprecations.html#passing-command-line-string-to-pytest-main-deprecated"><span class="std std-ref">docs</span></a> on information on how to update your code.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3086">#3086</a>: <code class="docutils literal notranslate"><span class="pre">[pytest]</span></code> section in <strong>setup.cfg</strong> files is no longer supported, use <code class="docutils literal notranslate"><span class="pre">[tool:pytest]</span></code> instead. <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code> files
are meant for use with <code class="docutils literal notranslate"><span class="pre">distutils</span></code>, and a section named <code class="docutils literal notranslate"><span class="pre">pytest</span></code> has notoriously been a source of conflicts and bugs.</p>
<p>Note that for <strong>pytest.ini</strong> and <strong>tox.ini</strong> files the section remains <code class="docutils literal notranslate"><span class="pre">[pytest]</span></code>.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3616">#3616</a>: Removed the deprecated compat properties for <code class="docutils literal notranslate"><span class="pre">node.Class/Function/Module</span></code> - use <code class="docutils literal notranslate"><span class="pre">pytest.Class/Function/Module</span></code> now.</p>
<p>See our <a class="reference internal" href="deprecations.html#internal-classes-accessed-through-node-deprecated"><span class="std std-ref">docs</span></a> on information on how to update your code.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4421">#4421</a>: Removed the implementation of the <code class="docutils literal notranslate"><span class="pre">pytest_namespace</span></code> hook.</p>
<p>See our <a class="reference internal" href="deprecations.html#pytest-namespace-deprecated"><span class="std std-ref">docs</span></a> on information on how to update your code.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4489">#4489</a>: Removed <code class="docutils literal notranslate"><span class="pre">request.cached_setup</span></code>. This was the predecessor mechanism to modern fixtures.</p>
<p>See our <a class="reference internal" href="deprecations.html#cached-setup-deprecated"><span class="std std-ref">docs</span></a> on information on how to update your code.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4535">#4535</a>: Removed the deprecated <code class="docutils literal notranslate"><span class="pre">PyCollector.makeitem</span></code> method. This method was made public by mistake a long time ago.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4543">#4543</a>: Removed support to define fixtures using the <code class="docutils literal notranslate"><span class="pre">pytest_funcarg__</span></code> prefix. Use the <code class="docutils literal notranslate"><span class="pre">&#64;pytest.fixture</span></code> decorator instead.</p>
<p>See our <a class="reference internal" href="deprecations.html#pytest-funcarg-prefix-deprecated"><span class="std std-ref">docs</span></a> on information on how to update your code.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4545">#4545</a>: Calling fixtures directly is now always an error instead of a warning.</p>
<p>See our <a class="reference internal" href="deprecations.html#calling-fixtures-directly-deprecated"><span class="std std-ref">docs</span></a> on information on how to update your code.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4546">#4546</a>: Remove <code class="docutils literal notranslate"><span class="pre">Node.get_marker(name)</span></code> the return value was not usable for more than an existence check.</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">Node.get_closest_marker(name)</span></code> as a replacement.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4547">#4547</a>: The deprecated <code class="docutils literal notranslate"><span class="pre">record_xml_property</span></code> fixture has been removed, use the more generic <code class="docutils literal notranslate"><span class="pre">record_property</span></code> instead.</p>
<p>See our <a class="reference internal" href="deprecations.html#record-xml-property-deprecated"><span class="std std-ref">docs</span></a> for more information.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4548">#4548</a>: An error is now raised if the <code class="docutils literal notranslate"><span class="pre">pytest_plugins</span></code> variable is defined in a non-top-level <code class="docutils literal notranslate"><span class="pre">conftest.py</span></code> file (i.e., not residing in the <code class="docutils literal notranslate"><span class="pre">rootdir</span></code>).</p>
<p>See our <a class="reference internal" href="deprecations.html#pytest-plugins-in-non-top-level-conftest-files-deprecated"><span class="std std-ref">docs</span></a> for more information.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/891">#891</a>: Remove <code class="docutils literal notranslate"><span class="pre">testfunction.markername</span></code> attributes - use <code class="docutils literal notranslate"><span class="pre">Node.iter_markers(name=None)</span></code> to iterate them.</p></li>
</ul>
</section>
<section id="id608">
<h3>Deprecations<a class="headerlink" href="#id608" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3050">#3050</a>: Deprecated the <code class="docutils literal notranslate"><span class="pre">pytest.config</span></code> global.</p>
<p>See <a class="reference internal" href="deprecations.html#pytest-config-global-deprecated"><span class="std std-ref">pytest.config global</span></a> for rationale.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3974">#3974</a>: Passing the <code class="docutils literal notranslate"><span class="pre">message</span></code> parameter of <code class="docutils literal notranslate"><span class="pre">pytest.raises</span></code> now issues a <code class="docutils literal notranslate"><span class="pre">DeprecationWarning</span></code>.</p>
<p>It is a common mistake to think this parameter will match the exception message, while in fact
it only serves to provide a custom message in case the <code class="docutils literal notranslate"><span class="pre">pytest.raises</span></code> check fails. To avoid this
mistake and because it is believed to be little used, pytest is deprecating it without providing
an alternative for the moment.</p>
<p>If you have concerns about this, please comment on <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3974">#3974</a>.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4435">#4435</a>: Deprecated <code class="docutils literal notranslate"><span class="pre">raises(...,</span> <span class="pre">'code(as_a_string)')</span></code> and <code class="docutils literal notranslate"><span class="pre">warns(...,</span> <span class="pre">'code(as_a_string)')</span></code>.</p>
<p>See <a class="reference internal" href="deprecations.html#raises-warns-exec"><span class="std std-ref">raises / warns with a string as the second argument</span></a> for rationale and examples.</p>
</li>
</ul>
</section>
<section id="id609">
<h3>Features<a class="headerlink" href="#id609" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3191">#3191</a>: A warning is now issued when assertions are made for <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>This is a common source of confusion among new users, which write:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="n">mocked_object</span><span class="o">.</span><span class="n">assert_called_with</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>When they should write:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mocked_object</span><span class="o">.</span><span class="n">assert_called_with</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Because the <code class="docutils literal notranslate"><span class="pre">assert_called_with</span></code> method of mock objects already executes an assertion.</p>
<p>This warning will not be issued when <code class="docutils literal notranslate"><span class="pre">None</span></code> is explicitly checked. An assertion like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="n">variable</span> <span class="ow">is</span> <span class="kc">None</span>
</pre></div>
</div>
<p>will not issue the warning.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3632">#3632</a>: Richer equality comparison introspection on <code class="docutils literal notranslate"><span class="pre">AssertionError</span></code> for objects created using <a class="reference external" href="https://www.attrs.org/en/stable/">attrs</a> or <a class="reference external" href="https://docs.python.org/3/library/dataclasses.html#module-dataclasses" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dataclasses</span></code></a> (Python 3.7+, <a class="reference external" href="https://pypi.org/project/dataclasses">backported to 3.6</a>).</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4278">#4278</a>: <code class="docutils literal notranslate"><span class="pre">CACHEDIR.TAG</span></code> files are now created inside cache directories.</p>
<p>Those files are part of the <a class="reference external" href="https://bford.info/cachedir/spec.html">Cache Directory Tagging Standard</a>, and can
be used by backup or synchronization programs to identify pytest’s cache directory as such.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4292">#4292</a>: <code class="docutils literal notranslate"><span class="pre">pytest.outcomes.Exit</span></code> is derived from <code class="docutils literal notranslate"><span class="pre">SystemExit</span></code> instead of <code class="docutils literal notranslate"><span class="pre">KeyboardInterrupt</span></code>. This allows us to better handle <code class="docutils literal notranslate"><span class="pre">pdb</span></code> exiting.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4371">#4371</a>: Updated the <code class="docutils literal notranslate"><span class="pre">--collect-only</span></code> option to display test descriptions when ran using <code class="docutils literal notranslate"><span class="pre">--verbose</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4386">#4386</a>: Restructured <code class="docutils literal notranslate"><span class="pre">ExceptionInfo</span></code> object construction and ensure incomplete instances have a <code class="docutils literal notranslate"><span class="pre">repr</span></code>/<code class="docutils literal notranslate"><span class="pre">str</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4416">#4416</a>: pdb: added support for keyword arguments with <code class="docutils literal notranslate"><span class="pre">pdb.set_trace</span></code>.</p>
<p>It handles <code class="docutils literal notranslate"><span class="pre">header</span></code> similar to Python 3.7 does it, and forwards any
other keyword arguments to the <code class="docutils literal notranslate"><span class="pre">Pdb</span></code> constructor.</p>
<p>This allows for <code class="docutils literal notranslate"><span class="pre">__import__(&quot;pdb&quot;).set_trace(skip=[&quot;foo.*&quot;])</span></code>.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4483">#4483</a>: Added ini parameter <code class="docutils literal notranslate"><span class="pre">junit_duration_report</span></code> to optionally report test call durations, excluding setup and teardown times.</p>
<p>The JUnit XML specification and the default pytest behavior is to include setup and teardown times in the test duration
report. You can include just the call durations instead (excluding setup and teardown) by adding this to your <code class="docutils literal notranslate"><span class="pre">pytest.ini</span></code> file:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[pytest]</span>
<span class="na">junit_duration_report</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">call</span>
</pre></div>
</div>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4532">#4532</a>: <code class="docutils literal notranslate"><span class="pre">-ra</span></code> now will show errors and failures last, instead of as the first items in the summary.</p>
<p>This makes it easier to obtain a list of errors and failures to run tests selectively.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4599">#4599</a>: <code class="docutils literal notranslate"><span class="pre">pytest.importorskip</span></code> now supports a <code class="docutils literal notranslate"><span class="pre">reason</span></code> parameter, which will be shown when the
requested module cannot be imported.</p></li>
</ul>
</section>
<section id="id610">
<h3>Bug Fixes<a class="headerlink" href="#id610" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3532">#3532</a>: <code class="docutils literal notranslate"><span class="pre">-p</span></code> now accepts its argument without a space between the value, for example <code class="docutils literal notranslate"><span class="pre">-pmyplugin</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4327">#4327</a>: <code class="docutils literal notranslate"><span class="pre">approx</span></code> again works with more generic containers, more precisely instances of <code class="docutils literal notranslate"><span class="pre">Iterable</span></code> and <code class="docutils literal notranslate"><span class="pre">Sized</span></code> instead of more restrictive <code class="docutils literal notranslate"><span class="pre">Sequence</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4397">#4397</a>: Ensure that node ids are printable.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4435">#4435</a>: Fixed <code class="docutils literal notranslate"><span class="pre">raises(...,</span> <span class="pre">'code(string)')</span></code> frame filename.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4458">#4458</a>: Display actual test ids in <code class="docutils literal notranslate"><span class="pre">--collect-only</span></code>.</p></li>
</ul>
</section>
<section id="id611">
<h3>Improved Documentation<a class="headerlink" href="#id611" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4557">#4557</a>: Markers example documentation page updated to support latest pytest version.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4558">#4558</a>: Update cache documentation example to correctly show cache hit and miss.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4580">#4580</a>: Improved detailed summary report documentation.</p></li>
</ul>
</section>
<section id="id612">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id612" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4447">#4447</a>: Changed the deprecation type of <code class="docutils literal notranslate"><span class="pre">--result-log</span></code> to <code class="docutils literal notranslate"><span class="pre">PytestDeprecationWarning</span></code>.</p>
<p>It was decided to remove this feature at the next major revision.</p>
</li>
</ul>
</section>
</section>
<section id="pytest-4-0-2-2018-12-13">
<h2>pytest 4.0.2 (2018-12-13)<a class="headerlink" href="#pytest-4-0-2-2018-12-13" title="Link to this heading">¶</a></h2>
<section id="id613">
<h3>Bug Fixes<a class="headerlink" href="#id613" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4265">#4265</a>: Validate arguments from the <code class="docutils literal notranslate"><span class="pre">PYTEST_ADDOPTS</span></code> environment variable and the <code class="docutils literal notranslate"><span class="pre">addopts</span></code> ini option separately.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4435">#4435</a>: Fix <code class="docutils literal notranslate"><span class="pre">raises(...,</span> <span class="pre">'code(string)')</span></code> frame filename.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4500">#4500</a>: When a fixture yields and a log call is made after the test runs, and, if the test is interrupted, capture attributes are <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4538">#4538</a>: Raise <code class="docutils literal notranslate"><span class="pre">TypeError</span></code> for <code class="docutils literal notranslate"><span class="pre">with</span> <span class="pre">raises(...,</span> <span class="pre">match=&lt;non-None</span> <span class="pre">falsey</span> <span class="pre">value&gt;)</span></code>.</p></li>
</ul>
</section>
<section id="id614">
<h3>Improved Documentation<a class="headerlink" href="#id614" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1495">#1495</a>: Document common doctest fixture directory tree structure pitfalls</p></li>
</ul>
</section>
</section>
<section id="pytest-4-0-1-2018-11-23">
<h2>pytest 4.0.1 (2018-11-23)<a class="headerlink" href="#pytest-4-0-1-2018-11-23" title="Link to this heading">¶</a></h2>
<section id="id615">
<h3>Bug Fixes<a class="headerlink" href="#id615" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3952">#3952</a>: Display warnings before “short test summary info” again, but still later warnings in the end.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4386">#4386</a>: Handle uninitialized exceptioninfo in repr/str.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4393">#4393</a>: Do not create <code class="docutils literal notranslate"><span class="pre">.gitignore</span></code>/<code class="docutils literal notranslate"><span class="pre">README.md</span></code> files in existing cache directories.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4400">#4400</a>: Rearrange warning handling for the yield test errors so the opt-out in 4.0.x correctly works.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4405">#4405</a>: Fix collection of testpaths with <code class="docutils literal notranslate"><span class="pre">--pyargs</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4412">#4412</a>: Fix assertion rewriting involving <code class="docutils literal notranslate"><span class="pre">Starred</span></code> + side-effects.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4425">#4425</a>: Ensure we resolve the absolute path when the given <code class="docutils literal notranslate"><span class="pre">--basetemp</span></code> is a relative path.</p></li>
</ul>
</section>
<section id="id616">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id616" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4315">#4315</a>: Use <code class="docutils literal notranslate"><span class="pre">pkg_resources.parse_version</span></code> instead of <code class="docutils literal notranslate"><span class="pre">LooseVersion</span></code> in minversion check.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4440">#4440</a>: Adjust the stack level of some internal pytest warnings.</p></li>
</ul>
</section>
</section>
<section id="pytest-4-0-0-2018-11-13">
<h2>pytest 4.0.0 (2018-11-13)<a class="headerlink" href="#pytest-4-0-0-2018-11-13" title="Link to this heading">¶</a></h2>
<section id="id617">
<h3>Removals<a class="headerlink" href="#id617" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3737">#3737</a>: <strong>RemovedInPytest4Warnings are now errors by default.</strong></p>
<p>Following our plan to remove deprecated features with as little disruption as
possible, all warnings of type <code class="docutils literal notranslate"><span class="pre">RemovedInPytest4Warnings</span></code> now generate errors
instead of warning messages.</p>
<p><strong>The affected features will be effectively removed in pytest 4.1</strong>, so please consult the
<a class="reference internal" href="deprecations.html"><span class="doc">Deprecations and Removals</span></a> section in the docs for directions on how to update existing code.</p>
<p>In the pytest <code class="docutils literal notranslate"><span class="pre">4.0.X</span></code> series, it is possible to change the errors back into warnings as a stop
gap measure by adding this to your <code class="docutils literal notranslate"><span class="pre">pytest.ini</span></code> file:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[pytest]</span>
<span class="na">filterwarnings</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="na">ignore</span><span class="o">:</span><span class="s">:pytest.RemovedInPytest4Warning</span>
</pre></div>
</div>
<p>But this will stop working when pytest <code class="docutils literal notranslate"><span class="pre">4.1</span></code> is released.</p>
<p><strong>If you have concerns</strong> about the removal of a specific feature, please add a
comment to <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4348">#4348</a>.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4358">#4358</a>: Remove the <code class="docutils literal notranslate"><span class="pre">::()</span></code> notation to denote a test class instance in node ids.</p>
<p>Previously, node ids that contain test instances would use <code class="docutils literal notranslate"><span class="pre">::()</span></code> to denote the instance like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">test_foo</span><span class="o">.</span><span class="n">py</span><span class="p">::</span><span class="n">Test</span><span class="p">::()::</span><span class="n">test_bar</span>
</pre></div>
</div>
<p>The extra <code class="docutils literal notranslate"><span class="pre">::()</span></code> was puzzling to most users and has been removed, so that the test id becomes now:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">test_foo</span><span class="o">.</span><span class="n">py</span><span class="p">::</span><span class="n">Test</span><span class="p">::</span><span class="n">test_bar</span>
</pre></div>
</div>
<p>This change could not accompany a deprecation period as is usual when user-facing functionality changes because
it was not really possible to detect when the functionality was being used explicitly.</p>
<p>The extra <code class="docutils literal notranslate"><span class="pre">::()</span></code> might have been removed in some places internally already,
which then led to confusion in places where it was expected, e.g. with
<code class="docutils literal notranslate"><span class="pre">--deselect</span></code> (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4127">#4127</a>).</p>
<p>Test class instances are also not listed with <code class="docutils literal notranslate"><span class="pre">--collect-only</span></code> anymore.</p>
</li>
</ul>
</section>
<section id="id618">
<h3>Features<a class="headerlink" href="#id618" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4270">#4270</a>: The <code class="docutils literal notranslate"><span class="pre">cache_dir</span></code> option uses <code class="docutils literal notranslate"><span class="pre">$TOX_ENV_DIR</span></code> as prefix (if set in the environment).</p>
<p>This uses a different cache per tox environment by default.</p>
</li>
</ul>
</section>
<section id="id619">
<h3>Bug Fixes<a class="headerlink" href="#id619" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3554">#3554</a>: Fix <code class="docutils literal notranslate"><span class="pre">CallInfo.__repr__</span></code> for when the call is not finished yet.</p></li>
</ul>
</section>
</section>
<section id="pytest-3-10-1-2018-11-11">
<h2>pytest 3.10.1 (2018-11-11)<a class="headerlink" href="#pytest-3-10-1-2018-11-11" title="Link to this heading">¶</a></h2>
<section id="id620">
<h3>Bug Fixes<a class="headerlink" href="#id620" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4287">#4287</a>: Fix nested usage of debugging plugin (pdb), e.g. with pytester’s <code class="docutils literal notranslate"><span class="pre">testdir.runpytest</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4304">#4304</a>: Block the <code class="docutils literal notranslate"><span class="pre">stepwise</span></code> plugin if <code class="docutils literal notranslate"><span class="pre">cacheprovider</span></code> is also blocked, as one depends on the other.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4306">#4306</a>: Parse <code class="docutils literal notranslate"><span class="pre">minversion</span></code> as an actual version and not as dot-separated strings.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4310">#4310</a>: Fix duplicate collection due to multiple args matching the same packages.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4321">#4321</a>: Fix <code class="docutils literal notranslate"><span class="pre">item.nodeid</span></code> with resolved symlinks.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4325">#4325</a>: Fix collection of direct symlinked files, where the target does not match <code class="docutils literal notranslate"><span class="pre">python_files</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4329">#4329</a>: Fix TypeError in report_collect with _collect_report_last_write.</p></li>
</ul>
</section>
<section id="id621">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id621" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4305">#4305</a>: Replace byte/unicode helpers in test_capture with python level syntax.</p></li>
</ul>
</section>
</section>
<section id="pytest-3-10-0-2018-11-03">
<h2>pytest 3.10.0 (2018-11-03)<a class="headerlink" href="#pytest-3-10-0-2018-11-03" title="Link to this heading">¶</a></h2>
<section id="id622">
<h3>Features<a class="headerlink" href="#id622" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2619">#2619</a>: Resume capturing output after <code class="docutils literal notranslate"><span class="pre">continue</span></code> with <code class="docutils literal notranslate"><span class="pre">__import__(&quot;pdb&quot;).set_trace()</span></code>.</p>
<p>This also adds a new <code class="docutils literal notranslate"><span class="pre">pytest_leave_pdb</span></code> hook, and passes in <code class="docutils literal notranslate"><span class="pre">pdb</span></code> to the
existing <code class="docutils literal notranslate"><span class="pre">pytest_enter_pdb</span></code> hook.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4147">#4147</a>: Add <code class="docutils literal notranslate"><span class="pre">--sw</span></code>, <code class="docutils literal notranslate"><span class="pre">--stepwise</span></code> as an alternative to <code class="docutils literal notranslate"><span class="pre">--lf</span> <span class="pre">-x</span></code> for stopping at the first failure, but starting the next test invocation from that test.  See <a class="reference internal" href="how-to/cache.html#cache-stepwise"><span class="std std-ref">the documentation</span></a> for more info.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4188">#4188</a>: Make <code class="docutils literal notranslate"><span class="pre">--color</span></code> emit colorful dots when not running in verbose mode. Earlier, it would only colorize the test-by-test output if <code class="docutils literal notranslate"><span class="pre">--verbose</span></code> was also passed.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4225">#4225</a>: Improve performance with collection reporting in non-quiet mode with terminals.</p>
<p>The “collecting …” message is only printed/updated every 0.5s.</p>
</li>
</ul>
</section>
<section id="id623">
<h3>Bug Fixes<a class="headerlink" href="#id623" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2701">#2701</a>: Fix false <code class="docutils literal notranslate"><span class="pre">RemovedInPytest4Warning:</span> <span class="pre">usage</span> <span class="pre">of</span> <span class="pre">Session...</span> <span class="pre">is</span> <span class="pre">deprecated,</span> <span class="pre">please</span> <span class="pre">use</span> <span class="pre">pytest</span></code> warnings.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4046">#4046</a>: Fix problems with running tests in package <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> files.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4260">#4260</a>: Swallow warnings during anonymous compilation of source.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4262">#4262</a>: Fix access denied error when deleting stale directories created by <code class="docutils literal notranslate"><span class="pre">tmpdir</span></code> / <code class="docutils literal notranslate"><span class="pre">tmp_path</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/611">#611</a>: Naming a fixture <code class="docutils literal notranslate"><span class="pre">request</span></code> will now raise a warning: the <code class="docutils literal notranslate"><span class="pre">request</span></code> fixture is internal and
should not be overwritten as it will lead to internal errors.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4266">#4266</a>: Handle (ignore) exceptions raised during collection, e.g. with Django’s LazySettings proxy class.</p></li>
</ul>
</section>
<section id="id624">
<h3>Improved Documentation<a class="headerlink" href="#id624" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4255">#4255</a>: Added missing documentation about the fact that module names passed to filter warnings are not regex-escaped.</p></li>
</ul>
</section>
<section id="id625">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id625" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4272">#4272</a>: Display cachedir also in non-verbose mode if non-default.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4277">#4277</a>: pdb: improve message about output capturing with <code class="docutils literal notranslate"><span class="pre">set_trace</span></code>.</p>
<p>Do not display “IO-capturing turned off/on” when <code class="docutils literal notranslate"><span class="pre">-s</span></code> is used to avoid
confusion.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4279">#4279</a>: Improve message and stack level of warnings issued by <code class="docutils literal notranslate"><span class="pre">monkeypatch.setenv</span></code> when the value of the environment variable is not a <code class="docutils literal notranslate"><span class="pre">str</span></code>.</p></li>
</ul>
</section>
</section>
<section id="pytest-3-9-3-2018-10-27">
<h2>pytest 3.9.3 (2018-10-27)<a class="headerlink" href="#pytest-3-9-3-2018-10-27" title="Link to this heading">¶</a></h2>
<section id="id626">
<h3>Bug Fixes<a class="headerlink" href="#id626" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4174">#4174</a>: Fix “ValueError: Plugin already registered” with conftest plugins via symlink.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4181">#4181</a>: Handle race condition between creation and deletion of temporary folders.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4221">#4221</a>: Fix bug where the warning summary at the end of the test session was not showing the test where the warning was originated.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4243">#4243</a>: Fix regression when <code class="docutils literal notranslate"><span class="pre">stacklevel</span></code> for warnings was passed as positional argument on python2.</p></li>
</ul>
</section>
<section id="id627">
<h3>Improved Documentation<a class="headerlink" href="#id627" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3851">#3851</a>: Add reference to <code class="docutils literal notranslate"><span class="pre">empty_parameter_set_mark</span></code> ini option in documentation of <code class="docutils literal notranslate"><span class="pre">&#64;pytest.mark.parametrize</span></code></p></li>
</ul>
</section>
<section id="id628">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id628" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4028">#4028</a>: Revert patching of <code class="docutils literal notranslate"><span class="pre">sys.breakpointhook</span></code> since it appears to do nothing.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4233">#4233</a>: Apply an import sorter (<code class="docutils literal notranslate"><span class="pre">reorder-python-imports</span></code>) to the codebase.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4248">#4248</a>: Remove use of unnecessary compat shim, six.binary_type</p></li>
</ul>
</section>
</section>
<section id="pytest-3-9-2-2018-10-22">
<h2>pytest 3.9.2 (2018-10-22)<a class="headerlink" href="#pytest-3-9-2-2018-10-22" title="Link to this heading">¶</a></h2>
<section id="id629">
<h3>Bug Fixes<a class="headerlink" href="#id629" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2909">#2909</a>: Improve error message when a recursive dependency between fixtures is detected.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3340">#3340</a>: Fix logging messages not shown in hooks <code class="docutils literal notranslate"><span class="pre">pytest_sessionstart()</span></code> and <code class="docutils literal notranslate"><span class="pre">pytest_sessionfinish()</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3533">#3533</a>: Fix unescaped XML raw objects in JUnit report for skipped tests</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3691">#3691</a>: Python 2: safely format warning message about passing unicode strings to <code class="docutils literal notranslate"><span class="pre">warnings.warn</span></code>, which may cause
surprising <code class="docutils literal notranslate"><span class="pre">MemoryError</span></code> exception when monkey patching <code class="docutils literal notranslate"><span class="pre">warnings.warn</span></code> itself.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4026">#4026</a>: Improve error message when it is not possible to determine a function’s signature.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4177">#4177</a>: Pin <code class="docutils literal notranslate"><span class="pre">setuptools&gt;=40.0</span></code> to support <code class="docutils literal notranslate"><span class="pre">py_modules</span></code> in <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code></p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4179">#4179</a>: Restore the tmpdir behaviour of symlinking the current test run.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4192">#4192</a>: Fix filename reported by <code class="docutils literal notranslate"><span class="pre">warnings.warn</span></code> when using <code class="docutils literal notranslate"><span class="pre">recwarn</span></code> under python2.</p></li>
</ul>
</section>
</section>
<section id="pytest-3-9-1-2018-10-16">
<h2>pytest 3.9.1 (2018-10-16)<a class="headerlink" href="#pytest-3-9-1-2018-10-16" title="Link to this heading">¶</a></h2>
<section id="id630">
<h3>Features<a class="headerlink" href="#id630" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4159">#4159</a>: For test-suites containing test classes, the information about the subclassed
module is now output only if a higher verbosity level is specified (at least
“-vv”).</p></li>
</ul>
</section>
</section>
<section id="pytest-3-9-0-2018-10-15-not-published-due-to-a-release-automation-bug">
<h2>pytest 3.9.0 (2018-10-15 - not published due to a release automation bug)<a class="headerlink" href="#pytest-3-9-0-2018-10-15-not-published-due-to-a-release-automation-bug" title="Link to this heading">¶</a></h2>
<section id="id631">
<h3>Deprecations<a class="headerlink" href="#id631" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3616">#3616</a>: The following accesses have been documented as deprecated for years, but are now actually emitting deprecation warnings.</p>
<ul>
<li><p>Access of <code class="docutils literal notranslate"><span class="pre">Module</span></code>, <code class="docutils literal notranslate"><span class="pre">Function</span></code>, <code class="docutils literal notranslate"><span class="pre">Class</span></code>, <code class="docutils literal notranslate"><span class="pre">Instance</span></code>, <code class="docutils literal notranslate"><span class="pre">File</span></code> and <code class="docutils literal notranslate"><span class="pre">Item</span></code> through <code class="docutils literal notranslate"><span class="pre">Node</span></code> instances. Now
users will this warning:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span> <span class="n">of</span> <span class="n">Function</span><span class="o">.</span><span class="n">Module</span> <span class="ow">is</span> <span class="n">deprecated</span><span class="p">,</span> <span class="n">please</span> <span class="n">use</span> <span class="n">pytest</span><span class="o">.</span><span class="n">Module</span> <span class="n">instead</span>
</pre></div>
</div>
<p>Users should just <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">pytest</span></code> and access those objects using the <code class="docutils literal notranslate"><span class="pre">pytest</span></code> module.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">request.cached_setup</span></code>, this was the precursor of the setup/teardown mechanism available to fixtures. You can
consult <a class="reference internal" href="funcarg_compare.html"><span class="doc">funcarg comparison section in the docs</span></a>.</p></li>
<li><p>Using objects named <code class="docutils literal notranslate"><span class="pre">&quot;Class&quot;</span></code> as a way to customize the type of nodes that are collected in <code class="docutils literal notranslate"><span class="pre">Collector</span></code>
subclasses has been deprecated. Users instead should use <code class="docutils literal notranslate"><span class="pre">pytest_collect_make_item</span></code> to customize node types during
collection.</p>
<p>This issue should affect only advanced plugins who create new collection types, so if you see this warning
message please contact the authors so they can change the code.</p>
</li>
<li><p>The warning that produces the message below has changed to <code class="docutils literal notranslate"><span class="pre">RemovedInPytest4Warning</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">getfuncargvalue</span> <span class="ow">is</span> <span class="n">deprecated</span><span class="p">,</span> <span class="n">use</span> <span class="n">getfixturevalue</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3988">#3988</a>: Add a Deprecation warning for pytest.ensuretemp as it was deprecated since a while.</p></li>
</ul>
</section>
<section id="id632">
<h3>Features<a class="headerlink" href="#id632" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2293">#2293</a>: Improve usage errors messages by hiding internal details which can be distracting and noisy.</p>
<p>This has the side effect that some error conditions that previously raised generic errors (such as
<code class="docutils literal notranslate"><span class="pre">ValueError</span></code> for unregistered marks) are now raising <code class="docutils literal notranslate"><span class="pre">Failed</span></code> exceptions.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3332">#3332</a>: Improve the error displayed when a <code class="docutils literal notranslate"><span class="pre">conftest.py</span></code> file could not be imported.</p>
<p>In order to implement this, a new <code class="docutils literal notranslate"><span class="pre">chain</span></code> parameter was added to <code class="docutils literal notranslate"><span class="pre">ExceptionInfo.getrepr</span></code>
to show or hide chained tracebacks in Python 3 (defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3849">#3849</a>: Add <code class="docutils literal notranslate"><span class="pre">empty_parameter_set_mark=fail_at_collect</span></code> ini option for raising an exception when parametrize collects an empty set.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3964">#3964</a>: Log messages generated in the collection phase are shown when
live-logging is enabled and/or when they are logged to a file.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3985">#3985</a>: Introduce <code class="docutils literal notranslate"><span class="pre">tmp_path</span></code> as a fixture providing a Path object. Also introduce <code class="docutils literal notranslate"><span class="pre">tmp_path_factory</span></code> as
a session-scoped fixture for creating arbitrary temporary directories from any other fixture or test.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4013">#4013</a>: Deprecation warnings are now shown even if you customize the warnings filters yourself. In the previous version
any customization would override pytest’s filters and deprecation warnings would fall back to being hidden by default.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4073">#4073</a>: Allow specification of timeout for <code class="docutils literal notranslate"><span class="pre">Testdir.runpytest_subprocess()</span></code> and <code class="docutils literal notranslate"><span class="pre">Testdir.run()</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4098">#4098</a>: Add returncode argument to pytest.exit() to exit pytest with a specific return code.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4102">#4102</a>: Reimplement <code class="docutils literal notranslate"><span class="pre">pytest.deprecated_call</span></code> using <code class="docutils literal notranslate"><span class="pre">pytest.warns</span></code> so it supports the <code class="docutils literal notranslate"><span class="pre">match='...'</span></code> keyword argument.</p>
<p>This has the side effect that <code class="docutils literal notranslate"><span class="pre">pytest.deprecated_call</span></code> now raises <code class="docutils literal notranslate"><span class="pre">pytest.fail.Exception</span></code> instead
of <code class="docutils literal notranslate"><span class="pre">AssertionError</span></code>.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4149">#4149</a>: Require setuptools&gt;=30.3 and move most of the metadata to <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code>.</p></li>
</ul>
</section>
<section id="id633">
<h3>Bug Fixes<a class="headerlink" href="#id633" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2535">#2535</a>: Improve error message when test functions of <code class="docutils literal notranslate"><span class="pre">unittest.TestCase</span></code> subclasses use a parametrized fixture.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3057">#3057</a>: <code class="docutils literal notranslate"><span class="pre">request.fixturenames</span></code> now correctly returns the name of fixtures created by <code class="docutils literal notranslate"><span class="pre">request.getfixturevalue()</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3946">#3946</a>: Warning filters passed as command line options using <code class="docutils literal notranslate"><span class="pre">-W</span></code> now take precedence over filters defined in <code class="docutils literal notranslate"><span class="pre">ini</span></code>
configuration files.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4066">#4066</a>: Fix source reindenting by using <code class="docutils literal notranslate"><span class="pre">textwrap.dedent</span></code> directly.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4102">#4102</a>: <code class="docutils literal notranslate"><span class="pre">pytest.warn</span></code> will capture previously-warned warnings in Python 2. Previously they were never raised.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4108">#4108</a>: Resolve symbolic links for args.</p>
<p>This fixes running <code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">tests/test_foo.py::test_bar</span></code>, where <code class="docutils literal notranslate"><span class="pre">tests</span></code>
is a symlink to <code class="docutils literal notranslate"><span class="pre">project/app/tests</span></code>:
previously <code class="docutils literal notranslate"><span class="pre">project/app/conftest.py</span></code> would be ignored for fixtures then.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4132">#4132</a>: Fix duplicate printing of internal errors when using <code class="docutils literal notranslate"><span class="pre">--pdb</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4135">#4135</a>: pathlib based tmpdir cleanup now correctly handles symlinks in the folder.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4152">#4152</a>: Display the filename when encountering <code class="docutils literal notranslate"><span class="pre">SyntaxWarning</span></code>.</p></li>
</ul>
</section>
<section id="id634">
<h3>Improved Documentation<a class="headerlink" href="#id634" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3713">#3713</a>: Update usefixtures documentation to clarify that it can’t be used with fixture functions.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4058">#4058</a>: Update fixture documentation to specify that a fixture can be invoked twice in the scope it’s defined for.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4064">#4064</a>: According to unittest.rst, setUpModule and tearDownModule were not implemented, but it turns out they are. So updated the documentation for unittest.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4151">#4151</a>: Add tempir testing example to CONTRIBUTING.rst guide</p></li>
</ul>
</section>
<section id="id635">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id635" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2293">#2293</a>: The internal <code class="docutils literal notranslate"><span class="pre">MarkerError</span></code> exception has been removed.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3988">#3988</a>: Port the implementation of tmpdir to pathlib.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4063">#4063</a>: Exclude 0.00 second entries from <code class="docutils literal notranslate"><span class="pre">--duration</span></code> output unless <code class="docutils literal notranslate"><span class="pre">-vv</span></code> is passed on the command-line.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4093">#4093</a>: Fixed formatting of string literals in internal tests.</p></li>
</ul>
</section>
</section>
<section id="pytest-3-8-2-2018-10-02">
<h2>pytest 3.8.2 (2018-10-02)<a class="headerlink" href="#pytest-3-8-2-2018-10-02" title="Link to this heading">¶</a></h2>
<section id="deprecations-and-removals">
<h3>Deprecations and Removals<a class="headerlink" href="#deprecations-and-removals" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4036">#4036</a>: The <code class="docutils literal notranslate"><span class="pre">item</span></code> parameter of <code class="docutils literal notranslate"><span class="pre">pytest_warning_captured</span></code> hook is now documented as deprecated. We realized only after
the <code class="docutils literal notranslate"><span class="pre">3.8</span></code> release that this parameter is incompatible with <code class="docutils literal notranslate"><span class="pre">pytest-xdist</span></code>.</p>
<p>Our policy is to not deprecate features during bug-fix releases, but in this case we believe it makes sense as we are
only documenting it as deprecated, without issuing warnings which might potentially break test suites. This will get
the word out that hook implementers should not use this parameter at all.</p>
<p>In a future release <code class="docutils literal notranslate"><span class="pre">item</span></code> will always be <code class="docutils literal notranslate"><span class="pre">None</span></code> and will emit a proper warning when a hook implementation
makes use of it.</p>
</li>
</ul>
</section>
<section id="id636">
<h3>Bug Fixes<a class="headerlink" href="#id636" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3539">#3539</a>: Fix reload on assertion rewritten modules.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4034">#4034</a>: The <code class="docutils literal notranslate"><span class="pre">.user_properties</span></code> attribute of <code class="docutils literal notranslate"><span class="pre">TestReport</span></code> objects is a list
of (name, value) tuples, but could sometimes be instantiated as a tuple
of tuples.  It is now always a list.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4039">#4039</a>: No longer issue warnings about using <code class="docutils literal notranslate"><span class="pre">pytest_plugins</span></code> in non-top-level directories when using <code class="docutils literal notranslate"><span class="pre">--pyargs</span></code>: the
current <code class="docutils literal notranslate"><span class="pre">--pyargs</span></code> mechanism is not reliable and might give false negatives.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4040">#4040</a>: Exclude empty reports for passed tests when <code class="docutils literal notranslate"><span class="pre">-rP</span></code> option is used.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4051">#4051</a>: Improve error message when an invalid Python expression is passed to the <code class="docutils literal notranslate"><span class="pre">-m</span></code> option.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/4056">#4056</a>: <code class="docutils literal notranslate"><span class="pre">MonkeyPatch.setenv</span></code> and <code class="docutils literal notranslate"><span class="pre">MonkeyPatch.delenv</span></code> issue a warning if the environment variable name is not <code class="docutils literal notranslate"><span class="pre">str</span></code> on Python 2.</p>
<p>In Python 2, adding <code class="docutils literal notranslate"><span class="pre">unicode</span></code> keys to <code class="docutils literal notranslate"><span class="pre">os.environ</span></code> causes problems with <code class="docutils literal notranslate"><span class="pre">subprocess</span></code> (and possible other modules),
making this a subtle bug specially susceptible when used with <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">__future__</span> <span class="pre">import</span> <span class="pre">unicode_literals</span></code>.</p>
</li>
</ul>
</section>
<section id="id637">
<h3>Improved Documentation<a class="headerlink" href="#id637" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3928">#3928</a>: Add possible values for fixture scope to docs.</p></li>
</ul>
</section>
</section>
<section id="pytest-3-8-1-2018-09-22">
<h2>pytest 3.8.1 (2018-09-22)<a class="headerlink" href="#pytest-3-8-1-2018-09-22" title="Link to this heading">¶</a></h2>
<section id="id638">
<h3>Bug Fixes<a class="headerlink" href="#id638" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3286">#3286</a>: <code class="docutils literal notranslate"><span class="pre">.pytest_cache</span></code> directory is now automatically ignored by Git. Users who would like to contribute a solution for other SCMs please consult/comment on this issue.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3749">#3749</a>: Fix the following error during collection of tests inside packages:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">TypeError</span><span class="p">:</span> <span class="nb">object</span> <span class="n">of</span> <span class="nb">type</span> <span class="s1">&#39;Package&#39;</span> <span class="n">has</span> <span class="n">no</span> <span class="nb">len</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3941">#3941</a>: Fix bug where indirect parametrization would consider the scope of all fixtures used by the test function to determine the parametrization scope, and not only the scope of the fixtures being parametrized.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3973">#3973</a>: Fix crash of the assertion rewriter if a test changed the current working directory without restoring it afterwards.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3998">#3998</a>: Fix issue that prevented some caplog properties (for example <code class="docutils literal notranslate"><span class="pre">record_tuples</span></code>) from being available when entering the debugger with <code class="docutils literal notranslate"><span class="pre">--pdb</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3999">#3999</a>: Fix <code class="docutils literal notranslate"><span class="pre">UnicodeDecodeError</span></code> in python2.x when a class returns a non-ascii binary <code class="docutils literal notranslate"><span class="pre">__repr__</span></code> in an assertion which also contains non-ascii text.</p></li>
</ul>
</section>
<section id="id639">
<h3>Improved Documentation<a class="headerlink" href="#id639" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3996">#3996</a>: New <a class="reference internal" href="deprecations.html"><span class="doc">Deprecations and Removals</span></a> page shows all currently
deprecated features, the rationale to do so, and alternatives to update your code. It also list features removed
from pytest in past major releases to help those with ancient pytest versions to upgrade.</p></li>
</ul>
</section>
<section id="id640">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id640" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3955">#3955</a>: Improve pre-commit detection for changelog filenames</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3975">#3975</a>: Remove legacy code around im_func as that was python2 only</p></li>
</ul>
</section>
</section>
<section id="pytest-3-8-0-2018-09-05">
<h2>pytest 3.8.0 (2018-09-05)<a class="headerlink" href="#pytest-3-8-0-2018-09-05" title="Link to this heading">¶</a></h2>
<section id="id641">
<h3>Deprecations and Removals<a class="headerlink" href="#id641" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2452">#2452</a>: <code class="docutils literal notranslate"><span class="pre">Config.warn</span></code> and <code class="docutils literal notranslate"><span class="pre">Node.warn</span></code> have been
deprecated, see <a class="reference internal" href="deprecations.html#config-warn-and-node-warn-deprecated"><span class="std std-ref">Config.warn and Node.warn</span></a> for rationale and
examples.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3936">#3936</a>: <code class="docutils literal notranslate"><span class="pre">&#64;pytest.mark.filterwarnings</span></code> second parameter is no longer regex-escaped,
making it possible to actually use regular expressions to check the warning message.</p>
<p><strong>Note</strong>: regex-escaping the match string was an implementation oversight that might break test suites which depend
on the old behavior.</p>
</li>
</ul>
</section>
<section id="id642">
<h3>Features<a class="headerlink" href="#id642" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2452">#2452</a>: Internal pytest warnings are now issued using the standard <code class="docutils literal notranslate"><span class="pre">warnings</span></code> module, making it possible to use
the standard warnings filters to manage those warnings. This introduces <code class="docutils literal notranslate"><span class="pre">PytestWarning</span></code>,
<code class="docutils literal notranslate"><span class="pre">PytestDeprecationWarning</span></code> and <code class="docutils literal notranslate"><span class="pre">RemovedInPytest4Warning</span></code> warning types as part of the public API.</p>
<p>Consult <a class="reference internal" href="how-to/capture-warnings.html#internal-warnings"><span class="std std-ref">the documentation</span></a> for more info.</p>
</li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2908">#2908</a>: <code class="docutils literal notranslate"><span class="pre">DeprecationWarning</span></code> and <code class="docutils literal notranslate"><span class="pre">PendingDeprecationWarning</span></code> are now shown by default if no other warning filter is
configured. This makes pytest more compliant with
<span class="target" id="index-9"></span><a class="pep reference external" href="https://peps.python.org/pep-0506/#recommended-filter-settings-for-test-runners"><strong>PEP 506#recommended-filter-settings-for-test-runners</strong></a>. See
<a class="reference internal" href="how-to/capture-warnings.html#deprecation-warnings"><span class="std std-ref">the docs</span></a> for
more info.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3251">#3251</a>: Warnings are now captured and displayed during test collection.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3784">#3784</a>: <code class="docutils literal notranslate"><span class="pre">PYTEST_DISABLE_PLUGIN_AUTOLOAD</span></code> environment variable disables plugin auto-loading when set.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3829">#3829</a>: Added the <code class="docutils literal notranslate"><span class="pre">count</span></code> option to <code class="docutils literal notranslate"><span class="pre">console_output_style</span></code> to enable displaying the progress as a count instead of a percentage.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3837">#3837</a>: Added support for ‘xfailed’ and ‘xpassed’ outcomes to the <code class="docutils literal notranslate"><span class="pre">pytester.RunResult.assert_outcomes</span></code> signature.</p></li>
</ul>
</section>
<section id="id643">
<h3>Bug Fixes<a class="headerlink" href="#id643" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3911">#3911</a>: Terminal writer now takes into account unicode character width when writing out progress.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3913">#3913</a>: Pytest now returns with correct exit code (EXIT_USAGEERROR, 4) when called with unknown arguments.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3918">#3918</a>: Improve performance of assertion rewriting.</p></li>
</ul>
</section>
<section id="id644">
<h3>Improved Documentation<a class="headerlink" href="#id644" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3566">#3566</a>: Added a blurb in usage.rst for the usage of -r flag which is used to show an extra test summary info.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3907">#3907</a>: Corrected type of the exceptions collection passed to <code class="docutils literal notranslate"><span class="pre">xfail</span></code>: <code class="docutils literal notranslate"><span class="pre">raises</span></code> argument accepts a <code class="docutils literal notranslate"><span class="pre">tuple</span></code> instead of <code class="docutils literal notranslate"><span class="pre">list</span></code>.</p></li>
</ul>
</section>
<section id="id645">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id645" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3853">#3853</a>: Removed <code class="docutils literal notranslate"><span class="pre">&quot;run</span> <span class="pre">all</span> <span class="pre">(no</span> <span class="pre">recorded</span> <span class="pre">failures)&quot;</span></code> message printed with <code class="docutils literal notranslate"><span class="pre">--failed-first</span></code> and <code class="docutils literal notranslate"><span class="pre">--last-failed</span></code> when there are no failed tests.</p></li>
</ul>
</section>
</section>
<section id="pytest-3-7-4-2018-08-29">
<h2>pytest 3.7.4 (2018-08-29)<a class="headerlink" href="#pytest-3-7-4-2018-08-29" title="Link to this heading">¶</a></h2>
<section id="id646">
<h3>Bug Fixes<a class="headerlink" href="#id646" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3506">#3506</a>: Fix possible infinite recursion when writing <code class="docutils literal notranslate"><span class="pre">.pyc</span></code> files.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3853">#3853</a>: Cache plugin now obeys the <code class="docutils literal notranslate"><span class="pre">-q</span></code> flag when <code class="docutils literal notranslate"><span class="pre">--last-failed</span></code> and <code class="docutils literal notranslate"><span class="pre">--failed-first</span></code> flags are used.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3883">#3883</a>: Fix bad console output when using <code class="docutils literal notranslate"><span class="pre">console_output_style=classic</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3888">#3888</a>: Fix macOS specific code using <code class="docutils literal notranslate"><span class="pre">capturemanager</span></code> plugin in doctests.</p></li>
</ul>
</section>
<section id="id647">
<h3>Improved Documentation<a class="headerlink" href="#id647" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3902">#3902</a>: Fix pytest.org links</p></li>
</ul>
</section>
</section>
<section id="pytest-3-7-3-2018-08-26">
<h2>pytest 3.7.3 (2018-08-26)<a class="headerlink" href="#pytest-3-7-3-2018-08-26" title="Link to this heading">¶</a></h2>
<section id="id648">
<h3>Bug Fixes<a class="headerlink" href="#id648" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3033">#3033</a>: Fixtures during teardown can again use <code class="docutils literal notranslate"><span class="pre">capsys</span></code> and <code class="docutils literal notranslate"><span class="pre">capfd</span></code> to inspect output captured during tests.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3773">#3773</a>: Fix collection of tests from <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> files if they match the <code class="docutils literal notranslate"><span class="pre">python_files</span></code> configuration option.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3796">#3796</a>: Fix issue where teardown of fixtures of consecutive sub-packages were executed once, at the end of the outer
package.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3816">#3816</a>: Fix bug where <code class="docutils literal notranslate"><span class="pre">--show-capture=no</span></code> option would still show logs printed during fixture teardown.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3819">#3819</a>: Fix <code class="docutils literal notranslate"><span class="pre">stdout/stderr</span></code> not getting captured when real-time cli logging is active.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3843">#3843</a>: Fix collection error when specifying test functions directly in the command line using <code class="docutils literal notranslate"><span class="pre">test.py::test</span></code> syntax together with <code class="docutils literal notranslate"><span class="pre">--doctest-modules</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3848">#3848</a>: Fix bugs where unicode arguments could not be passed to <code class="docutils literal notranslate"><span class="pre">testdir.runpytest</span></code> on Python 2.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3854">#3854</a>: Fix double collection of tests within packages when the filename starts with a capital letter.</p></li>
</ul>
</section>
<section id="id649">
<h3>Improved Documentation<a class="headerlink" href="#id649" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3824">#3824</a>: Added example for multiple glob pattern matches in <code class="docutils literal notranslate"><span class="pre">python_files</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3833">#3833</a>: Added missing docs for <code class="docutils literal notranslate"><span class="pre">pytester.Testdir</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3870">#3870</a>: Correct documentation for setuptools integration.</p></li>
</ul>
</section>
<section id="id650">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id650" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3826">#3826</a>: Replace broken type annotations with type comments.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3845">#3845</a>: Remove a reference to issue <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/568">#568</a> from the documentation, which has since been
fixed.</p></li>
</ul>
</section>
</section>
<section id="pytest-3-7-2-2018-08-16">
<h2>pytest 3.7.2 (2018-08-16)<a class="headerlink" href="#pytest-3-7-2-2018-08-16" title="Link to this heading">¶</a></h2>
<section id="id651">
<h3>Bug Fixes<a class="headerlink" href="#id651" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3671">#3671</a>: Fix <code class="docutils literal notranslate"><span class="pre">filterwarnings</span></code> not being registered as a builtin mark.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3768">#3768</a>, <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3789">#3789</a>: Fix test collection from packages mixed with normal directories.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3771">#3771</a>: Fix infinite recursion during collection if a <code class="docutils literal notranslate"><span class="pre">pytest_ignore_collect</span></code> hook returns <code class="docutils literal notranslate"><span class="pre">False</span></code> instead of <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3774">#3774</a>: Fix bug where decorated fixtures would lose functionality (for example <code class="docutils literal notranslate"><span class="pre">&#64;mock.patch</span></code>).</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3775">#3775</a>: Fix bug where importing modules or other objects with prefix <code class="docutils literal notranslate"><span class="pre">pytest_</span></code> prefix would raise a <code class="docutils literal notranslate"><span class="pre">PluginValidationError</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3788">#3788</a>: Fix <code class="docutils literal notranslate"><span class="pre">AttributeError</span></code> during teardown of <code class="docutils literal notranslate"><span class="pre">TestCase</span></code> subclasses which raise an exception during <code class="docutils literal notranslate"><span class="pre">__init__</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3804">#3804</a>: Fix traceback reporting for exceptions with <code class="docutils literal notranslate"><span class="pre">__cause__</span></code> cycles.</p></li>
</ul>
</section>
<section id="id652">
<h3>Improved Documentation<a class="headerlink" href="#id652" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3746">#3746</a>: Add documentation for <code class="docutils literal notranslate"><span class="pre">metafunc.config</span></code> that had been mistakenly hidden.</p></li>
</ul>
</section>
</section>
<section id="pytest-3-7-1-2018-08-02">
<h2>pytest 3.7.1 (2018-08-02)<a class="headerlink" href="#pytest-3-7-1-2018-08-02" title="Link to this heading">¶</a></h2>
<section id="id653">
<h3>Bug Fixes<a class="headerlink" href="#id653" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3473">#3473</a>: Raise immediately if <code class="docutils literal notranslate"><span class="pre">approx()</span></code> is given an expected value of a type it doesn’t understand (e.g. strings, nested dicts, etc.).</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3712">#3712</a>: Correctly represent the dimensions of a numpy array when calling <code class="docutils literal notranslate"><span class="pre">repr()</span></code> on <code class="docutils literal notranslate"><span class="pre">approx()</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3742">#3742</a>: Fix incompatibility with third party plugins during collection, which produced the error <code class="docutils literal notranslate"><span class="pre">object</span> <span class="pre">has</span> <span class="pre">no</span> <span class="pre">attribute</span> <span class="pre">'_collectfile'</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3745">#3745</a>: Display the absolute path if <code class="docutils literal notranslate"><span class="pre">cache_dir</span></code> is not relative to the <code class="docutils literal notranslate"><span class="pre">rootdir</span></code> instead of failing.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3747">#3747</a>: Fix compatibility problem with plugins and the warning code issued by fixture functions when they are called directly.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3748">#3748</a>: Fix infinite recursion in <code class="docutils literal notranslate"><span class="pre">pytest.approx</span></code> with arrays in <code class="docutils literal notranslate"><span class="pre">numpy&lt;1.13</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3757">#3757</a>: Pin pathlib2 to <code class="docutils literal notranslate"><span class="pre">&gt;=2.2.0</span></code> as we require <code class="docutils literal notranslate"><span class="pre">__fspath__</span></code> support.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3763">#3763</a>: Fix <code class="docutils literal notranslate"><span class="pre">TypeError</span></code> when the assertion message is <code class="docutils literal notranslate"><span class="pre">bytes</span></code> in python 3.</p></li>
</ul>
</section>
</section>
<section id="pytest-3-7-0-2018-07-30">
<h2>pytest 3.7.0 (2018-07-30)<a class="headerlink" href="#pytest-3-7-0-2018-07-30" title="Link to this heading">¶</a></h2>
<section id="id654">
<h3>Deprecations and Removals<a class="headerlink" href="#id654" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2639">#2639</a>: <code class="docutils literal notranslate"><span class="pre">pytest_namespace</span></code> has been <a class="reference internal" href="deprecations.html#pytest-namespace-deprecated"><span class="std std-ref">deprecated</span></a>.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3661">#3661</a>: Calling a fixture function directly, as opposed to request them in a test function, now issues a <code class="docutils literal notranslate"><span class="pre">RemovedInPytest4Warning</span></code>. See <a class="reference internal" href="deprecations.html#calling-fixtures-directly-deprecated"><span class="std std-ref">the documentation for rationale and examples</span></a>.</p></li>
</ul>
</section>
<section id="id655">
<h3>Features<a class="headerlink" href="#id655" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2283">#2283</a>: New <code class="docutils literal notranslate"><span class="pre">package</span></code> fixture scope: fixtures are finalized when the last test of a <em>package</em> finishes. This feature is considered <strong>experimental</strong>, so use it sparingly.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3576">#3576</a>: <code class="docutils literal notranslate"><span class="pre">Node.add_marker</span></code> now supports an <code class="docutils literal notranslate"><span class="pre">append=True/False</span></code> parameter to determine whether the mark comes last (default) or first.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3579">#3579</a>: Fixture <code class="docutils literal notranslate"><span class="pre">caplog</span></code> now has a <code class="docutils literal notranslate"><span class="pre">messages</span></code> property, providing convenient access to the format-interpolated log messages without the extra data provided by the formatter/handler.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3610">#3610</a>: New <code class="docutils literal notranslate"><span class="pre">--trace</span></code> option to enter the debugger at the start of a test.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3623">#3623</a>: Introduce <code class="docutils literal notranslate"><span class="pre">pytester.copy_example</span></code> as helper to do acceptance tests against examples from the project.</p></li>
</ul>
</section>
<section id="id656">
<h3>Bug Fixes<a class="headerlink" href="#id656" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2220">#2220</a>: Fix a bug where fixtures overridden by direct parameters (for example parametrization) were being instantiated even if they were not being used by a test.</p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3695">#3695</a>: Fix <code class="docutils literal notranslate"><span class="pre">ApproxNumpy</span></code> initialisation argument mixup, <code class="docutils literal notranslate"><span class="pre">abs</span></code> and <code class="docutils literal notranslate"><span class="pre">rel</span></code> tolerances were flipped causing strange comparison results.
Add tests to check <code class="docutils literal notranslate"><span class="pre">abs</span></code> and <code class="docutils literal notranslate"><span class="pre">rel</span></code> tolerances for <code class="docutils literal notranslate"><span class="pre">np.array</span></code> and test for expecting <code class="docutils literal notranslate"><span class="pre">nan</span></code> with <code class="docutils literal notranslate"><span class="pre">np.array()</span></code></p></li>
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/980">#980</a>: Fix truncated locals output in verbose mode.</p></li>
</ul>
</section>
<section id="id657">
<h3>Improved Documentation<a class="headerlink" href="#id657" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3295">#3295</a>: Correct the usage documentation of <code class="docutils literal notranslate"><span class="pre">--last-failed-no-failures</span></code> by adding the missing <code class="docutils literal notranslate"><span class="pre">--last-failed</span></code> argument in the presented examples, because they are misleading and lead to think that the missing argument is not needed.</p></li>
</ul>
</section>
<section id="id658">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id658" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3519">#3519</a>: Now a <code class="docutils literal notranslate"><span class="pre">README.md</span></code> file is created in <code class="docutils literal notranslate"><span class="pre">.pytest_cache</span></code> to make it clear why the directory exists.</p></li>
</ul>
</section>
</section>
<section id="pytest-3-6-4-2018-07-28">
<h2>pytest 3.6.4 (2018-07-28)<a class="headerlink" href="#pytest-3-6-4-2018-07-28" title="Link to this heading">¶</a></h2>
<section id="id659">
<h3>Bug Fixes<a class="headerlink" href="#id659" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Invoke pytest using <code class="docutils literal notranslate"><span class="pre">-mpytest</span></code> so <code class="docutils literal notranslate"><span class="pre">sys.path</span></code> does not get polluted by packages installed in <code class="docutils literal notranslate"><span class="pre">site-packages</span></code>. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/742">#742</a>)</p></li>
</ul>
</section>
<section id="id660">
<h3>Improved Documentation<a class="headerlink" href="#id660" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Use <code class="docutils literal notranslate"><span class="pre">smtp_connection</span></code> instead of <code class="docutils literal notranslate"><span class="pre">smtp</span></code> in fixtures documentation to avoid possible confusion. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3592">#3592</a>)</p></li>
</ul>
</section>
<section id="id661">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id661" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Remove obsolete <code class="docutils literal notranslate"><span class="pre">__future__</span></code> imports. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2319">#2319</a>)</p></li>
<li><p>Add CITATION to provide information on how to formally cite pytest. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3402">#3402</a>)</p></li>
<li><p>Replace broken type annotations with type comments. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3635">#3635</a>)</p></li>
<li><p>Pin <code class="docutils literal notranslate"><span class="pre">pluggy</span></code> to <code class="docutils literal notranslate"><span class="pre">&lt;0.8</span></code>. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3727">#3727</a>)</p></li>
</ul>
</section>
</section>
<section id="pytest-3-6-3-2018-07-04">
<h2>pytest 3.6.3 (2018-07-04)<a class="headerlink" href="#pytest-3-6-3-2018-07-04" title="Link to this heading">¶</a></h2>
<section id="id662">
<h3>Bug Fixes<a class="headerlink" href="#id662" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Fix <code class="docutils literal notranslate"><span class="pre">ImportWarning</span></code> triggered by explicit relative imports in
assertion-rewritten package modules. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3061">#3061</a>)</p></li>
<li><p>Fix error in <code class="docutils literal notranslate"><span class="pre">pytest.approx</span></code> when dealing with 0-dimension numpy
arrays. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3593">#3593</a>)</p></li>
<li><p>No longer raise <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> when using the <code class="docutils literal notranslate"><span class="pre">get_marker</span></code> API. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3605">#3605</a>)</p></li>
<li><p>Fix problem where log messages with non-ascii characters would not
appear in the output log file.
(<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3630">#3630</a>)</p></li>
<li><p>No longer raise <code class="docutils literal notranslate"><span class="pre">AttributeError</span></code> when legacy marks can’t be stored in
functions. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3631">#3631</a>)</p></li>
</ul>
</section>
<section id="id663">
<h3>Improved Documentation<a class="headerlink" href="#id663" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>The description above the example for <code class="docutils literal notranslate"><span class="pre">&#64;pytest.mark.skipif</span></code> now better
matches the code. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3611">#3611</a>)</p></li>
</ul>
</section>
<section id="id664">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id664" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Internal refactoring: removed unused <code class="docutils literal notranslate"><span class="pre">CallSpec2tox</span> <span class="pre">._globalid_args</span></code>
attribute and <code class="docutils literal notranslate"><span class="pre">metafunc</span></code> parameter from <code class="docutils literal notranslate"><span class="pre">CallSpec2.copy()</span></code>. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3598">#3598</a>)</p></li>
<li><p>Silence usage of <code class="docutils literal notranslate"><span class="pre">reduce</span></code> warning in Python 2 (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3609">#3609</a>)</p></li>
<li><p>Fix usage of <code class="docutils literal notranslate"><span class="pre">attr.ib</span></code> deprecated <code class="docutils literal notranslate"><span class="pre">convert</span></code> parameter. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3653">#3653</a>)</p></li>
</ul>
</section>
</section>
<section id="pytest-3-6-2-2018-06-20">
<h2>pytest 3.6.2 (2018-06-20)<a class="headerlink" href="#pytest-3-6-2-2018-06-20" title="Link to this heading">¶</a></h2>
<section id="id665">
<h3>Bug Fixes<a class="headerlink" href="#id665" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Fix regression in <code class="docutils literal notranslate"><span class="pre">Node.add_marker</span></code> by extracting the mark object of a
<code class="docutils literal notranslate"><span class="pre">MarkDecorator</span></code>. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3555">#3555</a>)</p></li>
<li><p>Warnings without <code class="docutils literal notranslate"><span class="pre">location</span></code> were reported as <code class="docutils literal notranslate"><span class="pre">None</span></code>. This is corrected to
now report <code class="docutils literal notranslate"><span class="pre">&lt;undetermined</span> <span class="pre">location&gt;</span></code>. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3563">#3563</a>)</p></li>
<li><p>Continue to call finalizers in the stack when a finalizer in a former scope
raises an exception. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3569">#3569</a>)</p></li>
<li><p>Fix encoding error with <code class="docutils literal notranslate"><span class="pre">print</span></code> statements in doctests (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3583">#3583</a>)</p></li>
</ul>
</section>
<section id="id666">
<h3>Improved Documentation<a class="headerlink" href="#id666" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Add documentation for the <code class="docutils literal notranslate"><span class="pre">--strict</span></code> flag. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3549">#3549</a>)</p></li>
</ul>
</section>
<section id="id667">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id667" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Update old quotation style to parens in fixture.rst documentation. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3525">#3525</a>)</p></li>
<li><p>Improve display of hint about <code class="docutils literal notranslate"><span class="pre">--fulltrace</span></code> with <code class="docutils literal notranslate"><span class="pre">KeyboardInterrupt</span></code>.
(<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3545">#3545</a>)</p></li>
<li><p>pytest’s testsuite is no longer runnable through <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">test</span></code> –
instead invoke <code class="docutils literal notranslate"><span class="pre">pytest</span></code> or <code class="docutils literal notranslate"><span class="pre">tox</span></code> directly. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3552">#3552</a>)</p></li>
<li><p>Fix typo in documentation (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3567">#3567</a>)</p></li>
</ul>
</section>
</section>
<section id="pytest-3-6-1-2018-06-05">
<h2>pytest 3.6.1 (2018-06-05)<a class="headerlink" href="#pytest-3-6-1-2018-06-05" title="Link to this heading">¶</a></h2>
<section id="id668">
<h3>Bug Fixes<a class="headerlink" href="#id668" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Fixed a bug where stdout and stderr were logged twice by junitxml when a test
was marked xfail. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3491">#3491</a>)</p></li>
<li><p>Fix <code class="docutils literal notranslate"><span class="pre">usefixtures</span></code> mark applied to unittest tests by correctly instantiating
<code class="docutils literal notranslate"><span class="pre">FixtureInfo</span></code>. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3498">#3498</a>)</p></li>
<li><p>Fix assertion rewriter compatibility with libraries that monkey patch
<code class="docutils literal notranslate"><span class="pre">file</span></code> objects. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3503">#3503</a>)</p></li>
</ul>
</section>
<section id="id669">
<h3>Improved Documentation<a class="headerlink" href="#id669" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Added a section on how to use fixtures as factories to the fixture
documentation. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3461">#3461</a>)</p></li>
</ul>
</section>
<section id="id670">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id670" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Enable caching for pip/pre-commit in order to reduce build time on
travis/appveyor. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3502">#3502</a>)</p></li>
<li><p>Switch pytest to the src/ layout as we already suggested it for good practice
- now we implement it as well. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3513">#3513</a>)</p></li>
<li><p>Fix if in tests to support 3.7.0b5, where a docstring handling in AST got
reverted. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3530">#3530</a>)</p></li>
<li><p>Remove some python2.5 compatibility code. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3529">#3529</a>)</p></li>
</ul>
</section>
</section>
<section id="pytest-3-6-0-2018-05-23">
<h2>pytest 3.6.0 (2018-05-23)<a class="headerlink" href="#pytest-3-6-0-2018-05-23" title="Link to this heading">¶</a></h2>
<section id="id671">
<h3>Features<a class="headerlink" href="#id671" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Revamp the internals of the <code class="docutils literal notranslate"><span class="pre">pytest.mark</span></code> implementation with correct per
node handling which fixes a number of long standing bugs caused by the old
design. This introduces new <code class="docutils literal notranslate"><span class="pre">Node.iter_markers(name)</span></code> and
<code class="docutils literal notranslate"><span class="pre">Node.get_closest_marker(name)</span></code> APIs. Users are <strong>strongly encouraged</strong> to
read the <a class="reference internal" href="historical-notes.html#marker-revamp"><span class="std std-ref">reasons for the revamp in the docs</span></a>,
or jump over to details about <a class="reference internal" href="historical-notes.html#update-marker-code"><span class="std std-ref">updating existing code to use the new APIs</span></a>.
(<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3317">#3317</a>)</p></li>
<li><p>Now when <code class="docutils literal notranslate"><span class="pre">&#64;pytest.fixture</span></code> is applied more than once to the same function a
<code class="docutils literal notranslate"><span class="pre">ValueError</span></code> is raised. This buggy behavior would cause surprising problems
and if was working for a test suite it was mostly by accident. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2334">#2334</a>)</p></li>
<li><p>Support for Python 3.7’s builtin <code class="docutils literal notranslate"><span class="pre">breakpoint()</span></code> method, see
<a class="reference internal" href="how-to/failures.html#breakpoint-builtin"><span class="std std-ref">Using the builtin breakpoint function</span></a> for
details. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3180">#3180</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">monkeypatch</span></code> now supports a <code class="docutils literal notranslate"><span class="pre">context()</span></code> function which acts as a context
manager which undoes all patching done within the <code class="docutils literal notranslate"><span class="pre">with</span></code> block. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3290">#3290</a>)</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">--pdb</span></code> option now causes KeyboardInterrupt to enter the debugger,
instead of stopping the test session. On python 2.7, hitting CTRL+C again
exits the debugger. On python 3.2 and higher, use CTRL+D. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3299">#3299</a>)</p></li>
<li><p>pytest no longer changes the log level of the root logger when the
<code class="docutils literal notranslate"><span class="pre">log-level</span></code> parameter has greater numeric value than that of the level of
the root logger, which makes it play better with custom logging configuration
in user code. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3307">#3307</a>)</p></li>
</ul>
</section>
<section id="id672">
<h3>Bug Fixes<a class="headerlink" href="#id672" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>A rare race-condition which might result in corrupted <code class="docutils literal notranslate"><span class="pre">.pyc</span></code> files on
Windows has been hopefully solved. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3008">#3008</a>)</p></li>
<li><p>Also use iter_marker for discovering the marks applying for marker
expressions from the cli to avoid the bad data from the legacy mark storage.
(<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3441">#3441</a>)</p></li>
<li><p>When showing diffs of failed assertions where the contents contain only
whitespace, escape them using <code class="docutils literal notranslate"><span class="pre">repr()</span></code> first to make it easy to spot the
differences. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3443">#3443</a>)</p></li>
</ul>
</section>
<section id="id673">
<h3>Improved Documentation<a class="headerlink" href="#id673" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Change documentation copyright year to a range which auto-updates itself each
time it is published. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3303">#3303</a>)</p></li>
</ul>
</section>
<section id="id674">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id674" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pytest</span></code> now depends on the <a class="reference external" href="https://github.com/untitaker/python-atomicwrites">python-atomicwrites</a> library. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3008">#3008</a>)</p></li>
<li><p>Update all pypi.python.org URLs to pypi.org. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3431">#3431</a>)</p></li>
<li><p>Detect <code class="docutils literal notranslate"><span class="pre">pytest_</span></code> prefixed hooks using the internal plugin manager since
<code class="docutils literal notranslate"><span class="pre">pluggy</span></code> is deprecating the <code class="docutils literal notranslate"><span class="pre">implprefix</span></code> argument to <code class="docutils literal notranslate"><span class="pre">PluginManager</span></code>.
(<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3487">#3487</a>)</p></li>
<li><p>Import <code class="docutils literal notranslate"><span class="pre">Mapping</span></code> and <code class="docutils literal notranslate"><span class="pre">Sequence</span></code> from <code class="docutils literal notranslate"><span class="pre">_pytest.compat</span></code> instead of
directly from <code class="docutils literal notranslate"><span class="pre">collections</span></code> in <code class="docutils literal notranslate"><span class="pre">python_api.py::approx</span></code>. Add <code class="docutils literal notranslate"><span class="pre">Mapping</span></code>
to <code class="docutils literal notranslate"><span class="pre">_pytest.compat</span></code>, import it from <code class="docutils literal notranslate"><span class="pre">collections</span></code> on python 2, but from
<code class="docutils literal notranslate"><span class="pre">collections.abc</span></code> on Python 3 to avoid a <code class="docutils literal notranslate"><span class="pre">DeprecationWarning</span></code> on Python
3.7 or newer. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3497">#3497</a>)</p></li>
</ul>
</section>
</section>
<section id="pytest-3-5-1-2018-04-23">
<h2>pytest 3.5.1 (2018-04-23)<a class="headerlink" href="#pytest-3-5-1-2018-04-23" title="Link to this heading">¶</a></h2>
<section id="id675">
<h3>Bug Fixes<a class="headerlink" href="#id675" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Reset <code class="docutils literal notranslate"><span class="pre">sys.last_type</span></code>, <code class="docutils literal notranslate"><span class="pre">sys.last_value</span></code> and <code class="docutils literal notranslate"><span class="pre">sys.last_traceback</span></code> before
each test executes. Those attributes are added by pytest during the test run
to aid debugging, but were never reset so they would create a leaking
reference to the last failing test’s frame which in turn could never be
reclaimed by the garbage collector. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2798">#2798</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.raises</span></code> now raises <code class="docutils literal notranslate"><span class="pre">TypeError</span></code> when receiving an unknown keyword
argument. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3348">#3348</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.raises</span></code> now works with exception classes that look like iterables.
(<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3372">#3372</a>)</p></li>
</ul>
</section>
<section id="id676">
<h3>Improved Documentation<a class="headerlink" href="#id676" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Fix typo in <code class="docutils literal notranslate"><span class="pre">caplog</span></code> fixture documentation, which incorrectly identified
certain attributes as methods. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3406">#3406</a>)</p></li>
</ul>
</section>
<section id="id677">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id677" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Added a more indicative error message when parametrizing a function whose
argument takes a default value. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3221">#3221</a>)</p></li>
<li><p>Remove internal <code class="docutils literal notranslate"><span class="pre">_pytest.terminal.flatten</span></code> function in favor of
<code class="docutils literal notranslate"><span class="pre">more_itertools.collapse</span></code>. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3330">#3330</a>)</p></li>
<li><p>Import some modules from <code class="docutils literal notranslate"><span class="pre">collections.abc</span></code> instead of <code class="docutils literal notranslate"><span class="pre">collections</span></code> as
the former modules trigger <code class="docutils literal notranslate"><span class="pre">DeprecationWarning</span></code> in Python 3.7. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3339">#3339</a>)</p></li>
<li><p>record_property is no longer experimental, removing the warnings was
forgotten. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3360">#3360</a>)</p></li>
<li><p>Mention in documentation and CLI help that fixtures with leading <code class="docutils literal notranslate"><span class="pre">_</span></code> are
printed by <code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">--fixtures</span></code> only if the <code class="docutils literal notranslate"><span class="pre">-v</span></code> option is added. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3398">#3398</a>)</p></li>
</ul>
</section>
</section>
<section id="pytest-3-5-0-2018-03-21">
<h2>pytest 3.5.0 (2018-03-21)<a class="headerlink" href="#pytest-3-5-0-2018-03-21" title="Link to this heading">¶</a></h2>
<section id="id678">
<h3>Deprecations and Removals<a class="headerlink" href="#id678" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">record_xml_property</span></code> fixture is now deprecated in favor of the more
generic <code class="docutils literal notranslate"><span class="pre">record_property</span></code>. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2770">#2770</a>)</p></li>
<li><p>Defining <code class="docutils literal notranslate"><span class="pre">pytest_plugins</span></code> is now deprecated in non-top-level conftest.py
files, because they “leak” to the entire directory tree.
<a class="reference internal" href="deprecations.html#pytest-plugins-in-non-top-level-conftest-files-deprecated"><span class="std std-ref">See the docs</span></a>
for the rationale behind this decision (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3084">#3084</a>)</p></li>
</ul>
</section>
<section id="id679">
<h3>Features<a class="headerlink" href="#id679" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>New <code class="docutils literal notranslate"><span class="pre">--show-capture</span></code> command-line option that allows to specify how to
display captured output when tests fail: <code class="docutils literal notranslate"><span class="pre">no</span></code>, <code class="docutils literal notranslate"><span class="pre">stdout</span></code>, <code class="docutils literal notranslate"><span class="pre">stderr</span></code>,
<code class="docutils literal notranslate"><span class="pre">log</span></code> or <code class="docutils literal notranslate"><span class="pre">all</span></code> (the default). (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1478">#1478</a>)</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">--rootdir</span></code> command-line option to override the rules for discovering
the root directory. See <a class="reference internal" href="reference/customize.html"><span class="doc">customize</span></a> in the documentation for
details. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1642">#1642</a>)</p></li>
<li><p>Fixtures are now instantiated based on their scopes, with higher-scoped
fixtures (such as <code class="docutils literal notranslate"><span class="pre">session</span></code>) being instantiated first than lower-scoped
fixtures (such as <code class="docutils literal notranslate"><span class="pre">function</span></code>). The relative order of fixtures of the same
scope is kept unchanged, based in their declaration order and their
dependencies. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2405">#2405</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">record_xml_property</span></code> renamed to <code class="docutils literal notranslate"><span class="pre">record_property</span></code> and is now compatible
with xdist, markers and any reporter. <code class="docutils literal notranslate"><span class="pre">record_xml_property</span></code> name is now
deprecated. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2770">#2770</a>)</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">--nf</span></code>, <code class="docutils literal notranslate"><span class="pre">--new-first</span></code> options: run new tests first followed by the
rest of the tests, in both cases tests are also sorted by the file modified
time, with more recent files coming first. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3034">#3034</a>)</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">--last-failed-no-failures</span></code> command-line option that allows to specify
the behavior of the cache plugin’s <code class="docutils literal notranslate"><span class="pre">`--last-failed</span></code> feature when no tests
failed in the last run (or no cache was found): <code class="docutils literal notranslate"><span class="pre">none</span></code> or <code class="docutils literal notranslate"><span class="pre">all</span></code> (the
default). (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3139">#3139</a>)</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">--doctest-continue-on-failure</span></code> command-line option to enable doctests
to show multiple failures for each snippet, instead of stopping at the first
failure. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3149">#3149</a>)</p></li>
<li><p>Captured log messages are added to the <code class="docutils literal notranslate"><span class="pre">&lt;system-out&gt;</span></code> tag in the generated
junit xml file if the <code class="docutils literal notranslate"><span class="pre">junit_logging</span></code> ini option is set to <code class="docutils literal notranslate"><span class="pre">system-out</span></code>.
If the value of this ini option is <code class="docutils literal notranslate"><span class="pre">system-err</span></code>, the logs are written to
<code class="docutils literal notranslate"><span class="pre">&lt;system-err&gt;</span></code>. The default value for <code class="docutils literal notranslate"><span class="pre">junit_logging</span></code> is <code class="docutils literal notranslate"><span class="pre">no</span></code>, meaning
captured logs are not written to the output file. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3156">#3156</a>)</p></li>
<li><p>Allow the logging plugin to handle <code class="docutils literal notranslate"><span class="pre">pytest_runtest_logstart</span></code> and
<code class="docutils literal notranslate"><span class="pre">pytest_runtest_logfinish</span></code> hooks when live logs are enabled. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3189">#3189</a>)</p></li>
<li><p>Passing <code class="docutils literal notranslate"><span class="pre">--log-cli-level</span></code> in the command-line now automatically activates
live logging. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3190">#3190</a>)</p></li>
<li><p>Add command line option <code class="docutils literal notranslate"><span class="pre">--deselect</span></code> to allow deselection of individual
tests at collection time. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3198">#3198</a>)</p></li>
<li><p>Captured logs are printed before entering pdb. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3204">#3204</a>)</p></li>
<li><p>Deselected item count is now shown before tests are run, e.g. <code class="docutils literal notranslate"><span class="pre">collected</span> <span class="pre">X</span>
<span class="pre">items</span> <span class="pre">/</span> <span class="pre">Y</span> <span class="pre">deselected</span></code>. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3213">#3213</a>)</p></li>
<li><p>The builtin module <code class="docutils literal notranslate"><span class="pre">platform</span></code> is now available for use in expressions in
<code class="docutils literal notranslate"><span class="pre">pytest.mark</span></code>. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3236">#3236</a>)</p></li>
<li><p>The <em>short test summary info</em> section now is displayed after tracebacks and
warnings in the terminal. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3255">#3255</a>)</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">--verbosity</span></code> flag to set verbosity level explicitly. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3296">#3296</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.approx</span></code> now accepts comparing a numpy array with a scalar. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3312">#3312</a>)</p></li>
</ul>
</section>
<section id="id680">
<h3>Bug Fixes<a class="headerlink" href="#id680" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Suppress <code class="docutils literal notranslate"><span class="pre">IOError</span></code> when closing the temporary file used for capturing
streams in Python 2.7. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2370">#2370</a>)</p></li>
<li><p>Fixed <code class="docutils literal notranslate"><span class="pre">clear()</span></code> method on <code class="docutils literal notranslate"><span class="pre">caplog</span></code> fixture which cleared <code class="docutils literal notranslate"><span class="pre">records</span></code>, but
not the <code class="docutils literal notranslate"><span class="pre">text</span></code> property. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3297">#3297</a>)</p></li>
<li><p>During test collection, when stdin is not allowed to be read, the
<code class="docutils literal notranslate"><span class="pre">DontReadFromStdin</span></code> object still allow itself to be iterable and resolved
to an iterator without crashing. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3314">#3314</a>)</p></li>
</ul>
</section>
<section id="id681">
<h3>Improved Documentation<a class="headerlink" href="#id681" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Added a <a class="reference internal" href="reference/reference.html"><span class="doc">reference</span></a> page
to the docs. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1713">#1713</a>)</p></li>
</ul>
</section>
<section id="id682">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id682" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Change minimum requirement of <code class="docutils literal notranslate"><span class="pre">attrs</span></code> to <code class="docutils literal notranslate"><span class="pre">17.4.0</span></code>. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3228">#3228</a>)</p></li>
<li><p>Renamed example directories so all tests pass when ran from the base
directory. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3245">#3245</a>)</p></li>
<li><p>Internal <code class="docutils literal notranslate"><span class="pre">mark.py</span></code> module has been turned into a package. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3250">#3250</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest</span></code> now depends on the <a class="reference external" href="https://github.com/erikrose/more-itertools">more-itertools</a> package. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3265">#3265</a>)</p></li>
<li><p>Added warning when <code class="docutils literal notranslate"><span class="pre">[pytest]</span></code> section is used in a <code class="docutils literal notranslate"><span class="pre">.cfg</span></code> file passed
with <code class="docutils literal notranslate"><span class="pre">-c</span></code> (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3268">#3268</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nodeids</span></code> can now be passed explicitly to <code class="docutils literal notranslate"><span class="pre">FSCollector</span></code> and <code class="docutils literal notranslate"><span class="pre">Node</span></code>
constructors. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3291">#3291</a>)</p></li>
<li><p>Internal refactoring of <code class="docutils literal notranslate"><span class="pre">FormattedExcinfo</span></code> to use <code class="docutils literal notranslate"><span class="pre">attrs</span></code> facilities and
remove old support code for legacy Python versions. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3292">#3292</a>)</p></li>
<li><p>Refactoring to unify how verbosity is handled internally. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3296">#3296</a>)</p></li>
<li><p>Internal refactoring to better integrate with argparse. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3304">#3304</a>)</p></li>
<li><p>Fix a python example when calling a fixture in doc/en/usage.rst (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3308">#3308</a>)</p></li>
</ul>
</section>
</section>
<section id="pytest-3-4-2-2018-03-04">
<h2>pytest 3.4.2 (2018-03-04)<a class="headerlink" href="#pytest-3-4-2-2018-03-04" title="Link to this heading">¶</a></h2>
<section id="id683">
<h3>Bug Fixes<a class="headerlink" href="#id683" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Removed progress information when capture option is <code class="docutils literal notranslate"><span class="pre">no</span></code>. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3203">#3203</a>)</p></li>
<li><p>Refactor check of bindir from <code class="docutils literal notranslate"><span class="pre">exists</span></code> to <code class="docutils literal notranslate"><span class="pre">isdir</span></code>. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3241">#3241</a>)</p></li>
<li><p>Fix <code class="docutils literal notranslate"><span class="pre">TypeError</span></code> issue when using <code class="docutils literal notranslate"><span class="pre">approx</span></code> with a <code class="docutils literal notranslate"><span class="pre">Decimal</span></code> value.
(<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3247">#3247</a>)</p></li>
<li><p>Fix reference cycle generated when using the <code class="docutils literal notranslate"><span class="pre">request</span></code> fixture. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3249">#3249</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[tool:pytest]</span></code> sections in <code class="docutils literal notranslate"><span class="pre">*.cfg</span></code> files passed by the <code class="docutils literal notranslate"><span class="pre">-c</span></code> option are
now properly recognized. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3260">#3260</a>)</p></li>
</ul>
</section>
<section id="id684">
<h3>Improved Documentation<a class="headerlink" href="#id684" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Add logging plugin to plugins list. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3209">#3209</a>)</p></li>
</ul>
</section>
<section id="id685">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id685" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Fix minor typo in fixture.rst (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3259">#3259</a>)</p></li>
</ul>
</section>
</section>
<section id="pytest-3-4-1-2018-02-20">
<h2>pytest 3.4.1 (2018-02-20)<a class="headerlink" href="#pytest-3-4-1-2018-02-20" title="Link to this heading">¶</a></h2>
<section id="id686">
<h3>Bug Fixes<a class="headerlink" href="#id686" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Move import of <code class="docutils literal notranslate"><span class="pre">doctest.UnexpectedException</span></code> to top-level to avoid possible
errors when using <code class="docutils literal notranslate"><span class="pre">--pdb</span></code>. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1810">#1810</a>)</p></li>
<li><p>Added printing of captured stdout/stderr before entering pdb, and improved a
test which was giving false negatives about output capturing. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3052">#3052</a>)</p></li>
<li><p>Fix ordering of tests using parametrized fixtures which can lead to fixtures
being created more than necessary. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3161">#3161</a>)</p></li>
<li><p>Fix bug where logging happening at hooks outside of “test run” hooks would
cause an internal error. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3184">#3184</a>)</p></li>
<li><p>Detect arguments injected by <code class="docutils literal notranslate"><span class="pre">unittest.mock.patch</span></code> decorator correctly when
pypi <code class="docutils literal notranslate"><span class="pre">mock.patch</span></code> is installed and imported. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3206">#3206</a>)</p></li>
<li><p>Errors shown when a <code class="docutils literal notranslate"><span class="pre">pytest.raises()</span></code> with <code class="docutils literal notranslate"><span class="pre">match=</span></code> fails are now cleaner
on what happened: When no exception was raised, the “matching ‘…’” part got
removed as it falsely implies that an exception was raised but it didn’t
match. When a wrong exception was raised, it’s now thrown (like
<code class="docutils literal notranslate"><span class="pre">pytest.raised()</span></code> without <code class="docutils literal notranslate"><span class="pre">match=</span></code> would) instead of complaining about
the unmatched text. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3222">#3222</a>)</p></li>
<li><p>Fixed output capture handling in doctests on macOS. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/985">#985</a>)</p></li>
</ul>
</section>
<section id="id687">
<h3>Improved Documentation<a class="headerlink" href="#id687" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Add Sphinx parameter docs for <code class="docutils literal notranslate"><span class="pre">match</span></code> and <code class="docutils literal notranslate"><span class="pre">message</span></code> args to
<code class="docutils literal notranslate"><span class="pre">pytest.raises</span></code>. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3202">#3202</a>)</p></li>
</ul>
</section>
<section id="id688">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id688" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>pytest has changed the publication procedure and is now being published to
PyPI directly from Travis. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3060">#3060</a>)</p></li>
<li><p>Rename <code class="docutils literal notranslate"><span class="pre">ParameterSet._for_parameterize()</span></code> to <code class="docutils literal notranslate"><span class="pre">_for_parametrize()</span></code> in
order to comply with the naming convention. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3166">#3166</a>)</p></li>
<li><p>Skip failing pdb/doctest test on mac. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/985">#985</a>)</p></li>
</ul>
</section>
</section>
<section id="pytest-3-4-0-2018-01-30">
<h2>pytest 3.4.0 (2018-01-30)<a class="headerlink" href="#pytest-3-4-0-2018-01-30" title="Link to this heading">¶</a></h2>
<section id="id689">
<h3>Deprecations and Removals<a class="headerlink" href="#id689" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>All pytest classes now subclass <code class="docutils literal notranslate"><span class="pre">object</span></code> for better Python 2/3 compatibility.
This should not affect user code except in very rare edge cases. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2147">#2147</a>)</p></li>
</ul>
</section>
<section id="id690">
<h3>Features<a class="headerlink" href="#id690" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Introduce <code class="docutils literal notranslate"><span class="pre">empty_parameter_set_mark</span></code> ini option to select which mark to
apply when <code class="docutils literal notranslate"><span class="pre">&#64;pytest.mark.parametrize</span></code> is given an empty set of parameters.
Valid options are <code class="docutils literal notranslate"><span class="pre">skip</span></code> (default) and <code class="docutils literal notranslate"><span class="pre">xfail</span></code>. Note that it is planned
to change the default to <code class="docutils literal notranslate"><span class="pre">xfail</span></code> in future releases as this is considered
less error prone. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2527">#2527</a>)</p></li>
<li><p><strong>Incompatible change</strong>: after community feedback the <a class="reference internal" href="how-to/logging.html"><span class="doc">logging</span></a> functionality has
undergone some changes. Please consult the <a class="reference internal" href="how-to/logging.html#log-changes-3-4"><span class="std std-ref">logging documentation</span></a>
for details. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3013">#3013</a>)</p></li>
<li><p>Console output falls back to “classic” mode when capturing is disabled (<code class="docutils literal notranslate"><span class="pre">-s</span></code>),
otherwise the output gets garbled to the point of being useless. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3038">#3038</a>)</p></li>
<li><p>New <a class="reference internal" href="reference/reference.html#std:hook-23"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_runtest_logfinish</span></code></a>
hook which is called when a test item has finished executing, analogous to
<a class="reference internal" href="reference/reference.html#std:hook-22"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_runtest_logstart</span></code></a>.
(<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3101">#3101</a>)</p></li>
<li><p>Improve performance when collecting tests using many fixtures. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3107">#3107</a>)</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">caplog.get_records(when)</span></code> method which provides access to the captured
records for the <code class="docutils literal notranslate"><span class="pre">&quot;setup&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;call&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;teardown&quot;</span></code>
testing stages. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3117">#3117</a>)</p></li>
<li><p>New fixture <code class="docutils literal notranslate"><span class="pre">record_xml_attribute</span></code> that allows modifying and inserting
attributes on the <code class="docutils literal notranslate"><span class="pre">&lt;testcase&gt;</span></code> xml node in JUnit reports. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3130">#3130</a>)</p></li>
<li><p>The default cache directory has been renamed from <code class="docutils literal notranslate"><span class="pre">.cache</span></code> to
<code class="docutils literal notranslate"><span class="pre">.pytest_cache</span></code> after community feedback that the name <code class="docutils literal notranslate"><span class="pre">.cache</span></code> did not
make it clear that it was used by pytest. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3138">#3138</a>)</p></li>
<li><p>Colorize the levelname column in the live-log output. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3142">#3142</a>)</p></li>
</ul>
</section>
<section id="id691">
<h3>Bug Fixes<a class="headerlink" href="#id691" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Fix hanging pexpect test on macOS by using flush() instead of wait().
(<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2022">#2022</a>)</p></li>
<li><p>Fix restoring Python state after in-process pytest runs with the
<code class="docutils literal notranslate"><span class="pre">pytester</span></code> plugin; this may break tests using multiple inprocess
pytest runs if later ones depend on earlier ones leaking global interpreter
changes. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3016">#3016</a>)</p></li>
<li><p>Fix skipping plugin reporting hook when test aborted before plugin setup
hook. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3074">#3074</a>)</p></li>
<li><p>Fix progress percentage reported when tests fail during teardown. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3088">#3088</a>)</p></li>
<li><p><strong>Incompatible change</strong>: <code class="docutils literal notranslate"><span class="pre">-o/--override</span></code> option no longer eats all the
remaining options, which can lead to surprising behavior: for example,
<code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">-o</span> <span class="pre">foo=1</span> <span class="pre">/path/to/test.py</span></code> would fail because <code class="docutils literal notranslate"><span class="pre">/path/to/test.py</span></code>
would be considered as part of the <code class="docutils literal notranslate"><span class="pre">-o</span></code> command-line argument. One
consequence of this is that now multiple configuration overrides need
multiple <code class="docutils literal notranslate"><span class="pre">-o</span></code> flags: <code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">-o</span> <span class="pre">foo=1</span> <span class="pre">-o</span> <span class="pre">bar=2</span></code>. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3103">#3103</a>)</p></li>
</ul>
</section>
<section id="id692">
<h3>Improved Documentation<a class="headerlink" href="#id692" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Document hooks (defined with <code class="docutils literal notranslate"><span class="pre">historic=True</span></code>) which cannot be used with
<code class="docutils literal notranslate"><span class="pre">hookwrapper=True</span></code>. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2423">#2423</a>)</p></li>
<li><p>Clarify that warning capturing doesn’t change the warning filter by default.
(<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2457">#2457</a>)</p></li>
<li><p>Clarify a possible confusion when using pytest_fixture_setup with fixture
functions that return None. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2698">#2698</a>)</p></li>
<li><p>Fix the wording of a sentence on doctest flags used in pytest. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3076">#3076</a>)</p></li>
<li><p>Prefer <code class="docutils literal notranslate"><span class="pre">https://*.readthedocs.io</span></code> over <code class="docutils literal notranslate"><span class="pre">http://*.rtfd.org</span></code> for links in
the documentation. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3092">#3092</a>)</p></li>
<li><p>Improve readability (wording, grammar) of Getting Started guide (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3131">#3131</a>)</p></li>
<li><p>Added note that calling pytest.main multiple times from the same process is
not recommended because of import caching. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3143">#3143</a>)</p></li>
</ul>
</section>
<section id="id693">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id693" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Show a simple and easy error when keyword expressions trigger a syntax error
(for example, <code class="docutils literal notranslate"><span class="pre">&quot;-k</span> <span class="pre">foo</span> <span class="pre">and</span> <span class="pre">import&quot;</span></code> will show an error that you cannot use
the <code class="docutils literal notranslate"><span class="pre">import</span></code> keyword in expressions). (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2953">#2953</a>)</p></li>
<li><p>Change parametrized automatic test id generation to use the <code class="docutils literal notranslate"><span class="pre">__name__</span></code>
attribute of functions instead of the fallback argument name plus counter.
(<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2976">#2976</a>)</p></li>
<li><p>Replace py.std with stdlib imports. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3067">#3067</a>)</p></li>
<li><p>Corrected ‘you’ to ‘your’ in logging docs. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3129">#3129</a>)</p></li>
</ul>
</section>
</section>
<section id="pytest-3-3-2-2017-12-25">
<h2>pytest 3.3.2 (2017-12-25)<a class="headerlink" href="#pytest-3-3-2-2017-12-25" title="Link to this heading">¶</a></h2>
<section id="id694">
<h3>Bug Fixes<a class="headerlink" href="#id694" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>pytester: ignore files used to obtain current user metadata in the fd leak
detector. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2784">#2784</a>)</p></li>
<li><p>Fix <strong>memory leak</strong> where objects returned by fixtures were never destructed
by the garbage collector. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2981">#2981</a>)</p></li>
<li><p>Fix conversion of pyargs to filename to not convert symlinks on Python 2. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2985">#2985</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PYTEST_DONT_REWRITE</span></code> is now checked for plugins too rather than only for
test modules. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2995">#2995</a>)</p></li>
</ul>
</section>
<section id="id695">
<h3>Improved Documentation<a class="headerlink" href="#id695" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Add clarifying note about behavior of multiple parametrized arguments (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3001">#3001</a>)</p></li>
</ul>
</section>
<section id="id696">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id696" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Code cleanup. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3015">#3015</a>,
<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3021">#3021</a>)</p></li>
<li><p>Clean up code by replacing imports and references of <code class="docutils literal notranslate"><span class="pre">_ast</span></code> to <code class="docutils literal notranslate"><span class="pre">ast</span></code>.
(<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3018">#3018</a>)</p></li>
</ul>
</section>
</section>
<section id="pytest-3-3-1-2017-12-05">
<h2>pytest 3.3.1 (2017-12-05)<a class="headerlink" href="#pytest-3-3-1-2017-12-05" title="Link to this heading">¶</a></h2>
<section id="id697">
<h3>Bug Fixes<a class="headerlink" href="#id697" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Fix issue about <code class="docutils literal notranslate"><span class="pre">-p</span> <span class="pre">no:&lt;plugin&gt;</span></code> having no effect. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2920">#2920</a>)</p></li>
<li><p>Fix regression with warnings that contained non-strings in their arguments in
Python 2. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2956">#2956</a>)</p></li>
<li><p>Always escape null bytes when setting <code class="docutils literal notranslate"><span class="pre">PYTEST_CURRENT_TEST</span></code>. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2957">#2957</a>)</p></li>
<li><p>Fix <code class="docutils literal notranslate"><span class="pre">ZeroDivisionError</span></code> when using the <code class="docutils literal notranslate"><span class="pre">testmon</span></code> plugin when no tests
were actually collected. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2971">#2971</a>)</p></li>
<li><p>Bring back <code class="docutils literal notranslate"><span class="pre">TerminalReporter.writer</span></code> as an alias to
<code class="docutils literal notranslate"><span class="pre">TerminalReporter._tw</span></code>. This alias was removed by accident in the <code class="docutils literal notranslate"><span class="pre">3.3.0</span></code>
release. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2984">#2984</a>)</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">pytest-capturelog</span></code> plugin is now also blacklisted, avoiding errors when
running pytest with it still installed. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3004">#3004</a>)</p></li>
</ul>
</section>
<section id="id698">
<h3>Improved Documentation<a class="headerlink" href="#id698" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Fix broken link to plugin <code class="docutils literal notranslate"><span class="pre">pytest-localserver</span></code>. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2963">#2963</a>)</p></li>
</ul>
</section>
<section id="id699">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id699" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Update github “bugs” link in <code class="docutils literal notranslate"><span class="pre">CONTRIBUTING.rst</span></code> (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2949">#2949</a>)</p></li>
</ul>
</section>
</section>
<section id="pytest-3-3-0-2017-11-23">
<h2>pytest 3.3.0 (2017-11-23)<a class="headerlink" href="#pytest-3-3-0-2017-11-23" title="Link to this heading">¶</a></h2>
<section id="id700">
<h3>Deprecations and Removals<a class="headerlink" href="#id700" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>pytest no longer supports Python <strong>2.6</strong> and <strong>3.3</strong>. Those Python versions
are EOL for some time now and incur maintenance and compatibility costs on
the pytest core team, and following up with the rest of the community we
decided that they will no longer be supported starting on this version. Users
which still require those versions should pin pytest to <code class="docutils literal notranslate"><span class="pre">&lt;3.3</span></code>. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2812">#2812</a>)</p></li>
<li><p>Remove internal <code class="docutils literal notranslate"><span class="pre">_preloadplugins()</span></code> function. This removal is part of the
<code class="docutils literal notranslate"><span class="pre">pytest_namespace()</span></code> hook deprecation. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2636">#2636</a>)</p></li>
<li><p>Internally change <code class="docutils literal notranslate"><span class="pre">CallSpec2</span></code> to have a list of marks instead of a broken
mapping of keywords. This removes the keywords attribute of the internal
<code class="docutils literal notranslate"><span class="pre">CallSpec2</span></code> class. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2672">#2672</a>)</p></li>
<li><p>Remove ParameterSet.deprecated_arg_dict - its not a public api and the lack
of the underscore was a naming error. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2675">#2675</a>)</p></li>
<li><p>Remove the internal multi-typed attribute <code class="docutils literal notranslate"><span class="pre">Node._evalskip</span></code> and replace it
with the boolean <code class="docutils literal notranslate"><span class="pre">Node._skipped_by_mark</span></code>. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2767">#2767</a>)</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">params</span></code> list passed to <code class="docutils literal notranslate"><span class="pre">pytest.fixture</span></code> is now for
all effects considered immutable and frozen at the moment of the <code class="docutils literal notranslate"><span class="pre">pytest.fixture</span></code>
call. Previously the list could be changed before the first invocation of the fixture
allowing for a form of dynamic parametrization (for example, updated from command-line options),
but this was an unwanted implementation detail which complicated the internals and prevented
some internal cleanup. See issue <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2959">#2959</a>
for details and a recommended workaround.</p></li>
</ul>
</section>
<section id="id701">
<h3>Features<a class="headerlink" href="#id701" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pytest_fixture_post_finalizer</span></code> hook can now receive a <code class="docutils literal notranslate"><span class="pre">request</span></code>
argument. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2124">#2124</a>)</p></li>
<li><p>Replace the old introspection code in compat.py that determines the available
arguments of fixtures with inspect.signature on Python 3 and
funcsigs.signature on Python 2. This should respect <code class="docutils literal notranslate"><span class="pre">__signature__</span></code>
declarations on functions. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2267">#2267</a>)</p></li>
<li><p>Report tests with global <code class="docutils literal notranslate"><span class="pre">pytestmark</span></code> variable only once. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2549">#2549</a>)</p></li>
<li><p>Now pytest displays the total progress percentage while running tests. The
previous output style can be set by configuring the <code class="docutils literal notranslate"><span class="pre">console_output_style</span></code>
setting to <code class="docutils literal notranslate"><span class="pre">classic</span></code>. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2657">#2657</a>)</p></li>
<li><p>Match <code class="docutils literal notranslate"><span class="pre">warns</span></code> signature to <code class="docutils literal notranslate"><span class="pre">raises</span></code> by adding <code class="docutils literal notranslate"><span class="pre">match</span></code> keyword. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2708">#2708</a>)</p></li>
<li><p>pytest now captures and displays output from the standard <code class="docutils literal notranslate"><span class="pre">logging</span></code> module.
The user can control the logging level to be captured by specifying options
in <code class="docutils literal notranslate"><span class="pre">pytest.ini</span></code>, the command line and also during individual tests using
markers. Also, a <code class="docutils literal notranslate"><span class="pre">caplog</span></code> fixture is available that enables users to test
the captured log during specific tests (similar to <code class="docutils literal notranslate"><span class="pre">capsys</span></code> for example).
For more information, please see the <a class="reference internal" href="how-to/logging.html"><span class="doc">logging docs</span></a>. This feature was
introduced by merging the popular <a class="reference external" href="https://pypi.org/project/pytest-catchlog">pytest-catchlog</a> plugin, thanks to <a class="reference external" href="https://github.com/sponsors/thisch">&#64;thisch</a>.
Be advised that during the merging the
backward compatibility interface with the defunct <code class="docutils literal notranslate"><span class="pre">pytest-capturelog</span></code> has
been dropped. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2794">#2794</a>)</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">allow_module_level</span></code> kwarg to <code class="docutils literal notranslate"><span class="pre">pytest.skip()</span></code>, enabling to skip the
whole module. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2808">#2808</a>)</p></li>
<li><p>Allow setting <code class="docutils literal notranslate"><span class="pre">file_or_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">-c</span></code>, and <code class="docutils literal notranslate"><span class="pre">-o</span></code> in PYTEST_ADDOPTS. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2824">#2824</a>)</p></li>
<li><p>Return stdout/stderr capture results as a <code class="docutils literal notranslate"><span class="pre">namedtuple</span></code>, so <code class="docutils literal notranslate"><span class="pre">out</span></code> and
<code class="docutils literal notranslate"><span class="pre">err</span></code> can be accessed by attribute. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2879">#2879</a>)</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">capfdbinary</span></code>, a version of <code class="docutils literal notranslate"><span class="pre">capfd</span></code> which returns bytes from
<code class="docutils literal notranslate"><span class="pre">readouterr()</span></code>. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2923">#2923</a>)</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">capsysbinary</span></code> a version of <code class="docutils literal notranslate"><span class="pre">capsys</span></code> which returns bytes from
<code class="docutils literal notranslate"><span class="pre">readouterr()</span></code>. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2934">#2934</a>)</p></li>
<li><p>Implement feature to skip <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> files when run with
<code class="docutils literal notranslate"><span class="pre">--doctest-modules</span></code>. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/502">#502</a>)</p></li>
</ul>
</section>
<section id="id702">
<h3>Bug Fixes<a class="headerlink" href="#id702" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Resume output capturing after <code class="docutils literal notranslate"><span class="pre">capsys/capfd.disabled()</span></code> context manager.
(<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1993">#1993</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest_fixture_setup</span></code> and <code class="docutils literal notranslate"><span class="pre">pytest_fixture_post_finalizer</span></code> hooks are now
called for all <code class="docutils literal notranslate"><span class="pre">conftest.py</span></code> files. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2124">#2124</a>)</p></li>
<li><p>If an exception happens while loading a plugin, pytest no longer hides the
original traceback. In Python 2 it will show the original traceback with a new
message that explains in which plugin. In Python 3 it will show 2 canonized
exceptions, the original exception while loading the plugin in addition to an
exception that pytest throws about loading a plugin. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2491">#2491</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">capsys</span></code> and <code class="docutils literal notranslate"><span class="pre">capfd</span></code> can now be used by other fixtures. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2709">#2709</a>)</p></li>
<li><p>Internal <code class="docutils literal notranslate"><span class="pre">pytester</span></code> plugin properly encodes <code class="docutils literal notranslate"><span class="pre">bytes</span></code> arguments to
<code class="docutils literal notranslate"><span class="pre">utf-8</span></code>. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2738">#2738</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">testdir</span></code> now uses use the same method used by <code class="docutils literal notranslate"><span class="pre">tmpdir</span></code> to create its
temporary directory. This changes the final structure of the <code class="docutils literal notranslate"><span class="pre">testdir</span></code>
directory slightly, but should not affect usage in normal scenarios and
avoids a number of potential problems. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2751">#2751</a>)</p></li>
<li><p>pytest no longer complains about warnings with unicode messages being
non-ascii compatible even for ascii-compatible messages. As a result of this,
warnings with unicode messages are converted first to an ascii representation
for safety. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2809">#2809</a>)</p></li>
<li><p>Change return value of pytest command when <code class="docutils literal notranslate"><span class="pre">--maxfail</span></code> is reached from
<code class="docutils literal notranslate"><span class="pre">2</span></code> (interrupted) to <code class="docutils literal notranslate"><span class="pre">1</span></code> (failed). (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2845">#2845</a>)</p></li>
<li><p>Fix issue in assertion rewriting which could lead it to rewrite modules which
should not be rewritten. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2939">#2939</a>)</p></li>
<li><p>Handle marks without description in <code class="docutils literal notranslate"><span class="pre">pytest.ini</span></code>. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2942">#2942</a>)</p></li>
</ul>
</section>
<section id="id703">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id703" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>pytest now depends on <a class="reference external" href="https://pypi.org/project/attrs">attrs</a> for internal
structures to ease code maintainability. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2641">#2641</a>)</p></li>
<li><p>Refactored internal Python 2/3 compatibility code to use <code class="docutils literal notranslate"><span class="pre">six</span></code>. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2642">#2642</a>)</p></li>
<li><p>Stop vendoring <code class="docutils literal notranslate"><span class="pre">pluggy</span></code> - we’re missing out on its latest changes for not
much benefit (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2719">#2719</a>)</p></li>
<li><p>Internal refactor: simplify ascii string escaping by using the
backslashreplace error handler in newer Python 3 versions. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2734">#2734</a>)</p></li>
<li><p>Remove unnecessary mark evaluator in unittest plugin (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2767">#2767</a>)</p></li>
<li><p>Calls to <code class="docutils literal notranslate"><span class="pre">Metafunc.addcall</span></code> now emit a deprecation warning. This function
is scheduled to be removed in <code class="docutils literal notranslate"><span class="pre">pytest-4.0</span></code>. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2876">#2876</a>)</p></li>
<li><p>Internal move of the parameterset extraction to a more maintainable place.
(<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2877">#2877</a>)</p></li>
<li><p>Internal refactoring to simplify scope node lookup. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2910">#2910</a>)</p></li>
<li><p>Configure <code class="docutils literal notranslate"><span class="pre">pytest</span></code> to prevent pip from installing pytest in unsupported
Python versions. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2922">#2922</a>)</p></li>
</ul>
</section>
</section>
<section id="pytest-3-2-5-2017-11-15">
<h2>pytest 3.2.5 (2017-11-15)<a class="headerlink" href="#pytest-3-2-5-2017-11-15" title="Link to this heading">¶</a></h2>
<section id="id704">
<h3>Bug Fixes<a class="headerlink" href="#id704" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Remove <code class="docutils literal notranslate"><span class="pre">py&lt;1.5</span></code> restriction from <code class="docutils literal notranslate"><span class="pre">pytest</span></code> as this can cause version
conflicts in some installations. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2926">#2926</a>)</p></li>
</ul>
</section>
</section>
<section id="pytest-3-2-4-2017-11-13">
<h2>pytest 3.2.4 (2017-11-13)<a class="headerlink" href="#pytest-3-2-4-2017-11-13" title="Link to this heading">¶</a></h2>
<section id="id705">
<h3>Bug Fixes<a class="headerlink" href="#id705" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Fix the bug where running with <code class="docutils literal notranslate"><span class="pre">--pyargs</span></code> will result in items with
empty <code class="docutils literal notranslate"><span class="pre">parent.nodeid</span></code> if run from a different root directory. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2775">#2775</a>)</p></li>
<li><p>Fix issue with <code class="docutils literal notranslate"><span class="pre">&#64;pytest.parametrize</span></code> if argnames was specified as keyword arguments.
(<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2819">#2819</a>)</p></li>
<li><p>Strip whitespace from marker names when reading them from INI config. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2856">#2856</a>)</p></li>
<li><p>Show full context of doctest source in the pytest output, if the line number of
failed example in the docstring is &lt; 9. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2882">#2882</a>)</p></li>
<li><p>Match fixture paths against actual path segments in order to avoid matching folders which share a prefix.
(<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2836">#2836</a>)</p></li>
</ul>
</section>
<section id="id706">
<h3>Improved Documentation<a class="headerlink" href="#id706" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Introduce a dedicated section about conftest.py. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1505">#1505</a>)</p></li>
<li><p>Explicitly mention <code class="docutils literal notranslate"><span class="pre">xpass</span></code> in the documentation of <code class="docutils literal notranslate"><span class="pre">xfail</span></code>. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1997">#1997</a>)</p></li>
<li><p>Append example for pytest.param in the example/parametrize document. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2658">#2658</a>)</p></li>
<li><p>Clarify language of proposal for fixtures parameters (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2893">#2893</a>)</p></li>
<li><p>List python 3.6 in the documented supported versions in the getting started
document. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2903">#2903</a>)</p></li>
<li><p>Clarify the documentation of available fixture scopes. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/538">#538</a>)</p></li>
<li><p>Add documentation about the <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">pytest</span></code> invocation adding the
current directory to sys.path. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/911">#911</a>)</p></li>
</ul>
</section>
</section>
<section id="pytest-3-2-3-2017-10-03">
<h2>pytest 3.2.3 (2017-10-03)<a class="headerlink" href="#pytest-3-2-3-2017-10-03" title="Link to this heading">¶</a></h2>
<section id="id707">
<h3>Bug Fixes<a class="headerlink" href="#id707" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Fix crash in tab completion when no prefix is given. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2748">#2748</a>)</p></li>
<li><p>The equality checking function (<code class="docutils literal notranslate"><span class="pre">__eq__</span></code>) of <code class="docutils literal notranslate"><span class="pre">MarkDecorator</span></code> returns
<code class="docutils literal notranslate"><span class="pre">False</span></code> if one object is not an instance of <code class="docutils literal notranslate"><span class="pre">MarkDecorator</span></code>. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2758">#2758</a>)</p></li>
<li><p>When running <code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">--fixtures-per-test</span></code>: don’t crash if an item has no
_fixtureinfo attribute (e.g. doctests) (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2788">#2788</a>)</p></li>
</ul>
</section>
<section id="id708">
<h3>Improved Documentation<a class="headerlink" href="#id708" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>In help text of <code class="docutils literal notranslate"><span class="pre">-k</span></code> option, add example of using <code class="docutils literal notranslate"><span class="pre">not</span></code> to not select
certain tests whose names match the provided expression. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1442">#1442</a>)</p></li>
<li><p>Add note in <code class="docutils literal notranslate"><span class="pre">parametrize.rst</span></code> about calling <code class="docutils literal notranslate"><span class="pre">metafunc.parametrize</span></code>
multiple times. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1548">#1548</a>)</p></li>
</ul>
</section>
<section id="id709">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id709" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Set <code class="docutils literal notranslate"><span class="pre">xfail_strict=True</span></code> in pytest’s own test suite to catch expected
failures as soon as they start to pass. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2722">#2722</a>)</p></li>
<li><p>Fix typo in example of passing a callable to markers (in example/markers.rst)
(<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2765">#2765</a>)</p></li>
</ul>
</section>
</section>
<section id="pytest-3-2-2-2017-09-06">
<h2>pytest 3.2.2 (2017-09-06)<a class="headerlink" href="#pytest-3-2-2-2017-09-06" title="Link to this heading">¶</a></h2>
<section id="id710">
<h3>Bug Fixes<a class="headerlink" href="#id710" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Calling the deprecated <code class="docutils literal notranslate"><span class="pre">request.getfuncargvalue()</span></code> now shows the source of
the call. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2681">#2681</a>)</p></li>
<li><p>Allow tests declared as <code class="docutils literal notranslate"><span class="pre">&#64;staticmethod</span></code> to use fixtures. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2699">#2699</a>)</p></li>
<li><p>Fixed edge-case during collection: attributes which raised <code class="docutils literal notranslate"><span class="pre">pytest.fail</span></code>
when accessed would abort the entire collection. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2707">#2707</a>)</p></li>
<li><p>Fix <code class="docutils literal notranslate"><span class="pre">ReprFuncArgs</span></code> with mixed unicode and UTF-8 args. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2731">#2731</a>)</p></li>
</ul>
</section>
<section id="id711">
<h3>Improved Documentation<a class="headerlink" href="#id711" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>In examples on working with custom markers, add examples demonstrating the
usage of <code class="docutils literal notranslate"><span class="pre">pytest.mark.MARKER_NAME.with_args</span></code> in comparison with
<code class="docutils literal notranslate"><span class="pre">pytest.mark.MARKER_NAME.__call__</span></code> (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2604">#2604</a>)</p></li>
<li><p>In one of the simple examples, use <code class="docutils literal notranslate"><span class="pre">pytest_collection_modifyitems()</span></code> to skip
tests based on a command-line option, allowing its sharing while preventing a
user error when accessing <code class="docutils literal notranslate"><span class="pre">pytest.config</span></code> before the argument parsing.
(<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2653">#2653</a>)</p></li>
</ul>
</section>
<section id="id712">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id712" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Fixed minor error in ‘Good Practices/Manual Integration’ code snippet.
(<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2691">#2691</a>)</p></li>
<li><p>Fixed typo in goodpractices.rst. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2721">#2721</a>)</p></li>
<li><p>Improve user guidance regarding <code class="docutils literal notranslate"><span class="pre">--resultlog</span></code> deprecation. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2739">#2739</a>)</p></li>
</ul>
</section>
</section>
<section id="pytest-3-2-1-2017-08-08">
<h2>pytest 3.2.1 (2017-08-08)<a class="headerlink" href="#pytest-3-2-1-2017-08-08" title="Link to this heading">¶</a></h2>
<section id="id713">
<h3>Bug Fixes<a class="headerlink" href="#id713" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Fixed small terminal glitch when collecting a single test item. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2579">#2579</a>)</p></li>
<li><p>Correctly consider <code class="docutils literal notranslate"><span class="pre">/</span></code> as the file separator to automatically mark plugin
files for rewrite on Windows. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2591">#2591</a>)</p></li>
<li><p>Properly escape test names when setting <code class="docutils literal notranslate"><span class="pre">PYTEST_CURRENT_TEST</span></code> environment
variable. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2644">#2644</a>)</p></li>
<li><p>Fix error on Windows and Python 3.6+ when <code class="docutils literal notranslate"><span class="pre">sys.stdout</span></code> has been replaced
with a stream-like object which does not implement the full <code class="docutils literal notranslate"><span class="pre">io</span></code> module
buffer protocol. In particular this affects <code class="docutils literal notranslate"><span class="pre">pytest-xdist</span></code> users on the
aforementioned platform. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2666">#2666</a>)</p></li>
</ul>
</section>
<section id="id714">
<h3>Improved Documentation<a class="headerlink" href="#id714" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Explicitly document which pytest features work with <code class="docutils literal notranslate"><span class="pre">unittest</span></code>. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2626">#2626</a>)</p></li>
</ul>
</section>
</section>
<section id="pytest-3-2-0-2017-07-30">
<h2>pytest 3.2.0 (2017-07-30)<a class="headerlink" href="#pytest-3-2-0-2017-07-30" title="Link to this heading">¶</a></h2>
<section id="id715">
<h3>Deprecations and Removals<a class="headerlink" href="#id715" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.approx</span></code> no longer supports <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;=</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;=</span></code>
operators to avoid surprising/inconsistent behavior. See the <a class="reference internal" href="reference/reference.html#pytest.approx" title="pytest.approx"><code class="xref py py-func docutils literal notranslate"><span class="pre">approx()</span></code></a> docs for more
information. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2003">#2003</a>)</p></li>
<li><p>All old-style specific behavior in current classes in the pytest’s API is
considered deprecated at this point and will be removed in a future release.
This affects Python 2 users only and in rare situations. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2147">#2147</a>)</p></li>
<li><p>A deprecation warning is now raised when using marks for parameters
in <code class="docutils literal notranslate"><span class="pre">pytest.mark.parametrize</span></code>. Use <code class="docutils literal notranslate"><span class="pre">pytest.param</span></code> to apply marks to
parameters instead. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2427">#2427</a>)</p></li>
</ul>
</section>
<section id="id716">
<h3>Features<a class="headerlink" href="#id716" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Add support for numpy arrays (and dicts) to approx. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1994">#1994</a>)</p></li>
<li><p>Now test function objects have a <code class="docutils literal notranslate"><span class="pre">pytestmark</span></code> attribute containing a list
of marks applied directly to the test function, as opposed to marks inherited
from parent classes or modules. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2516">#2516</a>)</p></li>
<li><p>Collection ignores local virtualenvs by default; <code class="docutils literal notranslate"><span class="pre">--collect-in-virtualenv</span></code>
overrides this behavior. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2518">#2518</a>)</p></li>
<li><p>Allow class methods decorated as <code class="docutils literal notranslate"><span class="pre">&#64;staticmethod</span></code> to be candidates for
collection as a test function. (Only for Python 2.7 and above. Python 2.6
will still ignore static methods.) (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2528">#2528</a>)</p></li>
<li><p>Introduce <code class="docutils literal notranslate"><span class="pre">mark.with_args</span></code> in order to allow passing functions/classes as
sole argument to marks. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2540">#2540</a>)</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">cache_dir</span></code> ini option: sets the directory where the contents of the
cache plugin are stored. Directory may be relative or absolute path: if relative path, then
directory is created relative to <code class="docutils literal notranslate"><span class="pre">rootdir</span></code>, otherwise it is used as is.
Additionally path may contain environment variables which are expanded during
runtime. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2543">#2543</a>)</p></li>
<li><p>Introduce the <code class="docutils literal notranslate"><span class="pre">PYTEST_CURRENT_TEST</span></code> environment variable that is set with
the <code class="docutils literal notranslate"><span class="pre">nodeid</span></code> and stage (<code class="docutils literal notranslate"><span class="pre">setup</span></code>, <code class="docutils literal notranslate"><span class="pre">call</span></code> and <code class="docutils literal notranslate"><span class="pre">teardown</span></code>) of the test
being currently executed. See the <a class="reference internal" href="example/simple.html#pytest-current-test-env"><span class="std std-ref">documentation</span></a>
for more info. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2583">#2583</a>)</p></li>
<li><p>Introduced <code class="docutils literal notranslate"><span class="pre">&#64;pytest.mark.filterwarnings</span></code> mark which allows overwriting the
warnings filter on a per test, class or module level. See the <a class="reference internal" href="how-to/capture-warnings.html#filterwarnings"><span class="std std-ref">docs</span></a>
for more information. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2598">#2598</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--last-failed</span></code> now remembers forever when a test has failed and only
forgets it if it passes again. This makes it easy to fix a test suite by
selectively running files and fixing tests incrementally. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2621">#2621</a>)</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">pytest_report_collectionfinish</span></code> hook which allows plugins to add
messages to the terminal reporting after collection has been finished
successfully. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2622">#2622</a>)</p></li>
<li><p>Added support for <span class="target" id="index-10"></span><a class="pep reference external" href="https://peps.python.org/pep-0415/"><strong>PEP 415</strong></a>'s
<code class="docutils literal notranslate"><span class="pre">Exception.__suppress_context__</span></code>. Now if a <code class="docutils literal notranslate"><span class="pre">raise</span> <span class="pre">exception</span> <span class="pre">from</span> <span class="pre">None</span></code> is
caught by pytest, pytest will no longer chain the context in the test report.
The behavior now matches Python’s traceback behavior. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2631">#2631</a>)</p></li>
<li><p>Exceptions raised by <code class="docutils literal notranslate"><span class="pre">pytest.fail</span></code>, <code class="docutils literal notranslate"><span class="pre">pytest.skip</span></code> and <code class="docutils literal notranslate"><span class="pre">pytest.xfail</span></code>
now subclass BaseException, making them harder to be caught unintentionally
by normal code. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/580">#580</a>)</p></li>
</ul>
</section>
<section id="id717">
<h3>Bug Fixes<a class="headerlink" href="#id717" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Set <code class="docutils literal notranslate"><span class="pre">stdin</span></code> to a closed <code class="docutils literal notranslate"><span class="pre">PIPE</span></code> in <code class="docutils literal notranslate"><span class="pre">pytester.py.Testdir.popen()</span></code> for
avoid unwanted interactive <code class="docutils literal notranslate"><span class="pre">pdb</span></code> (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2023">#2023</a>)</p></li>
<li><p>Add missing <code class="docutils literal notranslate"><span class="pre">encoding</span></code> attribute to <code class="docutils literal notranslate"><span class="pre">sys.std*</span></code> streams when using
<code class="docutils literal notranslate"><span class="pre">capsys</span></code> capture mode. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2375">#2375</a>)</p></li>
<li><p>Fix terminal color changing to black on Windows if <code class="docutils literal notranslate"><span class="pre">colorama</span></code> is imported
in a <code class="docutils literal notranslate"><span class="pre">conftest.py</span></code> file. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2510">#2510</a>)</p></li>
<li><p>Fix line number when reporting summary of skipped tests. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2548">#2548</a>)</p></li>
<li><p>capture: ensure that EncodedFile.name is a string. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2555">#2555</a>)</p></li>
<li><p>The options <code class="docutils literal notranslate"><span class="pre">--fixtures</span></code> and <code class="docutils literal notranslate"><span class="pre">--fixtures-per-test</span></code> will now keep
indentation within docstrings. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2574">#2574</a>)</p></li>
<li><p>doctests line numbers are now reported correctly, fixing <a class="reference external" href="https://github.com/Frozenball/pytest-sugar/issues/122">pytest-sugar#122</a>. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2610">#2610</a>)</p></li>
<li><p>Fix non-determinism in order of fixture collection. Adds new dependency
(ordereddict) for Python 2.6. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/920">#920</a>)</p></li>
</ul>
</section>
<section id="id718">
<h3>Improved Documentation<a class="headerlink" href="#id718" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Clarify <code class="docutils literal notranslate"><span class="pre">pytest_configure</span></code> hook call order. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2539">#2539</a>)</p></li>
<li><p>Extend documentation for testing plugin code with the <code class="docutils literal notranslate"><span class="pre">pytester</span></code> plugin.
(<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/971">#971</a>)</p></li>
</ul>
</section>
<section id="id719">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id719" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Update help message for <code class="docutils literal notranslate"><span class="pre">--strict</span></code> to make it clear it only deals with
unregistered markers, not warnings. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2444">#2444</a>)</p></li>
<li><p>Internal code move: move code for pytest.approx/pytest.raises to own files in
order to cut down the size of python.py (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2489">#2489</a>)</p></li>
<li><p>Renamed the utility function <code class="docutils literal notranslate"><span class="pre">_pytest.compat._escape_strings</span></code> to
<code class="docutils literal notranslate"><span class="pre">_ascii_escaped</span></code> to better communicate the function’s purpose. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2533">#2533</a>)</p></li>
<li><p>Improve error message for CollectError with skip/skipif. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2546">#2546</a>)</p></li>
<li><p>Emit warning about <code class="docutils literal notranslate"><span class="pre">yield</span></code> tests being deprecated only once per generator.
(<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2562">#2562</a>)</p></li>
<li><p>Ensure final collected line doesn’t include artifacts of previous write.
(<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2571">#2571</a>)</p></li>
<li><p>Fixed all flake8 errors and warnings. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2581">#2581</a>)</p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">fix-lint</span></code> tox environment to run automatic pep8 fixes on the code.
(<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2582">#2582</a>)</p></li>
<li><p>Turn warnings into errors in pytest’s own test suite in order to catch
regressions due to deprecations more promptly. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2588">#2588</a>)</p></li>
<li><p>Show multiple issue links in CHANGELOG entries. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2620">#2620</a>)</p></li>
</ul>
</section>
</section>
<section id="pytest-3-1-3-2017-07-03">
<h2>pytest 3.1.3 (2017-07-03)<a class="headerlink" href="#pytest-3-1-3-2017-07-03" title="Link to this heading">¶</a></h2>
<section id="id720">
<h3>Bug Fixes<a class="headerlink" href="#id720" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Fix decode error in Python 2 for doctests in docstrings. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2434">#2434</a>)</p></li>
<li><p>Exceptions raised during teardown by finalizers are now suppressed until all
finalizers are called, with the initial exception reraised. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2440">#2440</a>)</p></li>
<li><p>Fix incorrect “collected items” report when specifying tests on the command-
line. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2464">#2464</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">deprecated_call</span></code> in context-manager form now captures deprecation warnings
even if the same warning has already been raised. Also, <code class="docutils literal notranslate"><span class="pre">deprecated_call</span></code>
will always produce the same error message (previously it would produce
different messages in context-manager vs. function-call mode). (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2469">#2469</a>)</p></li>
<li><p>Fix issue where paths collected by pytest could have triple leading <code class="docutils literal notranslate"><span class="pre">/</span></code>
characters. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2475">#2475</a>)</p></li>
<li><p>Fix internal error when trying to detect the start of a recursive traceback.
(<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2486">#2486</a>)</p></li>
</ul>
</section>
<section id="id721">
<h3>Improved Documentation<a class="headerlink" href="#id721" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Explicitly state for which hooks the calls stop after the first non-None
result. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2493">#2493</a>)</p></li>
</ul>
</section>
<section id="id722">
<h3>Trivial/Internal Changes<a class="headerlink" href="#id722" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Create invoke tasks for updating the vendored packages. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2474">#2474</a>)</p></li>
<li><p>Update copyright dates in LICENSE, README.rst and in the documentation.
(<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2499">#2499</a>)</p></li>
</ul>
</section>
</section>
<section id="pytest-3-1-2-2017-06-08">
<h2>pytest 3.1.2 (2017-06-08)<a class="headerlink" href="#pytest-3-1-2-2017-06-08" title="Link to this heading">¶</a></h2>
<section id="id723">
<h3>Bug Fixes<a class="headerlink" href="#id723" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Required options added via <code class="docutils literal notranslate"><span class="pre">pytest_addoption</span></code> will no longer prevent using
–help without passing them. (#1999)</p></li>
<li><p>Respect <code class="docutils literal notranslate"><span class="pre">python_files</span></code> in assertion rewriting. (#2121)</p></li>
<li><p>Fix recursion error detection when frames in the traceback contain objects
that can’t be compared (like <code class="docutils literal notranslate"><span class="pre">numpy</span></code> arrays). (#2459)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">UnicodeWarning</span></code> is issued from the internal pytest warnings plugin only
when the message contains non-ascii unicode (Python 2 only). (#2463)</p></li>
<li><p>Added a workaround for Python 3.6 <code class="docutils literal notranslate"><span class="pre">WindowsConsoleIO</span></code> breaking due to Pytests’s
<code class="docutils literal notranslate"><span class="pre">FDCapture</span></code>. Other code using console handles might still be affected by the
very same issue and might require further workarounds/fixes, i.e. <code class="docutils literal notranslate"><span class="pre">colorama</span></code>.
(#2467)</p></li>
</ul>
</section>
<section id="id724">
<h3>Improved Documentation<a class="headerlink" href="#id724" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Fix internal API links to <code class="docutils literal notranslate"><span class="pre">pluggy</span></code> objects. (#2331)</p></li>
<li><p>Make it clear that <code class="docutils literal notranslate"><span class="pre">pytest.xfail</span></code> stops test execution at the calling point
and improve overall flow of the <code class="docutils literal notranslate"><span class="pre">skipping</span></code> docs. (#810)</p></li>
</ul>
</section>
</section>
<section id="pytest-3-1-1-2017-05-30">
<h2>pytest 3.1.1 (2017-05-30)<a class="headerlink" href="#pytest-3-1-1-2017-05-30" title="Link to this heading">¶</a></h2>
<section id="id725">
<h3>Bug Fixes<a class="headerlink" href="#id725" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>pytest warning capture no longer overrides existing warning filters. The
previous behaviour would override all filters and caused regressions in test
suites which configure warning filters to match their needs. Note that as a
side-effect of this is that <code class="docutils literal notranslate"><span class="pre">DeprecationWarning</span></code> and
<code class="docutils literal notranslate"><span class="pre">PendingDeprecationWarning</span></code> are no longer shown by default. (#2430)</p></li>
<li><p>Fix issue with non-ascii contents in doctest text files. (#2434)</p></li>
<li><p>Fix encoding errors for unicode warnings in Python 2. (#2436)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.deprecated_call</span></code> now captures <code class="docutils literal notranslate"><span class="pre">PendingDeprecationWarning</span></code> in
context manager form. (#2441)</p></li>
</ul>
</section>
<section id="id726">
<h3>Improved Documentation<a class="headerlink" href="#id726" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Addition of towncrier for changelog management. (#2390)</p></li>
</ul>
</section>
</section>
<section id="id727">
<h2>3.1.0 (2017-05-22)<a class="headerlink" href="#id727" title="Link to this heading">¶</a></h2>
<section id="id728">
<h3>New Features<a class="headerlink" href="#id728" title="Link to this heading">¶</a></h3>
<ul>
<li><p>The <code class="docutils literal notranslate"><span class="pre">pytest-warnings</span></code> plugin has been integrated into the core and now <code class="docutils literal notranslate"><span class="pre">pytest</span></code> automatically
captures and displays warnings at the end of the test session.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This feature may disrupt test suites which apply and treat warnings themselves, and can be
disabled in your <code class="docutils literal notranslate"><span class="pre">pytest.ini</span></code>:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[pytest]</span>
<span class="na">addopts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">-p no:warnings</span>
</pre></div>
</div>
<p>See the <a class="reference internal" href="how-to/capture-warnings.html"><span class="doc">warnings documentation page</span></a> for more
information.</p>
</div>
<p>Thanks <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p>
</li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">junit_suite_name</span></code> ini option to specify root <code class="docutils literal notranslate"><span class="pre">&lt;testsuite&gt;</span></code> name for JUnit XML reports (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/533">#533</a>).</p></li>
<li><p>Added an ini option <code class="docutils literal notranslate"><span class="pre">doctest_encoding</span></code> to specify which encoding to use for doctest files.
Thanks <a class="reference external" href="https://github.com/sponsors/wheerd">&#64;wheerd</a> for the PR (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/2101">#2101</a>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.warns</span></code> now checks for subclass relationship rather than
class equality. Thanks <a class="reference external" href="https://github.com/sponsors/lesteve">&#64;lesteve</a> for the PR (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/2166">#2166</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.raises</span></code> now asserts that the error message matches a text or regex
with the <code class="docutils literal notranslate"><span class="pre">match</span></code> keyword argument. Thanks <a class="reference external" href="https://github.com/sponsors/Kriechi">&#64;Kriechi</a> for the PR.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.param</span></code> can be used to declare test parameter sets with marks and test ids.
Thanks <a class="reference external" href="https://github.com/sponsors/RonnyPfannschmidt">&#64;RonnyPfannschmidt</a> for the PR.</p></li>
</ul>
</section>
<section id="changes">
<h3>Changes<a class="headerlink" href="#changes" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>remove all internal uses of pytest_namespace hooks,
this is to prepare the removal of preloadconfig in pytest 4.0
Thanks to <a class="reference external" href="https://github.com/sponsors/RonnyPfannschmidt">&#64;RonnyPfannschmidt</a> for the PR.</p></li>
<li><p>pytest now warns when a callable ids raises in a parametrized test. Thanks <a class="reference external" href="https://github.com/sponsors/fogo">&#64;fogo</a> for the PR.</p></li>
<li><p>It is now possible to skip test classes from being collected by setting a
<code class="docutils literal notranslate"><span class="pre">__test__</span></code> attribute to <code class="docutils literal notranslate"><span class="pre">False</span></code> in the class body (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2007">#2007</a>). Thanks
to <a class="reference external" href="https://github.com/sponsors/syre">&#64;syre</a> for the report and <a class="reference external" href="https://github.com/sponsors/lwm">&#64;lwm</a> for the PR.</p></li>
<li><p>Change junitxml.py to produce reports that comply with Junitxml schema.
If the same test fails with failure in call and then errors in teardown
we split testcase element into two, one containing the error and the other
the failure. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2228">#2228</a>) Thanks to <a class="reference external" href="https://github.com/sponsors/kkoukiou">&#64;kkoukiou</a> for the PR.</p></li>
<li><p>Testcase reports with a <code class="docutils literal notranslate"><span class="pre">url</span></code> attribute will now properly write this to junitxml.
Thanks <a class="reference external" href="https://github.com/sponsors/fushi">&#64;fushi</a> for the PR (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1874">#1874</a>).</p></li>
<li><p>Remove common items from dict comparison output when verbosity=1. Also update
the truncation message to make it clearer that pytest truncates all
assertion messages if verbosity &lt; 2 (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1512">#1512</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/mattduck">&#64;mattduck</a> for the PR</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--pdbcls</span></code> no longer implies <code class="docutils literal notranslate"><span class="pre">--pdb</span></code>. This makes it possible to use
<code class="docutils literal notranslate"><span class="pre">addopts=--pdbcls=module.SomeClass</span></code> on <code class="docutils literal notranslate"><span class="pre">pytest.ini</span></code>. Thanks <a class="reference external" href="https://github.com/sponsors/davidszotten">&#64;davidszotten</a> for
the PR (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1952">#1952</a>).</p></li>
<li><p>fix <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2013">#2013</a>: turn RecordedWarning into <code class="docutils literal notranslate"><span class="pre">namedtuple</span></code>,
to give it a comprehensible repr while preventing unwarranted modification.</p></li>
<li><p>fix <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2208">#2208</a>: ensure an iteration limit for <code class="docutils literal notranslate"><span class="pre">_pytest.compat.get_real_func</span></code>.
Thanks <a class="reference external" href="https://github.com/sponsors/RonnyPfannschmidt">&#64;RonnyPfannschmidt</a> for the report and PR.</p></li>
<li><p>Hooks are now verified after collection is complete, rather than right after loading installed plugins. This
makes it easy to write hooks for plugins which will be loaded during collection, for example using the
<code class="docutils literal notranslate"><span class="pre">pytest_plugins</span></code> special variable (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1821">#1821</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>Modify <code class="docutils literal notranslate"><span class="pre">pytest_make_parametrize_id()</span></code> hook to accept <code class="docutils literal notranslate"><span class="pre">argname</span></code> as an
additional parameter.
Thanks <a class="reference external" href="https://github.com/sponsors/unsignedint">&#64;unsignedint</a> for the PR.</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">venv</span></code> to the default <code class="docutils literal notranslate"><span class="pre">norecursedirs</span></code> setting.
Thanks <a class="reference external" href="https://github.com/sponsors/The-Compiler">&#64;The-Compiler</a> for the PR.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PluginManager.import_plugin</span></code> now accepts unicode plugin names in Python 2.
Thanks <a class="reference external" href="https://github.com/sponsors/reutsharabani">&#64;reutsharabani</a> for the PR.</p></li>
<li><p>fix <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2308">#2308</a>: When using both <code class="docutils literal notranslate"><span class="pre">--lf</span></code> and <code class="docutils literal notranslate"><span class="pre">--ff</span></code>, only the last failed tests are run.
Thanks <a class="reference external" href="https://github.com/sponsors/ojii">&#64;ojii</a> for the PR.</p></li>
<li><p>Replace minor/patch level version numbers in the documentation with placeholders.
This significantly reduces change-noise as different contributors regenerate
the documentation on different platforms.
Thanks <a class="reference external" href="https://github.com/sponsors/RonnyPfannschmidt">&#64;RonnyPfannschmidt</a> for the PR.</p></li>
<li><p>fix <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2391">#2391</a>: consider pytest_plugins on all plugin modules
Thanks <a class="reference external" href="https://github.com/sponsors/RonnyPfannschmidt">&#64;RonnyPfannschmidt</a> for the PR.</p></li>
</ul>
</section>
<section id="id729">
<h3>Bug Fixes<a class="headerlink" href="#id729" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Fix <code class="docutils literal notranslate"><span class="pre">AttributeError</span></code> on <code class="docutils literal notranslate"><span class="pre">sys.stdout.buffer</span></code> / <code class="docutils literal notranslate"><span class="pre">sys.stderr.buffer</span></code>
while using <code class="docutils literal notranslate"><span class="pre">capsys</span></code> fixture in python 3. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1407">#1407</a>).
Thanks to <a class="reference external" href="https://github.com/sponsors/asottile">&#64;asottile</a>.</p></li>
<li><p>Change capture.py’s <code class="docutils literal notranslate"><span class="pre">DontReadFromInput</span></code> class to throw <code class="docutils literal notranslate"><span class="pre">io.UnsupportedOperation</span></code> errors rather
than ValueErrors in the <code class="docutils literal notranslate"><span class="pre">fileno</span></code> method (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2276">#2276</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/metasyn">&#64;metasyn</a> and <a class="reference external" href="https://github.com/sponsors/vlad-dragos">&#64;vlad-dragos</a> for the PR.</p></li>
<li><p>Fix exception formatting while importing modules when the exception message
contains non-ascii characters (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2336">#2336</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/fabioz">&#64;fabioz</a> for the report and <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>Added documentation related to issue (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1937">#1937</a>)
Thanks <a class="reference external" href="https://github.com/sponsors/skylarjhdownes">&#64;skylarjhdownes</a> for the PR.</p></li>
<li><p>Allow collecting files with any file extension as Python modules (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2369">#2369</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/Kodiologist">&#64;Kodiologist</a> for the PR.</p></li>
<li><p>Show the correct error message when collect “parametrize” func with wrong args (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2383">#2383</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/The-Compiler">&#64;The-Compiler</a> for the report and <a class="reference external" href="https://github.com/sponsors/robin0371">&#64;robin0371</a> for the PR.</p></li>
</ul>
</section>
</section>
<section id="id730">
<h2>3.0.7 (2017-03-14)<a class="headerlink" href="#id730" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Fix issue in assertion rewriting breaking due to modules silently discarding
other modules when importing fails
Notably, importing the <code class="docutils literal notranslate"><span class="pre">anydbm</span></code> module is fixed. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2248">#2248</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/pfhayes">&#64;pfhayes</a> for the PR.</p></li>
<li><p>junitxml: Fix problematic case where system-out tag occurred twice per testcase
element in the XML report. Thanks <a class="reference external" href="https://github.com/sponsors/kkoukiou">&#64;kkoukiou</a> for the PR.</p></li>
<li><p>Fix regression, pytest now skips unittest correctly if run with <code class="docutils literal notranslate"><span class="pre">--pdb</span></code>
(<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2137">#2137</a>). Thanks to <a class="reference external" href="https://github.com/sponsors/gst">&#64;gst</a> for the report and <a class="reference external" href="https://github.com/sponsors/mbyt">&#64;mbyt</a> for the PR.</p></li>
<li><p>Ignore exceptions raised from descriptors (e.g. properties) during Python test collection (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2234">#2234</a>).
Thanks to <a class="reference external" href="https://github.com/sponsors/bluetech">&#64;bluetech</a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--override-ini</span></code> now correctly overrides some fundamental options like <code class="docutils literal notranslate"><span class="pre">python_files</span></code> (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2238">#2238</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/sirex">&#64;sirex</a> for the report and <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>Replace <code class="docutils literal notranslate"><span class="pre">raise</span> <span class="pre">StopIteration</span></code> usages in the code by simple <code class="docutils literal notranslate"><span class="pre">returns</span></code> to finish generators, in accordance to <span class="target" id="index-11"></span><a class="pep reference external" href="https://peps.python.org/pep-0479/"><strong>PEP 479</strong></a> (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2160">#2160</a>).
Thanks to <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>Fix internal errors when an unprintable <code class="docutils literal notranslate"><span class="pre">AssertionError</span></code> is raised inside a test.
Thanks <a class="reference external" href="https://github.com/sponsors/omerhadari">&#64;omerhadari</a> for the PR.</p></li>
<li><p>Skipping plugin now also works with test items generated by custom collectors (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2231">#2231</a>).
Thanks to <a class="reference external" href="https://github.com/sponsors/vidartf">&#64;vidartf</a>.</p></li>
<li><p>Fix trailing whitespace in console output if no .ini file presented (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2281">#2281</a>). Thanks <a class="reference external" href="https://github.com/sponsors/fbjorn">&#64;fbjorn</a> for the PR.</p></li>
<li><p>Conditionless <code class="docutils literal notranslate"><span class="pre">xfail</span></code> markers no longer rely on the underlying test item
being an instance of <code class="docutils literal notranslate"><span class="pre">PyobjMixin</span></code>, and can therefore apply to tests not
collected by the built-in python test collector. Thanks <a class="reference external" href="https://github.com/sponsors/barneygale">&#64;barneygale</a> for the
PR.</p></li>
</ul>
</section>
<section id="id731">
<h2>3.0.6 (2017-01-22)<a class="headerlink" href="#id731" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>pytest no longer generates <code class="docutils literal notranslate"><span class="pre">PendingDeprecationWarning</span></code> from its own operations, which was introduced by mistake in version <code class="docutils literal notranslate"><span class="pre">3.0.5</span></code> (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2118">#2118</a>).
Thanks to <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the report and <a class="reference external" href="https://github.com/sponsors/RonnyPfannschmidt">&#64;RonnyPfannschmidt</a> for the PR.</p></li>
<li><p>pytest no longer recognizes coroutine functions as yield tests (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2129">#2129</a>).
Thanks to <a class="reference external" href="https://github.com/sponsors/malinoff">&#64;malinoff</a> for the PR.</p></li>
<li><p>Plugins loaded by the <code class="docutils literal notranslate"><span class="pre">PYTEST_PLUGINS</span></code> environment variable are now automatically
considered for assertion rewriting (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2185">#2185</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>Improve error message when pytest.warns fails (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2150">#2150</a>). The type(s) of the
expected warnings and the list of caught warnings is added to the
error message. Thanks <a class="reference external" href="https://github.com/sponsors/lesteve">&#64;lesteve</a> for the PR.</p></li>
<li><p>Fix <code class="docutils literal notranslate"><span class="pre">pytester</span></code> internal plugin to work correctly with latest versions of
<code class="docutils literal notranslate"><span class="pre">zope.interface</span></code> (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1989">#1989</a>). Thanks <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>Assert statements of the <code class="docutils literal notranslate"><span class="pre">pytester</span></code> plugin again benefit from assertion rewriting (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1920">#1920</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/RonnyPfannschmidt">&#64;RonnyPfannschmidt</a> for the report and <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>Specifying tests with colons like <code class="docutils literal notranslate"><span class="pre">test_foo.py::test_bar</span></code> for tests in
subdirectories with ini configuration files now uses the correct ini file
(<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2148">#2148</a>).  Thanks <a class="reference external" href="https://github.com/sponsors/pelme">&#64;pelme</a>.</p></li>
<li><p>Fail <code class="docutils literal notranslate"><span class="pre">testdir.runpytest().assert_outcomes()</span></code> explicitly if the pytest
terminal output it relies on is missing. Thanks to <a class="reference external" href="https://github.com/sponsors/eli-b">&#64;eli-b</a> for the PR.</p></li>
</ul>
</section>
<section id="id732">
<h2>3.0.5 (2016-12-05)<a class="headerlink" href="#id732" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Add warning when not passing <code class="docutils literal notranslate"><span class="pre">option=value</span></code> correctly to <code class="docutils literal notranslate"><span class="pre">-o/--override-ini</span></code> (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2105">#2105</a>).
Also improved the help documentation. Thanks to <a class="reference external" href="https://github.com/sponsors/mbukatov">&#64;mbukatov</a> for the report and
<a class="reference external" href="https://github.com/sponsors/lwm">&#64;lwm</a> for the PR.</p></li>
<li><p>Now <code class="docutils literal notranslate"><span class="pre">--confcutdir</span></code> and <code class="docutils literal notranslate"><span class="pre">--junit-xml</span></code> are properly validated if they are directories
and filenames, respectively (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2089">#2089</a> and <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2078">#2078</a>). Thanks to <a class="reference external" href="https://github.com/sponsors/lwm">&#64;lwm</a> for the PR.</p></li>
<li><p>Add hint to error message hinting possible missing <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/478">#478</a>). Thanks <a class="reference external" href="https://github.com/sponsors/DuncanBetts">&#64;DuncanBetts</a>.</p></li>
<li><p>More accurately describe when fixture finalization occurs in documentation (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/687">#687</a>). Thanks <a class="reference external" href="https://github.com/sponsors/DuncanBetts">&#64;DuncanBetts</a>.</p></li>
<li><p>Provide <code class="docutils literal notranslate"><span class="pre">:ref:</span></code> targets for <code class="docutils literal notranslate"><span class="pre">recwarn.rst</span></code> so we can use intersphinx referencing.
Thanks to <a class="reference external" href="https://github.com/sponsors/dupuy">&#64;dupuy</a> for the report and <a class="reference external" href="https://github.com/sponsors/lwm">&#64;lwm</a> for the PR.</p></li>
<li><p>In Python 2, use a simple <code class="docutils literal notranslate"><span class="pre">+-</span></code> ASCII string in the string representation of <code class="docutils literal notranslate"><span class="pre">pytest.approx</span></code> (for example <code class="docutils literal notranslate"><span class="pre">&quot;4</span> <span class="pre">+-</span> <span class="pre">4.0e-06&quot;</span></code>)
because it is brittle to handle that in different contexts and representations internally in pytest
which can result in bugs such as <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2111">#2111</a>. In Python 3, the representation still uses <code class="docutils literal notranslate"><span class="pre">±</span></code> (for example <code class="docutils literal notranslate"><span class="pre">4</span> <span class="pre">±</span> <span class="pre">4.0e-06</span></code>).
Thanks <a class="reference external" href="https://github.com/sponsors/kerrick-lyft">&#64;kerrick-lyft</a> for the report and <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>Using <code class="docutils literal notranslate"><span class="pre">item.Function</span></code>, <code class="docutils literal notranslate"><span class="pre">item.Module</span></code>, etc., is now issuing deprecation warnings, prefer
<code class="docutils literal notranslate"><span class="pre">pytest.Function</span></code>, <code class="docutils literal notranslate"><span class="pre">pytest.Module</span></code>, etc., instead (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2034">#2034</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/nmundar">&#64;nmundar</a> for the PR.</p></li>
<li><p>Fix error message using <code class="docutils literal notranslate"><span class="pre">approx</span></code> with complex numbers (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2082">#2082</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/adler-j">&#64;adler-j</a> for the report and <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>Fixed false-positives warnings from assertion rewrite hook for modules imported more than
once by the <code class="docutils literal notranslate"><span class="pre">pytest_plugins</span></code> mechanism.
Thanks <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>Remove an internal cache which could cause hooks from <code class="docutils literal notranslate"><span class="pre">conftest.py</span></code> files in
sub-directories to be called in other directories incorrectly (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2016">#2016</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/d-b-w">&#64;d-b-w</a> for the report and <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>Remove internal code meant to support earlier Python 3 versions that produced the side effect
of leaving <code class="docutils literal notranslate"><span class="pre">None</span></code> in <code class="docutils literal notranslate"><span class="pre">sys.modules</span></code> when expressions were evaluated by pytest (for example passing a condition
as a string to <code class="docutils literal notranslate"><span class="pre">pytest.mark.skipif</span></code>)(<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2103">#2103</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/jaraco">&#64;jaraco</a> for the report and <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>Cope gracefully with a .pyc file with no matching .py file (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2038">#2038</a>). Thanks
<a class="reference external" href="https://github.com/sponsors/nedbat">&#64;nedbat</a>.</p></li>
</ul>
</section>
<section id="id733">
<h2>3.0.4 (2016-11-09)<a class="headerlink" href="#id733" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Import errors when collecting test modules now display the full traceback (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1976">#1976</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/cwitty">&#64;cwitty</a> for the report and <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>Fix confusing command-line help message for custom options with two or more <code class="docutils literal notranslate"><span class="pre">metavar</span></code> properties (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2004">#2004</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/okulynyak">&#64;okulynyak</a> and <a class="reference external" href="https://github.com/sponsors/davehunt">&#64;davehunt</a> for the report and <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>When loading plugins, import errors which contain non-ascii messages are now properly handled in Python 2 (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1998">#1998</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>Fixed cyclic reference when <code class="docutils literal notranslate"><span class="pre">pytest.raises</span></code> is used in context-manager form (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1965">#1965</a>). Also as a
result of this fix, <code class="docutils literal notranslate"><span class="pre">sys.exc_info()</span></code> is left empty in both context-manager and function call usages.
Previously, <code class="docutils literal notranslate"><span class="pre">sys.exc_info</span></code> would contain the exception caught by the context manager,
even when the expected exception occurred.
Thanks <a class="reference external" href="https://github.com/sponsors/MSeifert04">&#64;MSeifert04</a> for the report and the PR.</p></li>
<li><p>Fixed false-positives warnings from assertion rewrite hook for modules that were rewritten but
were later marked explicitly by <code class="docutils literal notranslate"><span class="pre">pytest.register_assert_rewrite</span></code>
or implicitly as a plugin (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/2005">#2005</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/RonnyPfannschmidt">&#64;RonnyPfannschmidt</a> for the report and <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>Report teardown output on test failure (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/442">#442</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/matclab">&#64;matclab</a> for the PR.</p></li>
<li><p>Fix teardown error message in generated xUnit XML.
Thanks <a class="reference external" href="https://github.com/sponsors/gdyuldin">&#64;gdyuldin</a> for the PR.</p></li>
<li><p>Properly handle exceptions in <code class="docutils literal notranslate"><span class="pre">multiprocessing</span></code> tasks (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1984">#1984</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/adborden">&#64;adborden</a> for the report and <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>Clean up unittest TestCase objects after tests are complete (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1649">#1649</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/d-b-w">&#64;d-b-w</a> for the report and PR.</p></li>
</ul>
</section>
<section id="id734">
<h2>3.0.3 (2016-09-28)<a class="headerlink" href="#id734" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">ids</span></code> argument to <code class="docutils literal notranslate"><span class="pre">parametrize</span></code> again accepts <code class="docutils literal notranslate"><span class="pre">unicode</span></code> strings
in Python 2 (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1905">#1905</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/philpep">&#64;philpep</a> for the report and <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>Assertions are now being rewritten for plugins in development mode
(<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-e</span></code>) (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1934">#1934</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>Fix pkg_resources import error in Jython projects (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1853">#1853</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/raquelalegre">&#64;raquelalegre</a> for the PR.</p></li>
<li><p>Got rid of <code class="docutils literal notranslate"><span class="pre">AttributeError:</span> <span class="pre">'Module'</span> <span class="pre">object</span> <span class="pre">has</span> <span class="pre">no</span> <span class="pre">attribute</span> <span class="pre">'_obj'</span></code> exception
in Python 3 (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1944">#1944</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/axil">&#64;axil</a> for the PR.</p></li>
<li><p>Explain a bad scope value passed to <code class="docutils literal notranslate"><span class="pre">&#64;fixture</span></code> declarations or
a <code class="docutils literal notranslate"><span class="pre">MetaFunc.parametrize()</span></code> call.</p></li>
<li><p>This version includes <code class="docutils literal notranslate"><span class="pre">pluggy-0.4.0</span></code>, which correctly handles
<code class="docutils literal notranslate"><span class="pre">VersionConflict</span></code> errors in plugins (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/704">#704</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
</ul>
</section>
<section id="id735">
<h2>3.0.2 (2016-09-01)<a class="headerlink" href="#id735" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Improve error message when passing non-string ids to <code class="docutils literal notranslate"><span class="pre">pytest.mark.parametrize</span></code> (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1857">#1857</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/okken">&#64;okken</a> for the report and <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">buffer</span></code> attribute to stdin stub class <code class="docutils literal notranslate"><span class="pre">pytest.capture.DontReadFromInput</span></code>
Thanks <a class="reference external" href="https://github.com/sponsors/joguSD">&#64;joguSD</a> for the PR.</p></li>
<li><p>Fix <code class="docutils literal notranslate"><span class="pre">UnicodeEncodeError</span></code> when string comparison with unicode has failed. (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1864">#1864</a>)
Thanks <a class="reference external" href="https://github.com/sponsors/AiOO">&#64;AiOO</a> for the PR.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest_plugins</span></code> is now handled correctly if defined as a string (as opposed as
a sequence of strings) when modules are considered for assertion rewriting.
Due to this bug, much more modules were being rewritten than necessary
if a test suite uses <code class="docutils literal notranslate"><span class="pre">pytest_plugins</span></code> to load internal plugins (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1888">#1888</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/jaraco">&#64;jaraco</a> for the report and <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1891">#1891</a>).</p></li>
<li><p>Do not call tearDown and cleanups when running tests from
<code class="docutils literal notranslate"><span class="pre">unittest.TestCase</span></code> subclasses with <code class="docutils literal notranslate"><span class="pre">--pdb</span></code>
enabled. This allows proper post mortem debugging for all applications
which have significant logic in their tearDown machinery (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1890">#1890</a>). Thanks
<a class="reference external" href="https://github.com/sponsors/mbyt">&#64;mbyt</a> for the PR.</p></li>
<li><p>Fix use of deprecated <code class="docutils literal notranslate"><span class="pre">getfuncargvalue</span></code> method in the internal doctest plugin.
Thanks <a class="reference external" href="https://github.com/sponsors/ViviCoder">&#64;ViviCoder</a> for the report (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1898">#1898</a>).</p></li>
</ul>
</section>
<section id="id736">
<h2>3.0.1 (2016-08-23)<a class="headerlink" href="#id736" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Fix regression when <code class="docutils literal notranslate"><span class="pre">importorskip</span></code> is used at module level (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1822">#1822</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/jaraco">&#64;jaraco</a> and <a class="reference external" href="https://github.com/sponsors/The-Compiler">&#64;The-Compiler</a> for the report and <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>Fix parametrization scope when session fixtures are used in conjunction
with normal parameters in the same call (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1832">#1832</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/The-Compiler">&#64;The-Compiler</a> for the report, <a class="reference external" href="https://github.com/sponsors/Kingdread">&#64;Kingdread</a> and <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>Fix internal error when parametrizing tests or fixtures using an empty <code class="docutils literal notranslate"><span class="pre">ids</span></code> argument (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1849">#1849</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/OPpuolitaival">&#64;OPpuolitaival</a> for the report and <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>Fix loader error when running <code class="docutils literal notranslate"><span class="pre">pytest</span></code> embedded in a zipfile.
Thanks <a class="reference external" href="https://github.com/sponsors/mbachry">&#64;mbachry</a> for the PR.</p></li>
</ul>
</section>
<section id="release-3-0-0">
<span id="id737"></span><h2>3.0.0 (2016-08-18)<a class="headerlink" href="#release-3-0-0" title="Link to this heading">¶</a></h2>
<p><strong>Incompatible changes</strong></p>
<p>A number of incompatible changes were made in this release, with the intent of removing features deprecated for a long
time or change existing behaviors in order to make them less surprising/more useful.</p>
<ul>
<li><p>Reinterpretation mode has now been removed.  Only plain and rewrite
mode are available, consequently the <code class="docutils literal notranslate"><span class="pre">--assert=reinterp</span></code> option is
no longer available.  This also means files imported from plugins or
<code class="docutils literal notranslate"><span class="pre">conftest.py</span></code> will not benefit from improved assertions by
default, you should use <code class="docutils literal notranslate"><span class="pre">pytest.register_assert_rewrite()</span></code> to
explicitly turn on assertion rewriting for those files.  Thanks
<a class="reference external" href="https://github.com/sponsors/flub">&#64;flub</a> for the PR.</p></li>
<li><p>The following deprecated commandline options were removed:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--genscript</span></code>: no longer supported;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--no-assert</span></code>: use <code class="docutils literal notranslate"><span class="pre">--assert=plain</span></code> instead;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--nomagic</span></code>: use <code class="docutils literal notranslate"><span class="pre">--assert=plain</span></code> instead;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--report</span></code>: use <code class="docutils literal notranslate"><span class="pre">-r</span></code> instead;</p></li>
</ul>
<p>Thanks to <a class="reference external" href="https://github.com/sponsors/RedBeardCode">&#64;RedBeardCode</a> for the PR (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1664">#1664</a>).</p>
</li>
<li><p>ImportErrors in plugins now are a fatal error instead of issuing a
pytest warning (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1479">#1479</a>). Thanks to <a class="reference external" href="https://github.com/sponsors/The-Compiler">&#64;The-Compiler</a> for the PR.</p></li>
<li><p>Removed support code for Python 3 versions &lt; 3.3 (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1627">#1627</a>).</p></li>
<li><p>Removed all <code class="docutils literal notranslate"><span class="pre">py.test-X*</span></code> entry points. The versioned, suffixed entry points
were never documented and a leftover from a pre-virtualenv era. These entry
points also created broken entry points in wheels, so removing them also
removes a source of confusion for users (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1632">#1632</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/obestwalter">&#64;obestwalter</a> for the PR.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.skip()</span></code> now raises an error when used to decorate a test function,
as opposed to its original intent (to imperatively skip a test inside a test function). Previously
this usage would cause the entire module to be skipped (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/607">#607</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/omarkohl">&#64;omarkohl</a> for the complete PR (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1519">#1519</a>).</p></li>
<li><p>Exit tests if a collection error occurs. A poll indicated most users will hit CTRL-C
anyway as soon as they see collection errors, so pytest might as well make that the default behavior (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1421">#1421</a>).
A <code class="docutils literal notranslate"><span class="pre">--continue-on-collection-errors</span></code> option has been added to restore the previous behaviour.
Thanks <a class="reference external" href="https://github.com/sponsors/olegpidsadnyi">&#64;olegpidsadnyi</a> and <a class="reference external" href="https://github.com/sponsors/omarkohl">&#64;omarkohl</a> for the complete PR (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1628">#1628</a>).</p></li>
<li><p>Renamed the pytest <code class="docutils literal notranslate"><span class="pre">pdb</span></code> module (plugin) into <code class="docutils literal notranslate"><span class="pre">debugging</span></code> to avoid clashes with the builtin <code class="docutils literal notranslate"><span class="pre">pdb</span></code> module.</p></li>
<li><p>Raise a helpful failure message when requesting a parametrized fixture at runtime,
e.g. with <code class="docutils literal notranslate"><span class="pre">request.getfixturevalue</span></code>. Previously these parameters were simply
never defined, so a fixture decorated like <code class="docutils literal notranslate"><span class="pre">&#64;pytest.fixture(params=[0,</span> <span class="pre">1,</span> <span class="pre">2])</span></code>
only ran once (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/460">#460</a>).
Thanks to <a class="reference external" href="https://github.com/sponsors/nikratio">&#64;nikratio</a> for the bug report, <a class="reference external" href="https://github.com/sponsors/RedBeardCode">&#64;RedBeardCode</a> and <a class="reference external" href="https://github.com/sponsors/tomviner">&#64;tomviner</a> for the PR.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_pytest.monkeypatch.monkeypatch</span></code> class has been renamed to <code class="docutils literal notranslate"><span class="pre">_pytest.monkeypatch.MonkeyPatch</span></code>
so it doesn’t conflict with the <code class="docutils literal notranslate"><span class="pre">monkeypatch</span></code> fixture.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--exitfirst</span> <span class="pre">/</span> <span class="pre">-x</span></code> can now be overridden by a following <code class="docutils literal notranslate"><span class="pre">--maxfail=N</span></code>
and is just a synonym for <code class="docutils literal notranslate"><span class="pre">--maxfail=1</span></code>.</p></li>
</ul>
<p><strong>New Features</strong></p>
<ul>
<li><p>Support nose-style <code class="docutils literal notranslate"><span class="pre">__test__</span></code> attribute on methods of classes,
including unittest-style Classes. If set to <code class="docutils literal notranslate"><span class="pre">False</span></code>, the test will not be
collected.</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">doctest_namespace</span></code> fixture for injecting names into the
namespace in which doctests run.
Thanks <a class="reference external" href="https://github.com/sponsors/milliams">&#64;milliams</a> for the complete PR (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1428">#1428</a>).</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">--doctest-report</span></code> option available to change the output format of diffs
when running (failing) doctests (implements <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1749">#1749</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/hartym">&#64;hartym</a> for the PR.</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">name</span></code> argument to <code class="docutils literal notranslate"><span class="pre">pytest.fixture</span></code> decorator which allows a custom name
for a fixture (to solve the funcarg-shadowing-fixture problem).
Thanks <a class="reference external" href="https://github.com/sponsors/novas0x2a">&#64;novas0x2a</a> for the complete PR (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1444">#1444</a>).</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">approx()</span></code> function for easily comparing floating-point numbers in
tests.
Thanks <a class="reference external" href="https://github.com/sponsors/kalekundert">&#64;kalekundert</a> for the complete PR (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1441">#1441</a>).</p></li>
<li><p>Ability to add global properties in the final xunit output file by accessing
the internal <code class="docutils literal notranslate"><span class="pre">junitxml</span></code> plugin (experimental).
Thanks <a class="reference external" href="https://github.com/sponsors/tareqalayan">&#64;tareqalayan</a> for the complete PR <a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1454">#1454</a>).</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">ExceptionInfo.match()</span></code> method to match a regular expression on the
string representation of an exception (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/372">#372</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/omarkohl">&#64;omarkohl</a> for the complete PR (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1502">#1502</a>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">__tracebackhide__</span></code> can now also be set to a callable which then can decide
whether to filter the traceback based on the <code class="docutils literal notranslate"><span class="pre">ExceptionInfo</span></code> object passed
to it. Thanks <a class="reference external" href="https://github.com/sponsors/The-Compiler">&#64;The-Compiler</a> for the complete PR (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1526">#1526</a>).</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">pytest_make_parametrize_id(config,</span> <span class="pre">val)</span></code> hook which can be used by plugins to provide
friendly strings for custom types.
Thanks <a class="reference external" href="https://github.com/sponsors/palaviv">&#64;palaviv</a> for the PR.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">capsys</span></code> and <code class="docutils literal notranslate"><span class="pre">capfd</span></code> now have a <code class="docutils literal notranslate"><span class="pre">disabled()</span></code> context-manager method, which
can be used to temporarily disable capture within a test.
Thanks <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>New cli flag <code class="docutils literal notranslate"><span class="pre">--fixtures-per-test</span></code>: shows which fixtures are being used
for each selected test item. Features doc strings of fixtures by default.
Can also show where fixtures are defined if combined with <code class="docutils literal notranslate"><span class="pre">-v</span></code>.
Thanks <a class="reference external" href="https://github.com/sponsors/hackebrot">&#64;hackebrot</a> for the PR.</p></li>
<li><p>Introduce <code class="docutils literal notranslate"><span class="pre">pytest</span></code> command as recommended entry point. Note that <code class="docutils literal notranslate"><span class="pre">py.test</span></code>
still works and is not scheduled for removal. Closes proposal
<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1629">#1629</a>. Thanks <a class="reference external" href="https://github.com/sponsors/obestwalter">&#64;obestwalter</a> and <a class="reference external" href="https://github.com/sponsors/davehunt">&#64;davehunt</a> for the complete PR
(<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1633">#1633</a>).</p></li>
<li><p>New cli flags:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--setup-plan</span></code>: performs normal collection and reports
the potential setup and teardown and does not execute any fixtures and tests;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--setup-only</span></code>: performs normal collection, executes setup and teardown of
fixtures and reports them;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--setup-show</span></code>: performs normal test execution and additionally shows
setup and teardown of fixtures;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--keep-duplicates</span></code>: py.test now ignores duplicated paths given in the command
line. To retain the previous behavior where the same test could be run multiple
times by specifying it in the command-line multiple times, pass the <code class="docutils literal notranslate"><span class="pre">--keep-duplicates</span></code>
argument (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1609">#1609</a>);</p></li>
</ul>
<p>Thanks <a class="reference external" href="https://github.com/sponsors/d6e">&#64;d6e</a>, <a class="reference external" href="https://github.com/sponsors/kvas-it">&#64;kvas-it</a>, <a class="reference external" href="https://github.com/sponsors/sallner">&#64;sallner</a>, <a class="reference external" href="https://github.com/sponsors/ioggstream">&#64;ioggstream</a> and <a class="reference external" href="https://github.com/sponsors/omarkohl">&#64;omarkohl</a> for the PRs.</p>
</li>
<li><p>New CLI flag <code class="docutils literal notranslate"><span class="pre">--override-ini</span></code>/<code class="docutils literal notranslate"><span class="pre">-o</span></code>: overrides values from the ini file.
For example: <code class="docutils literal notranslate"><span class="pre">&quot;-o</span> <span class="pre">xfail_strict=True&quot;</span></code>’.
Thanks <a class="reference external" href="https://github.com/sponsors/blueyed">&#64;blueyed</a> and <a class="reference external" href="https://github.com/sponsors/fengxx">&#64;fengxx</a> for the PR.</p></li>
<li><p>New hooks:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pytest_fixture_setup(fixturedef,</span> <span class="pre">request)</span></code>: executes fixture setup;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest_fixture_post_finalizer(fixturedef)</span></code>: called after the fixture’s
finalizer and has access to the fixture’s result cache.</p></li>
</ul>
<p>Thanks <a class="reference external" href="https://github.com/sponsors/d6e">&#64;d6e</a>, <a class="reference external" href="https://github.com/sponsors/sallner">&#64;sallner</a>.</p>
</li>
<li><p>Issue warnings for asserts whose test is a tuple literal. Such asserts will
never fail because tuples are always truthy and are usually a mistake
(see <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1562">#1562</a>). Thanks <a class="reference external" href="https://github.com/sponsors/kvas-it">&#64;kvas-it</a>, for the PR.</p></li>
<li><p>Allow passing a custom debugger class (e.g. <code class="docutils literal notranslate"><span class="pre">--pdbcls=IPython.core.debugger:Pdb</span></code>).
Thanks to <a class="reference external" href="https://github.com/sponsors/anntzer">&#64;anntzer</a> for the PR.</p></li>
</ul>
<p><strong>Changes</strong></p>
<ul class="simple">
<li><p>Plugins now benefit from assertion rewriting.  Thanks
<a class="reference external" href="https://github.com/sponsors/sober7">&#64;sober7</a>, <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> and <a class="reference external" href="https://github.com/sponsors/flub">&#64;flub</a> for the PR.</p></li>
<li><p>Change <code class="docutils literal notranslate"><span class="pre">report.outcome</span></code> for <code class="docutils literal notranslate"><span class="pre">xpassed</span></code> tests to <code class="docutils literal notranslate"><span class="pre">&quot;passed&quot;</span></code> in non-strict
mode and <code class="docutils literal notranslate"><span class="pre">&quot;failed&quot;</span></code> in strict mode. Thanks to <a class="reference external" href="https://github.com/sponsors/hackebrot">&#64;hackebrot</a> for the PR
(<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1795">#1795</a>) and <a class="reference external" href="https://github.com/sponsors/gprasad84">&#64;gprasad84</a> for report (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1546">#1546</a>).</p></li>
<li><p>Tests marked with <code class="docutils literal notranslate"><span class="pre">xfail(strict=False)</span></code> (the default) now appear in
JUnitXML reports as passing tests instead of skipped.
Thanks to <a class="reference external" href="https://github.com/sponsors/hackebrot">&#64;hackebrot</a> for the PR (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1795">#1795</a>).</p></li>
<li><p>Highlight path of the file location in the error report to make it easier to copy/paste.
Thanks <a class="reference external" href="https://github.com/sponsors/suzaku">&#64;suzaku</a> for the PR (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1778">#1778</a>).</p></li>
<li><p>Fixtures marked with <code class="docutils literal notranslate"><span class="pre">&#64;pytest.fixture</span></code> can now use <code class="docutils literal notranslate"><span class="pre">yield</span></code> statements exactly like
those marked with the <code class="docutils literal notranslate"><span class="pre">&#64;pytest.yield_fixture</span></code> decorator. This change renders
<code class="docutils literal notranslate"><span class="pre">&#64;pytest.yield_fixture</span></code> deprecated and makes <code class="docutils literal notranslate"><span class="pre">&#64;pytest.fixture</span></code> with <code class="docutils literal notranslate"><span class="pre">yield</span></code> statements
the preferred way to write teardown code (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1461">#1461</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/csaftoiu">&#64;csaftoiu</a> for bringing this to attention and <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>Explicitly passed parametrize ids do not get escaped to ascii (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1351">#1351</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/ceridwen">&#64;ceridwen</a> for the PR.</p></li>
<li><p>Fixtures are now sorted in the error message displayed when an unknown
fixture is declared in a test function.
Thanks <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest_terminal_summary</span></code> hook now receives the <code class="docutils literal notranslate"><span class="pre">exitstatus</span></code>
of the test session as argument. Thanks <a class="reference external" href="https://github.com/sponsors/blueyed">&#64;blueyed</a> for the PR (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1809">#1809</a>).</p></li>
<li><p>Parametrize ids can accept <code class="docutils literal notranslate"><span class="pre">None</span></code> as specific test id, in which case the
automatically generated id for that argument will be used.
Thanks <a class="reference external" href="https://github.com/sponsors/palaviv">&#64;palaviv</a> for the complete PR (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1468">#1468</a>).</p></li>
<li><p>The parameter to xunit-style setup/teardown methods (<code class="docutils literal notranslate"><span class="pre">setup_method</span></code>,
<code class="docutils literal notranslate"><span class="pre">setup_module</span></code>, etc.) is now optional and may be omitted.
Thanks <a class="reference external" href="https://github.com/sponsors/okken">&#64;okken</a> for bringing this to attention and <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>Improved automatic id generation selection in case of duplicate ids in
parametrize.
Thanks <a class="reference external" href="https://github.com/sponsors/palaviv">&#64;palaviv</a> for the complete PR (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1474">#1474</a>).</p></li>
<li><p>Now pytest warnings summary is shown up by default. Added a new flag
<code class="docutils literal notranslate"><span class="pre">--disable-pytest-warnings</span></code> to explicitly disable the warnings summary (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1668">#1668</a>).</p></li>
<li><p>Make ImportError during collection more explicit by reminding
the user to check the name of the test module/package(s) (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1426">#1426</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/omarkohl">&#64;omarkohl</a> for the complete PR (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1520">#1520</a>).</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">build/</span></code> and <code class="docutils literal notranslate"><span class="pre">dist/</span></code> to the default <code class="docutils literal notranslate"><span class="pre">--norecursedirs</span></code> list. Thanks
<a class="reference external" href="https://github.com/sponsors/mikofski">&#64;mikofski</a> for the report and <a class="reference external" href="https://github.com/sponsors/tomviner">&#64;tomviner</a> for the PR (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1544">#1544</a>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.raises</span></code> in the context manager form accepts a custom
<code class="docutils literal notranslate"><span class="pre">message</span></code> to raise when no exception occurred.
Thanks <a class="reference external" href="https://github.com/sponsors/palaviv">&#64;palaviv</a> for the complete PR (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1616">#1616</a>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">conftest.py</span></code> files now benefit from assertion rewriting; previously it
was only available for test modules. Thanks <a class="reference external" href="https://github.com/sponsors/flub">&#64;flub</a>, <a class="reference external" href="https://github.com/sponsors/sober7">&#64;sober7</a> and
<a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1619">#1619</a>).</p></li>
<li><p>Text documents without any doctests no longer appear as “skipped”.
Thanks <a class="reference external" href="https://github.com/sponsors/graingert">&#64;graingert</a> for reporting and providing a full PR (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1580">#1580</a>).</p></li>
<li><p>Ensure that a module within a namespace package can be found when it
is specified on the command line together with the <code class="docutils literal notranslate"><span class="pre">--pyargs</span></code>
option.  Thanks to <a class="reference external" href="https://github.com/sponsors/taschini">&#64;taschini</a> for the PR (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1597">#1597</a>).</p></li>
<li><p>Always include full assertion explanation during assertion rewriting. The previous behaviour was hiding
sub-expressions that happened to be <code class="docutils literal notranslate"><span class="pre">False</span></code>, assuming this was redundant information.
Thanks <a class="reference external" href="https://github.com/sponsors/bagerard">&#64;bagerard</a> for reporting (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1503">#1503</a>). Thanks to <a class="reference external" href="https://github.com/sponsors/davehunt">&#64;davehunt</a> and
<a class="reference external" href="https://github.com/sponsors/tomviner">&#64;tomviner</a> for the PR.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">OptionGroup.addoption()</span></code> now checks if option names were already
added before, to make it easier to track down issues like <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1618">#1618</a>.
Before, you only got exceptions later from <code class="docutils literal notranslate"><span class="pre">argparse</span></code> library,
giving no clue about the actual reason for double-added options.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">yield</span></code>-based tests are considered deprecated and will be removed in pytest-4.0.
Thanks <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[pytest]</span></code> sections in <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code> files should now be named <code class="docutils literal notranslate"><span class="pre">[tool:pytest]</span></code>
to avoid conflicts with other distutils commands (see <a class="reference external" href="https://github.com/pytest-dev/pytest/pull/567">#567</a>). <code class="docutils literal notranslate"><span class="pre">[pytest]</span></code> sections in
<code class="docutils literal notranslate"><span class="pre">pytest.ini</span></code> or <code class="docutils literal notranslate"><span class="pre">tox.ini</span></code> files are supported and unchanged.
Thanks <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>Using <code class="docutils literal notranslate"><span class="pre">pytest_funcarg__</span></code> prefix to declare fixtures is considered deprecated and will be
removed in pytest-4.0 (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1684">#1684</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>Passing a command-line string to <code class="docutils literal notranslate"><span class="pre">pytest.main()</span></code> is considered deprecated and scheduled
for removal in pytest-4.0. It is recommended to pass a list of arguments instead (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1723">#1723</a>).</p></li>
<li><p>Rename <code class="docutils literal notranslate"><span class="pre">getfuncargvalue</span></code> to <code class="docutils literal notranslate"><span class="pre">getfixturevalue</span></code>. <code class="docutils literal notranslate"><span class="pre">getfuncargvalue</span></code> is
still present but is now considered deprecated. Thanks to <a class="reference external" href="https://github.com/sponsors/RedBeardCode">&#64;RedBeardCode</a> and <a class="reference external" href="https://github.com/sponsors/tomviner">&#64;tomviner</a>
for the PR (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1626">#1626</a>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">optparse</span></code> type usage now triggers DeprecationWarnings (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1740">#1740</a>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">optparse</span></code> backward compatibility supports float/complex types (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/457">#457</a>).</p></li>
<li><p>Refined logic for determining the <code class="docutils literal notranslate"><span class="pre">rootdir</span></code>, considering only valid
paths which fixes a number of issues: <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1594">#1594</a>, <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1435">#1435</a> and <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1471">#1471</a>.
Updated the documentation according to current behavior. Thanks to
<a class="reference external" href="https://github.com/sponsors/blueyed">&#64;blueyed</a>, <a class="reference external" href="https://github.com/sponsors/davehunt">&#64;davehunt</a> and <a class="reference external" href="https://github.com/sponsors/matthiasha">&#64;matthiasha</a> for the PR.</p></li>
<li><p>Always include full assertion explanation. The previous behaviour was hiding
sub-expressions that happened to be False, assuming this was redundant information.
Thanks <a class="reference external" href="https://github.com/sponsors/bagerard">&#64;bagerard</a> for reporting (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1503">#1503</a>). Thanks to <a class="reference external" href="https://github.com/sponsors/davehunt">&#64;davehunt</a> and
<a class="reference external" href="https://github.com/sponsors/tomviner">&#64;tomviner</a> for PR.</p></li>
<li><p>Better message in case of not using parametrized variable (see <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1539">#1539</a>).
Thanks to <a class="reference external" href="https://github.com/sponsors/tramwaj29">&#64;tramwaj29</a> for the PR.</p></li>
<li><p>Updated docstrings with a more uniform style.</p></li>
<li><p>Add stderr write for <code class="docutils literal notranslate"><span class="pre">pytest.exit(msg)</span></code> during startup. Previously the message was never shown.
Thanks <a class="reference external" href="https://github.com/sponsors/BeyondEvil">&#64;BeyondEvil</a> for reporting <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1210">#1210</a>. Thanks to &#64;jgsonesen and
<a class="reference external" href="https://github.com/sponsors/tomviner">&#64;tomviner</a> for the PR.</p></li>
<li><p>No longer display the incorrect test deselection reason (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1372">#1372</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/ronnypfannschmidt">&#64;ronnypfannschmidt</a> for the PR.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">--resultlog</span></code> command line option has been deprecated: it is little used
and there are more modern and better alternatives (see <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/830">#830</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>Improve error message with fixture lookup errors: add an ‘E’ to the first
line and ‘&gt;’ to the rest. Fixes <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/717">#717</a>. Thanks <a class="reference external" href="https://github.com/sponsors/blueyed">&#64;blueyed</a> for reporting and
a PR, <a class="reference external" href="https://github.com/sponsors/eolo999">&#64;eolo999</a> for the initial PR and <a class="reference external" href="https://github.com/sponsors/tomviner">&#64;tomviner</a> for his guidance during
EuroPython2016 sprint.</p></li>
</ul>
<p><strong>Bug Fixes</strong></p>
<ul class="simple">
<li><p>Parametrize now correctly handles duplicated test ids.</p></li>
<li><p>Fix internal error issue when the <code class="docutils literal notranslate"><span class="pre">method</span></code> argument is missing for
<code class="docutils literal notranslate"><span class="pre">teardown_method()</span></code> (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1605">#1605</a>).</p></li>
<li><p>Fix exception visualization in case the current working directory (CWD) gets
deleted during testing (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1235">#1235</a>). Thanks <a class="reference external" href="https://github.com/sponsors/bukzor">&#64;bukzor</a> for reporting. PR by
<a class="reference external" href="https://github.com/sponsors/marscher">&#64;marscher</a>.</p></li>
<li><p>Improve test output for logical expression with brackets (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/925">#925</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/DRMacIver">&#64;DRMacIver</a> for reporting and <a class="reference external" href="https://github.com/sponsors/RedBeardCode">&#64;RedBeardCode</a> for the PR.</p></li>
<li><p>Create correct diff for strings ending with newlines (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1553">#1553</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/Vogtinator">&#64;Vogtinator</a> for reporting and <a class="reference external" href="https://github.com/sponsors/RedBeardCode">&#64;RedBeardCode</a> and
<a class="reference external" href="https://github.com/sponsors/tomviner">&#64;tomviner</a> for the PR.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ConftestImportFailure</span></code> now shows the traceback making it easier to
identify bugs in <code class="docutils literal notranslate"><span class="pre">conftest.py</span></code> files (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1516">#1516</a>). Thanks <a class="reference external" href="https://github.com/sponsors/txomon">&#64;txomon</a> for
the PR.</p></li>
<li><p>Text documents without any doctests no longer appear as “skipped”.
Thanks <a class="reference external" href="https://github.com/sponsors/graingert">&#64;graingert</a> for reporting and providing a full PR (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1580">#1580</a>).</p></li>
<li><p>Fixed collection of classes with custom <code class="docutils literal notranslate"><span class="pre">__new__</span></code> method.
Fixes <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1579">#1579</a>. Thanks to <a class="reference external" href="https://github.com/sponsors/Stranger6667">&#64;Stranger6667</a> for the PR.</p></li>
<li><p>Fixed scope overriding inside metafunc.parametrize (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/634">#634</a>).
Thanks to <a class="reference external" href="https://github.com/sponsors/Stranger6667">&#64;Stranger6667</a> for the PR.</p></li>
<li><p>Fixed the total tests tally in junit xml output (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1798">#1798</a>).
Thanks to <a class="reference external" href="https://github.com/sponsors/cboelsen">&#64;cboelsen</a> for the PR.</p></li>
<li><p>Fixed off-by-one error with lines from <code class="docutils literal notranslate"><span class="pre">request.node.warn</span></code>.
Thanks to <a class="reference external" href="https://github.com/sponsors/blueyed">&#64;blueyed</a> for the PR.</p></li>
</ul>
</section>
<section id="id738">
<h2>2.9.2 (2016-05-31)<a class="headerlink" href="#id738" title="Link to this heading">¶</a></h2>
<p><strong>Bug Fixes</strong></p>
<ul class="simple">
<li><p>fix <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/510">#510</a>: skip tests where one parameterize dimension was empty
thanks Alex Stapleton for the Report and <a class="reference external" href="https://github.com/sponsors/RonnyPfannschmidt">&#64;RonnyPfannschmidt</a> for the PR</p></li>
<li><p>Fix Xfail does not work with condition keyword argument.
Thanks <a class="reference external" href="https://github.com/sponsors/astraw38">&#64;astraw38</a> for reporting the issue (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1496">#1496</a>) and <a class="reference external" href="https://github.com/sponsors/tomviner">&#64;tomviner</a>
for PR the (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1524">#1524</a>).</p></li>
<li><p>Fix win32 path issue when putting custom config file with absolute path
in <code class="docutils literal notranslate"><span class="pre">pytest.main(&quot;-c</span> <span class="pre">your_absolute_path&quot;)</span></code>.</p></li>
<li><p>Fix maximum recursion depth detection when raised error class is not aware
of unicode/encoded bytes.
Thanks <a class="reference external" href="https://github.com/sponsors/prusse-martin">&#64;prusse-martin</a> for the PR (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1506">#1506</a>).</p></li>
<li><p>Fix <code class="docutils literal notranslate"><span class="pre">pytest.mark.skip</span></code> mark when used in strict mode.
Thanks <a class="reference external" href="https://github.com/sponsors/pquentin">&#64;pquentin</a> for the PR and <a class="reference external" href="https://github.com/sponsors/RonnyPfannschmidt">&#64;RonnyPfannschmidt</a> for
showing how to fix the bug.</p></li>
<li><p>Minor improvements and fixes to the documentation.
Thanks <a class="reference external" href="https://github.com/sponsors/omarkohl">&#64;omarkohl</a> for the PR.</p></li>
<li><p>Fix <code class="docutils literal notranslate"><span class="pre">--fixtures</span></code> to show all fixture definitions as opposed to just
one per fixture name.
Thanks to <a class="reference external" href="https://github.com/sponsors/hackebrot">&#64;hackebrot</a> for the PR.</p></li>
</ul>
</section>
<section id="id739">
<h2>2.9.1 (2016-03-17)<a class="headerlink" href="#id739" title="Link to this heading">¶</a></h2>
<p><strong>Bug Fixes</strong></p>
<ul class="simple">
<li><p>Improve error message when a plugin fails to load.
Thanks <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>Fix (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1178">#1178</a>):
<code class="docutils literal notranslate"><span class="pre">pytest.fail</span></code> with non-ascii characters raises an internal pytest error.
Thanks <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>Fix (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/469">#469</a>): junit parses report.nodeid incorrectly, when params IDs
contain <code class="docutils literal notranslate"><span class="pre">::</span></code>. Thanks <a class="reference external" href="https://github.com/sponsors/tomviner">&#64;tomviner</a> for the PR (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1431">#1431</a>).</p></li>
<li><p>Fix (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/578">#578</a>): SyntaxErrors
containing non-ascii lines at the point of failure generated an internal
py.test error.
Thanks <a class="reference external" href="https://github.com/sponsors/asottile">&#64;asottile</a> for the report and <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>Fix (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1437">#1437</a>): When passing in a bytestring regex pattern to parameterize
attempt to decode it as utf-8 ignoring errors.</p></li>
<li><p>Fix (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/649">#649</a>): parametrized test nodes cannot be specified to run on the command line.</p></li>
<li><p>Fix (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/138">#138</a>): better reporting for python 3.3+ chained exceptions</p></li>
</ul>
</section>
<section id="id740">
<h2>2.9.0 (2016-02-29)<a class="headerlink" href="#id740" title="Link to this heading">¶</a></h2>
<p><strong>New Features</strong></p>
<ul class="simple">
<li><p>New <code class="docutils literal notranslate"><span class="pre">pytest.mark.skip</span></code> mark, which unconditionally skips marked tests.
Thanks <a class="reference external" href="https://github.com/sponsors/MichaelAquilina">&#64;MichaelAquilina</a> for the complete PR (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1040">#1040</a>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--doctest-glob</span></code> may now be passed multiple times in the command-line.
Thanks <a class="reference external" href="https://github.com/sponsors/jab">&#64;jab</a> and <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">-rp</span></code> and <code class="docutils literal notranslate"><span class="pre">-rP</span></code> reporting options give the summary and full output
of passing tests, respectively. Thanks to <a class="reference external" href="https://github.com/sponsors/codewarrior0">&#64;codewarrior0</a> for the PR.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest.mark.xfail</span></code> now has a <code class="docutils literal notranslate"><span class="pre">strict</span></code> option, which makes <code class="docutils literal notranslate"><span class="pre">XPASS</span></code>
tests to fail the test suite (defaulting to <code class="docutils literal notranslate"><span class="pre">False</span></code>). There’s also a
<code class="docutils literal notranslate"><span class="pre">xfail_strict</span></code> ini option that can be used to configure it project-wise.
Thanks <a class="reference external" href="https://github.com/sponsors/rabbbit">&#64;rabbbit</a> for the request and <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1355">#1355</a>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Parser.addini</span></code> now supports options of type <code class="docutils literal notranslate"><span class="pre">bool</span></code>.
Thanks <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">ALLOW_BYTES</span></code> doctest option. This strips <code class="docutils literal notranslate"><span class="pre">b</span></code> prefixes from byte strings
in doctest output (similar to <code class="docutils literal notranslate"><span class="pre">ALLOW_UNICODE</span></code>).
Thanks <a class="reference external" href="https://github.com/sponsors/jaraco">&#64;jaraco</a> for the request and <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1287">#1287</a>).</p></li>
<li><p>Give a hint on <code class="docutils literal notranslate"><span class="pre">KeyboardInterrupt</span></code> to use the <code class="docutils literal notranslate"><span class="pre">--fulltrace</span></code> option to show the errors.
Fixes <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1366">#1366</a>.
Thanks to <a class="reference external" href="https://github.com/sponsors/hpk42">&#64;hpk42</a> for the report and <a class="reference external" href="https://github.com/sponsors/RonnyPfannschmidt">&#64;RonnyPfannschmidt</a> for the PR.</p></li>
<li><p>Catch <code class="docutils literal notranslate"><span class="pre">IndexError</span></code> exceptions when getting exception source location.
Fixes a pytest internal error for dynamically generated code (fixtures and tests)
where source lines are fake by intention.</p></li>
</ul>
<p><strong>Changes</strong></p>
<ul>
<li><p><strong>Important</strong>: <a class="reference external" href="https://pylib.readthedocs.io/en/stable/code.html">py.code</a> has been
merged into the <code class="docutils literal notranslate"><span class="pre">pytest</span></code> repository as <code class="docutils literal notranslate"><span class="pre">pytest._code</span></code>. This decision
was made because <code class="docutils literal notranslate"><span class="pre">py.code</span></code> had very few uses outside <code class="docutils literal notranslate"><span class="pre">pytest</span></code> and the
fact that it was in a different repository made it difficult to fix bugs on
its code in a timely manner. The team hopes with this to be able to better
refactor out and improve that code.
This change shouldn’t affect users, but it is useful to let users aware
if they encounter any strange behavior.</p>
<p>Keep in mind that the code for <code class="docutils literal notranslate"><span class="pre">pytest._code</span></code> is <strong>private</strong> and
<strong>experimental</strong>, so you definitely should not import it explicitly!</p>
<p>Please note that the original <code class="docutils literal notranslate"><span class="pre">py.code</span></code> is still available in
<a class="reference external" href="https://pylib.readthedocs.io">pylib</a>.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytest_enter_pdb</span></code> now optionally receives the pytest config object.
Thanks <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR.</p></li>
<li><p>Removed code and documentation for Python 2.5 or lower versions,
including removal of the obsolete <code class="docutils literal notranslate"><span class="pre">_pytest.assertion.oldinterpret</span></code> module.
Thanks <a class="reference external" href="https://github.com/sponsors/nicoddemus">&#64;nicoddemus</a> for the PR (<a class="reference external" href="https://github.com/pytest-dev/pytest/pull/1226">#1226</a>).</p></li>
<li><p>Comparisons now always show up in full when <code class="docutils literal notranslate"><span class="pre">CI</span></code> or <code class="docutils literal notranslate"><span class="pre">BUILD_NUMBER</span></code> is
found in the environment, even when <code class="docutils literal notranslate"><span class="pre">-vv</span></code> isn’t used.
Thanks <a class="reference external" href="https://github.com/sponsors/The-Compiler">&#64;The-Compiler</a> for the PR.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--lf</span></code> and <code class="docutils literal notranslate"><span class="pre">--ff</span></code> now support long names: <code class="docutils literal notranslate"><span class="pre">--last-failed</span></code> and
<code class="docutils literal notranslate"><span class="pre">--failed-first</span></code> respectively.
Thanks <a class="reference external" href="https://github.com/sponsors/MichaelAquilina">&#64;MichaelAquilina</a> for the PR.</p></li>
<li><p>Added expected exceptions to <code class="docutils literal notranslate"><span class="pre">pytest.raises</span></code> fail message.</p></li>
<li><p>Collection only displays progress (“collecting X items”) when in a terminal.
This avoids cluttering the output when using <code class="docutils literal notranslate"><span class="pre">--color=yes</span></code> to obtain
colors in CI integrations systems (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1397">#1397</a>).</p></li>
</ul>
<p><strong>Bug Fixes</strong></p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">-s</span></code> and <code class="docutils literal notranslate"><span class="pre">-c</span></code> options should now work under <code class="docutils literal notranslate"><span class="pre">xdist</span></code>;
<code class="docutils literal notranslate"><span class="pre">Config.fromdictargs</span></code> now represents its input much more faithfully.
Thanks to <a class="reference external" href="https://github.com/sponsors/bukzor">&#64;bukzor</a> for the complete PR (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/680">#680</a>).</p></li>
<li><p>Fix (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1290">#1290</a>): support Python 3.5’s <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> operator in assertion rewriting.
Thanks <a class="reference external" href="https://github.com/sponsors/Shinkenjoe">&#64;Shinkenjoe</a> for report with test case and <a class="reference external" href="https://github.com/sponsors/tomviner">&#64;tomviner</a> for the PR.</p></li>
<li><p>Fix formatting utf-8 explanation messages (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1379">#1379</a>).
Thanks <a class="reference external" href="https://github.com/sponsors/biern">&#64;biern</a> for the PR.</p></li>
<li><p>Fix <a class="reference internal" href="how-to/output.html#how-to-modifying-python-tb-printing"><span class="std std-ref">traceback style docs</span></a> to describe all of the available options
(auto/long/short/line/native/no), with <code class="docutils literal notranslate"><span class="pre">auto</span></code> being the default since v2.6.
Thanks <a class="reference external" href="https://github.com/sponsors/hackebrot">&#64;hackebrot</a> for the PR.</p></li>
<li><p>Fix (<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1422">#1422</a>): junit record_xml_property doesn’t allow multiple records
with same name.</p></li>
</ul>
</section>
<section id="id741">
<h2>2.8.7 (2016-01-24)<a class="headerlink" href="#id741" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>fix #1338: use predictable object resolution for monkeypatch</p></li>
</ul>
</section>
<section id="id742">
<h2>2.8.6 (2016-01-21)<a class="headerlink" href="#id742" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>fix #1259: allow for double nodeids in junitxml,
this was a regression failing plugins combinations
like pytest-pep8 + pytest-flakes</p></li>
<li><p>Workaround for exception that occurs in pyreadline when using
<code class="docutils literal notranslate"><span class="pre">--pdb</span></code> with standard I/O capture enabled.
Thanks Erik M. Bray for the PR.</p></li>
<li><p>fix #900: Better error message in case the target of a <code class="docutils literal notranslate"><span class="pre">monkeypatch</span></code> call
raises an <code class="docutils literal notranslate"><span class="pre">ImportError</span></code>.</p></li>
<li><p>fix #1292: monkeypatch calls (setattr, setenv, etc.) are now O(1).
Thanks David R. MacIver for the report and Bruno Oliveira for the PR.</p></li>
<li><p>fix #1223: captured stdout and stderr are now properly displayed before
entering pdb when <code class="docutils literal notranslate"><span class="pre">--pdb</span></code> is used instead of being thrown away.
Thanks Cal Leeming for the PR.</p></li>
<li><p>fix #1305: pytest warnings emitted during <code class="docutils literal notranslate"><span class="pre">pytest_terminal_summary</span></code> are now
properly displayed.
Thanks Ionel Maries Cristian for the report and Bruno Oliveira for the PR.</p></li>
<li><p>fix #628: fixed internal UnicodeDecodeError when doctests contain unicode.
Thanks Jason R. Coombs for the report and Bruno Oliveira for the PR.</p></li>
<li><p>fix #1334: Add captured stdout to jUnit XML report on setup error.
Thanks Georgy Dyuldin for the PR.</p></li>
</ul>
</section>
<section id="id743">
<h2>2.8.5 (2015-12-11)<a class="headerlink" href="#id743" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>fix #1243: fixed issue where class attributes injected during collection could break pytest.
PR by Alexei Kozlenok, thanks Ronny Pfannschmidt and Bruno Oliveira for the review and help.</p></li>
<li><p>fix #1074: precompute junitxml chunks instead of storing the whole tree in objects
Thanks Bruno Oliveira for the report and Ronny Pfannschmidt for the PR</p></li>
<li><p>fix #1238: fix <code class="docutils literal notranslate"><span class="pre">pytest.deprecated_call()</span></code> receiving multiple arguments
(Regression introduced in 2.8.4). Thanks Alex Gaynor for the report and
Bruno Oliveira for the PR.</p></li>
</ul>
</section>
<section id="id744">
<h2>2.8.4 (2015-12-06)<a class="headerlink" href="#id744" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>fix #1190: <code class="docutils literal notranslate"><span class="pre">deprecated_call()</span></code> now works when the deprecated
function has been already called by another test in the same
module. Thanks Mikhail Chernykh for the report and Bruno Oliveira for the
PR.</p></li>
<li><p>fix #1198: <code class="docutils literal notranslate"><span class="pre">--pastebin</span></code> option now works on Python 3. Thanks
Mehdy Khoshnoody for the PR.</p></li>
<li><p>fix #1219: <code class="docutils literal notranslate"><span class="pre">--pastebin</span></code> now works correctly when captured output contains
non-ascii characters. Thanks Bruno Oliveira for the PR.</p></li>
<li><p>fix #1204: another error when collecting with a nasty __getattr__().
Thanks Florian Bruhin for the PR.</p></li>
<li><p>fix the summary printed when no tests did run.
Thanks Florian Bruhin for the PR.</p></li>
<li><p>fix #1185 - ensure MANIFEST.in exactly matches what should go to a sdist</p></li>
<li><p>a number of documentation modernizations wrt good practices.
Thanks Bruno Oliveira for the PR.</p></li>
</ul>
</section>
<section id="id745">
<h2>2.8.3 (2015-11-18)<a class="headerlink" href="#id745" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>fix #1169: add __name__ attribute to testcases in TestCaseFunction to
support the &#64;unittest.skip decorator on functions and methods.
Thanks Lee Kamentsky for the PR.</p></li>
<li><p>fix #1035: collecting tests if test module level obj has __getattr__().
Thanks Suor for the report and Bruno Oliveira / Tom Viner for the PR.</p></li>
<li><p>fix #331: don’t collect tests if their failure cannot be reported correctly
e.g. they are a callable instance of a class.</p></li>
<li><p>fix #1133: fixed internal error when filtering tracebacks where one entry
belongs to a file which is no longer available.
Thanks Bruno Oliveira for the PR.</p></li>
<li><p>enhancement made to highlight in red the name of the failing tests so
they stand out in the output.
Thanks Gabriel Reis for the PR.</p></li>
<li><p>add more talks to the documentation</p></li>
<li><p>extend documentation on the –ignore cli option</p></li>
<li><p>use pytest-runner for setuptools integration</p></li>
<li><p>minor fixes for interaction with OS X El Capitan
system integrity protection (thanks Florian)</p></li>
</ul>
</section>
<section id="id746">
<h2>2.8.2 (2015-10-07)<a class="headerlink" href="#id746" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>fix #1085: proper handling of encoding errors when passing encoded byte
strings to pytest.parametrize in Python 2.
Thanks Themanwithoutaplan for the report and Bruno Oliveira for the PR.</p></li>
<li><p>fix #1087: handling SystemError when passing empty byte strings to
pytest.parametrize in Python 3.
Thanks Paul Kehrer for the report and Bruno Oliveira for the PR.</p></li>
<li><p>fix #995: fixed internal error when filtering tracebacks where one entry
was generated by an exec() statement.
Thanks Daniel Hahler, Ashley C Straw, Philippe Gauthier and Pavel Savchenko
for contributing and Bruno Oliveira for the PR.</p></li>
<li><p>fix #1100 and #1057: errors when using autouse fixtures and doctest modules.
Thanks Sergey B Kirpichev and Vital Kudzelka for contributing and Bruno
Oliveira for the PR.</p></li>
</ul>
</section>
<section id="id747">
<h2>2.8.1 (2015-09-29)<a class="headerlink" href="#id747" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>fix #1034: Add missing nodeid on pytest_logwarning call in
addhook.  Thanks Simon Gomizelj for the PR.</p></li>
<li><p>‘deprecated_call’ is now only satisfied with a DeprecationWarning or
PendingDeprecationWarning. Before 2.8.0, it accepted any warning, and 2.8.0
made it accept only DeprecationWarning (but not PendingDeprecationWarning).
Thanks Alex Gaynor for the issue and Eric Hunsberger for the PR.</p></li>
<li><p>fix issue #1073: avoid calling __getattr__ on potential plugin objects.
This fixes an incompatibility with pytest-django.  Thanks Andreas Pelme,
Bruno Oliveira and Ronny Pfannschmidt for contributing and Holger Krekel
for the fix.</p></li>
<li><p>Fix issue #704: handle versionconflict during plugin loading more
gracefully.  Thanks Bruno Oliveira for the PR.</p></li>
<li><p>Fix issue #1064: “”–junitxml” regression when used with the
“pytest-xdist” plugin, with test reports being assigned to the wrong tests.
Thanks Daniel Grunwald for the report and Bruno Oliveira for the PR.</p></li>
<li><p>(experimental) adapt more SEMVER style versioning and change meaning of
master branch in git repo: “master” branch now keeps the bug fixes, changes
aimed for micro releases.  “features” branch will only be released
with minor or major pytest releases.</p></li>
<li><p>Fix issue #766 by removing documentation references to distutils.
Thanks Russel Winder.</p></li>
<li><p>Fix issue #1030: now byte-strings are escaped to produce item node ids
to make them always serializable.
Thanks Andy Freeland for the report and Bruno Oliveira for the PR.</p></li>
<li><p>Python 2: if unicode parametrized values are convertible to ascii, their
ascii representation is used for the node id.</p></li>
<li><p>Fix issue #411: Add __eq__ method to assertion comparison example.
Thanks Ben Webb.</p></li>
<li><p>Fix issue #653: deprecated_call can be used as context manager.</p></li>
<li><p>fix issue 877: properly handle assertion explanations with non-ascii repr
Thanks Mathieu Agopian for the report and Ronny Pfannschmidt for the PR.</p></li>
<li><p>fix issue 1029: transform errors when writing cache values into pytest-warnings</p></li>
</ul>
</section>
<section id="id748">
<h2>2.8.0 (2015-09-18)<a class="headerlink" href="#id748" title="Link to this heading">¶</a></h2>
<ul>
<li><p>new <code class="docutils literal notranslate"><span class="pre">--lf</span></code> and <code class="docutils literal notranslate"><span class="pre">-ff</span></code> options to run only the last failing tests or
“failing tests first” from the last run.  This functionality is provided
through porting the formerly external pytest-cache plugin into pytest core.
BACKWARD INCOMPAT: if you used pytest-cache’s functionality to persist
data between test runs be aware that we don’t serialize sets anymore.
Thanks Ronny Pfannschmidt for most of the merging work.</p></li>
<li><p>“-r” option now accepts “a” to include all possible reports, similar
to passing “fEsxXw” explicitly (issue960).
Thanks Abhijeet Kasurde for the PR.</p></li>
<li><p>avoid python3.5 deprecation warnings by introducing version
specific inspection helpers, thanks Michael Droettboom.</p></li>
<li><p>fix issue562: &#64;nose.tools.istest now fully respected.</p></li>
<li><p>fix issue934: when string comparison fails and a diff is too large to display
without passing -vv, still show a few lines of the diff.
Thanks Florian Bruhin for the report and Bruno Oliveira for the PR.</p></li>
<li><p>fix issue736: Fix a bug where fixture params would be discarded when combined
with parametrization markers.
Thanks to Markus Unterwaditzer for the PR.</p></li>
<li><p>fix issue710: introduce ALLOW_UNICODE doctest option: when enabled, the
<code class="docutils literal notranslate"><span class="pre">u</span></code> prefix is stripped from unicode strings in expected doctest output. This
allows doctests which use unicode to run in Python 2 and 3 unchanged.
Thanks Jason R. Coombs for the report and Bruno Oliveira for the PR.</p></li>
<li><p>parametrize now also generates meaningful test IDs for enum, regex and class
objects (as opposed to class instances).
Thanks to Florian Bruhin for the PR.</p></li>
<li><p>Add ‘warns’ to assert that warnings are thrown (like ‘raises’).
Thanks to Eric Hunsberger for the PR.</p></li>
<li><p>Fix issue683: Do not apply an already applied mark.  Thanks ojake for the PR.</p></li>
<li><p>Deal with capturing failures better so fewer exceptions get lost to
/dev/null.  Thanks David Szotten for the PR.</p></li>
<li><p>fix issue730: deprecate and warn about the –genscript option.
Thanks Ronny Pfannschmidt for the report and Christian Pommranz for the PR.</p></li>
<li><p>fix issue751: multiple parametrize with ids bug if it parametrizes class with
two or more test methods. Thanks Sergey Chipiga for reporting and Jan
Bednarik for PR.</p></li>
<li><p>fix issue82: avoid loading conftest files from setup.cfg/pytest.ini/tox.ini
files and upwards by default (–confcutdir can still be set to override this).
Thanks Bruno Oliveira for the PR.</p></li>
<li><p>fix issue768: docstrings found in python modules were not setting up session
fixtures. Thanks Jason R. Coombs for reporting and Bruno Oliveira for the PR.</p></li>
<li><p>added <code class="docutils literal notranslate"><span class="pre">tmpdir_factory</span></code>, a session-scoped fixture that can be used to create
directories under the base temporary directory. Previously this object was
installed as a <code class="docutils literal notranslate"><span class="pre">_tmpdirhandler</span></code> attribute of the <code class="docutils literal notranslate"><span class="pre">config</span></code> object, but now it
is part of the official API and using <code class="docutils literal notranslate"><span class="pre">config._tmpdirhandler</span></code> is
deprecated.
Thanks Bruno Oliveira for the PR.</p></li>
<li><p>fix issue808: pytest’s internal assertion rewrite hook now implements the
optional <span class="target" id="index-12"></span><a class="pep reference external" href="https://peps.python.org/pep-0302/"><strong>PEP 302</strong></a> get_data API so tests can access data files next to them.
Thanks xmo-odoo for request and example and Bruno Oliveira for
the PR.</p></li>
<li><p>rootdir and inifile are now displayed during usage errors to help
users diagnose problems such as unexpected ini files which add
unknown options being picked up by pytest. Thanks to Pavel Savchenko for
bringing the problem to attention in #821 and Bruno Oliveira for the PR.</p></li>
<li><p>Summary bar now is colored yellow for warning
situations such as: all tests either were skipped or xpass/xfailed,
or no tests were run at all (this is a partial fix for issue500).</p></li>
<li><p>fix issue812: pytest now exits with status code 5 in situations where no
tests were run at all, such as the directory given in the command line does
not contain any tests or as result of a command line option filters
all out all tests (-k for example).
Thanks Eric Siegerman (issue812) and Bruno Oliveira for the PR.</p></li>
<li><p>Summary bar now is colored yellow for warning
situations such as: all tests either were skipped or xpass/xfailed,
or no tests were run at all (related to issue500).
Thanks Eric Siegerman.</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">testpaths</span></code> ini option: list of directories to search for tests
when executing pytest from the root directory. This can be used
to speed up test collection when a project has well specified directories
for tests, being usually more practical than configuring norecursedirs for
all directories that do not contain tests.
Thanks to Adrian for idea (#694) and Bruno Oliveira for the PR.</p></li>
<li><p>fix issue713: JUnit XML reports for doctest failures.
Thanks Punyashloka Biswal.</p></li>
<li><p>fix issue970: internal pytest warnings now appear as “pytest-warnings” in
the terminal instead of “warnings”, so it is clear for users that those
warnings are from pytest and not from the builtin “warnings” module.
Thanks Bruno Oliveira.</p></li>
<li><p>Include setup and teardown in junitxml test durations.
Thanks Janne Vanhala.</p></li>
<li><p>fix issue735: assertion failures on debug versions of Python 3.4+</p></li>
<li><p>new option <code class="docutils literal notranslate"><span class="pre">--import-mode</span></code> to allow to change test module importing
behaviour to append to sys.path instead of prepending.  This better allows
to run test modules against installed versions of a package even if the
package under test has the same import root.  In this example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">testing</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span>
<span class="n">testing</span><span class="o">/</span><span class="n">test_pkg_under_test</span><span class="o">.</span><span class="n">py</span>
<span class="n">pkg_under_test</span><span class="o">/</span>
</pre></div>
</div>
<p>the tests will run against the installed version
of pkg_under_test when <code class="docutils literal notranslate"><span class="pre">--import-mode=append</span></code> is used whereas
by default they would always pick up the local version.  Thanks Holger Krekel.</p>
</li>
<li><p>pytester: add method <code class="docutils literal notranslate"><span class="pre">TmpTestdir.delete_loaded_modules()</span></code>, and call it
from <code class="docutils literal notranslate"><span class="pre">inline_run()</span></code> to allow temporary modules to be reloaded.
Thanks Eduardo Schettino.</p></li>
<li><p>internally refactor pluginmanager API and code so that there
is a clear distinction between a pytest-agnostic rather simple
pluginmanager and the PytestPluginManager which adds a lot of
behaviour, among it handling of the local conftest files.
In terms of documented methods this is a backward compatible
change but it might still break 3rd party plugins which relied on
details like especially the pluginmanager.add_shutdown() API.
Thanks Holger Krekel.</p></li>
<li><p>pluginmanagement: introduce <code class="docutils literal notranslate"><span class="pre">pytest.hookimpl</span></code> and
<code class="docutils literal notranslate"><span class="pre">pytest.hookspec</span></code> decorators for setting impl/spec
specific parameters.  This substitutes the previous
now deprecated use of <code class="docutils literal notranslate"><span class="pre">pytest.mark</span></code> which is meant to
contain markers for test functions only.</p></li>
<li><p>write/refine docs for “writing plugins” which now have their
own page and are separate from the “using/installing plugins`` page.</p></li>
<li><p>fix issue732: properly unregister plugins from any hook calling
sites allowing to have temporary plugins during test execution.</p></li>
<li><p>deprecate and warn about <code class="docutils literal notranslate"><span class="pre">__multicall__</span></code> argument in hook
implementations.  Use the <code class="docutils literal notranslate"><span class="pre">hookwrapper</span></code> mechanism instead already
introduced with pytest-2.7.</p></li>
<li><p>speed up pytest’s own test suite considerably by using inprocess
tests by default (testrun can be modified with –runpytest=subprocess
to create subprocesses in many places instead).  The main
APIs to run pytest in a test is “runpytest()” or “runpytest_subprocess”
and “runpytest_inprocess” if you need a particular way of running
the test.  In all cases you get back a RunResult but the inprocess
one will also have a “reprec” attribute with the recorded events/reports.</p></li>
<li><p>fix monkeypatch.setattr(“x.y”, raising=False) to actually not raise
if “y” is not a preexisting attribute. Thanks Florian Bruhin.</p></li>
<li><p>fix issue741: make running output from testdir.run copy/pasteable
Thanks Bruno Oliveira.</p></li>
<li><p>add a new <code class="docutils literal notranslate"><span class="pre">--noconftest</span></code> argument which ignores all <code class="docutils literal notranslate"><span class="pre">conftest.py</span></code> files.</p></li>
<li><p>add <code class="docutils literal notranslate"><span class="pre">file</span></code> and <code class="docutils literal notranslate"><span class="pre">line</span></code> attributes to JUnit-XML output.</p></li>
<li><p>fix issue890: changed extension of all documentation files from <code class="docutils literal notranslate"><span class="pre">txt</span></code> to
<code class="docutils literal notranslate"><span class="pre">rst</span></code>. Thanks to Abhijeet for the PR.</p></li>
<li><p>fix issue714: add ability to apply indirect=True parameter on particular argnames.
Thanks Elizaveta239.</p></li>
<li><p>fix issue890: changed extension of all documentation files from <code class="docutils literal notranslate"><span class="pre">txt</span></code> to
<code class="docutils literal notranslate"><span class="pre">rst</span></code>. Thanks to Abhijeet for the PR.</p></li>
<li><p>fix issue957: “# doctest: SKIP” option will now register doctests as SKIPPED
rather than PASSED.
Thanks Thomas Grainger for the report and Bruno Oliveira for the PR.</p></li>
<li><p>issue951: add new record_xml_property fixture, that supports logging
additional information on xml output. Thanks David Diaz for the PR.</p></li>
<li><p>issue949: paths after normal options (for example <code class="docutils literal notranslate"><span class="pre">-s</span></code>, <code class="docutils literal notranslate"><span class="pre">-v</span></code>, etc) are now
properly used to discover <code class="docutils literal notranslate"><span class="pre">rootdir</span></code> and <code class="docutils literal notranslate"><span class="pre">ini</span></code> files.
Thanks Peter Lauri for the report and Bruno Oliveira for the PR.</p></li>
</ul>
</section>
<section id="id749">
<h2>2.7.3 (2015-09-15)<a class="headerlink" href="#id749" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Allow ‘dev’, ‘rc’, or other non-integer version strings in <code class="docutils literal notranslate"><span class="pre">importorskip</span></code>.
Thanks to Eric Hunsberger for the PR.</p></li>
<li><p>fix issue856: consider –color parameter in all outputs (for example
–fixtures). Thanks Barney Gale for the report and Bruno Oliveira for the PR.</p></li>
<li><p>fix issue855: passing str objects as <code class="docutils literal notranslate"><span class="pre">plugins</span></code> argument to pytest.main
is now interpreted as a module name to be imported and registered as a
plugin, instead of silently having no effect.
Thanks xmo-odoo for the report and Bruno Oliveira for the PR.</p></li>
<li><p>fix issue744: fix for ast.Call changes in Python 3.5+.  Thanks
Guido van Rossum, Matthias Bussonnier, Stefan Zimmermann and
Thomas Kluyver.</p></li>
<li><p>fix issue842: applying markers in classes no longer propagate this markers
to superclasses which also have markers.
Thanks xmo-odoo for the report and Bruno Oliveira for the PR.</p></li>
<li><p>preserve warning functions after call to pytest.deprecated_call. Thanks
Pieter Mulder for PR.</p></li>
<li><p>fix issue854: autouse yield_fixtures defined as class members of
unittest.TestCase subclasses now work as expected.
Thanks xmo-odoo for the report and Bruno Oliveira for the PR.</p></li>
<li><p>fix issue833: –fixtures now shows all fixtures of collected test files, instead of just the
fixtures declared on the first one.
Thanks Florian Bruhin for reporting and Bruno Oliveira for the PR.</p></li>
<li><p>fix issue863: skipped tests now report the correct reason when a skip/xfail
condition is met when using multiple markers.
Thanks Raphael Pierzina for reporting and Bruno Oliveira for the PR.</p></li>
<li><p>optimized tmpdir fixture initialization, which should make test sessions
faster (specially when using pytest-xdist). The only visible effect
is that now pytest uses a subdirectory in the $TEMP directory for all
directories created by this fixture (defaults to $TEMP/pytest-$USER).
Thanks Bruno Oliveira for the PR.</p></li>
</ul>
</section>
<section id="id750">
<h2>2.7.2 (2015-06-23)<a class="headerlink" href="#id750" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>fix issue767: pytest.raises value attribute does not contain the exception
instance on Python 2.6. Thanks Eric Siegerman for providing the test
case and Bruno Oliveira for PR.</p></li>
<li><p>Automatically create directory for junitxml and results log.
Thanks Aron Curzon.</p></li>
<li><p>fix issue713: JUnit XML reports for doctest failures.
Thanks Punyashloka Biswal.</p></li>
<li><p>fix issue735: assertion failures on debug versions of Python 3.4+
Thanks Benjamin Peterson.</p></li>
<li><p>fix issue114: skipif marker reports to internal skipping plugin;
Thanks Floris Bruynooghe for reporting and Bruno Oliveira for the PR.</p></li>
<li><p>fix issue748: unittest.SkipTest reports to internal pytest unittest plugin.
Thanks Thomas De Schampheleire for reporting and Bruno Oliveira for the PR.</p></li>
<li><p>fix issue718: failed to create representation of sets containing unsortable
elements in python 2. Thanks Edison Gustavo Muenz.</p></li>
<li><p>fix issue756, fix issue752 (and similar issues): depend on py-1.4.29
which has a refined algorithm for traceback generation.</p></li>
</ul>
</section>
<section id="id751">
<h2>2.7.1 (2015-05-19)<a class="headerlink" href="#id751" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>fix issue731: do not get confused by the braces which may be present
and unbalanced in an object’s repr while collapsing False
explanations.  Thanks Carl Meyer for the report and test case.</p></li>
<li><p>fix issue553: properly handling inspect.getsourcelines failures in
FixtureLookupError which would lead to an internal error,
obfuscating the original problem. Thanks talljosh for initial
diagnose/patch and Bruno Oliveira for final patch.</p></li>
<li><p>fix issue660: properly report scope-mismatch-access errors
independently from ordering of fixture arguments.  Also
avoid the pytest internal traceback which does not provide
information to the user. Thanks Holger Krekel.</p></li>
<li><p>streamlined and documented release process.  Also all versions
(in setup.py and documentation generation) are now read
from _pytest/__init__.py. Thanks Holger Krekel.</p></li>
<li><p>fixed docs to remove the notion that yield-fixtures are experimental.
They are here to stay :)  Thanks Bruno Oliveira.</p></li>
<li><p>Support building wheels by using environment markers for the
requirements.  Thanks Ionel Maries Cristian.</p></li>
<li><p>fixed regression to 2.6.4 which surfaced e.g. in lost stdout capture printing
when tests raised SystemExit. Thanks Holger Krekel.</p></li>
<li><p>reintroduced _pytest fixture of the pytester plugin which is used
at least by pytest-xdist.</p></li>
</ul>
</section>
<section id="id752">
<h2>2.7.0 (2015-03-26)<a class="headerlink" href="#id752" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>fix issue435: make reload() work when assert rewriting is active.
Thanks Daniel Hahler.</p></li>
<li><p>fix issue616: conftest.py files and their contained fixtures are now
properly considered for visibility, independently from the exact
current working directory and test arguments that are used.
Many thanks to Eric Siegerman and his PR235 which contains
systematic tests for conftest visibility and now passes.
This change also introduces the concept of a <code class="docutils literal notranslate"><span class="pre">rootdir</span></code> which
is printed as a new pytest header and documented in the pytest
customize web page.</p></li>
<li><p>change reporting of “diverted” tests, i.e. tests that are collected
in one file but actually come from another (e.g. when tests in a test class
come from a base class in a different file).  We now show the nodeid
and indicate via a postfix the other file.</p></li>
<li><p>add ability to set command line options by environment variable PYTEST_ADDOPTS.</p></li>
<li><p>added documentation on the new pytest-dev teams on bitbucket and
github.  See <a class="reference external" href="https://pytest.org/en/stable/contributing.html">https://pytest.org/en/stable/contributing.html</a> .
Thanks to Anatoly for pushing and initial work on this.</p></li>
<li><p>fix issue650: new option <code class="docutils literal notranslate"><span class="pre">--doctest-ignore-import-errors</span></code> which
will turn import errors in doctests into skips.  Thanks Charles Cloud
for the complete PR.</p></li>
<li><p>fix issue655: work around different ways that cause python2/3
to leak sys.exc_info into fixtures/tests causing failures in 3rd party code</p></li>
<li><p>fix issue615: assertion rewriting did not correctly escape % signs
when formatting boolean operations, which tripped over mixing
booleans with modulo operators.  Thanks to Tom Viner for the report,
triaging and fix.</p></li>
<li><p>implement issue351: add ability to specify parametrize ids as a callable
to generate custom test ids.  Thanks Brianna Laugher for the idea and
implementation.</p></li>
<li><p>introduce and document new hookwrapper mechanism useful for plugins
which want to wrap the execution of certain hooks for their purposes.
This supersedes the undocumented <code class="docutils literal notranslate"><span class="pre">__multicall__</span></code> protocol which
pytest itself and some external plugins use.  Note that pytest-2.8
is scheduled to drop supporting the old <code class="docutils literal notranslate"><span class="pre">__multicall__</span></code>
and only support the hookwrapper protocol.</p></li>
<li><p>majorly speed up invocation of plugin hooks</p></li>
<li><p>use hookwrapper mechanism in builtin pytest plugins.</p></li>
<li><p>add a doctest ini option for doctest flags, thanks Holger Peters.</p></li>
<li><p>add note to docs that if you want to mark a parameter and the
parameter is a callable, you also need to pass in a reason to disambiguate
it from the “decorator” case.  Thanks Tom Viner.</p></li>
<li><p>“python_classes” and “python_functions” options now support glob-patterns
for test discovery, as discussed in issue600. Thanks Ldiary Translations.</p></li>
<li><p>allow to override parametrized fixtures with non-parametrized ones and vice versa (bubenkoff).</p></li>
<li><p>fix issue463: raise specific error for ‘parameterize’ misspelling (pfctdayelise).</p></li>
<li><p>On failure, the <code class="docutils literal notranslate"><span class="pre">sys.last_value</span></code>, <code class="docutils literal notranslate"><span class="pre">sys.last_type</span></code> and
<code class="docutils literal notranslate"><span class="pre">sys.last_traceback</span></code> are set, so that a user can inspect the error
via postmortem debugging (almarklein).</p></li>
</ul>
</section>
<section id="id753">
<h2>2.6.4 (2014-10-24)<a class="headerlink" href="#id753" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Improve assertion failure reporting on iterables, by using ndiff and
pprint.</p></li>
<li><p>removed outdated japanese docs from source tree.</p></li>
<li><p>docs for “pytest_addhooks” hook.  Thanks Bruno Oliveira.</p></li>
<li><p>updated plugin index docs.  Thanks Bruno Oliveira.</p></li>
<li><p>fix issue557: with “-k” we only allow the old style “-” for negation
at the beginning of strings and even that is deprecated.  Use “not” instead.
This should allow to pick parametrized tests where “-” appeared in the parameter.</p></li>
<li><p>fix issue604: Escape % character in the assertion message.</p></li>
<li><p>fix issue620: add explanation in the –genscript target about what
the binary blob means. Thanks Dinu Gherman.</p></li>
<li><p>fix issue614: fixed pastebin support.</p></li>
<li><p>fix issue620: add explanation in the –genscript target about what
the binary blob means. Thanks Dinu Gherman.</p></li>
<li><p>fix issue614: fixed pastebin support.</p></li>
</ul>
</section>
<section id="id754">
<h2>2.6.3 (2014-09-24)<a class="headerlink" href="#id754" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>fix issue575: xunit-xml was reporting collection errors as failures
instead of errors, thanks Oleg Sinyavskiy.</p></li>
<li><p>fix issue582: fix setuptools example, thanks Laszlo Papp and Ronny
Pfannschmidt.</p></li>
<li><p>Fix infinite recursion bug when pickling capture.EncodedFile, thanks
Uwe Schmitt.</p></li>
<li><p>fix issue589: fix bad interaction with numpy and others when showing
exceptions.  Check for precise “maximum recursion depth exceed” exception
instead of presuming any RuntimeError is that one (implemented in py
dep).  Thanks Charles Cloud for analysing the issue.</p></li>
<li><p>fix conftest related fixture visibility issue: when running with a
CWD outside of a test package pytest would get fixture discovery wrong.
Thanks to Wolfgang Schnerring for figuring out a reproducible example.</p></li>
<li><p>Introduce pytest_enter_pdb hook (needed e.g. by pytest_timeout to cancel the
timeout when interactively entering pdb).  Thanks Wolfgang Schnerring.</p></li>
<li><p>check xfail/skip also with non-python function test items. Thanks
Floris Bruynooghe.</p></li>
</ul>
</section>
<section id="id755">
<h2>2.6.2 (2014-09-05)<a class="headerlink" href="#id755" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Added function pytest.freeze_includes(), which makes it easy to embed
pytest into executables using tools like cx_freeze.
See docs for examples and rationale. Thanks Bruno Oliveira.</p></li>
<li><p>Improve assertion rewriting cache invalidation precision.</p></li>
<li><p>fixed issue561: adapt autouse fixture example for python3.</p></li>
<li><p>fixed issue453: assertion rewriting issue with __repr__ containing
“n{”, “n}” and “n~”.</p></li>
<li><p>fix issue560: correctly display code if an “else:” or “finally:” is
followed by statements on the same line.</p></li>
<li><p>Fix example in monkeypatch documentation, thanks t-8ch.</p></li>
<li><p>fix issue572: correct tmpdir doc example for python3.</p></li>
<li><p>Do not mark as universal wheel because Python 2.6 is different from
other builds due to the extra argparse dependency.  Fixes issue566.
Thanks sontek.</p></li>
<li><p>Implement issue549: user-provided assertion messages now no longer
replace the py.test introspection message but are shown in addition
to them.</p></li>
</ul>
</section>
<section id="id756">
<h2>2.6.1 (2014-08-07)<a class="headerlink" href="#id756" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>No longer show line numbers in the –verbose output, the output is now
purely the nodeid.  The line number is still shown in failure reports.
Thanks Floris Bruynooghe.</p></li>
<li><p>fix issue437 where assertion rewriting could cause pytest-xdist worker nodes
to collect different tests. Thanks Bruno Oliveira.</p></li>
<li><p>fix issue555: add “errors” attribute to capture-streams to satisfy
some distutils and possibly other code accessing sys.stdout.errors.</p></li>
<li><p>fix issue547 capsys/capfd also work when output capturing (“-s”) is disabled.</p></li>
<li><p>address issue170: allow pytest.mark.xfail(…) to specify expected exceptions via
an optional “raises=EXC” argument where EXC can be a single exception
or a tuple of exception classes.  Thanks David Mohr for the complete
PR.</p></li>
<li><p>fix integration of pytest with unittest.mock.patch decorator when
it uses the “new” argument.  Thanks Nicolas Delaby for test and PR.</p></li>
<li><p>fix issue with detecting conftest files if the arguments contain
“::” node id specifications (copy pasted from “-v” output)</p></li>
<li><p>fix issue544 by only removing “&#64;NUM” at the end of “::” separated parts
and if the part has a “.py” extension</p></li>
<li><p>don’t use py.std import helper, rather import things directly.
Thanks Bruno Oliveira.</p></li>
</ul>
</section>
<section id="id757">
<h2>2.6<a class="headerlink" href="#id757" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Cache exceptions from fixtures according to their scope (issue 467).</p></li>
<li><p>fix issue537: Avoid importing old assertion reinterpretation code by default.</p></li>
<li><p>fix issue364: shorten and enhance tracebacks representation by default.
The new “–tb=auto” option (default) will only display long tracebacks
for the first and last entry.  You can get the old behaviour of printing
all entries as long entries with “–tb=long”.  Also short entries by
default are now printed very similarly to “–tb=native” ones.</p></li>
<li><p>fix issue514: teach assertion reinterpretation about private class attributes</p></li>
<li><p>change -v output to include full node IDs of tests.  Users can copy
a node ID from a test run, including line number, and use it as a
positional argument in order to run only a single test.</p></li>
<li><p>fix issue 475: fail early and comprehensible if calling
pytest.raises with wrong exception type.</p></li>
<li><p>fix issue516: tell in getting-started about current dependencies.</p></li>
<li><p>cleanup setup.py a bit and specify supported versions. Thanks Jurko
Gospodnetic for the PR.</p></li>
<li><p>change XPASS colour to yellow rather than red when tests are run
with -v.</p></li>
<li><p>fix issue473: work around mock putting an unbound method into a class
dict when double-patching.</p></li>
<li><p>fix issue498: if a fixture finalizer fails, make sure that
the fixture is still invalidated.</p></li>
<li><p>fix issue453: the result of the pytest_assertrepr_compare hook now gets
it’s newlines escaped so that format_exception does not blow up.</p></li>
<li><p>internal new warning system: pytest will now produce warnings when
it detects oddities in your test collection or execution.
Warnings are ultimately sent to a new pytest_logwarning hook which is
currently only implemented by the terminal plugin which displays
warnings in the summary line and shows more details when -rw (report on
warnings) is specified.</p></li>
<li><p>change skips into warnings for test classes with an __init__ and
callables in test modules which look like a test but are not functions.</p></li>
<li><p>fix issue436: improved finding of initial conftest files from command
line arguments by using the result of parse_known_args rather than
the previous flaky heuristics.  Thanks Marc Abramowitz for tests
and initial fixing approaches in this area.</p></li>
<li><p>fix issue #479: properly handle nose/unittest(2) SkipTest exceptions
during collection/loading of test modules.  Thanks to Marc Schlaich
for the complete PR.</p></li>
<li><p>fix issue490: include pytest_load_initial_conftests in documentation
and improve docstring.</p></li>
<li><p>fix issue472: clarify that <code class="docutils literal notranslate"><span class="pre">pytest.config.getvalue()</span></code> cannot work
if it’s triggered ahead of command line parsing.</p></li>
<li><p>merge PR123: improved integration with mock.patch decorator on tests.</p></li>
<li><p>fix issue412: messing with stdout/stderr FD-level streams is now
captured without crashes.</p></li>
<li><p>fix issue483: trial/py33 works now properly.  Thanks Daniel Grana for PR.</p></li>
<li><p>improve example for pytest integration with “python setup.py test”
which now has a generic “-a” or “–pytest-args” option where you
can pass additional options as a quoted string.  Thanks Trevor Bekolay.</p></li>
<li><p>simplified internal capturing mechanism and made it more robust
against tests or setups changing FD1/FD2, also better integrated
now with pytest.pdb() in single tests.</p></li>
<li><p>improvements to pytest’s own test-suite leakage detection, courtesy of PRs
from Marc Abramowitz</p></li>
<li><p>fix issue492: avoid leak in test_writeorg.  Thanks Marc Abramowitz.</p></li>
<li><p>fix issue493: don’t run tests in doc directory with <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">test</span></code>
(use tox -e doctesting for that)</p></li>
<li><p>fix issue486: better reporting and handling of early conftest loading failures</p></li>
<li><p>some cleanup and simplification of internal conftest handling.</p></li>
<li><p>work a bit harder to break reference cycles when catching exceptions.
Thanks Jurko Gospodnetic.</p></li>
<li><p>fix issue443: fix skip examples to use proper comparison.  Thanks Alex
Groenholm.</p></li>
<li><p>support nose-style <code class="docutils literal notranslate"><span class="pre">__test__</span></code> attribute on modules, classes and
functions, including unittest-style Classes.  If set to False, the
test will not be collected.</p></li>
<li><p>fix issue512: show “&lt;notset&gt;” for arguments which might not be set
in monkeypatch plugin.  Improves output in documentation.</p></li>
</ul>
</section>
<section id="id758">
<h2>2.5.2 (2014-01-29)<a class="headerlink" href="#id758" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>fix issue409 – better interoperate with cx_freeze by not
trying to import from collections.abc which causes problems
for py27/cx_freeze.  Thanks Wolfgang L. for reporting and tracking it down.</p></li>
<li><p>fixed docs and code to use “pytest” instead of “py.test” almost everywhere.
Thanks Jurko Gospodnetic for the complete PR.</p></li>
<li><p>fix issue425: mention at end of “py.test -h” that –markers
and –fixtures work according to specified test path (or current dir)</p></li>
<li><p>fix issue413: exceptions with unicode attributes are now printed
correctly also on python2 and with pytest-xdist runs. (the fix
requires py-1.4.20)</p></li>
<li><p>copy, cleanup and integrate py.io capture
from pylib 1.4.20.dev2 (rev 13d9af95547e)</p></li>
<li><p>address issue416: clarify docs as to conftest.py loading semantics</p></li>
<li><p>fix issue429: comparing byte strings with non-ascii chars in assert
expressions now work better.  Thanks Floris Bruynooghe.</p></li>
<li><p>make capfd/capsys.capture private, its unused and shouldn’t be exposed</p></li>
</ul>
</section>
<section id="id759">
<h2>2.5.1 (2013-12-17)<a class="headerlink" href="#id759" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>merge new documentation styling PR from Tobias Bieniek.</p></li>
<li><p>fix issue403: allow parametrize of multiple same-name functions within
a collection node.  Thanks Andreas Kloeckner and Alex Gaynor for reporting
and analysis.</p></li>
<li><p>Allow parameterized fixtures to specify the ID of the parameters by
adding an ids argument to pytest.fixture() and pytest.yield_fixture().
Thanks Floris Bruynooghe.</p></li>
<li><p>fix issue404 by always using the binary xml escape in the junitxml
plugin.  Thanks Ronny Pfannschmidt.</p></li>
<li><p>fix issue407: fix addoption docstring to point to argparse instead of
optparse. Thanks Daniel D. Wright.</p></li>
</ul>
</section>
<section id="id760">
<h2>2.5.0 (2013-12-12)<a class="headerlink" href="#id760" title="Link to this heading">¶</a></h2>
<ul>
<li><p>dropped python2.5 from automated release testing of pytest itself
which means it’s probably going to break soon (but still works
with this release we believe).</p></li>
<li><p>simplified and fixed implementation for calling finalizers when
parametrized fixtures or function arguments are involved.  finalization
is now performed lazily at setup time instead of in the “teardown phase”.
While this might sound odd at first, it helps to ensure that we are
correctly handling setup/teardown even in complex code.  User-level code
should not be affected unless it’s implementing the pytest_runtest_teardown
hook and expecting certain fixture instances are torn down within (very
unlikely and would have been unreliable anyway).</p></li>
<li><p>PR90: add –color=yes|no|auto option to force terminal coloring
mode (“auto” is default).  Thanks Marc Abramowitz.</p></li>
<li><p>fix issue319 - correctly show unicode in assertion errors.  Many
thanks to Floris Bruynooghe for the complete PR.  Also means
we depend on py&gt;=1.4.19 now.</p></li>
<li><p>fix issue396 - correctly sort and finalize class-scoped parametrized
tests independently from number of methods on the class.</p></li>
<li><p>refix issue323 in a better way – parametrization should now never
cause Runtime Recursion errors because the underlying algorithm
for re-ordering tests per-scope/per-fixture is not recursive
anymore (it was tail-call recursive before which could lead
to problems for more than &gt;966 non-function scoped parameters).</p></li>
<li><p>fix issue290 - there is preliminary support now for parametrizing
with repeated same values (sometimes useful to test if calling
a second time works as with the first time).</p></li>
<li><p>close issue240 - document precisely how pytest module importing
works, discuss the two common test directory layouts, and how it
interacts with <span class="target" id="index-13"></span><a class="pep reference external" href="https://peps.python.org/pep-0420/"><strong>PEP 420</strong></a>-namespace packages.</p></li>
<li><p>fix issue246 fix finalizer order to be LIFO on independent fixtures
depending on a parametrized higher-than-function scoped fixture.
(was quite some effort so please bear with the complexity of this sentence :)
Thanks Ralph Schmitt for the precise failure example.</p></li>
<li><p>fix issue244 by implementing special index for parameters to only use
indices for parametrized test ids</p></li>
<li><p>fix issue287 by running all finalizers but saving the exception
from the first failing finalizer and re-raising it so teardown will
still have failed.  We reraise the first failing exception because
it might be the cause for other finalizers to fail.</p></li>
<li><p>fix ordering when mock.patch or other standard decorator-wrappings
are used with test methods.  This fixes issue346 and should
help with random “xdist” collection failures.  Thanks to
Ronny Pfannschmidt and Donald Stufft for helping to isolate it.</p></li>
<li><p>fix issue357 - special case “-k” expressions to allow for
filtering with simple strings that are not valid python expressions.
Examples: “-k 1.3” matches all tests parametrized with 1.3.
“-k None” filters all tests that have “None” in their name
and conversely “-k ‘not None’”.
Previously these examples would raise syntax errors.</p></li>
<li><p>fix issue384 by removing the trial support code
since the unittest compat enhancements allow
trial to handle it on its own</p></li>
<li><p>don’t hide an ImportError when importing a plugin produces one.
fixes issue375.</p></li>
<li><p>fix issue275 - allow usefixtures and autouse fixtures
for running doctest text files.</p></li>
<li><p>fix issue380 by making –resultlog only rely on longrepr instead
of the “reprcrash” attribute which only exists sometimes.</p></li>
<li><p>address issue122: allow &#64;pytest.fixture(params=iterator) by exploding
into a list early on.</p></li>
<li><p>fix pexpect-3.0 compatibility for pytest’s own tests.
(fixes issue386)</p></li>
<li><p>allow nested parametrize-value markers, thanks James Lan for the PR.</p></li>
<li><p>fix unicode handling with new monkeypatch.setattr(import_path, value)
API.  Thanks Rob Dennis.  Fixes issue371.</p></li>
<li><p>fix unicode handling with junitxml, fixes issue368.</p></li>
<li><p>In assertion rewriting mode on Python 2, fix the detection of coding
cookies. See issue #330.</p></li>
<li><p>make “–runxfail” turn imperative pytest.xfail calls into no ops
(it already did neutralize pytest.mark.xfail markers)</p></li>
<li><p>refine pytest / pkg_resources interactions: The AssertionRewritingHook
<span class="target" id="index-14"></span><a class="pep reference external" href="https://peps.python.org/pep-0302/"><strong>PEP 302</strong></a> compliant loader now registers itself with setuptools/pkg_resources
properly so that the pkg_resources.resource_stream method works properly.
Fixes issue366.  Thanks for the investigations and full PR to Jason R. Coombs.</p></li>
<li><p>pytestconfig fixture is now session-scoped as it is the same object during the
whole test run.  Fixes issue370.</p></li>
<li><p>avoid one surprising case of marker malfunction/confusion:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">some</span><span class="p">(</span><span class="k">lambda</span> <span class="n">arg</span><span class="p">:</span> <span class="o">...</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_function</span><span class="p">():</span>
</pre></div>
</div>
<p>would not work correctly because pytest assumes &#64;pytest.mark.some
gets a function to be decorated already.  We now at least detect if this
arg is a lambda and thus the example will work.  Thanks Alex Gaynor
for bringing it up.</p>
</li>
<li><p>xfail a test on pypy that checks wrong encoding/ascii (pypy does
not error out). fixes issue385.</p></li>
<li><p>internally make varnames() deal with classes’s __init__,
although it’s not needed by pytest itself atm.  Also
fix caching.  Fixes issue376.</p></li>
<li><p>fix issue221 - handle importing of namespace-package with no
__init__.py properly.</p></li>
<li><p>refactor internal FixtureRequest handling to avoid monkeypatching.
One of the positive user-facing effects is that the “request” object
can now be used in closures.</p></li>
<li><p>fixed version comparison in pytest.importskip(modname, minverstring)</p></li>
<li><p>fix issue377 by clarifying in the nose-compat docs that pytest
does not duplicate the unittest-API into the “plain” namespace.</p></li>
<li><p>fix verbose reporting for &#64;mock’d test functions</p></li>
</ul>
</section>
<section id="id761">
<h2>2.4.2 (2013-10-04)<a class="headerlink" href="#id761" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>on Windows require colorama and a newer py lib so that py.io.TerminalWriter()
now uses colorama instead of its own ctypes hacks. (fixes issue365)
thanks Paul Moore for bringing it up.</p></li>
<li><p>fix “-k” matching of tests where “repr” and “attr” and other names would
cause wrong matches because of an internal implementation quirk
(don’t ask) which is now properly implemented. fixes issue345.</p></li>
<li><p>avoid tmpdir fixture to create too long filenames especially
when parametrization is used (issue354)</p></li>
<li><p>fix pytest-pep8 and pytest-flakes / pytest interactions
(collection names in mark plugin was assuming an item always
has a function which is not true for those plugins etc.)
Thanks Andi Zeidler.</p></li>
<li><p>introduce node.get_marker/node.add_marker API for plugins
like pytest-pep8 and pytest-flakes to avoid the messy
details of the node.keywords  pseudo-dicts.  Adapted
docs.</p></li>
<li><p>remove attempt to “dup” stdout at startup as it’s icky.
the normal capturing should catch enough possibilities
of tests messing up standard FDs.</p></li>
<li><p>add pluginmanager.do_configure(config) as a link to
config.do_configure() for plugin-compatibility</p></li>
</ul>
</section>
<section id="id762">
<h2>2.4.1 (2013-10-02)<a class="headerlink" href="#id762" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>When using parser.addoption() unicode arguments to the
“type” keyword should also be converted to the respective types.
thanks Floris Bruynooghe, &#64;dnozay. (fixes issue360 and issue362)</p></li>
<li><p>fix dotted filename completion when using argcomplete
thanks Anthon van der Neuth. (fixes issue361)</p></li>
<li><p>fix regression when a 1-tuple (“arg”,) is used for specifying
parametrization (the values of the parametrization were passed
nested in a tuple).  Thanks Donald Stufft.</p></li>
<li><p>merge doc typo fixes, thanks Andy Dirnberger</p></li>
</ul>
</section>
<section id="id763">
<h2>2.4<a class="headerlink" href="#id763" title="Link to this heading">¶</a></h2>
<p>known incompatibilities:</p>
<ul class="simple">
<li><p>if calling –genscript from python2.7 or above, you only get a
standalone script which works on python2.7 or above.  Use Python2.6
to also get a python2.5 compatible version.</p></li>
<li><p>all xunit-style teardown methods (nose-style, pytest-style,
unittest-style) will not be called if the corresponding setup method failed,
see issue322 below.</p></li>
<li><p>the pytest_plugin_unregister hook wasn’t ever properly called
and there is no known implementation of the hook - so it got removed.</p></li>
<li><p>pytest.fixture-decorated functions cannot be generators (i.e. use
yield) anymore.  This change might be reversed in 2.4.1 if it causes
unforeseen real-life issues.  However, you can always write and return
an inner function/generator and change the fixture consumer to iterate
over the returned generator.  This change was done in lieu of the new
<code class="docutils literal notranslate"><span class="pre">pytest.yield_fixture</span></code> decorator, see below.</p></li>
</ul>
<p>new features:</p>
<ul>
<li><p>experimentally introduce a new <code class="docutils literal notranslate"><span class="pre">pytest.yield_fixture</span></code> decorator
which accepts exactly the same parameters as pytest.fixture but
mandates a <code class="docutils literal notranslate"><span class="pre">yield</span></code> statement instead of a <code class="docutils literal notranslate"><span class="pre">return</span> <span class="pre">statement</span></code> from
fixture functions.  This allows direct integration with “with-style”
context managers in fixture functions and generally avoids registering
of finalization callbacks in favour of treating the “after-yield” as
teardown code.  Thanks Andreas Pelme, Vladimir Keleshev, Floris
Bruynooghe, Ronny Pfannschmidt and many others for discussions.</p></li>
<li><p>allow boolean expression directly with skipif/xfail
if a “reason” is also specified.  Rework skipping documentation
to recommend “condition as booleans” because it prevents surprises
when importing markers between modules.  Specifying conditions
as strings will remain fully supported.</p></li>
<li><p>reporting: color the last line red or green depending if
failures/errors occurred or everything passed.  thanks Christian
Theunert.</p></li>
<li><p>make “import pdb ; pdb.set_trace()” work natively wrt capturing (no
“-s” needed anymore), making <code class="docutils literal notranslate"><span class="pre">pytest.set_trace()</span></code> a mere shortcut.</p></li>
<li><p>fix issue181: –pdb now also works on collect errors (and
on internal errors) .  This was implemented by a slight internal
refactoring and the introduction of a new hook
<code class="docutils literal notranslate"><span class="pre">pytest_exception_interact</span></code> hook (see next item).</p></li>
<li><p>fix issue341: introduce new experimental hook for IDEs/terminals to
intercept debugging: <code class="docutils literal notranslate"><span class="pre">pytest_exception_interact(node,</span> <span class="pre">call,</span> <span class="pre">report)</span></code>.</p></li>
<li><p>new monkeypatch.setattr() variant to provide a shorter
invocation for patching out classes/functions from modules:</p>
<blockquote>
<div><p>monkeypatch.setattr(“requests.get”, myfunc)</p>
</div></blockquote>
<p>will replace the “get” function of the “requests” module with <code class="docutils literal notranslate"><span class="pre">myfunc</span></code>.</p>
</li>
<li><p>fix issue322: tearDownClass is not run if setUpClass failed. Thanks
Mathieu Agopian for the initial fix.  Also make all of pytest/nose
finalizer mimic the same generic behaviour: if a setupX exists and
fails, don’t run teardownX.  This internally introduces a new method
“node.addfinalizer()” helper which can only be called during the setup
phase of a node.</p></li>
<li><p>simplify pytest.mark.parametrize() signature: allow to pass a
CSV-separated string to specify argnames.  For example:
<code class="docutils literal notranslate"><span class="pre">pytest.mark.parametrize(&quot;input,expected&quot;,</span>&#160; <span class="pre">[(1,2),</span> <span class="pre">(2,3)])</span></code>
works as well as the previous:
<code class="docutils literal notranslate"><span class="pre">pytest.mark.parametrize((&quot;input&quot;,</span> <span class="pre">&quot;expected&quot;),</span> <span class="pre">...)</span></code>.</p></li>
<li><p>add support for setUpModule/tearDownModule detection, thanks Brian Okken.</p></li>
<li><p>integrate tab-completion on options through use of “argcomplete”.
Thanks Anthon van der Neut for the PR.</p></li>
<li><p>change option names to be hyphen-separated long options but keep the
old spelling backward compatible.  py.test -h will only show the
hyphenated version, for example “–collect-only” but “–collectonly”
will remain valid as well (for backward-compat reasons).  Many thanks to
Anthon van der Neut for the implementation and to Hynek Schlawack for
pushing us.</p></li>
<li><p>fix issue 308 - allow to mark/xfail/skip individual parameter sets
when parametrizing.  Thanks Brianna Laugher.</p></li>
<li><p>call new experimental pytest_load_initial_conftests hook to allow
3rd party plugins to do something before a conftest is loaded.</p></li>
</ul>
<p>Bug fixes:</p>
<ul class="simple">
<li><p>fix issue358 - capturing options are now parsed more properly
by using a new parser.parse_known_args method.</p></li>
<li><p>pytest now uses argparse instead of optparse (thanks Anthon) which
means that “argparse” is added as a dependency if installing into python2.6
environments or below.</p></li>
<li><p>fix issue333: fix a case of bad unittest/pytest hook interaction.</p></li>
<li><p>PR27: correctly handle nose.SkipTest during collection.  Thanks
Antonio Cuni, Ronny Pfannschmidt.</p></li>
<li><p>fix issue355: junitxml puts name=”pytest” attribute to testsuite tag.</p></li>
<li><p>fix issue336: autouse fixture in plugins should work again.</p></li>
<li><p>fix issue279: improve object comparisons on assertion failure
for standard datatypes and recognise collections.abc.  Thanks to
Brianna Laugher and Mathieu Agopian.</p></li>
<li><p>fix issue317: assertion rewriter support for the is_package method</p></li>
<li><p>fix issue335: document py.code.ExceptionInfo() object returned
from pytest.raises(), thanks Mathieu Agopian.</p></li>
<li><p>remove implicit distribute_setup support from setup.py.</p></li>
<li><p>fix issue305: ignore any problems when writing pyc files.</p></li>
<li><p>SO-17664702: call fixture finalizers even if the fixture function
partially failed (finalizers would not always be called before)</p></li>
<li><p>fix issue320 - fix class scope for fixtures when mixed with
module-level functions.  Thanks Anatoly Bubenkoff.</p></li>
<li><p>you can specify “-q” or “-qq” to get different levels of “quieter”
reporting (thanks Katarzyna Jachim)</p></li>
<li><p>fix issue300 - Fix order of conftest loading when starting py.test
in a subdirectory.</p></li>
<li><p>fix issue323 - sorting of many module-scoped arg parametrizations</p></li>
<li><p>make sessionfinish hooks execute with the same cwd-context as at
session start (helps fix plugin behaviour which write output files
with relative path such as pytest-cov)</p></li>
<li><p>fix issue316 - properly reference collection hooks in docs</p></li>
<li><p>fix issue 306 - cleanup of -k/-m options to only match markers/test
names/keywords respectively.  Thanks Wouter van Ackooy.</p></li>
<li><p>improved doctest counting for doctests in python modules –
files without any doctest items will not show up anymore
and doctest examples are counted as separate test items.
thanks Danilo Bellini.</p></li>
<li><p>fix issue245 by depending on the released py-1.4.14
which fixes py.io.dupfile to work with files with no
mode. Thanks Jason R. Coombs.</p></li>
<li><p>fix junitxml generation when test output contains control characters,
addressing issue267, thanks Jaap Broekhuizen</p></li>
<li><p>fix issue338: honor –tb style for setup/teardown errors as well.  Thanks Maho.</p></li>
<li><p>fix issue307 - use yaml.safe_load in example, thanks Mark Eichin.</p></li>
<li><p>better parametrize error messages, thanks Brianna Laugher</p></li>
<li><p>pytest_terminal_summary(terminalreporter) hooks can now use
“.section(title)” and “.line(msg)” methods to print extra
information at the end of a test run.</p></li>
</ul>
</section>
<section id="id764">
<h2>2.3.5 (2013-04-30)<a class="headerlink" href="#id764" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>fix issue169: respect –tb=style with setup/teardown errors as well.</p></li>
<li><p>never consider a fixture function for test function collection</p></li>
<li><p>allow re-running of test items / helps to fix pytest-reruntests plugin
and also help to keep less fixture/resource references alive</p></li>
<li><p>put captured stdout/stderr into junitxml output even for passing tests
(thanks Adam Goucher)</p></li>
<li><p>Issue 265 - integrate nose setup/teardown with setupstate
so it doesn’t try to teardown if it did not setup</p></li>
<li><p>issue 271 - don’t write junitxml on worker nodes</p></li>
<li><p>Issue 274 - don’t try to show full doctest example
when doctest does not know the example location</p></li>
<li><p>issue 280 - disable assertion rewriting on buggy CPython 2.6.0</p></li>
<li><p>inject “getfixture()” helper to retrieve fixtures from doctests,
thanks Andreas Zeidler</p></li>
<li><p>issue 259 - when assertion rewriting, be consistent with the default
source encoding of ASCII on Python 2</p></li>
<li><p>issue 251 - report a skip instead of ignoring classes with init</p></li>
<li><p>issue250 unicode/str mixes in parametrization names and values now works</p></li>
<li><p>issue257, assertion-triggered compilation of source ending in a
comment line doesn’t blow up in python2.5 (fixed through py&gt;=1.4.13.dev6)</p></li>
<li><p>fix –genscript option to generate standalone scripts that also
work with python3.3 (importer ordering)</p></li>
<li><p>issue171 - in assertion rewriting, show the repr of some
global variables</p></li>
<li><p>fix option help for “-k”</p></li>
<li><p>move long description of distribution into README.rst</p></li>
<li><p>improve docstring for metafunc.parametrize()</p></li>
<li><p>fix bug where using capsys with pytest.set_trace() in a test
function would break when looking at capsys.readouterr()</p></li>
<li><p>allow to specify prefixes starting with “_” when
customizing python_functions test discovery. (thanks Graham Horler)</p></li>
<li><p>improve PYTEST_DEBUG tracing output by putting
extra data on a new lines with additional indent</p></li>
<li><p>ensure OutcomeExceptions like skip/fail have initialized exception attributes</p></li>
<li><p>issue 260 - don’t use nose special setup on plain unittest cases</p></li>
<li><p>fix issue134 - print the collect errors that prevent running specified test items</p></li>
<li><p>fix issue266 - accept unicode in MarkEvaluator expressions</p></li>
</ul>
</section>
<section id="id765">
<h2>2.3.4 (2012-11-20)<a class="headerlink" href="#id765" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>yielded test functions will now have autouse-fixtures active but
cannot accept fixtures as funcargs - it’s anyway recommended to
rather use the post-2.0 parametrize features instead of yield, see:
<a class="reference external" href="http://pytest.org/en/stable/example/how-to/parametrize.html">http://pytest.org/en/stable/example/how-to/parametrize.html</a></p></li>
<li><p>fix autouse-issue where autouse-fixtures would not be discovered
if defined in an a/conftest.py file and tests in a/tests/test_some.py</p></li>
<li><p>fix issue226 - LIFO ordering for fixture teardowns</p></li>
<li><p>fix issue224 - invocations with &gt;256 char arguments now work</p></li>
<li><p>fix issue91 - add/discuss package/directory level setups in example</p></li>
<li><p>allow to dynamically define markers via
item.keywords[…]=assignment integrating with “-m” option</p></li>
<li><p>make “-k” accept an expressions the same as with “-m” so that one
can write: -k “name1 or name2” etc.  This is a slight incompatibility
if you used special syntax like “TestClass.test_method” which you now
need to write as -k “TestClass and test_method” to match a certain
method in a certain test class.</p></li>
</ul>
</section>
<section id="id766">
<h2>2.3.3 (2012-11-06)<a class="headerlink" href="#id766" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>fix issue214 - parse modules that contain special objects like e. g.
flask’s request object which blows up on getattr access if no request
is active. thanks Thomas Waldmann.</p></li>
<li><p>fix issue213 - allow to parametrize with values like numpy arrays that
do not support an __eq__ operator</p></li>
<li><p>fix issue215 - split test_python.org into multiple files</p></li>
<li><p>fix issue148 - &#64;unittest.skip on classes is now recognized and avoids
calling setUpClass/tearDownClass, thanks Pavel Repin</p></li>
<li><p>fix issue209 - reintroduce python2.4 support by depending on newer
pylib which re-introduced statement-finding for pre-AST interpreters</p></li>
<li><p>nose support: only call setup if it’s a callable, thanks Andrew
Taumoefolau</p></li>
<li><p>fix issue219 - add py2.4-3.3 classifiers to TROVE list</p></li>
<li><p>in tracebacks <em>,*</em> arg values are now shown next to normal arguments
(thanks Manuel Jacob)</p></li>
<li><p>fix issue217 - support mock.patch with pytest’s fixtures - note that
you need either mock-1.0.1 or the python3.3 builtin unittest.mock.</p></li>
<li><p>fix issue127 - improve documentation for pytest_addoption() and
add a <code class="docutils literal notranslate"><span class="pre">config.getoption(name)</span></code> helper function for consistency.</p></li>
</ul>
</section>
<section id="id767">
<h2>2.3.2 (2012-10-25)<a class="headerlink" href="#id767" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>fix issue208 and fix issue29 use new py version to avoid long pauses
when printing tracebacks in long modules</p></li>
<li><p>fix issue205 - conftests in subdirs customizing
pytest_pycollect_makemodule and pytest_pycollect_makeitem
now work properly</p></li>
<li><p>fix teardown-ordering for parametrized setups</p></li>
<li><p>fix issue127 - better documentation for pytest_addoption
and related objects.</p></li>
<li><p>fix unittest behaviour: TestCase.runtest only called if there are
test methods defined</p></li>
<li><p>improve trial support: don’t collect its empty
unittest.TestCase.runTest() method</p></li>
<li><p>“python setup.py test” now works with pytest itself</p></li>
<li><p>fix/improve internal/packaging related bits:</p>
<ul>
<li><p>exception message check of test_nose.py now passes on python33 as well</p></li>
<li><p>issue206 - fix test_assertrewrite.py to work when a global
PYTHONDONTWRITEBYTECODE=1 is present</p></li>
<li><p>add tox.ini to pytest distribution so that ignore-dirs and others config
bits are properly distributed for maintainers who run pytest-own tests</p></li>
</ul>
</li>
</ul>
</section>
<section id="id768">
<h2>2.3.1 (2012-10-20)<a class="headerlink" href="#id768" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>fix issue202 - fix regression: using “self” from fixture functions now
works as expected (it’s the same “self” instance that a test method
which uses the fixture sees)</p></li>
<li><p>skip pexpect using tests (test_pdb.py mostly) on freebsd* systems
due to pexpect not supporting it properly (hanging)</p></li>
<li><p>link to web pages from –markers output which provides help for
pytest.mark.* usage.</p></li>
</ul>
</section>
<section id="id769">
<h2>2.3.0 (2012-10-19)<a class="headerlink" href="#id769" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>fix issue202 - better automatic names for parametrized test functions</p></li>
<li><p>fix issue139 - introduce &#64;pytest.fixture which allows direct scoping
and parametrization of funcarg factories.</p></li>
<li><p>fix issue198 - conftest fixtures were not found on windows32 in some
circumstances with nested directory structures due to path manipulation issues</p></li>
<li><p>fix issue193 skip test functions with were parametrized with empty
parameter sets</p></li>
<li><p>fix python3.3 compat, mostly reporting bits that previously depended
on dict ordering</p></li>
<li><p>introduce re-ordering of tests by resource and parametrization setup
which takes precedence to the usual file-ordering</p></li>
<li><p>fix issue185 monkeypatching time.time does not cause pytest to fail</p></li>
<li><p>fix issue172 duplicate call of pytest.fixture decoratored setup_module
functions</p></li>
<li><p>fix junitxml=path construction so that if tests change the
current working directory and the path is a relative path
it is constructed correctly from the original current working dir.</p></li>
<li><p>fix “python setup.py test” example to cause a proper “errno” return</p></li>
<li><p>fix issue165 - fix broken doc links and mention stackoverflow for FAQ</p></li>
<li><p>catch unicode-issues when writing failure representations
to terminal to prevent the whole session from crashing</p></li>
<li><p>fix xfail/skip confusion: a skip-mark or an imperative pytest.skip
will now take precedence before xfail-markers because we
can’t determine xfail/xpass status in case of a skip. see also:
<a class="reference external" href="http://stackoverflow.com/questions/11105828/in-py-test-when-i-explicitly-skip-a-test-that-is-marked-as-xfail-how-can-i-get">http://stackoverflow.com/questions/11105828/in-py-test-when-i-explicitly-skip-a-test-that-is-marked-as-xfail-how-can-i-get</a></p></li>
<li><p>always report installed 3rd party plugins in the header of a test run</p></li>
<li><p>fix issue160: a failing setup of an xfail-marked tests should
be reported as xfail (not xpass)</p></li>
<li><p>fix issue128: show captured output when capsys/capfd are used</p></li>
<li><p>fix issue179: properly show the dependency chain of factories</p></li>
<li><p>pluginmanager.register(…) now raises ValueError if the
plugin has been already registered or the name is taken</p></li>
<li><p>fix issue159: improve <a class="reference external" href="https://docs.pytest.org/en/6.0.1/faq.html">https://docs.pytest.org/en/6.0.1/faq.html</a>
especially with respect to the “magic” history, also mention
pytest-django, trial and unittest integration.</p></li>
<li><p>make request.keywords and node.keywords writable.  All descendant
collection nodes will see keyword values.  Keywords are dictionaries
containing markers and other info.</p></li>
<li><p>fix issue 178: xml binary escapes are now wrapped in py.xml.raw</p></li>
<li><p>fix issue 176: correctly catch the builtin AssertionError
even when we replaced AssertionError with a subclass on the
python level</p></li>
<li><p>factory discovery no longer fails with magic global callables
that provide no sane __code__ object (mock.call for example)</p></li>
<li><p>fix issue 182: testdir.inprocess_run now considers passed plugins</p></li>
<li><dl class="simple">
<dt>fix issue 188: ensure sys.exc_info is clear on python2</dt><dd><p>before calling into a test</p>
</dd>
</dl>
</li>
<li><p>fix issue 191: add unittest TestCase runTest method support</p></li>
<li><p>fix issue 156: monkeypatch correctly handles class level descriptors</p></li>
<li><p>reporting refinements:</p>
<ul>
<li><p>pytest_report_header now receives a “startdir” so that
you can use startdir.bestrelpath(yourpath) to show
nice relative path</p></li>
<li><p>allow plugins to implement both pytest_report_header and
pytest_sessionstart (sessionstart is invoked first).</p></li>
<li><p>don’t show deselected reason line if there is none</p></li>
<li><p>py.test -vv will show all of assert comparisons instead of truncating</p></li>
</ul>
</li>
</ul>
</section>
<section id="id770">
<h2>2.2.4 (2012-05-22)<a class="headerlink" href="#id770" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>fix error message for rewritten assertions involving the % operator</p></li>
<li><p>fix issue 126: correctly match all invalid xml characters for junitxml
binary escape</p></li>
<li><p>fix issue with unittest: now &#64;unittest.expectedFailure markers should
be processed correctly (you can also use &#64;pytest.mark markers)</p></li>
<li><p>document integration with the extended distribute/setuptools test commands</p></li>
<li><p>fix issue 140: properly get the real functions
of bound classmethods for setup/teardown_class</p></li>
<li><p>fix issue #141: switch from the deceased paste.pocoo.org to bpaste.net</p></li>
<li><p>fix issue #143: call unconfigure/sessionfinish always when
configure/sessionstart where called</p></li>
<li><p>fix issue #144: better mangle test ids to junitxml classnames</p></li>
<li><p>upgrade distribute_setup.py to 0.6.27</p></li>
</ul>
</section>
<section id="id771">
<h2>2.2.3 (2012-02-05)<a class="headerlink" href="#id771" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>fix uploaded package to only include necessary files</p></li>
</ul>
</section>
<section id="id772">
<h2>2.2.2 (2012-02-05)<a class="headerlink" href="#id772" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>fix issue101: wrong args to unittest.TestCase test function now
produce better output</p></li>
<li><p>fix issue102: report more useful errors and hints for when a
test directory was renamed and some pyc/__pycache__ remain</p></li>
<li><p>fix issue106: allow parametrize to be applied multiple times
e.g. from module, class and at function level.</p></li>
<li><p>fix issue107: actually perform session scope finalization</p></li>
<li><p>don’t check in parametrize if indirect parameters are funcarg names</p></li>
<li><p>add chdir method to monkeypatch funcarg</p></li>
<li><p>fix crash resulting from calling monkeypatch undo a second time</p></li>
<li><p>fix issue115: make –collectonly robust against early failure
(missing files/directories)</p></li>
<li><p>“-qq –collectonly” now shows only files and the number of tests in them</p></li>
<li><p>“-q –collectonly” now shows test ids</p></li>
<li><p>allow adding of attributes to test reports such that it also works
with distributed testing (no upgrade of pytest-xdist needed)</p></li>
</ul>
</section>
<section id="id773">
<h2>2.2.1 (2011-12-16)<a class="headerlink" href="#id773" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>fix issue99 (in pytest and py) internallerrors with resultlog now
produce better output - fixed by normalizing pytest_internalerror
input arguments.</p></li>
<li><p>fix issue97 / traceback issues (in pytest and py) improve traceback output
in conjunction with jinja2 and cython which hack tracebacks</p></li>
<li><p>fix issue93 (in pytest and pytest-xdist) avoid “delayed teardowns”:
the final test in a test node will now run its teardown directly
instead of waiting for the end of the session. Thanks Dave Hunt for
the good reporting and feedback.  The pytest_runtest_protocol as well
as the pytest_runtest_teardown hooks now have “nextitem” available
which will be None indicating the end of the test run.</p></li>
<li><p>fix collection crash due to unknown-source collected items, thanks
to Ralf Schmitt (fixed by depending on a more recent pylib)</p></li>
</ul>
</section>
<section id="id774">
<h2>2.2.0 (2011-11-18)<a class="headerlink" href="#id774" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>fix issue90: introduce eager tearing down of test items so that
teardown function are called earlier.</p></li>
<li><p>add an all-powerful metafunc.parametrize function which allows to
parametrize test function arguments in multiple steps and therefore
from independent plugins and places.</p></li>
<li><p>add a &#64;pytest.mark.parametrize helper which allows to easily
call a test function with different argument values</p></li>
<li><p>Add examples to the “parametrize” example page, including a quick port
of Test scenarios and the new parametrize function and decorator.</p></li>
<li><p>introduce registration for “pytest.mark.*” helpers via ini-files
or through plugin hooks.  Also introduce a “–strict” option which
will treat unregistered markers as errors
allowing to avoid typos and maintain a well described set of markers
for your test suite.  See examples at <a class="reference external" href="http://pytest.org/en/stable/how-to/mark.html">http://pytest.org/en/stable/how-to/mark.html</a>
and its links.</p></li>
<li><p>issue50: introduce “-m marker” option to select tests based on markers
(this is a stricter and more predictable version of ‘-k’ in that “-m”
only matches complete markers and has more obvious rules for and/or
semantics.</p></li>
<li><p>new feature to help optimizing the speed of your tests:
–durations=N option for displaying N slowest test calls
and setup/teardown methods.</p></li>
<li><p>fix issue87: –pastebin now works with python3</p></li>
<li><p>fix issue89: –pdb with unexpected exceptions in doctest work more sensibly</p></li>
<li><p>fix and cleanup pytest’s own test suite to not leak FDs</p></li>
<li><p>fix issue83: link to generated funcarg list</p></li>
<li><p>fix issue74: pyarg module names are now checked against imp.find_module false positives</p></li>
<li><p>fix compatibility with twisted/trial-11.1.0 use cases</p></li>
<li><p>simplify Node.listchain</p></li>
<li><p>simplify junitxml output code by relying on py.xml</p></li>
<li><p>add support for skip properties on unittest classes and functions</p></li>
</ul>
</section>
<section id="id775">
<h2>2.1.3 (2011-10-18)<a class="headerlink" href="#id775" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>fix issue79: assertion rewriting failed on some comparisons in boolops</p></li>
<li><p>correctly handle zero length arguments (a la pytest ‘’)</p></li>
<li><p>fix issue67 / junitxml now contains correct test durations, thanks ronny</p></li>
<li><p>fix issue75 / skipping test failure on jython</p></li>
<li><p>fix issue77 / Allow assertrepr_compare hook to apply to a subset of tests</p></li>
</ul>
</section>
<section id="id776">
<h2>2.1.2 (2011-09-24)<a class="headerlink" href="#id776" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>fix assertion rewriting on files with windows newlines on some Python versions</p></li>
<li><p>refine test discovery by package/module name (–pyargs), thanks Florian Mayer</p></li>
<li><p>fix issue69 / assertion rewriting fixed on some boolean operations</p></li>
<li><p>fix issue68 / packages now work with assertion rewriting</p></li>
<li><p>fix issue66: use different assertion rewriting caches when the -O option is passed</p></li>
<li><p>don’t try assertion rewriting on Jython, use reinterp</p></li>
</ul>
</section>
<section id="id777">
<h2>2.1.1<a class="headerlink" href="#id777" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>fix issue64 / pytest.set_trace now works within pytest_generate_tests hooks</p></li>
<li><p>fix issue60 / fix error conditions involving the creation of __pycache__</p></li>
<li><p>fix issue63 / assertion rewriting on inserts involving strings containing ‘%’</p></li>
<li><p>fix assertion rewriting on calls with a ** arg</p></li>
<li><p>don’t cache rewritten modules if bytecode generation is disabled</p></li>
<li><p>fix assertion rewriting in read-only directories</p></li>
<li><p>fix issue59: provide system-out/err tags for junitxml output</p></li>
<li><p>fix issue61: assertion rewriting on boolean operations with 3 or more operands</p></li>
<li><p>you can now build a man page with “cd doc ; make man”</p></li>
</ul>
</section>
<section id="id778">
<h2>2.1.0 (2011-07-09)<a class="headerlink" href="#id778" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>fix issue53 call nosestyle setup functions with correct ordering</p></li>
<li><p>fix issue58 and issue59: new assertion code fixes</p></li>
<li><p>merge Benjamin’s assertionrewrite branch: now assertions
for test modules on python 2.6 and above are done by rewriting
the AST and saving the pyc file before the test module is imported.
see doc/assert.txt for more info.</p></li>
<li><p>fix issue43: improve doctests with better traceback reporting on
unexpected exceptions</p></li>
<li><p>fix issue47: timing output in junitxml for test cases is now correct</p></li>
<li><p>fix issue48: typo in MarkInfo repr leading to exception</p></li>
<li><p>fix issue49: avoid confusing error when initialization partially fails</p></li>
<li><p>fix issue44: env/username expansion for junitxml file path</p></li>
<li><p>show releaselevel information in test runs for pypy</p></li>
<li><p>reworked doc pages for better navigation and PDF generation</p></li>
<li><p>report KeyboardInterrupt even if interrupted during session startup</p></li>
<li><p>fix issue 35 - provide PDF doc version and download link from index page</p></li>
</ul>
</section>
<section id="id779">
<h2>2.0.3 (2011-05-11)<a class="headerlink" href="#id779" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>fix issue38: nicer tracebacks on calls to hooks, particularly early
configure/sessionstart ones</p></li>
<li><p>fix missing skip reason/meta information in junitxml files, reported
via <a class="reference external" href="http://lists.idyll.org/pipermail/testing-in-python/2011-March/003928.html">http://lists.idyll.org/pipermail/testing-in-python/2011-March/003928.html</a></p></li>
<li><p>fix issue34: avoid collection failure with “test” prefixed classes
deriving from object.</p></li>
<li><p>don’t require zlib (and other libs) for genscript plugin without
–genscript actually being used.</p></li>
<li><p>speed up skips (by not doing a full traceback representation
internally)</p></li>
<li><p>fix issue37: avoid invalid characters in junitxml’s output</p></li>
</ul>
</section>
<section id="id780">
<h2>2.0.2 (2011-03-09)<a class="headerlink" href="#id780" title="Link to this heading">¶</a></h2>
<ul>
<li><p>tackle issue32 - speed up test runs of very quick test functions
by reducing the relative overhead</p></li>
<li><p>fix issue30 - extended xfail/skipif handling and improved reporting.
If you have a syntax error in your skip/xfail
expressions you now get nice error reports.</p>
<p>Also you can now access module globals from xfail/skipif
expressions so that this for example works now:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pytest</span>
<span class="kn">import</span> <span class="nn">mymodule</span>
<span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">skipif</span><span class="p">(</span><span class="s2">&quot;mymodule.__version__[0] == &quot;</span><span class="mi">1</span><span class="s2">&quot;)</span>
<span class="k">def</span> <span class="nf">test_function</span><span class="p">():</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>This will not run the test function if the module’s version string
does not start with a “1”.  Note that specifying a string instead
of a boolean expressions allows py.test to report meaningful information
when summarizing a test run as to what conditions lead to skipping
(or xfail-ing) tests.</p>
</li>
<li><p>fix issue28 - setup_method and pytest_generate_tests work together
The setup_method fixture method now gets called also for
test function invocations generated from the pytest_generate_tests
hook.</p></li>
<li><p>fix issue27 - collectonly and keyword-selection (-k) now work together
Also, if you do “py.test –collectonly -q” you now get a flat list
of test ids that you can use to paste to the py.test commandline
in order to execute a particular test.</p></li>
<li><p>fix issue25 avoid reported problems with –pdb and python3.2/encodings output</p></li>
<li><p>fix issue23 - tmpdir argument now works on Python3.2 and WindowsXP
Starting with Python3.2 os.symlink may be supported. By requiring
a newer py lib version the py.path.local() implementation acknowledges
this.</p></li>
<li><p>fixed typos in the docs (thanks Victor Garcia, Brianna Laugher) and particular
thanks to Laura Creighton who also reviewed parts of the documentation.</p></li>
<li><p>fix slightly wrong output of verbose progress reporting for classes
(thanks Amaury)</p></li>
<li><p>more precise (avoiding of) deprecation warnings for node.Class|Function accesses</p></li>
<li><p>avoid std unittest assertion helper code in tracebacks (thanks Ronny)</p></li>
</ul>
</section>
<section id="id781">
<h2>2.0.1 (2011-02-07)<a class="headerlink" href="#id781" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>refine and unify initial capturing so that it works nicely
even if the logging module is used on an early-loaded conftest.py
file or plugin.</p></li>
<li><p>allow to omit “()” in test ids to allow for uniform test ids
as produced by Alfredo’s nice pytest.vim plugin.</p></li>
<li><p>fix issue12 - show plugin versions with “–version” and
“–traceconfig” and also document how to add extra information
to reporting test header</p></li>
<li><p>fix issue17 (import-* reporting issue on python3) by
requiring py&gt;1.4.0 (1.4.1 is going to include it)</p></li>
<li><p>fix issue10 (numpy arrays truth checking) by refining
assertion interpretation in py lib</p></li>
<li><p>fix issue15: make nose compatibility tests compatible
with python3 (now that nose-1.0 supports python3)</p></li>
<li><p>remove somewhat surprising “same-conftest” detection because
it ignores conftest.py when they appear in several subdirs.</p></li>
<li><p>improve assertions (“not in”), thanks Floris Bruynooghe</p></li>
<li><p>improve behaviour/warnings when running on top of “python -OO”
(assertions and docstrings are turned off, leading to potential
false positives)</p></li>
<li><p>introduce a pytest_cmdline_processargs(args) hook
to allow dynamic computation of command line arguments.
This fixes a regression because py.test prior to 2.0
allowed to set command line options from conftest.py
files which so far pytest-2.0 only allowed from ini-files now.</p></li>
<li><p>fix issue7: assert failures in doctest modules.
unexpected failures in doctests will not generally
show nicer, i.e. within the doctest failing context.</p></li>
<li><p>fix issue9: setup/teardown functions for an xfail-marked
test will report as xfail if they fail but report as normally
passing (not xpassing) if they succeed.  This only is true
for “direct” setup/teardown invocations because teardown_class/
teardown_module cannot closely relate to a single test.</p></li>
<li><p>fix issue14: no logging errors at process exit</p></li>
<li><p>refinements to “collecting” output on non-ttys</p></li>
<li><p>refine internal plugin registration and –traceconfig output</p></li>
<li><p>introduce a mechanism to prevent/unregister plugins from the
command line, see <a class="reference external" href="http://pytest.org/en/stable/how-to/plugins.html#cmdunregister">http://pytest.org/en/stable/how-to/plugins.html#cmdunregister</a></p></li>
<li><p>activate resultlog plugin by default</p></li>
<li><p>fix regression wrt yielded tests which due to the
collection-before-running semantics were not
setup as with pytest 1.3.4.  Note, however, that
the recommended and much cleaner way to do test
parameterization remains the “pytest_generate_tests”
mechanism, see the docs.</p></li>
</ul>
</section>
<section id="id782">
<h2>2.0.0 (2010-11-25)<a class="headerlink" href="#id782" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>pytest-2.0 is now its own package and depends on pylib-2.0</p></li>
<li><p>new ability: python -m pytest / python -m pytest.main ability</p></li>
<li><p>new python invocation: pytest.main(args, plugins) to load
some custom plugins early.</p></li>
<li><p>try harder to run unittest test suites in a more compatible manner
by deferring setup/teardown semantics to the unittest package.
also work harder to run twisted/trial and Django tests which
should now basically work by default.</p></li>
<li><p>introduce a new way to set config options via ini-style files,
by default setup.cfg and tox.ini files are searched.  The old
ways (certain environment variables, dynamic conftest.py reading
is removed).</p></li>
<li><p>add a new “-q” option which decreases verbosity and prints a more
nose/unittest-style “dot” output.</p></li>
<li><p>fix issue135 - marks now work with unittest test cases as well</p></li>
<li><p>fix issue126 - introduce py.test.set_trace() to trace execution via
PDB during the running of tests even if capturing is ongoing.</p></li>
<li><p>fix issue123 - new “python -m py.test” invocation for py.test
(requires Python 2.5 or above)</p></li>
<li><p>fix issue124 - make reporting more resilient against tests opening
files on filedescriptor 1 (stdout).</p></li>
<li><p>fix issue109 - sibling conftest.py files will not be loaded.
(and Directory collectors cannot be customized anymore from a Directory’s
conftest.py - this needs to happen at least one level up).</p></li>
<li><p>introduce (customizable) assertion failure representations and enhance
output on assertion failures for comparisons and other cases (Floris Bruynooghe)</p></li>
<li><p>nose-plugin: pass through type-signature failures in setup/teardown
functions instead of not calling them (Ed Singleton)</p></li>
<li><p>remove py.test.collect.Directory (follows from a major refactoring
and simplification of the collection process)</p></li>
<li><p>majorly reduce py.test core code, shift function/python testing to own plugin</p></li>
<li><p>fix issue88 (finding custom test nodes from command line arg)</p></li>
<li><p>refine ‘tmpdir’ creation, will now create basenames better associated
with test names (thanks Ronny)</p></li>
<li><p>“xpass” (unexpected pass) tests don’t cause exitcode!=0</p></li>
<li><p>fix issue131 / issue60 - importing doctests in __init__ files used as namespace packages</p></li>
<li><p>fix issue93 stdout/stderr is captured while importing conftest.py</p></li>
<li><p>fix bug: unittest collected functions now also can have “pytestmark”
applied at class/module level</p></li>
<li><p>add ability to use “class” level for cached_setup helper</p></li>
<li><p>fix strangeness: mark.* objects are now immutable, create new instances</p></li>
</ul>
</section>
<section id="id783">
<h2>1.3.4 (2010-09-14)<a class="headerlink" href="#id783" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>fix issue111: improve install documentation for windows</p></li>
<li><p>fix issue119: fix custom collectability of __init__.py as a module</p></li>
<li><p>fix issue116: –doctestmodules work with __init__.py files as well</p></li>
<li><p>fix issue115: unify internal exception passthrough/catching/GeneratorExit</p></li>
<li><p>fix issue118: new –tb=native for presenting cpython-standard exceptions</p></li>
</ul>
</section>
<section id="id784">
<h2>1.3.3 (2010-07-30)<a class="headerlink" href="#id784" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>fix issue113: assertion representation problem with triple-quoted strings
(and possibly other cases)</p></li>
<li><p>make conftest loading detect that a conftest file with the same
content was already loaded, avoids surprises in nested directory structures
which can be produced e.g. by Hudson. It probably removes the need to use
–confcutdir in most cases.</p></li>
<li><p>fix terminal coloring for win32
(thanks Michael Foord for reporting)</p></li>
<li><p>fix weirdness: make terminal width detection work on stdout instead of stdin
(thanks Armin Ronacher for reporting)</p></li>
<li><p>remove trailing whitespace in all py/text distribution files</p></li>
</ul>
</section>
<section id="id785">
<h2>1.3.2 (2010-07-08)<a class="headerlink" href="#id785" title="Link to this heading">¶</a></h2>
<p><strong>New features</strong></p>
<ul>
<li><p>fix issue103:  introduce py.test.raises as context manager, examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">py</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ZeroDivisionError</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="mi">1</span> <span class="o">/</span> <span class="n">x</span>

<span class="k">with</span> <span class="n">py</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">RuntimeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">excinfo</span><span class="p">:</span>
    <span class="n">call_something</span><span class="p">()</span>

<span class="c1"># you may do extra checks on excinfo.value|type|traceback here</span>
</pre></div>
</div>
<p>(thanks Ronny Pfannschmidt)</p>
</li>
<li><p>Funcarg factories can now dynamically apply a marker to a
test invocation.  This is for example useful if a factory
provides parameters to a test which are expected-to-fail:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pytest_funcarg__arg</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">request</span><span class="o">.</span><span class="n">applymarker</span><span class="p">(</span><span class="n">py</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">xfail</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="s2">&quot;flaky config&quot;</span><span class="p">))</span>
    <span class="o">...</span>

<span class="k">def</span> <span class="nf">test_function</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
</li>
<li><p>improved error reporting on collection and import errors. This makes
use of a more general mechanism, namely that for custom test item/collect
nodes <code class="docutils literal notranslate"><span class="pre">node.repr_failure(excinfo)</span></code> is now uniformly called so that you can
override it to return a string error representation of your choice
which is going to be reported as a (red) string.</p></li>
<li><p>introduce ‘–junitprefix=STR’ option to prepend a prefix
to all reports in the junitxml file.</p></li>
</ul>
<p><strong>Bug fixes</strong></p>
<ul class="simple">
<li><p>make tests and the <code class="docutils literal notranslate"><span class="pre">pytest_recwarn</span></code> plugin in particular fully compatible
to Python2.7 (if you use the <code class="docutils literal notranslate"><span class="pre">recwarn</span></code> funcarg warnings will be enabled so that
you can properly check for their existence in a cross-python manner).</p></li>
<li><p>refine –pdb: ignore xfailed tests, unify its TB-reporting and
don’t display failures again at the end.</p></li>
<li><p>fix assertion interpretation with the ** operator (thanks Benjamin Peterson)</p></li>
<li><p>fix issue105 assignment on the same line as a failing assertion (thanks Benjamin Peterson)</p></li>
<li><p>fix issue104 proper escaping for test names in junitxml plugin (thanks anonymous)</p></li>
<li><p>fix issue57 -f|–looponfail to work with xpassing tests (thanks Ronny)</p></li>
<li><p>fix issue92 collectonly reporter and –pastebin (thanks Benjamin Peterson)</p></li>
<li><p>fix py.code.compile(source) to generate unique filenames</p></li>
<li><p>fix assertion re-interp problems on PyPy, by deferring code
compilation to the (overridable) Frame.eval class. (thanks Amaury Forgeot)</p></li>
<li><p>fix py.path.local.pyimport() to work with directories</p></li>
<li><p>streamline py.path.local.mkdtemp implementation and usage</p></li>
<li><p>don’t print empty lines when showing junitxml-filename</p></li>
<li><p>add optional boolean ignore_errors parameter to py.path.local.remove</p></li>
<li><p>fix terminal writing on win32/python2.4</p></li>
<li><p>py.process.cmdexec() now tries harder to return properly encoded unicode objects
on all python versions</p></li>
<li><p>install plain py.test/py.which scripts also for Jython, this helps to
get canonical script paths in virtualenv situations</p></li>
<li><p>make path.bestrelpath(path) return “.”, note that when calling
X.bestrelpath the assumption is that X is a directory.</p></li>
<li><p>make initial conftest discovery ignore “–” prefixed arguments</p></li>
<li><p>fix resultlog plugin when used in a multicpu/multihost xdist situation
(thanks Jakub Gustak)</p></li>
<li><p>perform distributed testing related reporting in the xdist-plugin
rather than having dist-related code in the generic py.test
distribution</p></li>
<li><p>fix homedir detection on Windows</p></li>
<li><p>ship distribute_setup.py version 0.6.13</p></li>
</ul>
</section>
<section id="id786">
<h2>1.3.1 (2010-05-25)<a class="headerlink" href="#id786" title="Link to this heading">¶</a></h2>
<p><strong>New features</strong></p>
<ul>
<li><p>issue91: introduce new py.test.xfail(reason) helper
to imperatively mark a test as expected to fail. Can
be used from within setup and test functions. This is
useful especially for parametrized tests when certain
configurations are expected-to-fail.  In this case the
declarative approach with the &#64;py.test.mark.xfail cannot
be used as it would mark all configurations as xfail.</p></li>
<li><p>issue102: introduce new –maxfail=NUM option to stop
test runs after NUM failures.  This is a generalization
of the ‘-x’ or ‘–exitfirst’ option which is now equivalent
to ‘–maxfail=1’.  Both ‘-x’ and ‘–maxfail’ will
now also print a line near the end indicating the Interruption.</p></li>
<li><p>issue89: allow py.test.mark decorators to be used on classes
(class decorators were introduced with python2.6) and
also allow to have multiple markers applied at class/module level
by specifying a list.</p></li>
<li><p>improve and refine letter reporting in the progress bar:
.  pass
f  failed test
s  skipped tests (reminder: use for dependency/platform mismatch only)
x  xfailed test (test that was expected to fail)
X  xpassed test (test that was expected to fail but passed)</p>
<p>You can use any combination of ‘fsxX’ with the ‘-r’ extended
reporting option. The xfail/xpass results will show up as
skipped tests in the junitxml output - which also fixes
issue99.</p>
</li>
<li><p>make py.test.cmdline.main() return the exitstatus instead of raising
SystemExit and also allow it to be called multiple times.  This of
course requires that your application and tests are properly teared
down and don’t have global state.</p></li>
</ul>
<p><strong>Bug Fixes</strong></p>
<ul class="simple">
<li><p>improved traceback presentation:
- improved and unified reporting for “–tb=short” option
- Errors during test module imports are much shorter, (using –tb=short style)
- raises shows shorter more relevant tracebacks
- –fulltrace now more systematically makes traces longer / inhibits cutting</p></li>
<li><p>improve support for raises and other dynamically compiled code by
manipulating python’s linecache.cache instead of the previous
rather hacky way of creating custom code objects.  This makes
it seamlessly work on Jython and PyPy where it previously didn’t.</p></li>
<li><p>fix issue96: make capturing more resilient against Control-C
interruptions (involved somewhat substantial refactoring
to the underlying capturing functionality to avoid race
conditions).</p></li>
<li><p>fix chaining of conditional skipif/xfail decorators - so it works now
as expected to use multiple &#64;py.test.mark.skipif(condition) decorators,
including specific reporting which of the conditions lead to skipping.</p></li>
<li><p>fix issue95: late-import zlib so that it’s not required
for general py.test startup.</p></li>
<li><p>fix issue94: make reporting more robust against bogus source code
(and internally be more careful when presenting unexpected byte sequences)</p></li>
</ul>
</section>
<section id="id787">
<h2>1.3.0 (2010-05-05)<a class="headerlink" href="#id787" title="Link to this heading">¶</a></h2>
<ul>
<li><p>deprecate –report option in favour of a new shorter and easier to
remember -r option: it takes a string argument consisting of any
combination of ‘xfsX’ characters.  They relate to the single chars
you see during the dotted progress printing and will print an extra line
per test at the end of the test run.  This extra line indicates the exact
position or test ID that you directly paste to the py.test cmdline in order
to re-run a particular test.</p></li>
<li><p>allow external plugins to register new hooks via the new
pytest_addhooks(pluginmanager) hook.  The new release of
the pytest-xdist plugin for distributed and looponfailing
testing requires this feature.</p></li>
<li><p>add a new pytest_ignore_collect(path, config) hook to allow projects and
plugins to define exclusion behaviour for their directory structure -
for example you may define in a conftest.py this method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pytest_ignore_collect</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">path</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">link</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>to prevent even a collection try of any tests in symlinked dirs.</p>
</li>
<li><p>new pytest_pycollect_makemodule(path, parent) hook for
allowing customization of the Module collection object for a
matching test module.</p></li>
<li><p>extend and refine xfail mechanism:
<code class="docutils literal notranslate"><span class="pre">&#64;py.test.mark.xfail(run=False)</span></code> do not run the decorated test
<code class="docutils literal notranslate"><span class="pre">&#64;py.test.mark.xfail(reason=&quot;...&quot;)</span></code> prints the reason string in xfail summaries
specifying <code class="docutils literal notranslate"><span class="pre">--runxfail</span></code> on command line virtually ignores xfail markers</p></li>
<li><p>expose (previously internal) commonly useful methods:
py.io.get_terminal_with() -&gt; return terminal width
py.io.ansi_print(…) -&gt; print colored/bold text on linux/win32
py.io.saferepr(obj) -&gt; return limited representation string</p></li>
<li><p>expose test outcome related exceptions as py.test.skip.Exception,
py.test.raises.Exception etc., useful mostly for plugins
doing special outcome interpretation/tweaking</p></li>
<li><p>(issue85) fix junitxml plugin to handle tests with non-ascii output</p></li>
<li><p>fix/refine python3 compatibility (thanks Benjamin Peterson)</p></li>
<li><p>fixes for making the jython/win32 combination work, note however:
jython2.5.1/win32 does not provide a command line launcher, see
<a class="reference external" href="https://bugs.jython.org/issue1491">https://bugs.jython.org/issue1491</a> . See pylib install documentation
for how to work around.</p></li>
<li><p>fixes for handling of unicode exception values and unprintable objects</p></li>
<li><p>(issue87) fix unboundlocal error in assertionold code</p></li>
<li><p>(issue86) improve documentation for looponfailing</p></li>
<li><p>refine IO capturing: stdin-redirect pseudo-file now has a NOP close() method</p></li>
<li><p>ship distribute_setup.py version 0.6.10</p></li>
<li><p>added links to the new capturelog and coverage plugins</p></li>
</ul>
</section>
<section id="id788">
<h2>1.2.0 (2010-01-18)<a class="headerlink" href="#id788" title="Link to this heading">¶</a></h2>
<ul>
<li><p>refined usage and options for “py.cleanup”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">py</span><span class="o">.</span><span class="n">cleanup</span>     <span class="c1"># remove &quot;*.pyc&quot; and &quot;*$py.class&quot; (jython) files</span>
<span class="n">py</span><span class="o">.</span><span class="n">cleanup</span> <span class="o">-</span><span class="n">e</span> <span class="o">.</span><span class="n">swp</span> <span class="o">-</span><span class="n">e</span> <span class="o">.</span><span class="n">cache</span> <span class="c1"># also remove files with these extensions</span>
<span class="n">py</span><span class="o">.</span><span class="n">cleanup</span> <span class="o">-</span><span class="n">s</span>  <span class="c1"># remove &quot;build&quot; and &quot;dist&quot; directory next to setup.py files</span>
<span class="n">py</span><span class="o">.</span><span class="n">cleanup</span> <span class="o">-</span><span class="n">d</span>  <span class="c1"># also remove empty directories</span>
<span class="n">py</span><span class="o">.</span><span class="n">cleanup</span> <span class="o">-</span><span class="n">a</span>  <span class="c1"># synonym for &quot;-s -d -e &#39;pip-log.txt&#39;&quot;</span>
<span class="n">py</span><span class="o">.</span><span class="n">cleanup</span> <span class="o">-</span><span class="n">n</span>  <span class="c1"># dry run, only show what would be removed</span>
</pre></div>
</div>
</li>
<li><p>add a new option “py.test –funcargs” which shows available funcargs
and their help strings (docstrings on their respective factory function)
for a given test path</p></li>
<li><p>display a short and concise traceback if a funcarg lookup fails</p></li>
<li><p>early-load “conftest.py” files in non-dot first-level sub directories.
allows to conveniently keep and access test-related options in a <code class="docutils literal notranslate"><span class="pre">test</span></code>
subdir and still add command line options.</p></li>
<li><p>fix issue67: new super-short traceback-printing option: “–tb=line” will print a single line for each failing (python) test indicating its filename, lineno and the failure value</p></li>
<li><p>fix issue78: always call python-level teardown functions even if the
according setup failed.  This includes refinements for calling setup_module/class functions
which will now only be called once instead of the previous behaviour where they’d be called
multiple times if they raise an exception (including a Skipped exception).  Any exception
will be re-corded and associated with all tests in the according module/class scope.</p></li>
<li><p>fix issue63: assume &lt;40 columns to be a bogus terminal width, default to 80</p></li>
<li><p>fix pdb debugging to be in the correct frame on raises-related errors</p></li>
<li><p>update apipkg.py to fix an issue where recursive imports might
unnecessarily break importing</p></li>
<li><p>fix plugin links</p></li>
</ul>
</section>
<section id="id789">
<h2>1.1.1 (2009-11-24)<a class="headerlink" href="#id789" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>moved dist/looponfailing from py.test core into a new
separately released pytest-xdist plugin.</p></li>
<li><p>new junitxml plugin: –junitxml=path will generate a junit style xml file
which is processable e.g. by the Hudson CI system.</p></li>
<li><p>new option: –genscript=path will generate a standalone py.test script
which will not need any libraries installed.  thanks to Ralf Schmitt.</p></li>
<li><p>new option: –ignore will prevent specified path from collection.
Can be specified multiple times.</p></li>
<li><p>new option: –confcutdir=dir will make py.test only consider conftest
files that are relative to the specified dir.</p></li>
<li><p>new funcarg: “pytestconfig” is the pytest config object for access
to command line args and can now be easily used in a test.</p></li>
<li><p>install <code class="docutils literal notranslate"><span class="pre">py.test</span></code> and <code class="docutils literal notranslate"><span class="pre">py.which</span></code> with a <code class="docutils literal notranslate"><span class="pre">-$VERSION</span></code> suffix to
disambiguate between Python3, python2.X, Jython and PyPy installed versions.</p></li>
<li><p>new “pytestconfig” funcarg allows access to test config object</p></li>
<li><p>new “pytest_report_header” hook can return additional lines
to be displayed at the header of a test run.</p></li>
<li><p>(experimental) allow “py.test path::name1::name2::…” for pointing
to a test within a test collection directly.  This might eventually
evolve as a full substitute to “-k” specifications.</p></li>
<li><p>streamlined plugin loading: order is now as documented in
customize.html: setuptools, ENV, commandline, conftest.
also setuptools entry point names are turned to canonical names (“pytest_*”)</p></li>
<li><p>automatically skip tests that need ‘capfd’ but have no os.dup</p></li>
<li><p>allow pytest_generate_tests to be defined in classes as well</p></li>
<li><p>deprecate usage of ‘disabled’ attribute in favour of pytestmark</p></li>
<li><p>deprecate definition of Directory, Module, Class and Function nodes
in conftest.py files.  Use pytest collect hooks instead.</p></li>
<li><p>collection/item node specific runtest/collect hooks are only called exactly
on matching conftest.py files, i.e. ones which are exactly below
the filesystem path of an item</p></li>
<li><p>change: the first pytest_collect_directory hook to return something
will now prevent further hooks to be called.</p></li>
<li><p>change: figleaf plugin now requires –figleaf to run.  Also
change its long command line options to be a bit shorter (see py.test -h).</p></li>
<li><p>change: pytest doctest plugin is now enabled by default and has a
new option –doctest-glob to set a pattern for file matches.</p></li>
<li><p>change: remove internal py._* helper vars, only keep py._pydir</p></li>
<li><p>robustify capturing to survive if custom pytest_runtest_setup
code failed and prevented the capturing setup code from running.</p></li>
<li><p>make py.test.* helpers provided by default plugins visible early -
works transparently both for pydoc and for interactive sessions
which will regularly see e.g. py.test.mark and py.test.importorskip.</p></li>
<li><p>simplify internal plugin manager machinery</p></li>
<li><p>simplify internal collection tree by introducing a RootCollector node</p></li>
<li><p>fix assert reinterpreation that sees a call containing “keyword=…”</p></li>
<li><p>fix issue66: invoke pytest_sessionstart and pytest_sessionfinish
hooks on worker nodes during dist-testing, report module/session teardown
hooks correctly.</p></li>
<li><p>fix issue65: properly handle dist-testing if no
execnet/py lib installed remotely.</p></li>
<li><p>skip some install-tests if no execnet is available</p></li>
<li><p>fix docs, fix internal bin/ script generation</p></li>
</ul>
</section>
<section id="id790">
<h2>1.1.0 (2009-11-05)<a class="headerlink" href="#id790" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>introduce automatic plugin registration via ‘pytest11’
entrypoints via setuptools’ pkg_resources.iter_entry_points</p></li>
<li><p>fix py.test dist-testing to work with execnet &gt;= 1.0.0b4</p></li>
<li><p>re-introduce py.test.cmdline.main() for better backward compatibility</p></li>
<li><p>svn paths: fix a bug with path.check(versioned=True) for svn paths,
allow ‘%’ in svn paths, make svnwc.update() default to interactive mode
like in 1.0.x and add svnwc.update(interactive=False) to inhibit interaction.</p></li>
<li><p>refine distributed tarball to contain test and no pyc files</p></li>
<li><p>try harder to have deprecation warnings for py.compat.* accesses
report a correct location</p></li>
</ul>
</section>
<section id="id791">
<h2>1.0.3<a class="headerlink" href="#id791" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>adjust and improve docs</p></li>
<li><p>remove py.rest tool and internal namespace - it was
never really advertised and can still be used with
the old release if needed.  If there is interest
it could be revived into its own tool i guess.</p></li>
<li><p>fix issue48 and issue59: raise an Error if the module
from an imported test file does not seem to come from
the filepath - avoids “same-name” confusion that has
been reported repeatedly</p></li>
<li><p>merged Ronny’s nose-compatibility hacks: now
nose-style setup_module() and setup() functions are
supported</p></li>
<li><p>introduce generalized py.test.mark function marking</p></li>
<li><p>reshuffle / refine command line grouping</p></li>
<li><p>deprecate parser.addgroup in favour of getgroup which creates option group</p></li>
<li><p>add –report command line option that allows to control showing of skipped/xfailed sections</p></li>
<li><p>generalized skipping: a new way to mark python functions with skipif or xfail
at function, class and modules level based on platform or sys-module attributes.</p></li>
<li><p>extend py.test.mark decorator to allow for positional args</p></li>
<li><p>introduce and test “py.cleanup -d” to remove empty directories</p></li>
<li><p>fix issue #59 - robustify unittest test collection</p></li>
<li><p>make bpython/help interaction work by adding an __all__ attribute
to ApiModule, cleanup initpkg</p></li>
<li><p>use MIT license for pylib, add some contributors</p></li>
<li><p>remove py.execnet code and substitute all usages with ‘execnet’ proper</p></li>
<li><p>fix issue50 - cached_setup now caches more to expectations
for test functions with multiple arguments.</p></li>
<li><p>merge Jarko’s fixes, issue #45 and #46</p></li>
<li><p>add the ability to specify a path for py.lookup to search in</p></li>
<li><p>fix a funcarg cached_setup bug probably only occurring
in distributed testing and “module” scope with teardown.</p></li>
<li><p>many fixes and changes for making the code base python3 compatible,
many thanks to Benjamin Peterson for helping with this.</p></li>
<li><p>consolidate builtins implementation to be compatible with &gt;=2.3,
add helpers to ease keeping 2 and 3k compatible code</p></li>
<li><p>deprecate py.compat.doctest|subprocess|textwrap|optparse</p></li>
<li><p>deprecate py.magic.autopath, remove py/magic directory</p></li>
<li><p>move pytest assertion handling to py/code and a pytest_assertion
plugin, add “–no-assert” option, deprecate py.magic namespaces
in favour of (less) py.code ones.</p></li>
<li><p>consolidate and cleanup py/code classes and files</p></li>
<li><p>cleanup py/misc, move tests to bin-for-dist</p></li>
<li><p>introduce delattr/delitem/delenv methods to py.test’s monkeypatch funcarg</p></li>
<li><p>consolidate py.log implementation, remove old approach.</p></li>
<li><p>introduce py.io.TextIO and py.io.BytesIO for distinguishing between
text/unicode and byte-streams (uses underlying standard lib io.*
if available)</p></li>
<li><p>make py.unittest_convert helper script available which converts “unittest.py”
style files into the simpler assert/direct-test-classes py.test/nosetests
style.  The script was written by Laura Creighton.</p></li>
<li><p>simplified internal localpath implementation</p></li>
</ul>
</section>
<section id="id792">
<h2>1.0.2 (2009-08-27)<a class="headerlink" href="#id792" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>fixing packaging issues, triggered by fedora redhat packaging,
also added doc, examples and contrib dirs to the tarball.</p></li>
<li><p>added a documentation link to the new django plugin.</p></li>
</ul>
</section>
<section id="id793">
<h2>1.0.1 (2009-08-19)<a class="headerlink" href="#id793" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>added a ‘pytest_nose’ plugin which handles nose.SkipTest,
nose-style function/method/generator setup/teardown and
tries to report functions correctly.</p></li>
<li><p>capturing of unicode writes or encoded strings to sys.stdout/err
work better, also terminalwriting was adapted and somewhat
unified between windows and linux.</p></li>
<li><p>improved documentation layout and content a lot</p></li>
<li><p>added a “–help-config” option to show conftest.py / ENV-var names for
all longopt cmdline options, and some special conftest.py variables.
renamed ‘conf_capture’ conftest setting to ‘option_capture’ accordingly.</p></li>
<li><p>fix issue #27: better reporting on non-collectable items given on commandline
(e.g. pyc files)</p></li>
<li><p>fix issue #33: added –version flag (thanks Benjamin Peterson)</p></li>
<li><p>fix issue #32: adding support for “incomplete” paths to wcpath.status()</p></li>
<li><p>“Test” prefixed classes are <em>not</em> collected by default anymore if they
have an __init__ method</p></li>
<li><p>monkeypatch setenv() now accepts a “prepend” parameter</p></li>
<li><p>improved reporting of collection error tracebacks</p></li>
<li><p>simplified multicall mechanism and plugin architecture,
renamed some internal methods and argnames</p></li>
</ul>
</section>
<section id="id794">
<h2>1.0.0 (2009-08-04)<a class="headerlink" href="#id794" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>more terse reporting try to show filesystem path relatively to current dir</p></li>
<li><p>improve xfail output a bit</p></li>
</ul>
</section>
<section id="b9-2009-07-31">
<h2>1.0.0b9 (2009-07-31)<a class="headerlink" href="#b9-2009-07-31" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>cleanly handle and report final teardown of test setup</p></li>
<li><p>fix svn-1.6 compat issue with py.path.svnwc().versioned()
(thanks Wouter Vanden Hove)</p></li>
<li><p>setup/teardown or collection problems now show as ERRORs
or with big “E“‘s in the progress lines.  they are reported
and counted separately.</p></li>
<li><p>dist-testing: properly handle test items that get locally
collected but cannot be collected on the remote side - often
due to platform/dependency reasons</p></li>
<li><p>simplified py.test.mark API - see keyword plugin documentation</p></li>
<li><p>integrate better with logging: capturing now by default captures
test functions and their immediate setup/teardown in a single stream</p></li>
<li><p>capsys and capfd funcargs now have a readouterr() and a close() method
(underlyingly py.io.StdCapture/FD objects are used which grew a
readouterr() method as well to return snapshots of captured out/err)</p></li>
<li><p>make assert-reinterpretation work better with comparisons not
returning bools (reported with numpy from thanks maciej fijalkowski)</p></li>
<li><p>reworked per-test output capturing into the pytest_iocapture.py plugin
and thus removed capturing code from config object</p></li>
<li><p>item.repr_failure(excinfo) instead of item.repr_failure(excinfo, outerr)</p></li>
</ul>
</section>
<section id="b8-2009-07-22">
<h2>1.0.0b8 (2009-07-22)<a class="headerlink" href="#b8-2009-07-22" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>pytest_unittest-plugin is now enabled by default</p></li>
<li><p>introduced pytest_keyboardinterrupt hook and
refined pytest_sessionfinish hooked, added tests.</p></li>
<li><p>workaround a buggy logging module interaction (“closing already closed
files”).  Thanks to Sridhar Ratnakumar for triggering.</p></li>
<li><p>if plugins use “py.test.importorskip” for importing
a dependency only a warning will be issued instead
of exiting the testing process.</p></li>
<li><p>many improvements to docs:
- refined funcargs doc , use the term “factory” instead of “provider”
- added a new talk/tutorial doc page
- better download page
- better plugin docstrings
- added new plugins page and automatic doc generation script</p></li>
<li><p>fixed teardown problem related to partially failing funcarg setups
(thanks MrTopf for reporting), “pytest_runtest_teardown” is now
always invoked even if the “pytest_runtest_setup” failed.</p></li>
<li><p>tweaked doctest output for docstrings in py modules,
thanks Radomir.</p></li>
</ul>
</section>
<section id="b7">
<h2>1.0.0b7<a class="headerlink" href="#b7" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>renamed py.test.xfail back to py.test.mark.xfail to avoid
two ways to decorate for xfail</p></li>
<li><p>re-added py.test.mark decorator for setting keywords on functions
(it was actually documented so removing it was not nice)</p></li>
<li><p>remove scope-argument from request.addfinalizer() because
request.cached_setup has the scope arg. TOOWTDI.</p></li>
<li><p>perform setup finalization before reporting failures</p></li>
<li><p>apply modified patches from Andreas Kloeckner to allow
test functions to have no func_code (#22) and to make
“-k” and function keywords work  (#20)</p></li>
<li><p>apply patch from Daniel Peolzleithner (issue #23)</p></li>
<li><p>resolve issue #18, multiprocessing.Manager() and
redirection clash</p></li>
<li><p>make __name__ == “__channelexec__” for remote_exec code</p></li>
</ul>
</section>
<section id="b3-2009-06-19">
<h2>1.0.0b3 (2009-06-19)<a class="headerlink" href="#b3-2009-06-19" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>plugin classes are removed: one now defines
hooks directly in conftest.py or global pytest_*.py
files.</p></li>
<li><p>added new pytest_namespace(config) hook that allows
to inject helpers directly to the py.test.* namespace.</p></li>
<li><p>documented and refined many hooks</p></li>
<li><p>added new style of generative tests via
pytest_generate_tests hook that integrates
well with function arguments.</p></li>
</ul>
</section>
<section id="b1">
<h2>1.0.0b1<a class="headerlink" href="#b1" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>introduced new “funcarg” setup method,
see doc/test/funcarg.txt</p></li>
<li><p>introduced plugin architecture and many
new py.test plugins, see
doc/test/plugins.txt</p></li>
<li><p>teardown_method is now guaranteed to get
called after a test method has run.</p></li>
<li><p>new method: py.test.importorskip(mod,minversion)
will either import or call py.test.skip()</p></li>
<li><p>completely revised internal py.test architecture</p></li>
<li><p>new py.process.ForkedFunc object allowing to
fork execution of a function to a sub process
and getting a result back.</p></li>
</ul>
<p>XXX lots of things missing here XXX</p>
</section>
<section id="id795">
<h2>0.9.2<a class="headerlink" href="#id795" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>refined installation and metadata, created new setup.py,
now based on setuptools/ez_setup (thanks to Ralf Schmitt
for his support).</p></li>
<li><p>improved the way of making py.* scripts available in
windows environments, they are now added to the
Scripts directory as “.cmd” files.</p></li>
<li><p>py.path.svnwc.status() now is more complete and
uses xml output from the ‘svn’ command if available
(Guido Wesdorp)</p></li>
<li><p>fix for py.path.svn* to work with svn 1.5
(Chris Lamb)</p></li>
<li><p>fix path.relto(otherpath) method on windows to
use normcase for checking if a path is relative.</p></li>
<li><p>py.test’s traceback is better parseable from editors
(follows the filenames:LINENO: MSG convention)
(thanks to Osmo Salomaa)</p></li>
<li><p>fix to javascript-generation, “py.test –runbrowser”
should work more reliably now</p></li>
<li><p>removed previously accidentally added
py.test.broken and py.test.notimplemented helpers.</p></li>
<li><p>there now is a py.__version__ attribute</p></li>
</ul>
</section>
<section id="id796">
<h2>0.9.1<a class="headerlink" href="#id796" title="Link to this heading">¶</a></h2>
<p>This is a fairly complete list of v0.9.1, which can
serve as a reference for developers.</p>
<ul class="simple">
<li><p>allowing + signs in py.path.svn urls [39106]</p></li>
<li><p>fixed support for Failed exceptions without excinfo in py.test [39340]</p></li>
<li><p>added support for killing processes for Windows (as well as platforms that
support os.kill) in py.misc.killproc [39655]</p></li>
<li><p>added setup/teardown for generative tests to py.test [40702]</p></li>
<li><p>added detection of FAILED TO LOAD MODULE to py.test [40703, 40738, 40739]</p></li>
<li><p>fixed problem with calling .remove() on wcpaths of non-versioned files in
py.path [44248]</p></li>
<li><p>fixed some import and inheritance issues in py.test [41480, 44648, 44655]</p></li>
<li><p>fail to run greenlet tests when pypy is available, but without stackless
[45294]</p></li>
<li><p>small fixes in rsession tests [45295]</p></li>
<li><p>fixed issue with 2.5 type representations in py.test [45483, 45484]</p></li>
<li><p>made that internal reporting issues displaying is done atomically in py.test
[45518]</p></li>
<li><p>made that non-existing files are ignored by the py.lookup script [45519]</p></li>
<li><p>improved exception name creation in py.test [45535]</p></li>
<li><p>made that less threads are used in execnet [merge in 45539]</p></li>
<li><p>removed lock required for atomic reporting issue displaying in py.test
[45545]</p></li>
<li><p>removed globals from execnet [45541, 45547]</p></li>
<li><p>refactored cleanup mechanics, made that setDaemon is set to 1 to make atexit
get called in 2.5 (py.execnet) [45548]</p></li>
<li><p>fixed bug in joining threads in py.execnet’s servemain [45549]</p></li>
<li><p>refactored py.test.rsession tests to not rely on exact output format anymore
[45646]</p></li>
<li><p>using repr() on test outcome [45647]</p></li>
<li><p>added ‘Reason’ classes for py.test.skip() [45648, 45649]</p></li>
<li><p>killed some unnecessary sanity check in py.test.collect [45655]</p></li>
<li><p>avoid using os.tmpfile() in py.io.fdcapture because on Windows it’s only
usable by Administrators [45901]</p></li>
<li><p>added support for locking and non-recursive commits to py.path.svnwc [45994]</p></li>
<li><p>locking files in py.execnet to prevent CPython from segfaulting [46010]</p></li>
<li><p>added export() method to py.path.svnurl</p></li>
<li><p>fixed -d -x in py.test [47277]</p></li>
<li><p>fixed argument concatenation problem in py.path.svnwc [49423]</p></li>
<li><p>restore py.test behaviour that it exits with code 1 when there are failures
[49974]</p></li>
<li><p>don’t fail on html files that don’t have an accompanying .txt file [50606]</p></li>
<li><p>fixed ‘utestconvert.py &lt; input’ [50645]</p></li>
<li><p>small fix for code indentation in py.code.source [50755]</p></li>
<li><p>fix _docgen.py documentation building [51285]</p></li>
<li><p>improved checks for source representation of code blocks in py.test [51292]</p></li>
<li><p>added support for passing authentication to py.path.svn* objects [52000,
52001]</p></li>
<li><p>removed sorted() call for py.apigen tests in favour of [].sort() to support
Python 2.3 [52481]</p></li>
</ul>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="contributing.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">贡献</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="example/customdirectory.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">使用自定义目录收集器</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2015, holger krekel and pytest-dev team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">更改日志</a><ul>
<li><a class="reference internal" href="#to-be-included-in-vrelease-if-present">To be included in v0.1 (if present)</a><ul>
<li><a class="reference internal" href="#pytest-release-unreleased-draft-2024-10-30">pytest 0.1 [UNRELEASED DRAFT] (2024-10-30)</a><ul>
<li><a class="reference internal" href="#new-features">New features</a></li>
<li><a class="reference internal" href="#improvements-in-existing-functionality">Improvements in existing functionality</a></li>
<li><a class="reference internal" href="#bug-fixes">Bug fixes</a></li>
<li><a class="reference internal" href="#improved-documentation">Improved documentation</a></li>
<li><a class="reference internal" href="#contributor-facing-changes">Contributor-facing changes</a></li>
<li><a class="reference internal" href="#miscellaneous-internal-changes">Miscellaneous internal changes</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#released-versions">Released versions</a></li>
<li><a class="reference internal" href="#pytest-8-3-3-2024-09-09">pytest 8.3.3 (2024-09-09)</a><ul>
<li><a class="reference internal" href="#bug">bug修复</a></li>
<li><a class="reference internal" href="#id35">改进的文档</a></li>
<li><a class="reference internal" href="#id40">Miscellaneous internal changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-8-3-2-2024-07-24">pytest 8.3.2 (2024-07-24)</a><ul>
<li><a class="reference internal" href="#id43">Bug fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-8-3-1-2024-07-20">pytest 8.3.1 (2024-07-20)</a></li>
<li><a class="reference internal" href="#pytest-8-3-0-2024-07-20">pytest 8.3.0 (2024-07-20)</a><ul>
<li><a class="reference internal" href="#id45">New features</a></li>
<li><a class="reference internal" href="#id49">Improvements in existing functionality</a></li>
<li><a class="reference internal" href="#id56">Bug fixes</a></li>
<li><a class="reference internal" href="#id69">Improved documentation</a></li>
<li><a class="reference internal" href="#id73">Contributor-facing changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-8-2-2-2024-06-04">pytest 8.2.2 (2024-06-04)</a><ul>
<li><a class="reference internal" href="#id85">Bug Fixes</a></li>
<li><a class="reference internal" href="#id89">Improved Documentation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-8-2-1-2024-05-19">pytest 8.2.1 (2024-05-19)</a><ul>
<li><a class="reference internal" href="#improvements">Improvements</a></li>
<li><a class="reference internal" href="#id94">Bug Fixes</a></li>
<li><a class="reference internal" href="#trivial-internal-changes">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-8-2-0-2024-04-27">pytest 8.2.0 (2024-04-27)</a><ul>
<li><a class="reference internal" href="#breaking-changes">Breaking Changes</a></li>
<li><a class="reference internal" href="#deprecations">Deprecations</a></li>
<li><a class="reference internal" href="#features">Features</a></li>
<li><a class="reference internal" href="#id103">Improvements</a></li>
<li><a class="reference internal" href="#id109">Bug Fixes</a></li>
<li><a class="reference internal" href="#id114">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-8-1-2-2024-04-26">pytest 8.1.2 (2024-04-26)</a><ul>
<li><a class="reference internal" href="#id117">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-8-1-1-2024-03-08">pytest 8.1.1 (2024-03-08)</a><ul>
<li><a class="reference internal" href="#id119">Features</a></li>
<li><a class="reference internal" href="#id122">Improvements</a></li>
<li><a class="reference internal" href="#id131">Bug Fixes</a></li>
<li><a class="reference internal" href="#id137">Improved Documentation</a></li>
<li><a class="reference internal" href="#id139">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-8-1-0-yanked">pytest 8.1.0 (YANKED)</a></li>
<li><a class="reference internal" href="#pytest-8-0-2-2024-02-24">pytest 8.0.2 (2024-02-24)</a><ul>
<li><a class="reference internal" href="#id142">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-8-0-1-2024-02-16">pytest 8.0.1 (2024-02-16)</a><ul>
<li><a class="reference internal" href="#id146">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-8-0-0-2024-01-27">pytest 8.0.0 (2024-01-27)</a><ul>
<li><a class="reference internal" href="#id153">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-8-0-0rc2-2024-01-17">pytest 8.0.0rc2 (2024-01-17)</a><ul>
<li><a class="reference internal" href="#id156">Improvements</a></li>
<li><a class="reference internal" href="#id159">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-8-0-0rc1-2023-12-30">pytest 8.0.0rc1 (2023-12-30)</a><ul>
<li><a class="reference internal" href="#id164">Breaking Changes</a><ul>
<li><a class="reference internal" href="#old-deprecations-are-now-errors">Old Deprecations Are Now Errors</a></li>
<li><a class="reference internal" href="#version-compatibility">Version Compatibility</a></li>
<li><a class="reference internal" href="#collection-changes">Collection Changes</a></li>
<li><a class="reference internal" href="#other-breaking-changes">Other breaking changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id175">Deprecations</a></li>
<li><a class="reference internal" href="#features-and-improvements">Features and Improvements</a><ul>
<li><a class="reference internal" href="#improved-diffs">Improved Diffs</a></li>
<li><a class="reference internal" href="#separate-control-for-assertion-verbosity">Separate Control For Assertion Verbosity</a></li>
<li><a class="reference internal" href="#additional-support-for-exception-groups-and-notes">Additional Support For Exception Groups and <code class="docutils literal notranslate"><span class="pre">__notes__</span></code></a></li>
<li><a class="reference internal" href="#custom-directory-collectors">Custom Directory collectors</a></li>
<li><a class="reference internal" href="#new-style-hook-wrappers">“New-style” Hook Wrappers</a></li>
<li><a class="reference internal" href="#other-improvements">Other Improvements</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id193">Bug Fixes</a></li>
<li><a class="reference internal" href="#id201">Improved Documentation</a></li>
<li><a class="reference internal" href="#id204">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-7-4-4-2023-12-31">pytest 7.4.4 (2023-12-31)</a><ul>
<li><a class="reference internal" href="#id210">Bug Fixes</a></li>
<li><a class="reference internal" href="#id215">Improved Documentation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-7-4-3-2023-10-24">pytest 7.4.3 (2023-10-24)</a><ul>
<li><a class="reference internal" href="#id217">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-7-4-2-2023-09-07">pytest 7.4.2 (2023-09-07)</a><ul>
<li><a class="reference internal" href="#id221">Bug Fixes</a></li>
<li><a class="reference internal" href="#id226">Improved Documentation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-7-4-1-2023-09-02">pytest 7.4.1 (2023-09-02)</a><ul>
<li><a class="reference internal" href="#id228">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-7-4-0-2023-06-23">pytest 7.4.0 (2023-06-23)</a><ul>
<li><a class="reference internal" href="#id232">Features</a></li>
<li><a class="reference internal" href="#id234">Improvements</a></li>
<li><a class="reference internal" href="#id244">Bug Fixes</a></li>
<li><a class="reference internal" href="#id250">Improved Documentation</a></li>
<li><a class="reference internal" href="#id252">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-7-3-2-2023-06-10">pytest 7.3.2 (2023-06-10)</a><ul>
<li><a class="reference internal" href="#id254">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-7-3-1-2023-04-14">pytest 7.3.1 (2023-04-14)</a><ul>
<li><a class="reference internal" href="#id261">Improvements</a></li>
<li><a class="reference internal" href="#id264">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-7-3-0-2023-04-08">pytest 7.3.0 (2023-04-08)</a><ul>
<li><a class="reference internal" href="#id267">Features</a></li>
<li><a class="reference internal" href="#id272">Improvements</a></li>
<li><a class="reference internal" href="#id279">Bug Fixes</a></li>
<li><a class="reference internal" href="#id283">Improved Documentation</a></li>
<li><a class="reference internal" href="#id285">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-7-2-2-2023-03-03">pytest 7.2.2 (2023-03-03)</a><ul>
<li><a class="reference internal" href="#id287">Bug Fixes</a></li>
<li><a class="reference internal" href="#id293">Improved Documentation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-7-2-1-2023-01-13">pytest 7.2.1 (2023-01-13)</a><ul>
<li><a class="reference internal" href="#id297">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-7-2-0-2022-10-23">pytest 7.2.0 (2022-10-23)</a><ul>
<li><a class="reference internal" href="#id303">Deprecations</a></li>
<li><a class="reference internal" href="#id309">Features</a></li>
<li><a class="reference internal" href="#id311">Improvements</a></li>
<li><a class="reference internal" href="#id324">Bug Fixes</a></li>
<li><a class="reference internal" href="#id330">Improved Documentation</a></li>
<li><a class="reference internal" href="#id334">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-7-1-3-2022-08-31">pytest 7.1.3 (2022-08-31)</a><ul>
<li><a class="reference internal" href="#id339">Bug Fixes</a></li>
<li><a class="reference internal" href="#id347">Improved Documentation</a></li>
<li><a class="reference internal" href="#id349">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-7-1-2-2022-04-23">pytest 7.1.2 (2022-04-23)</a><ul>
<li><a class="reference internal" href="#id351">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-7-1-1-2022-03-17">pytest 7.1.1 (2022-03-17)</a><ul>
<li><a class="reference internal" href="#id356">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-7-1-0-2022-03-13">pytest 7.1.0 (2022-03-13)</a><ul>
<li><a class="reference internal" href="#id358">Breaking Changes</a></li>
<li><a class="reference internal" href="#id361">Improvements</a></li>
<li><a class="reference internal" href="#id368">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-7-0-1-2022-02-11">pytest 7.0.1 (2022-02-11)</a><ul>
<li><a class="reference internal" href="#id375">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-7-0-0-2022-02-03">pytest 7.0.0 (2022-02-03)</a><ul>
<li><a class="reference internal" href="#id381">Deprecations</a></li>
<li><a class="reference internal" href="#id383">Bug Fixes</a></li>
<li><a class="reference internal" href="#id386">Improved Documentation</a></li>
<li><a class="reference internal" href="#id389">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-7-0-0rc1-2021-12-06">pytest 7.0.0rc1 (2021-12-06)</a><ul>
<li><a class="reference internal" href="#id391">Breaking Changes</a></li>
<li><a class="reference internal" href="#id398">Deprecations</a></li>
<li><a class="reference internal" href="#id408">Features</a></li>
<li><a class="reference internal" href="#id426">Improvements</a></li>
<li><a class="reference internal" href="#id437">Bug Fixes</a></li>
<li><a class="reference internal" href="#id459">Improved Documentation</a></li>
<li><a class="reference internal" href="#id467">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-6-2-5-2021-08-29">pytest 6.2.5 (2021-08-29)</a><ul>
<li><a class="reference internal" href="#id478">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-6-2-4-2021-05-04">pytest 6.2.4 (2021-05-04)</a><ul>
<li><a class="reference internal" href="#id479">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-6-2-3-2021-04-03">pytest 6.2.3 (2021-04-03)</a><ul>
<li><a class="reference internal" href="#id480">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-6-2-2-2021-01-25">pytest 6.2.2 (2021-01-25)</a><ul>
<li><a class="reference internal" href="#id481">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-6-2-1-2020-12-15">pytest 6.2.1 (2020-12-15)</a><ul>
<li><a class="reference internal" href="#id482">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-6-2-0-2020-12-12">pytest 6.2.0 (2020-12-12)</a><ul>
<li><a class="reference internal" href="#id483">Breaking Changes</a></li>
<li><a class="reference internal" href="#id484">Deprecations</a></li>
<li><a class="reference internal" href="#id485">Features</a></li>
<li><a class="reference internal" href="#id486">Improvements</a></li>
<li><a class="reference internal" href="#id487">Bug Fixes</a></li>
<li><a class="reference internal" href="#id488">Improved Documentation</a></li>
<li><a class="reference internal" href="#id489">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-6-1-2-2020-10-28">pytest 6.1.2 (2020-10-28)</a><ul>
<li><a class="reference internal" href="#id490">Bug Fixes</a></li>
<li><a class="reference internal" href="#id491">Improved Documentation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-6-1-1-2020-10-03">pytest 6.1.1 (2020-10-03)</a><ul>
<li><a class="reference internal" href="#id492">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-6-1-0-2020-09-26">pytest 6.1.0 (2020-09-26)</a><ul>
<li><a class="reference internal" href="#id493">Breaking Changes</a></li>
<li><a class="reference internal" href="#id494">Deprecations</a></li>
<li><a class="reference internal" href="#id495">Features</a></li>
<li><a class="reference internal" href="#id496">Improvements</a></li>
<li><a class="reference internal" href="#id497">Bug Fixes</a></li>
<li><a class="reference internal" href="#id498">Improved Documentation</a></li>
<li><a class="reference internal" href="#id499">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-6-0-2-2020-09-04">pytest 6.0.2 (2020-09-04)</a><ul>
<li><a class="reference internal" href="#id500">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-6-0-1-2020-07-30">pytest 6.0.1 (2020-07-30)</a><ul>
<li><a class="reference internal" href="#id501">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-6-0-0-2020-07-28">pytest 6.0.0 (2020-07-28)</a><ul>
<li><a class="reference internal" href="#id502">Breaking Changes</a></li>
<li><a class="reference internal" href="#id503">Features</a></li>
<li><a class="reference internal" href="#id504">Improvements</a></li>
<li><a class="reference internal" href="#id505">Bug Fixes</a></li>
<li><a class="reference internal" href="#id506">Improved Documentation</a></li>
<li><a class="reference internal" href="#id507">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-6-0-0rc1-2020-07-08">pytest 6.0.0rc1 (2020-07-08)</a><ul>
<li><a class="reference internal" href="#id508">Breaking Changes</a></li>
<li><a class="reference internal" href="#id509">Deprecations</a></li>
<li><a class="reference internal" href="#id510">Features</a></li>
<li><a class="reference internal" href="#id511">Improvements</a></li>
<li><a class="reference internal" href="#id512">Bug Fixes</a></li>
<li><a class="reference internal" href="#id513">Improved Documentation</a></li>
<li><a class="reference internal" href="#id514">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-5-4-3-2020-06-02">pytest 5.4.3 (2020-06-02)</a><ul>
<li><a class="reference internal" href="#id515">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-5-4-2-2020-05-08">pytest 5.4.2 (2020-05-08)</a><ul>
<li><a class="reference internal" href="#id516">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-5-4-1-2020-03-13">pytest 5.4.1 (2020-03-13)</a><ul>
<li><a class="reference internal" href="#id517">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-5-4-0-2020-03-12">pytest 5.4.0 (2020-03-12)</a><ul>
<li><a class="reference internal" href="#id518">Breaking Changes</a></li>
<li><a class="reference internal" href="#id519">Deprecations</a></li>
<li><a class="reference internal" href="#id520">Features</a></li>
<li><a class="reference internal" href="#id521">Improvements</a></li>
<li><a class="reference internal" href="#id522">Bug Fixes</a></li>
<li><a class="reference internal" href="#id523">Improved Documentation</a></li>
<li><a class="reference internal" href="#id524">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-5-3-5-2020-01-29">pytest 5.3.5 (2020-01-29)</a><ul>
<li><a class="reference internal" href="#id525">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-5-3-4-2020-01-20">pytest 5.3.4 (2020-01-20)</a><ul>
<li><a class="reference internal" href="#id526">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-5-3-3-2020-01-16">pytest 5.3.3 (2020-01-16)</a><ul>
<li><a class="reference internal" href="#id527">Bug Fixes</a></li>
<li><a class="reference internal" href="#id528">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-5-3-2-2019-12-13">pytest 5.3.2 (2019-12-13)</a><ul>
<li><a class="reference internal" href="#id529">Improvements</a></li>
<li><a class="reference internal" href="#id530">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-5-3-1-2019-11-25">pytest 5.3.1 (2019-11-25)</a><ul>
<li><a class="reference internal" href="#id531">Improvements</a></li>
<li><a class="reference internal" href="#id532">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-5-3-0-2019-11-19">pytest 5.3.0 (2019-11-19)</a><ul>
<li><a class="reference internal" href="#id533">Deprecations</a></li>
<li><a class="reference internal" href="#id534">Features</a></li>
<li><a class="reference internal" href="#id535">Improvements</a></li>
<li><a class="reference internal" href="#id536">Bug Fixes</a></li>
<li><a class="reference internal" href="#id537">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-5-2-4-2019-11-15">pytest 5.2.4 (2019-11-15)</a><ul>
<li><a class="reference internal" href="#id538">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-5-2-3-2019-11-14">pytest 5.2.3 (2019-11-14)</a><ul>
<li><a class="reference internal" href="#id539">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-5-2-2-2019-10-24">pytest 5.2.2 (2019-10-24)</a><ul>
<li><a class="reference internal" href="#id540">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-5-2-1-2019-10-06">pytest 5.2.1 (2019-10-06)</a><ul>
<li><a class="reference internal" href="#id541">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-5-2-0-2019-09-28">pytest 5.2.0 (2019-09-28)</a><ul>
<li><a class="reference internal" href="#id542">Deprecations</a></li>
<li><a class="reference internal" href="#id543">Features</a></li>
<li><a class="reference internal" href="#id544">Bug Fixes</a></li>
<li><a class="reference internal" href="#id545">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-5-1-3-2019-09-18">pytest 5.1.3 (2019-09-18)</a><ul>
<li><a class="reference internal" href="#id546">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-5-1-2-2019-08-30">pytest 5.1.2 (2019-08-30)</a><ul>
<li><a class="reference internal" href="#id547">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-5-1-1-2019-08-20">pytest 5.1.1 (2019-08-20)</a><ul>
<li><a class="reference internal" href="#id548">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-5-1-0-2019-08-15">pytest 5.1.0 (2019-08-15)</a><ul>
<li><a class="reference internal" href="#removals">Removals</a></li>
<li><a class="reference internal" href="#id549">Features</a></li>
<li><a class="reference internal" href="#id550">Improvements</a></li>
<li><a class="reference internal" href="#id551">Bug Fixes</a></li>
<li><a class="reference internal" href="#id552">Improved Documentation</a></li>
<li><a class="reference internal" href="#id553">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-5-0-1-2019-07-04">pytest 5.0.1 (2019-07-04)</a><ul>
<li><a class="reference internal" href="#id554">Bug Fixes</a></li>
<li><a class="reference internal" href="#id555">Improved Documentation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-5-0-0-2019-06-28">pytest 5.0.0 (2019-06-28)</a><ul>
<li><a class="reference internal" href="#important">Important</a></li>
<li><a class="reference internal" href="#id556">Removals</a></li>
<li><a class="reference internal" href="#id557">Deprecations</a></li>
<li><a class="reference internal" href="#id558">Features</a></li>
<li><a class="reference internal" href="#id559">Bug Fixes</a></li>
<li><a class="reference internal" href="#id560">Improved Documentation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-4-6-11-2020-06-04">pytest 4.6.11 (2020-06-04)</a><ul>
<li><a class="reference internal" href="#id561">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-4-6-10-2020-05-08">pytest 4.6.10 (2020-05-08)</a><ul>
<li><a class="reference internal" href="#id562">Features</a></li>
<li><a class="reference internal" href="#id563">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-4-6-9-2020-01-04">pytest 4.6.9 (2020-01-04)</a><ul>
<li><a class="reference internal" href="#id564">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-4-6-8-2019-12-19">pytest 4.6.8 (2019-12-19)</a><ul>
<li><a class="reference internal" href="#id565">Features</a></li>
<li><a class="reference internal" href="#id566">Bug Fixes</a></li>
<li><a class="reference internal" href="#id567">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-4-6-7-2019-12-05">pytest 4.6.7 (2019-12-05)</a><ul>
<li><a class="reference internal" href="#id568">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-4-6-6-2019-10-11">pytest 4.6.6 (2019-10-11)</a><ul>
<li><a class="reference internal" href="#id569">Bug Fixes</a></li>
<li><a class="reference internal" href="#id570">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-4-6-5-2019-08-05">pytest 4.6.5 (2019-08-05)</a><ul>
<li><a class="reference internal" href="#id571">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-4-6-4-2019-06-28">pytest 4.6.4 (2019-06-28)</a><ul>
<li><a class="reference internal" href="#id572">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-4-6-3-2019-06-11">pytest 4.6.3 (2019-06-11)</a><ul>
<li><a class="reference internal" href="#id573">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-4-6-2-2019-06-03">pytest 4.6.2 (2019-06-03)</a><ul>
<li><a class="reference internal" href="#id574">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-4-6-1-2019-06-02">pytest 4.6.1 (2019-06-02)</a><ul>
<li><a class="reference internal" href="#id575">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-4-6-0-2019-05-31">pytest 4.6.0 (2019-05-31)</a><ul>
<li><a class="reference internal" href="#id576">Important</a></li>
<li><a class="reference internal" href="#id578">Features</a></li>
<li><a class="reference internal" href="#id579">Bug Fixes</a></li>
<li><a class="reference internal" href="#id580">Improved Documentation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-4-5-0-2019-05-11">pytest 4.5.0 (2019-05-11)</a><ul>
<li><a class="reference internal" href="#id581">Features</a></li>
<li><a class="reference internal" href="#id582">Bug Fixes</a></li>
<li><a class="reference internal" href="#id583">Improved Documentation</a></li>
<li><a class="reference internal" href="#id584">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-4-4-2-2019-05-08">pytest 4.4.2 (2019-05-08)</a><ul>
<li><a class="reference internal" href="#id585">Bug Fixes</a></li>
<li><a class="reference internal" href="#id586">Improved Documentation</a></li>
<li><a class="reference internal" href="#id587">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-4-4-1-2019-04-15">pytest 4.4.1 (2019-04-15)</a><ul>
<li><a class="reference internal" href="#id588">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-4-4-0-2019-03-29">pytest 4.4.0 (2019-03-29)</a><ul>
<li><a class="reference internal" href="#id589">Features</a></li>
<li><a class="reference internal" href="#id590">Bug Fixes</a></li>
<li><a class="reference internal" href="#id591">Improved Documentation</a></li>
<li><a class="reference internal" href="#id592">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-4-3-1-2019-03-11">pytest 4.3.1 (2019-03-11)</a><ul>
<li><a class="reference internal" href="#id593">Bug Fixes</a></li>
<li><a class="reference internal" href="#id594">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-4-3-0-2019-02-16">pytest 4.3.0 (2019-02-16)</a><ul>
<li><a class="reference internal" href="#id595">Deprecations</a></li>
<li><a class="reference internal" href="#id596">Features</a></li>
<li><a class="reference internal" href="#id597">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-4-2-1-2019-02-12">pytest 4.2.1 (2019-02-12)</a><ul>
<li><a class="reference internal" href="#id598">Bug Fixes</a></li>
<li><a class="reference internal" href="#id599">Improved Documentation</a></li>
<li><a class="reference internal" href="#id600">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-4-2-0-2019-01-30">pytest 4.2.0 (2019-01-30)</a><ul>
<li><a class="reference internal" href="#id601">Features</a></li>
<li><a class="reference internal" href="#id602">Bug Fixes</a></li>
<li><a class="reference internal" href="#id603">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-4-1-1-2019-01-12">pytest 4.1.1 (2019-01-12)</a><ul>
<li><a class="reference internal" href="#id604">Bug Fixes</a></li>
<li><a class="reference internal" href="#id605">Improved Documentation</a></li>
<li><a class="reference internal" href="#id606">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-4-1-0-2019-01-05">pytest 4.1.0 (2019-01-05)</a><ul>
<li><a class="reference internal" href="#id607">Removals</a></li>
<li><a class="reference internal" href="#id608">Deprecations</a></li>
<li><a class="reference internal" href="#id609">Features</a></li>
<li><a class="reference internal" href="#id610">Bug Fixes</a></li>
<li><a class="reference internal" href="#id611">Improved Documentation</a></li>
<li><a class="reference internal" href="#id612">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-4-0-2-2018-12-13">pytest 4.0.2 (2018-12-13)</a><ul>
<li><a class="reference internal" href="#id613">Bug Fixes</a></li>
<li><a class="reference internal" href="#id614">Improved Documentation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-4-0-1-2018-11-23">pytest 4.0.1 (2018-11-23)</a><ul>
<li><a class="reference internal" href="#id615">Bug Fixes</a></li>
<li><a class="reference internal" href="#id616">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-4-0-0-2018-11-13">pytest 4.0.0 (2018-11-13)</a><ul>
<li><a class="reference internal" href="#id617">Removals</a></li>
<li><a class="reference internal" href="#id618">Features</a></li>
<li><a class="reference internal" href="#id619">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-10-1-2018-11-11">pytest 3.10.1 (2018-11-11)</a><ul>
<li><a class="reference internal" href="#id620">Bug Fixes</a></li>
<li><a class="reference internal" href="#id621">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-10-0-2018-11-03">pytest 3.10.0 (2018-11-03)</a><ul>
<li><a class="reference internal" href="#id622">Features</a></li>
<li><a class="reference internal" href="#id623">Bug Fixes</a></li>
<li><a class="reference internal" href="#id624">Improved Documentation</a></li>
<li><a class="reference internal" href="#id625">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-9-3-2018-10-27">pytest 3.9.3 (2018-10-27)</a><ul>
<li><a class="reference internal" href="#id626">Bug Fixes</a></li>
<li><a class="reference internal" href="#id627">Improved Documentation</a></li>
<li><a class="reference internal" href="#id628">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-9-2-2018-10-22">pytest 3.9.2 (2018-10-22)</a><ul>
<li><a class="reference internal" href="#id629">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-9-1-2018-10-16">pytest 3.9.1 (2018-10-16)</a><ul>
<li><a class="reference internal" href="#id630">Features</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-9-0-2018-10-15-not-published-due-to-a-release-automation-bug">pytest 3.9.0 (2018-10-15 - not published due to a release automation bug)</a><ul>
<li><a class="reference internal" href="#id631">Deprecations</a></li>
<li><a class="reference internal" href="#id632">Features</a></li>
<li><a class="reference internal" href="#id633">Bug Fixes</a></li>
<li><a class="reference internal" href="#id634">Improved Documentation</a></li>
<li><a class="reference internal" href="#id635">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-8-2-2018-10-02">pytest 3.8.2 (2018-10-02)</a><ul>
<li><a class="reference internal" href="#deprecations-and-removals">Deprecations and Removals</a></li>
<li><a class="reference internal" href="#id636">Bug Fixes</a></li>
<li><a class="reference internal" href="#id637">Improved Documentation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-8-1-2018-09-22">pytest 3.8.1 (2018-09-22)</a><ul>
<li><a class="reference internal" href="#id638">Bug Fixes</a></li>
<li><a class="reference internal" href="#id639">Improved Documentation</a></li>
<li><a class="reference internal" href="#id640">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-8-0-2018-09-05">pytest 3.8.0 (2018-09-05)</a><ul>
<li><a class="reference internal" href="#id641">Deprecations and Removals</a></li>
<li><a class="reference internal" href="#id642">Features</a></li>
<li><a class="reference internal" href="#id643">Bug Fixes</a></li>
<li><a class="reference internal" href="#id644">Improved Documentation</a></li>
<li><a class="reference internal" href="#id645">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-7-4-2018-08-29">pytest 3.7.4 (2018-08-29)</a><ul>
<li><a class="reference internal" href="#id646">Bug Fixes</a></li>
<li><a class="reference internal" href="#id647">Improved Documentation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-7-3-2018-08-26">pytest 3.7.3 (2018-08-26)</a><ul>
<li><a class="reference internal" href="#id648">Bug Fixes</a></li>
<li><a class="reference internal" href="#id649">Improved Documentation</a></li>
<li><a class="reference internal" href="#id650">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-7-2-2018-08-16">pytest 3.7.2 (2018-08-16)</a><ul>
<li><a class="reference internal" href="#id651">Bug Fixes</a></li>
<li><a class="reference internal" href="#id652">Improved Documentation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-7-1-2018-08-02">pytest 3.7.1 (2018-08-02)</a><ul>
<li><a class="reference internal" href="#id653">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-7-0-2018-07-30">pytest 3.7.0 (2018-07-30)</a><ul>
<li><a class="reference internal" href="#id654">Deprecations and Removals</a></li>
<li><a class="reference internal" href="#id655">Features</a></li>
<li><a class="reference internal" href="#id656">Bug Fixes</a></li>
<li><a class="reference internal" href="#id657">Improved Documentation</a></li>
<li><a class="reference internal" href="#id658">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-6-4-2018-07-28">pytest 3.6.4 (2018-07-28)</a><ul>
<li><a class="reference internal" href="#id659">Bug Fixes</a></li>
<li><a class="reference internal" href="#id660">Improved Documentation</a></li>
<li><a class="reference internal" href="#id661">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-6-3-2018-07-04">pytest 3.6.3 (2018-07-04)</a><ul>
<li><a class="reference internal" href="#id662">Bug Fixes</a></li>
<li><a class="reference internal" href="#id663">Improved Documentation</a></li>
<li><a class="reference internal" href="#id664">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-6-2-2018-06-20">pytest 3.6.2 (2018-06-20)</a><ul>
<li><a class="reference internal" href="#id665">Bug Fixes</a></li>
<li><a class="reference internal" href="#id666">Improved Documentation</a></li>
<li><a class="reference internal" href="#id667">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-6-1-2018-06-05">pytest 3.6.1 (2018-06-05)</a><ul>
<li><a class="reference internal" href="#id668">Bug Fixes</a></li>
<li><a class="reference internal" href="#id669">Improved Documentation</a></li>
<li><a class="reference internal" href="#id670">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-6-0-2018-05-23">pytest 3.6.0 (2018-05-23)</a><ul>
<li><a class="reference internal" href="#id671">Features</a></li>
<li><a class="reference internal" href="#id672">Bug Fixes</a></li>
<li><a class="reference internal" href="#id673">Improved Documentation</a></li>
<li><a class="reference internal" href="#id674">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-5-1-2018-04-23">pytest 3.5.1 (2018-04-23)</a><ul>
<li><a class="reference internal" href="#id675">Bug Fixes</a></li>
<li><a class="reference internal" href="#id676">Improved Documentation</a></li>
<li><a class="reference internal" href="#id677">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-5-0-2018-03-21">pytest 3.5.0 (2018-03-21)</a><ul>
<li><a class="reference internal" href="#id678">Deprecations and Removals</a></li>
<li><a class="reference internal" href="#id679">Features</a></li>
<li><a class="reference internal" href="#id680">Bug Fixes</a></li>
<li><a class="reference internal" href="#id681">Improved Documentation</a></li>
<li><a class="reference internal" href="#id682">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-4-2-2018-03-04">pytest 3.4.2 (2018-03-04)</a><ul>
<li><a class="reference internal" href="#id683">Bug Fixes</a></li>
<li><a class="reference internal" href="#id684">Improved Documentation</a></li>
<li><a class="reference internal" href="#id685">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-4-1-2018-02-20">pytest 3.4.1 (2018-02-20)</a><ul>
<li><a class="reference internal" href="#id686">Bug Fixes</a></li>
<li><a class="reference internal" href="#id687">Improved Documentation</a></li>
<li><a class="reference internal" href="#id688">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-4-0-2018-01-30">pytest 3.4.0 (2018-01-30)</a><ul>
<li><a class="reference internal" href="#id689">Deprecations and Removals</a></li>
<li><a class="reference internal" href="#id690">Features</a></li>
<li><a class="reference internal" href="#id691">Bug Fixes</a></li>
<li><a class="reference internal" href="#id692">Improved Documentation</a></li>
<li><a class="reference internal" href="#id693">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-3-2-2017-12-25">pytest 3.3.2 (2017-12-25)</a><ul>
<li><a class="reference internal" href="#id694">Bug Fixes</a></li>
<li><a class="reference internal" href="#id695">Improved Documentation</a></li>
<li><a class="reference internal" href="#id696">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-3-1-2017-12-05">pytest 3.3.1 (2017-12-05)</a><ul>
<li><a class="reference internal" href="#id697">Bug Fixes</a></li>
<li><a class="reference internal" href="#id698">Improved Documentation</a></li>
<li><a class="reference internal" href="#id699">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-3-0-2017-11-23">pytest 3.3.0 (2017-11-23)</a><ul>
<li><a class="reference internal" href="#id700">Deprecations and Removals</a></li>
<li><a class="reference internal" href="#id701">Features</a></li>
<li><a class="reference internal" href="#id702">Bug Fixes</a></li>
<li><a class="reference internal" href="#id703">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-2-5-2017-11-15">pytest 3.2.5 (2017-11-15)</a><ul>
<li><a class="reference internal" href="#id704">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-2-4-2017-11-13">pytest 3.2.4 (2017-11-13)</a><ul>
<li><a class="reference internal" href="#id705">Bug Fixes</a></li>
<li><a class="reference internal" href="#id706">Improved Documentation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-2-3-2017-10-03">pytest 3.2.3 (2017-10-03)</a><ul>
<li><a class="reference internal" href="#id707">Bug Fixes</a></li>
<li><a class="reference internal" href="#id708">Improved Documentation</a></li>
<li><a class="reference internal" href="#id709">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-2-2-2017-09-06">pytest 3.2.2 (2017-09-06)</a><ul>
<li><a class="reference internal" href="#id710">Bug Fixes</a></li>
<li><a class="reference internal" href="#id711">Improved Documentation</a></li>
<li><a class="reference internal" href="#id712">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-2-1-2017-08-08">pytest 3.2.1 (2017-08-08)</a><ul>
<li><a class="reference internal" href="#id713">Bug Fixes</a></li>
<li><a class="reference internal" href="#id714">Improved Documentation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-2-0-2017-07-30">pytest 3.2.0 (2017-07-30)</a><ul>
<li><a class="reference internal" href="#id715">Deprecations and Removals</a></li>
<li><a class="reference internal" href="#id716">Features</a></li>
<li><a class="reference internal" href="#id717">Bug Fixes</a></li>
<li><a class="reference internal" href="#id718">Improved Documentation</a></li>
<li><a class="reference internal" href="#id719">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-1-3-2017-07-03">pytest 3.1.3 (2017-07-03)</a><ul>
<li><a class="reference internal" href="#id720">Bug Fixes</a></li>
<li><a class="reference internal" href="#id721">Improved Documentation</a></li>
<li><a class="reference internal" href="#id722">Trivial/Internal Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-1-2-2017-06-08">pytest 3.1.2 (2017-06-08)</a><ul>
<li><a class="reference internal" href="#id723">Bug Fixes</a></li>
<li><a class="reference internal" href="#id724">Improved Documentation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytest-3-1-1-2017-05-30">pytest 3.1.1 (2017-05-30)</a><ul>
<li><a class="reference internal" href="#id725">Bug Fixes</a></li>
<li><a class="reference internal" href="#id726">Improved Documentation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id727">3.1.0 (2017-05-22)</a><ul>
<li><a class="reference internal" href="#id728">New Features</a></li>
<li><a class="reference internal" href="#changes">Changes</a></li>
<li><a class="reference internal" href="#id729">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id730">3.0.7 (2017-03-14)</a></li>
<li><a class="reference internal" href="#id731">3.0.6 (2017-01-22)</a></li>
<li><a class="reference internal" href="#id732">3.0.5 (2016-12-05)</a></li>
<li><a class="reference internal" href="#id733">3.0.4 (2016-11-09)</a></li>
<li><a class="reference internal" href="#id734">3.0.3 (2016-09-28)</a></li>
<li><a class="reference internal" href="#id735">3.0.2 (2016-09-01)</a></li>
<li><a class="reference internal" href="#id736">3.0.1 (2016-08-23)</a></li>
<li><a class="reference internal" href="#release-3-0-0">3.0.0 (2016-08-18)</a></li>
<li><a class="reference internal" href="#id738">2.9.2 (2016-05-31)</a></li>
<li><a class="reference internal" href="#id739">2.9.1 (2016-03-17)</a></li>
<li><a class="reference internal" href="#id740">2.9.0 (2016-02-29)</a></li>
<li><a class="reference internal" href="#id741">2.8.7 (2016-01-24)</a></li>
<li><a class="reference internal" href="#id742">2.8.6 (2016-01-21)</a></li>
<li><a class="reference internal" href="#id743">2.8.5 (2015-12-11)</a></li>
<li><a class="reference internal" href="#id744">2.8.4 (2015-12-06)</a></li>
<li><a class="reference internal" href="#id745">2.8.3 (2015-11-18)</a></li>
<li><a class="reference internal" href="#id746">2.8.2 (2015-10-07)</a></li>
<li><a class="reference internal" href="#id747">2.8.1 (2015-09-29)</a></li>
<li><a class="reference internal" href="#id748">2.8.0 (2015-09-18)</a></li>
<li><a class="reference internal" href="#id749">2.7.3 (2015-09-15)</a></li>
<li><a class="reference internal" href="#id750">2.7.2 (2015-06-23)</a></li>
<li><a class="reference internal" href="#id751">2.7.1 (2015-05-19)</a></li>
<li><a class="reference internal" href="#id752">2.7.0 (2015-03-26)</a></li>
<li><a class="reference internal" href="#id753">2.6.4 (2014-10-24)</a></li>
<li><a class="reference internal" href="#id754">2.6.3 (2014-09-24)</a></li>
<li><a class="reference internal" href="#id755">2.6.2 (2014-09-05)</a></li>
<li><a class="reference internal" href="#id756">2.6.1 (2014-08-07)</a></li>
<li><a class="reference internal" href="#id757">2.6</a></li>
<li><a class="reference internal" href="#id758">2.5.2 (2014-01-29)</a></li>
<li><a class="reference internal" href="#id759">2.5.1 (2013-12-17)</a></li>
<li><a class="reference internal" href="#id760">2.5.0 (2013-12-12)</a></li>
<li><a class="reference internal" href="#id761">2.4.2 (2013-10-04)</a></li>
<li><a class="reference internal" href="#id762">2.4.1 (2013-10-02)</a></li>
<li><a class="reference internal" href="#id763">2.4</a></li>
<li><a class="reference internal" href="#id764">2.3.5 (2013-04-30)</a></li>
<li><a class="reference internal" href="#id765">2.3.4 (2012-11-20)</a></li>
<li><a class="reference internal" href="#id766">2.3.3 (2012-11-06)</a></li>
<li><a class="reference internal" href="#id767">2.3.2 (2012-10-25)</a></li>
<li><a class="reference internal" href="#id768">2.3.1 (2012-10-20)</a></li>
<li><a class="reference internal" href="#id769">2.3.0 (2012-10-19)</a></li>
<li><a class="reference internal" href="#id770">2.2.4 (2012-05-22)</a></li>
<li><a class="reference internal" href="#id771">2.2.3 (2012-02-05)</a></li>
<li><a class="reference internal" href="#id772">2.2.2 (2012-02-05)</a></li>
<li><a class="reference internal" href="#id773">2.2.1 (2011-12-16)</a></li>
<li><a class="reference internal" href="#id774">2.2.0 (2011-11-18)</a></li>
<li><a class="reference internal" href="#id775">2.1.3 (2011-10-18)</a></li>
<li><a class="reference internal" href="#id776">2.1.2 (2011-09-24)</a></li>
<li><a class="reference internal" href="#id777">2.1.1</a></li>
<li><a class="reference internal" href="#id778">2.1.0 (2011-07-09)</a></li>
<li><a class="reference internal" href="#id779">2.0.3 (2011-05-11)</a></li>
<li><a class="reference internal" href="#id780">2.0.2 (2011-03-09)</a></li>
<li><a class="reference internal" href="#id781">2.0.1 (2011-02-07)</a></li>
<li><a class="reference internal" href="#id782">2.0.0 (2010-11-25)</a></li>
<li><a class="reference internal" href="#id783">1.3.4 (2010-09-14)</a></li>
<li><a class="reference internal" href="#id784">1.3.3 (2010-07-30)</a></li>
<li><a class="reference internal" href="#id785">1.3.2 (2010-07-08)</a></li>
<li><a class="reference internal" href="#id786">1.3.1 (2010-05-25)</a></li>
<li><a class="reference internal" href="#id787">1.3.0 (2010-05-05)</a></li>
<li><a class="reference internal" href="#id788">1.2.0 (2010-01-18)</a></li>
<li><a class="reference internal" href="#id789">1.1.1 (2009-11-24)</a></li>
<li><a class="reference internal" href="#id790">1.1.0 (2009-11-05)</a></li>
<li><a class="reference internal" href="#id791">1.0.3</a></li>
<li><a class="reference internal" href="#id792">1.0.2 (2009-08-27)</a></li>
<li><a class="reference internal" href="#id793">1.0.1 (2009-08-19)</a></li>
<li><a class="reference internal" href="#id794">1.0.0 (2009-08-04)</a></li>
<li><a class="reference internal" href="#b9-2009-07-31">1.0.0b9 (2009-07-31)</a></li>
<li><a class="reference internal" href="#b8-2009-07-22">1.0.0b8 (2009-07-22)</a></li>
<li><a class="reference internal" href="#b7">1.0.0b7</a></li>
<li><a class="reference internal" href="#b3-2009-06-19">1.0.0b3 (2009-06-19)</a></li>
<li><a class="reference internal" href="#b1">1.0.0b1</a></li>
<li><a class="reference internal" href="#id795">0.9.2</a></li>
<li><a class="reference internal" href="#id796">0.9.1</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=7c91f8fd"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="_static/tabs.js?v=3030b3cb"></script>
    </body>
</html>